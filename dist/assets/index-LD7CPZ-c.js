var XI=Object.defineProperty;var YI=(e,t,r)=>t in e?XI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Tr=(e,t,r)=>YI(e,typeof t!="symbol"?t+"":t,r);function JI(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var pse=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mse(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ZI(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var vS={exports:{}},Hg={},yS={exports:{}},pr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var th=Symbol.for("react.element"),eU=Symbol.for("react.portal"),tU=Symbol.for("react.fragment"),rU=Symbol.for("react.strict_mode"),nU=Symbol.for("react.profiler"),sU=Symbol.for("react.provider"),aU=Symbol.for("react.context"),iU=Symbol.for("react.forward_ref"),oU=Symbol.for("react.suspense"),lU=Symbol.for("react.memo"),cU=Symbol.for("react.lazy"),W_=Symbol.iterator;function AU(e){return e===null||typeof e!="object"?null:(e=W_&&e[W_]||e["@@iterator"],typeof e=="function"?e:null)}var wS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bS=Object.assign,_S={};function Bd(e,t,r){this.props=e,this.context=t,this.refs=_S,this.updater=r||wS}Bd.prototype.isReactComponent={};Bd.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Bd.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function BS(){}BS.prototype=Bd.prototype;function s2(e,t,r){this.props=e,this.context=t,this.refs=_S,this.updater=r||wS}var a2=s2.prototype=new BS;a2.constructor=s2;bS(a2,Bd.prototype);a2.isPureReactComponent=!0;var $_=Array.isArray,CS=Object.prototype.hasOwnProperty,i2={current:null},NS={key:!0,ref:!0,__self:!0,__source:!0};function SS(e,t,r){var n,s={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)CS.call(t,n)&&!NS.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),A=0;A<l;A++)c[A]=arguments[A+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:th,type:e,key:a,ref:o,props:s,_owner:i2.current}}function uU(e,t){return{$$typeof:th,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function o2(e){return typeof e=="object"&&e!==null&&e.$$typeof===th}function dU(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var z_=/\/+/g;function s1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dU(""+e.key):t.toString(36)}function hm(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case th:case eU:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+s1(o,0):n,$_(s)?(r="",e!=null&&(r=e.replace(z_,"$&/")+"/"),hm(s,t,r,"",function(A){return A})):s!=null&&(o2(s)&&(s=uU(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(z_,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",$_(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+s1(a,l);o+=hm(a,t,r,c,s)}else if(c=AU(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+s1(a,l++),o+=hm(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Xh(e,t,r){if(e==null)return e;var n=[],s=0;return hm(e,n,"","",function(a){return t.call(r,a,s++)}),n}function fU(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xa={current:null},pm={transition:null},hU={ReactCurrentDispatcher:xa,ReactCurrentBatchConfig:pm,ReactCurrentOwner:i2};function kS(){throw Error("act(...) is not supported in production builds of React.")}pr.Children={map:Xh,forEach:function(e,t,r){Xh(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Xh(e,function(){t++}),t},toArray:function(e){return Xh(e,function(t){return t})||[]},only:function(e){if(!o2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};pr.Component=Bd;pr.Fragment=tU;pr.Profiler=nU;pr.PureComponent=s2;pr.StrictMode=rU;pr.Suspense=oU;pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hU;pr.act=kS;pr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=bS({},e.props),s=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=i2.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)CS.call(t,c)&&!NS.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var A=0;A<c;A++)l[A]=arguments[A+2];n.children=l}return{$$typeof:th,type:e.type,key:s,ref:a,props:n,_owner:o}};pr.createContext=function(e){return e={$$typeof:aU,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:sU,_context:e},e.Consumer=e};pr.createElement=SS;pr.createFactory=function(e){var t=SS.bind(null,e);return t.type=e,t};pr.createRef=function(){return{current:null}};pr.forwardRef=function(e){return{$$typeof:iU,render:e}};pr.isValidElement=o2;pr.lazy=function(e){return{$$typeof:cU,_payload:{_status:-1,_result:e},_init:fU}};pr.memo=function(e,t){return{$$typeof:lU,type:e,compare:t===void 0?null:t}};pr.startTransition=function(e){var t=pm.transition;pm.transition={};try{e()}finally{pm.transition=t}};pr.unstable_act=kS;pr.useCallback=function(e,t){return xa.current.useCallback(e,t)};pr.useContext=function(e){return xa.current.useContext(e)};pr.useDebugValue=function(){};pr.useDeferredValue=function(e){return xa.current.useDeferredValue(e)};pr.useEffect=function(e,t){return xa.current.useEffect(e,t)};pr.useId=function(){return xa.current.useId()};pr.useImperativeHandle=function(e,t,r){return xa.current.useImperativeHandle(e,t,r)};pr.useInsertionEffect=function(e,t){return xa.current.useInsertionEffect(e,t)};pr.useLayoutEffect=function(e,t){return xa.current.useLayoutEffect(e,t)};pr.useMemo=function(e,t){return xa.current.useMemo(e,t)};pr.useReducer=function(e,t,r){return xa.current.useReducer(e,t,r)};pr.useRef=function(e){return xa.current.useRef(e)};pr.useState=function(e){return xa.current.useState(e)};pr.useSyncExternalStore=function(e,t,r){return xa.current.useSyncExternalStore(e,t,r)};pr.useTransition=function(){return xa.current.useTransition()};pr.version="18.3.1";yS.exports=pr;var G=yS.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pU=G,mU=Symbol.for("react.element"),gU=Symbol.for("react.fragment"),xU=Object.prototype.hasOwnProperty,vU=pU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yU={key:!0,ref:!0,__self:!0,__source:!0};function ES(e,t,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)xU.call(t,n)&&!yU.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:mU,type:e,key:a,ref:o,props:s,_owner:vU.current}}Hg.Fragment=gU;Hg.jsx=ES;Hg.jsxs=ES;vS.exports=Hg;var i=vS.exports,FS={exports:{}},ai={},jS={exports:{}},TS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,H){var se=V.length;V.push(H);e:for(;0<se;){var ce=se-1>>>1,B=V[ce];if(0<s(B,H))V[ce]=H,V[se]=B,se=ce;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var H=V[0],se=V.pop();if(se!==H){V[0]=se;e:for(var ce=0,B=V.length,U=B>>>1;ce<U;){var F=2*(ce+1)-1,D=V[F],X=F+1,K=V[X];if(0>s(D,se))X<B&&0>s(K,D)?(V[ce]=K,V[X]=se,ce=X):(V[ce]=D,V[F]=se,ce=F);else if(X<B&&0>s(K,se))V[ce]=K,V[X]=se,ce=X;else break e}}return H}function s(V,H){var se=V.sortIndex-H.sortIndex;return se!==0?se:V.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],A=[],u=1,f=null,h=3,d=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(V){for(var H=r(A);H!==null;){if(H.callback===null)n(A);else if(H.startTime<=V)n(A),H.sortIndex=H.expirationTime,t(c,H);else break;H=r(A)}}function v(V){if(g=!1,b(V),!x)if(r(c)!==null)x=!0,q(C);else{var H=r(A);H!==null&&M(v,H.startTime-V)}}function C(V,H){x=!1,g&&(g=!1,m(I),I=-1),d=!0;var se=h;try{for(b(H),f=r(c);f!==null&&(!(f.expirationTime>H)||V&&!L());){var ce=f.callback;if(typeof ce=="function"){f.callback=null,h=f.priorityLevel;var B=ce(f.expirationTime<=H);H=e.unstable_now(),typeof B=="function"?f.callback=B:f===r(c)&&n(c),b(H)}else n(c);f=r(c)}if(f!==null)var U=!0;else{var F=r(A);F!==null&&M(v,F.startTime-H),U=!1}return U}finally{f=null,h=se,d=!1}}var k=!1,S=null,I=-1,N=5,Q=-1;function L(){return!(e.unstable_now()-Q<N)}function T(){if(S!==null){var V=e.unstable_now();Q=V;var H=!0;try{H=S(!0,V)}finally{H?P():(k=!1,S=null)}}else k=!1}var P;if(typeof p=="function")P=function(){p(T)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,z=R.port2;R.port1.onmessage=T,P=function(){z.postMessage(null)}}else P=function(){y(T,0)};function q(V){S=V,k||(k=!0,P())}function M(V,H){I=y(function(){V(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){x||d||(x=!0,q(C))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(V){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var se=h;h=H;try{return V()}finally{h=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,H){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var se=h;h=V;try{return H()}finally{h=se}},e.unstable_scheduleCallback=function(V,H,se){var ce=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ce+se:ce):se=ce,V){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=se+B,V={id:u++,callback:H,priorityLevel:V,startTime:se,expirationTime:B,sortIndex:-1},se>ce?(V.sortIndex=se,t(A,V),r(c)===null&&V===r(A)&&(g?(m(I),I=-1):g=!0,M(v,se-ce))):(V.sortIndex=B,t(c,V),x||d||(x=!0,q(C))),V},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(V){var H=h;return function(){var se=h;h=H;try{return V.apply(this,arguments)}finally{h=se}}}})(TS);jS.exports=TS;var wU=jS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bU=G,ni=wU;function mt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var IS=new Set,pf={};function HA(e,t){dd(e,t),dd(e+"Capture",t)}function dd(e,t){for(pf[e]=t,e=0;e<t.length;e++)IS.add(t[e])}var gl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zv=Object.prototype.hasOwnProperty,_U=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,X_={},Y_={};function BU(e){return Zv.call(Y_,e)?!0:Zv.call(X_,e)?!1:_U.test(e)?Y_[e]=!0:(X_[e]=!0,!1)}function CU(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function NU(e,t,r,n){if(t===null||typeof t>"u"||CU(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function va(e,t,r,n,s,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Ss={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ss[e]=new va(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ss[t]=new va(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ss[e]=new va(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ss[e]=new va(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ss[e]=new va(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ss[e]=new va(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ss[e]=new va(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ss[e]=new va(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ss[e]=new va(e,5,!1,e.toLowerCase(),null,!1,!1)});var l2=/[\-:]([a-z])/g;function c2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(l2,c2);Ss[t]=new va(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(l2,c2);Ss[t]=new va(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(l2,c2);Ss[t]=new va(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ss[e]=new va(e,1,!1,e.toLowerCase(),null,!1,!1)});Ss.xlinkHref=new va("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ss[e]=new va(e,1,!1,e.toLowerCase(),null,!0,!0)});function A2(e,t,r,n){var s=Ss.hasOwnProperty(t)?Ss[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(NU(t,r,s,n)&&(r=null),n||s===null?BU(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var _l=bU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yh=Symbol.for("react.element"),Iu=Symbol.for("react.portal"),Uu=Symbol.for("react.fragment"),u2=Symbol.for("react.strict_mode"),ey=Symbol.for("react.profiler"),US=Symbol.for("react.provider"),LS=Symbol.for("react.context"),d2=Symbol.for("react.forward_ref"),ty=Symbol.for("react.suspense"),ry=Symbol.for("react.suspense_list"),f2=Symbol.for("react.memo"),Yl=Symbol.for("react.lazy"),DS=Symbol.for("react.offscreen"),J_=Symbol.iterator;function o0(e){return e===null||typeof e!="object"?null:(e=J_&&e[J_]||e["@@iterator"],typeof e=="function"?e:null)}var hn=Object.assign,a1;function S0(e){if(a1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);a1=t&&t[1]||""}return`
`+a1+e}var i1=!1;function o1(e,t){if(!e||i1)return"";i1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(A){var n=A}Reflect.construct(e,[],t)}else{try{t.call()}catch(A){n=A}e.call(t.prototype)}else{try{throw Error()}catch(A){n=A}e()}}catch(A){if(A&&n&&typeof A.stack=="string"){for(var s=A.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{i1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?S0(e):""}function SU(e){switch(e.tag){case 5:return S0(e.type);case 16:return S0("Lazy");case 13:return S0("Suspense");case 19:return S0("SuspenseList");case 0:case 2:case 15:return e=o1(e.type,!1),e;case 11:return e=o1(e.type.render,!1),e;case 1:return e=o1(e.type,!0),e;default:return""}}function ny(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Uu:return"Fragment";case Iu:return"Portal";case ey:return"Profiler";case u2:return"StrictMode";case ty:return"Suspense";case ry:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case LS:return(e.displayName||"Context")+".Consumer";case US:return(e._context.displayName||"Context")+".Provider";case d2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case f2:return t=e.displayName||null,t!==null?t:ny(e.type)||"Memo";case Yl:t=e._payload,e=e._init;try{return ny(e(t))}catch{}}return null}function kU(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ny(t);case 8:return t===u2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function PS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function EU(e){var t=PS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Jh(e){e._valueTracker||(e._valueTracker=EU(e))}function OS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=PS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Om(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sy(e,t){var r=t.checked;return hn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Z_(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=bc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function RS(e,t){t=t.checked,t!=null&&A2(e,"checked",t,!1)}function ay(e,t){RS(e,t);var r=bc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?iy(e,t.type,r):t.hasOwnProperty("defaultValue")&&iy(e,t.type,bc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function e5(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function iy(e,t,r){(t!=="number"||Om(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var k0=Array.isArray;function $u(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+bc(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function oy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(mt(91));return hn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function t5(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(mt(92));if(k0(r)){if(1<r.length)throw Error(mt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:bc(r)}}function QS(e,t){var r=bc(t.value),n=bc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function r5(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function MS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ly(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?MS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Zh,HS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Zh=Zh||document.createElement("div"),Zh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Zh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function mf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var H0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FU=["Webkit","ms","Moz","O"];Object.keys(H0).forEach(function(e){FU.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),H0[t]=H0[e]})});function KS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||H0.hasOwnProperty(e)&&H0[e]?(""+t).trim():t+"px"}function qS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=KS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var jU=hn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cy(e,t){if(t){if(jU[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(mt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(mt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(mt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(mt(62))}}function Ay(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uy=null;function h2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var dy=null,zu=null,Xu=null;function n5(e){if(e=sh(e)){if(typeof dy!="function")throw Error(mt(280));var t=e.stateNode;t&&(t=Wg(t),dy(e.stateNode,e.type,t))}}function VS(e){zu?Xu?Xu.push(e):Xu=[e]:zu=e}function GS(){if(zu){var e=zu,t=Xu;if(Xu=zu=null,n5(e),t)for(e=0;e<t.length;e++)n5(t[e])}}function WS(e,t){return e(t)}function $S(){}var l1=!1;function zS(e,t,r){if(l1)return e(t,r);l1=!0;try{return WS(e,t,r)}finally{l1=!1,(zu!==null||Xu!==null)&&($S(),GS())}}function gf(e,t){var r=e.stateNode;if(r===null)return null;var n=Wg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(mt(231,t,typeof r));return r}var fy=!1;if(gl)try{var l0={};Object.defineProperty(l0,"passive",{get:function(){fy=!0}}),window.addEventListener("test",l0,l0),window.removeEventListener("test",l0,l0)}catch{fy=!1}function TU(e,t,r,n,s,a,o,l,c){var A=Array.prototype.slice.call(arguments,3);try{t.apply(r,A)}catch(u){this.onError(u)}}var K0=!1,Rm=null,Qm=!1,hy=null,IU={onError:function(e){K0=!0,Rm=e}};function UU(e,t,r,n,s,a,o,l,c){K0=!1,Rm=null,TU.apply(IU,arguments)}function LU(e,t,r,n,s,a,o,l,c){if(UU.apply(this,arguments),K0){if(K0){var A=Rm;K0=!1,Rm=null}else throw Error(mt(198));Qm||(Qm=!0,hy=A)}}function KA(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function XS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function s5(e){if(KA(e)!==e)throw Error(mt(188))}function DU(e){var t=e.alternate;if(!t){if(t=KA(e),t===null)throw Error(mt(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return s5(s),e;if(a===n)return s5(s),t;a=a.sibling}throw Error(mt(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error(mt(189))}}if(r.alternate!==n)throw Error(mt(190))}if(r.tag!==3)throw Error(mt(188));return r.stateNode.current===r?e:t}function YS(e){return e=DU(e),e!==null?JS(e):null}function JS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=JS(e);if(t!==null)return t;e=e.sibling}return null}var ZS=ni.unstable_scheduleCallback,a5=ni.unstable_cancelCallback,PU=ni.unstable_shouldYield,OU=ni.unstable_requestPaint,En=ni.unstable_now,RU=ni.unstable_getCurrentPriorityLevel,p2=ni.unstable_ImmediatePriority,e3=ni.unstable_UserBlockingPriority,Mm=ni.unstable_NormalPriority,QU=ni.unstable_LowPriority,t3=ni.unstable_IdlePriority,Kg=null,ko=null;function MU(e){if(ko&&typeof ko.onCommitFiberRoot=="function")try{ko.onCommitFiberRoot(Kg,e,void 0,(e.current.flags&128)===128)}catch{}}var Ji=Math.clz32?Math.clz32:qU,HU=Math.log,KU=Math.LN2;function qU(e){return e>>>=0,e===0?32:31-(HU(e)/KU|0)|0}var ep=64,tp=4194304;function E0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Hm(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=E0(l):(a&=o,a!==0&&(n=E0(a)))}else o=r&~s,o!==0?n=E0(o):a!==0&&(n=E0(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ji(t),s=1<<r,n|=e[r],t&=~s;return n}function VU(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GU(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Ji(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=VU(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function py(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function r3(){var e=ep;return ep<<=1,!(ep&4194240)&&(ep=64),e}function c1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function rh(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ji(t),e[t]=r}function WU(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Ji(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function m2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ji(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Pr=0;function n3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var s3,g2,a3,i3,o3,my=!1,rp=[],dc=null,fc=null,hc=null,xf=new Map,vf=new Map,ec=[],$U="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function i5(e,t){switch(e){case"focusin":case"focusout":dc=null;break;case"dragenter":case"dragleave":fc=null;break;case"mouseover":case"mouseout":hc=null;break;case"pointerover":case"pointerout":xf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vf.delete(t.pointerId)}}function c0(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=sh(t),t!==null&&g2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function zU(e,t,r,n,s){switch(t){case"focusin":return dc=c0(dc,e,t,r,n,s),!0;case"dragenter":return fc=c0(fc,e,t,r,n,s),!0;case"mouseover":return hc=c0(hc,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return xf.set(a,c0(xf.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,vf.set(a,c0(vf.get(a)||null,e,t,r,n,s)),!0}return!1}function l3(e){var t=dA(e.target);if(t!==null){var r=KA(t);if(r!==null){if(t=r.tag,t===13){if(t=XS(r),t!==null){e.blockedOn=t,o3(e.priority,function(){a3(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function mm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=gy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);uy=n,r.target.dispatchEvent(n),uy=null}else return t=sh(r),t!==null&&g2(t),e.blockedOn=r,!1;t.shift()}return!0}function o5(e,t,r){mm(e)&&r.delete(t)}function XU(){my=!1,dc!==null&&mm(dc)&&(dc=null),fc!==null&&mm(fc)&&(fc=null),hc!==null&&mm(hc)&&(hc=null),xf.forEach(o5),vf.forEach(o5)}function A0(e,t){e.blockedOn===t&&(e.blockedOn=null,my||(my=!0,ni.unstable_scheduleCallback(ni.unstable_NormalPriority,XU)))}function yf(e){function t(s){return A0(s,e)}if(0<rp.length){A0(rp[0],e);for(var r=1;r<rp.length;r++){var n=rp[r];n.blockedOn===e&&(n.blockedOn=null)}}for(dc!==null&&A0(dc,e),fc!==null&&A0(fc,e),hc!==null&&A0(hc,e),xf.forEach(t),vf.forEach(t),r=0;r<ec.length;r++)n=ec[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ec.length&&(r=ec[0],r.blockedOn===null);)l3(r),r.blockedOn===null&&ec.shift()}var Yu=_l.ReactCurrentBatchConfig,Km=!0;function YU(e,t,r,n){var s=Pr,a=Yu.transition;Yu.transition=null;try{Pr=1,x2(e,t,r,n)}finally{Pr=s,Yu.transition=a}}function JU(e,t,r,n){var s=Pr,a=Yu.transition;Yu.transition=null;try{Pr=4,x2(e,t,r,n)}finally{Pr=s,Yu.transition=a}}function x2(e,t,r,n){if(Km){var s=gy(e,t,r,n);if(s===null)v1(e,t,n,qm,r),i5(e,n);else if(zU(s,e,t,r,n))n.stopPropagation();else if(i5(e,n),t&4&&-1<$U.indexOf(e)){for(;s!==null;){var a=sh(s);if(a!==null&&s3(a),a=gy(e,t,r,n),a===null&&v1(e,t,n,qm,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else v1(e,t,n,null,r)}}var qm=null;function gy(e,t,r,n){if(qm=null,e=h2(n),e=dA(e),e!==null)if(t=KA(e),t===null)e=null;else if(r=t.tag,r===13){if(e=XS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qm=e,null}function c3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RU()){case p2:return 1;case e3:return 4;case Mm:case QU:return 16;case t3:return 536870912;default:return 16}default:return 16}}var nc=null,v2=null,gm=null;function A3(){if(gm)return gm;var e,t=v2,r=t.length,n,s="value"in nc?nc.value:nc.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[a-n];n++);return gm=s.slice(e,1<n?1-n:void 0)}function xm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function np(){return!0}function l5(){return!1}function ii(e){function t(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?np:l5,this.isPropagationStopped=l5,this}return hn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=np)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=np)},persist:function(){},isPersistent:np}),t}var Cd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},y2=ii(Cd),nh=hn({},Cd,{view:0,detail:0}),ZU=ii(nh),A1,u1,u0,qg=hn({},nh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:w2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==u0&&(u0&&e.type==="mousemove"?(A1=e.screenX-u0.screenX,u1=e.screenY-u0.screenY):u1=A1=0,u0=e),A1)},movementY:function(e){return"movementY"in e?e.movementY:u1}}),c5=ii(qg),e8=hn({},qg,{dataTransfer:0}),t8=ii(e8),r8=hn({},nh,{relatedTarget:0}),d1=ii(r8),n8=hn({},Cd,{animationName:0,elapsedTime:0,pseudoElement:0}),s8=ii(n8),a8=hn({},Cd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),i8=ii(a8),o8=hn({},Cd,{data:0}),A5=ii(o8),l8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},c8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u8(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=A8[e])?!!t[e]:!1}function w2(){return u8}var d8=hn({},nh,{key:function(e){if(e.key){var t=l8[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?c8[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:w2,charCode:function(e){return e.type==="keypress"?xm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),f8=ii(d8),h8=hn({},qg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),u5=ii(h8),p8=hn({},nh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:w2}),m8=ii(p8),g8=hn({},Cd,{propertyName:0,elapsedTime:0,pseudoElement:0}),x8=ii(g8),v8=hn({},qg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),y8=ii(v8),w8=[9,13,27,32],b2=gl&&"CompositionEvent"in window,q0=null;gl&&"documentMode"in document&&(q0=document.documentMode);var b8=gl&&"TextEvent"in window&&!q0,u3=gl&&(!b2||q0&&8<q0&&11>=q0),d5=" ",f5=!1;function d3(e,t){switch(e){case"keyup":return w8.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function f3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Lu=!1;function _8(e,t){switch(e){case"compositionend":return f3(t);case"keypress":return t.which!==32?null:(f5=!0,d5);case"textInput":return e=t.data,e===d5&&f5?null:e;default:return null}}function B8(e,t){if(Lu)return e==="compositionend"||!b2&&d3(e,t)?(e=A3(),gm=v2=nc=null,Lu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return u3&&t.locale!=="ko"?null:t.data;default:return null}}var C8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function h5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!C8[e.type]:t==="textarea"}function h3(e,t,r,n){VS(n),t=Vm(t,"onChange"),0<t.length&&(r=new y2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var V0=null,wf=null;function N8(e){C3(e,0)}function Vg(e){var t=Ou(e);if(OS(t))return e}function S8(e,t){if(e==="change")return t}var p3=!1;if(gl){var f1;if(gl){var h1="oninput"in document;if(!h1){var p5=document.createElement("div");p5.setAttribute("oninput","return;"),h1=typeof p5.oninput=="function"}f1=h1}else f1=!1;p3=f1&&(!document.documentMode||9<document.documentMode)}function m5(){V0&&(V0.detachEvent("onpropertychange",m3),wf=V0=null)}function m3(e){if(e.propertyName==="value"&&Vg(wf)){var t=[];h3(t,wf,e,h2(e)),zS(N8,t)}}function k8(e,t,r){e==="focusin"?(m5(),V0=t,wf=r,V0.attachEvent("onpropertychange",m3)):e==="focusout"&&m5()}function E8(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Vg(wf)}function F8(e,t){if(e==="click")return Vg(t)}function j8(e,t){if(e==="input"||e==="change")return Vg(t)}function T8(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var no=typeof Object.is=="function"?Object.is:T8;function bf(e,t){if(no(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Zv.call(t,s)||!no(e[s],t[s]))return!1}return!0}function g5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function x5(e,t){var r=g5(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=g5(r)}}function g3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?g3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function x3(){for(var e=window,t=Om();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Om(e.document)}return t}function _2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function I8(e){var t=x3(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&g3(r.ownerDocument.documentElement,r)){if(n!==null&&_2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=x5(r,a);var o=x5(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var U8=gl&&"documentMode"in document&&11>=document.documentMode,Du=null,xy=null,G0=null,vy=!1;function v5(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vy||Du==null||Du!==Om(n)||(n=Du,"selectionStart"in n&&_2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),G0&&bf(G0,n)||(G0=n,n=Vm(xy,"onSelect"),0<n.length&&(t=new y2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Du)))}function sp(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Pu={animationend:sp("Animation","AnimationEnd"),animationiteration:sp("Animation","AnimationIteration"),animationstart:sp("Animation","AnimationStart"),transitionend:sp("Transition","TransitionEnd")},p1={},v3={};gl&&(v3=document.createElement("div").style,"AnimationEvent"in window||(delete Pu.animationend.animation,delete Pu.animationiteration.animation,delete Pu.animationstart.animation),"TransitionEvent"in window||delete Pu.transitionend.transition);function Gg(e){if(p1[e])return p1[e];if(!Pu[e])return e;var t=Pu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in v3)return p1[e]=t[r];return e}var y3=Gg("animationend"),w3=Gg("animationiteration"),b3=Gg("animationstart"),_3=Gg("transitionend"),B3=new Map,y5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jc(e,t){B3.set(e,t),HA(t,[e])}for(var m1=0;m1<y5.length;m1++){var g1=y5[m1],L8=g1.toLowerCase(),D8=g1[0].toUpperCase()+g1.slice(1);jc(L8,"on"+D8)}jc(y3,"onAnimationEnd");jc(w3,"onAnimationIteration");jc(b3,"onAnimationStart");jc("dblclick","onDoubleClick");jc("focusin","onFocus");jc("focusout","onBlur");jc(_3,"onTransitionEnd");dd("onMouseEnter",["mouseout","mouseover"]);dd("onMouseLeave",["mouseout","mouseover"]);dd("onPointerEnter",["pointerout","pointerover"]);dd("onPointerLeave",["pointerout","pointerover"]);HA("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));HA("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));HA("onBeforeInput",["compositionend","keypress","textInput","paste"]);HA("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));HA("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));HA("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var F0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),P8=new Set("cancel close invalid load scroll toggle".split(" ").concat(F0));function w5(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,LU(n,t,void 0,e),e.currentTarget=null}function C3(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,A=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;w5(s,l,A),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,A=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;w5(s,l,A),a=c}}}if(Qm)throw e=hy,Qm=!1,hy=null,e}function Xr(e,t){var r=t[By];r===void 0&&(r=t[By]=new Set);var n=e+"__bubble";r.has(n)||(N3(t,e,2,!1),r.add(n))}function x1(e,t,r){var n=0;t&&(n|=4),N3(r,e,n,t)}var ap="_reactListening"+Math.random().toString(36).slice(2);function _f(e){if(!e[ap]){e[ap]=!0,IS.forEach(function(r){r!=="selectionchange"&&(P8.has(r)||x1(r,!1,e),x1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ap]||(t[ap]=!0,x1("selectionchange",!1,t))}}function N3(e,t,r,n){switch(c3(t)){case 1:var s=YU;break;case 4:s=JU;break;default:s=x2}r=s.bind(null,t,r,e),s=void 0,!fy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function v1(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=dA(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}zS(function(){var A=a,u=h2(r),f=[];e:{var h=B3.get(e);if(h!==void 0){var d=y2,x=e;switch(e){case"keypress":if(xm(r)===0)break e;case"keydown":case"keyup":d=f8;break;case"focusin":x="focus",d=d1;break;case"focusout":x="blur",d=d1;break;case"beforeblur":case"afterblur":d=d1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=c5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=t8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=m8;break;case y3:case w3:case b3:d=s8;break;case _3:d=x8;break;case"scroll":d=ZU;break;case"wheel":d=y8;break;case"copy":case"cut":case"paste":d=i8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=u5}var g=(t&4)!==0,y=!g&&e==="scroll",m=g?h!==null?h+"Capture":null:h;g=[];for(var p=A,b;p!==null;){b=p;var v=b.stateNode;if(b.tag===5&&v!==null&&(b=v,m!==null&&(v=gf(p,m),v!=null&&g.push(Bf(p,v,b)))),y)break;p=p.return}0<g.length&&(h=new d(h,x,null,r,u),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",h&&r!==uy&&(x=r.relatedTarget||r.fromElement)&&(dA(x)||x[xl]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(x=r.relatedTarget||r.toElement,d=A,x=x?dA(x):null,x!==null&&(y=KA(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(d=null,x=A),d!==x)){if(g=c5,v="onMouseLeave",m="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(g=u5,v="onPointerLeave",m="onPointerEnter",p="pointer"),y=d==null?h:Ou(d),b=x==null?h:Ou(x),h=new g(v,p+"leave",d,r,u),h.target=y,h.relatedTarget=b,v=null,dA(u)===A&&(g=new g(m,p+"enter",x,r,u),g.target=b,g.relatedTarget=y,v=g),y=v,d&&x)t:{for(g=d,m=x,p=0,b=g;b;b=lu(b))p++;for(b=0,v=m;v;v=lu(v))b++;for(;0<p-b;)g=lu(g),p--;for(;0<b-p;)m=lu(m),b--;for(;p--;){if(g===m||m!==null&&g===m.alternate)break t;g=lu(g),m=lu(m)}g=null}else g=null;d!==null&&b5(f,h,d,g,!1),x!==null&&y!==null&&b5(f,y,x,g,!0)}}e:{if(h=A?Ou(A):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var C=S8;else if(h5(h))if(p3)C=j8;else{C=E8;var k=k8}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=F8);if(C&&(C=C(e,A))){h3(f,C,r,u);break e}k&&k(e,h,A),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&iy(h,"number",h.value)}switch(k=A?Ou(A):window,e){case"focusin":(h5(k)||k.contentEditable==="true")&&(Du=k,xy=A,G0=null);break;case"focusout":G0=xy=Du=null;break;case"mousedown":vy=!0;break;case"contextmenu":case"mouseup":case"dragend":vy=!1,v5(f,r,u);break;case"selectionchange":if(U8)break;case"keydown":case"keyup":v5(f,r,u)}var S;if(b2)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Lu?d3(e,r)&&(I="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(u3&&r.locale!=="ko"&&(Lu||I!=="onCompositionStart"?I==="onCompositionEnd"&&Lu&&(S=A3()):(nc=u,v2="value"in nc?nc.value:nc.textContent,Lu=!0)),k=Vm(A,I),0<k.length&&(I=new A5(I,e,null,r,u),f.push({event:I,listeners:k}),S?I.data=S:(S=f3(r),S!==null&&(I.data=S)))),(S=b8?_8(e,r):B8(e,r))&&(A=Vm(A,"onBeforeInput"),0<A.length&&(u=new A5("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:A}),u.data=S))}C3(f,t)})}function Bf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Vm(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=gf(e,r),a!=null&&n.unshift(Bf(e,a,s)),a=gf(e,t),a!=null&&n.push(Bf(e,a,s))),e=e.return}return n}function lu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function b5(e,t,r,n,s){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,A=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&A!==null&&(l=A,s?(c=gf(r,a),c!=null&&o.unshift(Bf(r,c,l))):s||(c=gf(r,a),c!=null&&o.push(Bf(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var O8=/\r\n?/g,R8=/\u0000|\uFFFD/g;function _5(e){return(typeof e=="string"?e:""+e).replace(O8,`
`).replace(R8,"")}function ip(e,t,r){if(t=_5(t),_5(e)!==t&&r)throw Error(mt(425))}function Gm(){}var yy=null,wy=null;function by(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _y=typeof setTimeout=="function"?setTimeout:void 0,Q8=typeof clearTimeout=="function"?clearTimeout:void 0,B5=typeof Promise=="function"?Promise:void 0,M8=typeof queueMicrotask=="function"?queueMicrotask:typeof B5<"u"?function(e){return B5.resolve(null).then(e).catch(H8)}:_y;function H8(e){setTimeout(function(){throw e})}function y1(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),yf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);yf(t)}function pc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function C5(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Nd=Math.random().toString(36).slice(2),Co="__reactFiber$"+Nd,Cf="__reactProps$"+Nd,xl="__reactContainer$"+Nd,By="__reactEvents$"+Nd,K8="__reactListeners$"+Nd,q8="__reactHandles$"+Nd;function dA(e){var t=e[Co];if(t)return t;for(var r=e.parentNode;r;){if(t=r[xl]||r[Co]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=C5(e);e!==null;){if(r=e[Co])return r;e=C5(e)}return t}e=r,r=e.parentNode}return null}function sh(e){return e=e[Co]||e[xl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ou(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(mt(33))}function Wg(e){return e[Cf]||null}var Cy=[],Ru=-1;function Tc(e){return{current:e}}function Zr(e){0>Ru||(e.current=Cy[Ru],Cy[Ru]=null,Ru--)}function $r(e,t){Ru++,Cy[Ru]=e.current,e.current=t}var _c={},Js=Tc(_c),Na=Tc(!1),SA=_c;function fd(e,t){var r=e.type.contextTypes;if(!r)return _c;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Sa(e){return e=e.childContextTypes,e!=null}function Wm(){Zr(Na),Zr(Js)}function N5(e,t,r){if(Js.current!==_c)throw Error(mt(168));$r(Js,t),$r(Na,r)}function S3(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(mt(108,kU(e)||"Unknown",s));return hn({},r,n)}function $m(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_c,SA=Js.current,$r(Js,e),$r(Na,Na.current),!0}function S5(e,t,r){var n=e.stateNode;if(!n)throw Error(mt(169));r?(e=S3(e,t,SA),n.__reactInternalMemoizedMergedChildContext=e,Zr(Na),Zr(Js),$r(Js,e)):Zr(Na),$r(Na,r)}var ol=null,$g=!1,w1=!1;function k3(e){ol===null?ol=[e]:ol.push(e)}function V8(e){$g=!0,k3(e)}function Ic(){if(!w1&&ol!==null){w1=!0;var e=0,t=Pr;try{var r=ol;for(Pr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ol=null,$g=!1}catch(s){throw ol!==null&&(ol=ol.slice(e+1)),ZS(p2,Ic),s}finally{Pr=t,w1=!1}}return null}var Qu=[],Mu=0,zm=null,Xm=0,yi=[],wi=0,kA=null,cl=1,Al="";function rA(e,t){Qu[Mu++]=Xm,Qu[Mu++]=zm,zm=e,Xm=t}function E3(e,t,r){yi[wi++]=cl,yi[wi++]=Al,yi[wi++]=kA,kA=e;var n=cl;e=Al;var s=32-Ji(n)-1;n&=~(1<<s),r+=1;var a=32-Ji(t)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,cl=1<<32-Ji(t)+s|r<<s|n,Al=a+e}else cl=1<<a|r<<s|n,Al=e}function B2(e){e.return!==null&&(rA(e,1),E3(e,1,0))}function C2(e){for(;e===zm;)zm=Qu[--Mu],Qu[Mu]=null,Xm=Qu[--Mu],Qu[Mu]=null;for(;e===kA;)kA=yi[--wi],yi[wi]=null,Al=yi[--wi],yi[wi]=null,cl=yi[--wi],yi[wi]=null}var ti=null,Za=null,sn=!1,zi=null;function F3(e,t){var r=_i(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function k5(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ti=e,Za=pc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ti=e,Za=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=kA!==null?{id:cl,overflow:Al}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=_i(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ti=e,Za=null,!0):!1;default:return!1}}function Ny(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Sy(e){if(sn){var t=Za;if(t){var r=t;if(!k5(e,t)){if(Ny(e))throw Error(mt(418));t=pc(r.nextSibling);var n=ti;t&&k5(e,t)?F3(n,r):(e.flags=e.flags&-4097|2,sn=!1,ti=e)}}else{if(Ny(e))throw Error(mt(418));e.flags=e.flags&-4097|2,sn=!1,ti=e}}}function E5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ti=e}function op(e){if(e!==ti)return!1;if(!sn)return E5(e),sn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!by(e.type,e.memoizedProps)),t&&(t=Za)){if(Ny(e))throw j3(),Error(mt(418));for(;t;)F3(e,t),t=pc(t.nextSibling)}if(E5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(mt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Za=pc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Za=null}}else Za=ti?pc(e.stateNode.nextSibling):null;return!0}function j3(){for(var e=Za;e;)e=pc(e.nextSibling)}function hd(){Za=ti=null,sn=!1}function N2(e){zi===null?zi=[e]:zi.push(e)}var G8=_l.ReactCurrentBatchConfig;function d0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(mt(309));var n=r.stateNode}if(!n)throw Error(mt(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(mt(284));if(!r._owner)throw Error(mt(290,e))}return e}function lp(e,t){throw e=Object.prototype.toString.call(t),Error(mt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function F5(e){var t=e._init;return t(e._payload)}function T3(e){function t(m,p){if(e){var b=m.deletions;b===null?(m.deletions=[p],m.flags|=16):b.push(p)}}function r(m,p){if(!e)return null;for(;p!==null;)t(m,p),p=p.sibling;return null}function n(m,p){for(m=new Map;p!==null;)p.key!==null?m.set(p.key,p):m.set(p.index,p),p=p.sibling;return m}function s(m,p){return m=vc(m,p),m.index=0,m.sibling=null,m}function a(m,p,b){return m.index=b,e?(b=m.alternate,b!==null?(b=b.index,b<p?(m.flags|=2,p):b):(m.flags|=2,p)):(m.flags|=1048576,p)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function l(m,p,b,v){return p===null||p.tag!==6?(p=k1(b,m.mode,v),p.return=m,p):(p=s(p,b),p.return=m,p)}function c(m,p,b,v){var C=b.type;return C===Uu?u(m,p,b.props.children,v,b.key):p!==null&&(p.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Yl&&F5(C)===p.type)?(v=s(p,b.props),v.ref=d0(m,p,b),v.return=m,v):(v=Cm(b.type,b.key,b.props,null,m.mode,v),v.ref=d0(m,p,b),v.return=m,v)}function A(m,p,b,v){return p===null||p.tag!==4||p.stateNode.containerInfo!==b.containerInfo||p.stateNode.implementation!==b.implementation?(p=E1(b,m.mode,v),p.return=m,p):(p=s(p,b.children||[]),p.return=m,p)}function u(m,p,b,v,C){return p===null||p.tag!==7?(p=vA(b,m.mode,v,C),p.return=m,p):(p=s(p,b),p.return=m,p)}function f(m,p,b){if(typeof p=="string"&&p!==""||typeof p=="number")return p=k1(""+p,m.mode,b),p.return=m,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Yh:return b=Cm(p.type,p.key,p.props,null,m.mode,b),b.ref=d0(m,null,p),b.return=m,b;case Iu:return p=E1(p,m.mode,b),p.return=m,p;case Yl:var v=p._init;return f(m,v(p._payload),b)}if(k0(p)||o0(p))return p=vA(p,m.mode,b,null),p.return=m,p;lp(m,p)}return null}function h(m,p,b,v){var C=p!==null?p.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:l(m,p,""+b,v);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Yh:return b.key===C?c(m,p,b,v):null;case Iu:return b.key===C?A(m,p,b,v):null;case Yl:return C=b._init,h(m,p,C(b._payload),v)}if(k0(b)||o0(b))return C!==null?null:u(m,p,b,v,null);lp(m,b)}return null}function d(m,p,b,v,C){if(typeof v=="string"&&v!==""||typeof v=="number")return m=m.get(b)||null,l(p,m,""+v,C);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Yh:return m=m.get(v.key===null?b:v.key)||null,c(p,m,v,C);case Iu:return m=m.get(v.key===null?b:v.key)||null,A(p,m,v,C);case Yl:var k=v._init;return d(m,p,b,k(v._payload),C)}if(k0(v)||o0(v))return m=m.get(b)||null,u(p,m,v,C,null);lp(p,v)}return null}function x(m,p,b,v){for(var C=null,k=null,S=p,I=p=0,N=null;S!==null&&I<b.length;I++){S.index>I?(N=S,S=null):N=S.sibling;var Q=h(m,S,b[I],v);if(Q===null){S===null&&(S=N);break}e&&S&&Q.alternate===null&&t(m,S),p=a(Q,p,I),k===null?C=Q:k.sibling=Q,k=Q,S=N}if(I===b.length)return r(m,S),sn&&rA(m,I),C;if(S===null){for(;I<b.length;I++)S=f(m,b[I],v),S!==null&&(p=a(S,p,I),k===null?C=S:k.sibling=S,k=S);return sn&&rA(m,I),C}for(S=n(m,S);I<b.length;I++)N=d(S,m,I,b[I],v),N!==null&&(e&&N.alternate!==null&&S.delete(N.key===null?I:N.key),p=a(N,p,I),k===null?C=N:k.sibling=N,k=N);return e&&S.forEach(function(L){return t(m,L)}),sn&&rA(m,I),C}function g(m,p,b,v){var C=o0(b);if(typeof C!="function")throw Error(mt(150));if(b=C.call(b),b==null)throw Error(mt(151));for(var k=C=null,S=p,I=p=0,N=null,Q=b.next();S!==null&&!Q.done;I++,Q=b.next()){S.index>I?(N=S,S=null):N=S.sibling;var L=h(m,S,Q.value,v);if(L===null){S===null&&(S=N);break}e&&S&&L.alternate===null&&t(m,S),p=a(L,p,I),k===null?C=L:k.sibling=L,k=L,S=N}if(Q.done)return r(m,S),sn&&rA(m,I),C;if(S===null){for(;!Q.done;I++,Q=b.next())Q=f(m,Q.value,v),Q!==null&&(p=a(Q,p,I),k===null?C=Q:k.sibling=Q,k=Q);return sn&&rA(m,I),C}for(S=n(m,S);!Q.done;I++,Q=b.next())Q=d(S,m,I,Q.value,v),Q!==null&&(e&&Q.alternate!==null&&S.delete(Q.key===null?I:Q.key),p=a(Q,p,I),k===null?C=Q:k.sibling=Q,k=Q);return e&&S.forEach(function(T){return t(m,T)}),sn&&rA(m,I),C}function y(m,p,b,v){if(typeof b=="object"&&b!==null&&b.type===Uu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Yh:e:{for(var C=b.key,k=p;k!==null;){if(k.key===C){if(C=b.type,C===Uu){if(k.tag===7){r(m,k.sibling),p=s(k,b.props.children),p.return=m,m=p;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Yl&&F5(C)===k.type){r(m,k.sibling),p=s(k,b.props),p.ref=d0(m,k,b),p.return=m,m=p;break e}r(m,k);break}else t(m,k);k=k.sibling}b.type===Uu?(p=vA(b.props.children,m.mode,v,b.key),p.return=m,m=p):(v=Cm(b.type,b.key,b.props,null,m.mode,v),v.ref=d0(m,p,b),v.return=m,m=v)}return o(m);case Iu:e:{for(k=b.key;p!==null;){if(p.key===k)if(p.tag===4&&p.stateNode.containerInfo===b.containerInfo&&p.stateNode.implementation===b.implementation){r(m,p.sibling),p=s(p,b.children||[]),p.return=m,m=p;break e}else{r(m,p);break}else t(m,p);p=p.sibling}p=E1(b,m.mode,v),p.return=m,m=p}return o(m);case Yl:return k=b._init,y(m,p,k(b._payload),v)}if(k0(b))return x(m,p,b,v);if(o0(b))return g(m,p,b,v);lp(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,p!==null&&p.tag===6?(r(m,p.sibling),p=s(p,b),p.return=m,m=p):(r(m,p),p=k1(b,m.mode,v),p.return=m,m=p),o(m)):r(m,p)}return y}var pd=T3(!0),I3=T3(!1),Ym=Tc(null),Jm=null,Hu=null,S2=null;function k2(){S2=Hu=Jm=null}function E2(e){var t=Ym.current;Zr(Ym),e._currentValue=t}function ky(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ju(e,t){Jm=e,S2=Hu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ca=!0),e.firstContext=null)}function ki(e){var t=e._currentValue;if(S2!==e)if(e={context:e,memoizedValue:t,next:null},Hu===null){if(Jm===null)throw Error(mt(308));Hu=e,Jm.dependencies={lanes:0,firstContext:e}}else Hu=Hu.next=e;return t}var fA=null;function F2(e){fA===null?fA=[e]:fA.push(e)}function U3(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,F2(t)):(r.next=s.next,s.next=r),t.interleaved=r,vl(e,n)}function vl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Jl=!1;function j2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function L3(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function dl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function mc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,wr&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,vl(e,r)}return s=n.interleaved,s===null?(t.next=t,F2(n)):(t.next=s.next,s.next=t),n.interleaved=t,vl(e,r)}function vm(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,m2(e,r)}}function j5(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Zm(e,t,r,n){var s=e.updateQueue;Jl=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,A=c.next;c.next=null,o===null?a=A:o.next=A,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=A:l.next=A,u.lastBaseUpdate=c))}if(a!==null){var f=s.baseState;o=0,u=A=c=null,l=a;do{var h=l.lane,d=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,g=l;switch(h=t,d=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){f=x.call(d,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,h=typeof x=="function"?x.call(d,f,h):x,h==null)break e;f=hn({},f,h);break e;case 2:Jl=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else d={eventTime:d,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(A=u=d,c=f):u=u.next=d,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=A,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);FA|=o,e.lanes=o,e.memoizedState=f}}function T5(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(mt(191,s));s.call(n)}}}var ah={},Eo=Tc(ah),Nf=Tc(ah),Sf=Tc(ah);function hA(e){if(e===ah)throw Error(mt(174));return e}function T2(e,t){switch($r(Sf,t),$r(Nf,e),$r(Eo,ah),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ly(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ly(t,e)}Zr(Eo),$r(Eo,t)}function md(){Zr(Eo),Zr(Nf),Zr(Sf)}function D3(e){hA(Sf.current);var t=hA(Eo.current),r=ly(t,e.type);t!==r&&($r(Nf,e),$r(Eo,r))}function I2(e){Nf.current===e&&(Zr(Eo),Zr(Nf))}var An=Tc(0);function eg(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var b1=[];function U2(){for(var e=0;e<b1.length;e++)b1[e]._workInProgressVersionPrimary=null;b1.length=0}var ym=_l.ReactCurrentDispatcher,_1=_l.ReactCurrentBatchConfig,EA=0,fn=null,ts=null,cs=null,tg=!1,W0=!1,kf=0,W8=0;function Is(){throw Error(mt(321))}function L2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!no(e[r],t[r]))return!1;return!0}function D2(e,t,r,n,s,a){if(EA=a,fn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ym.current=e===null||e.memoizedState===null?Y8:J8,e=r(n,s),W0){a=0;do{if(W0=!1,kf=0,25<=a)throw Error(mt(301));a+=1,cs=ts=null,t.updateQueue=null,ym.current=Z8,e=r(n,s)}while(W0)}if(ym.current=rg,t=ts!==null&&ts.next!==null,EA=0,cs=ts=fn=null,tg=!1,t)throw Error(mt(300));return e}function P2(){var e=kf!==0;return kf=0,e}function _o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cs===null?fn.memoizedState=cs=e:cs=cs.next=e,cs}function Ei(){if(ts===null){var e=fn.alternate;e=e!==null?e.memoizedState:null}else e=ts.next;var t=cs===null?fn.memoizedState:cs.next;if(t!==null)cs=t,ts=e;else{if(e===null)throw Error(mt(310));ts=e,e={memoizedState:ts.memoizedState,baseState:ts.baseState,baseQueue:ts.baseQueue,queue:ts.queue,next:null},cs===null?fn.memoizedState=cs=e:cs=cs.next=e}return cs}function Ef(e,t){return typeof t=="function"?t(e):t}function B1(e){var t=Ei(),r=t.queue;if(r===null)throw Error(mt(311));r.lastRenderedReducer=e;var n=ts,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,A=a;do{var u=A.lane;if((EA&u)===u)c!==null&&(c=c.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),n=A.hasEagerState?A.eagerState:e(n,A.action);else{var f={lane:u,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,fn.lanes|=u,FA|=u}A=A.next}while(A!==null&&A!==a);c===null?o=n:c.next=l,no(n,t.memoizedState)||(Ca=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,fn.lanes|=a,FA|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function C1(e){var t=Ei(),r=t.queue;if(r===null)throw Error(mt(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=e(a,o.action),o=o.next;while(o!==s);no(a,t.memoizedState)||(Ca=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function P3(){}function O3(e,t){var r=fn,n=Ei(),s=t(),a=!no(n.memoizedState,s);if(a&&(n.memoizedState=s,Ca=!0),n=n.queue,O2(M3.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||cs!==null&&cs.memoizedState.tag&1){if(r.flags|=2048,Ff(9,Q3.bind(null,r,n,s,t),void 0,null),fs===null)throw Error(mt(349));EA&30||R3(r,t,s)}return s}function R3(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=fn.updateQueue,t===null?(t={lastEffect:null,stores:null},fn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Q3(e,t,r,n){t.value=r,t.getSnapshot=n,H3(t)&&K3(e)}function M3(e,t,r){return r(function(){H3(t)&&K3(e)})}function H3(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!no(e,r)}catch{return!0}}function K3(e){var t=vl(e,1);t!==null&&Zi(t,e,1,-1)}function I5(e){var t=_o();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ef,lastRenderedState:e},t.queue=e,e=e.dispatch=X8.bind(null,fn,e),[t.memoizedState,e]}function Ff(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=fn.updateQueue,t===null?(t={lastEffect:null,stores:null},fn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function q3(){return Ei().memoizedState}function wm(e,t,r,n){var s=_o();fn.flags|=e,s.memoizedState=Ff(1|t,r,void 0,n===void 0?null:n)}function zg(e,t,r,n){var s=Ei();n=n===void 0?null:n;var a=void 0;if(ts!==null){var o=ts.memoizedState;if(a=o.destroy,n!==null&&L2(n,o.deps)){s.memoizedState=Ff(t,r,a,n);return}}fn.flags|=e,s.memoizedState=Ff(1|t,r,a,n)}function U5(e,t){return wm(8390656,8,e,t)}function O2(e,t){return zg(2048,8,e,t)}function V3(e,t){return zg(4,2,e,t)}function G3(e,t){return zg(4,4,e,t)}function W3(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function $3(e,t,r){return r=r!=null?r.concat([e]):null,zg(4,4,W3.bind(null,t,e),r)}function R2(){}function z3(e,t){var r=Ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function X3(e,t){var r=Ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Y3(e,t,r){return EA&21?(no(r,t)||(r=r3(),fn.lanes|=r,FA|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ca=!0),e.memoizedState=r)}function $8(e,t){var r=Pr;Pr=r!==0&&4>r?r:4,e(!0);var n=_1.transition;_1.transition={};try{e(!1),t()}finally{Pr=r,_1.transition=n}}function J3(){return Ei().memoizedState}function z8(e,t,r){var n=xc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Z3(e))ek(t,r);else if(r=U3(e,t,r,n),r!==null){var s=da();Zi(r,e,n,s),tk(r,t,n)}}function X8(e,t,r){var n=xc(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Z3(e))ek(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,no(l,o)){var c=t.interleaved;c===null?(s.next=s,F2(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=U3(e,t,s,n),r!==null&&(s=da(),Zi(r,e,n,s),tk(r,t,n))}}function Z3(e){var t=e.alternate;return e===fn||t!==null&&t===fn}function ek(e,t){W0=tg=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function tk(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,m2(e,r)}}var rg={readContext:ki,useCallback:Is,useContext:Is,useEffect:Is,useImperativeHandle:Is,useInsertionEffect:Is,useLayoutEffect:Is,useMemo:Is,useReducer:Is,useRef:Is,useState:Is,useDebugValue:Is,useDeferredValue:Is,useTransition:Is,useMutableSource:Is,useSyncExternalStore:Is,useId:Is,unstable_isNewReconciler:!1},Y8={readContext:ki,useCallback:function(e,t){return _o().memoizedState=[e,t===void 0?null:t],e},useContext:ki,useEffect:U5,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,wm(4194308,4,W3.bind(null,t,e),r)},useLayoutEffect:function(e,t){return wm(4194308,4,e,t)},useInsertionEffect:function(e,t){return wm(4,2,e,t)},useMemo:function(e,t){var r=_o();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=_o();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=z8.bind(null,fn,e),[n.memoizedState,e]},useRef:function(e){var t=_o();return e={current:e},t.memoizedState=e},useState:I5,useDebugValue:R2,useDeferredValue:function(e){return _o().memoizedState=e},useTransition:function(){var e=I5(!1),t=e[0];return e=$8.bind(null,e[1]),_o().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=fn,s=_o();if(sn){if(r===void 0)throw Error(mt(407));r=r()}else{if(r=t(),fs===null)throw Error(mt(349));EA&30||R3(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,U5(M3.bind(null,n,a,e),[e]),n.flags|=2048,Ff(9,Q3.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=_o(),t=fs.identifierPrefix;if(sn){var r=Al,n=cl;r=(n&~(1<<32-Ji(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=kf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=W8++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},J8={readContext:ki,useCallback:z3,useContext:ki,useEffect:O2,useImperativeHandle:$3,useInsertionEffect:V3,useLayoutEffect:G3,useMemo:X3,useReducer:B1,useRef:q3,useState:function(){return B1(Ef)},useDebugValue:R2,useDeferredValue:function(e){var t=Ei();return Y3(t,ts.memoizedState,e)},useTransition:function(){var e=B1(Ef)[0],t=Ei().memoizedState;return[e,t]},useMutableSource:P3,useSyncExternalStore:O3,useId:J3,unstable_isNewReconciler:!1},Z8={readContext:ki,useCallback:z3,useContext:ki,useEffect:O2,useImperativeHandle:$3,useInsertionEffect:V3,useLayoutEffect:G3,useMemo:X3,useReducer:C1,useRef:q3,useState:function(){return C1(Ef)},useDebugValue:R2,useDeferredValue:function(e){var t=Ei();return ts===null?t.memoizedState=e:Y3(t,ts.memoizedState,e)},useTransition:function(){var e=C1(Ef)[0],t=Ei().memoizedState;return[e,t]},useMutableSource:P3,useSyncExternalStore:O3,useId:J3,unstable_isNewReconciler:!1};function Vi(e,t){if(e&&e.defaultProps){t=hn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ey(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:hn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Xg={isMounted:function(e){return(e=e._reactInternals)?KA(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=da(),s=xc(e),a=dl(n,s);a.payload=t,r!=null&&(a.callback=r),t=mc(e,a,s),t!==null&&(Zi(t,e,s,n),vm(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=da(),s=xc(e),a=dl(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=mc(e,a,s),t!==null&&(Zi(t,e,s,n),vm(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=da(),n=xc(e),s=dl(r,n);s.tag=2,t!=null&&(s.callback=t),t=mc(e,s,n),t!==null&&(Zi(t,e,n,r),vm(t,e,n))}};function L5(e,t,r,n,s,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!bf(r,n)||!bf(s,a):!0}function rk(e,t,r){var n=!1,s=_c,a=t.contextType;return typeof a=="object"&&a!==null?a=ki(a):(s=Sa(t)?SA:Js.current,n=t.contextTypes,a=(n=n!=null)?fd(e,s):_c),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Xg,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function D5(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Xg.enqueueReplaceState(t,t.state,null)}function Fy(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},j2(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=ki(a):(a=Sa(t)?SA:Js.current,s.context=fd(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Ey(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Xg.enqueueReplaceState(s,s.state,null),Zm(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function gd(e,t){try{var r="",n=t;do r+=SU(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function N1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function jy(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var eL=typeof WeakMap=="function"?WeakMap:Map;function nk(e,t,r){r=dl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){sg||(sg=!0,My=n),jy(e,t)},r}function sk(e,t,r){r=dl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){jy(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){jy(e,t),typeof n!="function"&&(gc===null?gc=new Set([this]):gc.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function P5(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new eL;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=hL.bind(null,e,t,r),t.then(e,e))}function O5(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function R5(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=dl(-1,1),t.tag=2,mc(r,t,1))),r.lanes|=1),e)}var tL=_l.ReactCurrentOwner,Ca=!1;function la(e,t,r,n){t.child=e===null?I3(t,null,r,n):pd(t,e.child,r,n)}function Q5(e,t,r,n,s){r=r.render;var a=t.ref;return Ju(t,s),n=D2(e,t,r,n,a,s),r=P2(),e!==null&&!Ca?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,yl(e,t,s)):(sn&&r&&B2(t),t.flags|=1,la(e,t,n,s),t.child)}function M5(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!W2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,ak(e,t,a,n,s)):(e=Cm(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:bf,r(o,n)&&e.ref===t.ref)return yl(e,t,s)}return t.flags|=1,e=vc(a,n),e.ref=t.ref,e.return=t,t.child=e}function ak(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(bf(a,n)&&e.ref===t.ref)if(Ca=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(Ca=!0);else return t.lanes=e.lanes,yl(e,t,s)}return Ty(e,t,r,n,s)}function ik(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$r(qu,Ga),Ga|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$r(qu,Ga),Ga|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,$r(qu,Ga),Ga|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,$r(qu,Ga),Ga|=n;return la(e,t,s,r),t.child}function ok(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ty(e,t,r,n,s){var a=Sa(r)?SA:Js.current;return a=fd(t,a),Ju(t,s),r=D2(e,t,r,n,a,s),n=P2(),e!==null&&!Ca?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,yl(e,t,s)):(sn&&n&&B2(t),t.flags|=1,la(e,t,r,s),t.child)}function H5(e,t,r,n,s){if(Sa(r)){var a=!0;$m(t)}else a=!1;if(Ju(t,s),t.stateNode===null)bm(e,t),rk(t,r,n),Fy(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,A=r.contextType;typeof A=="object"&&A!==null?A=ki(A):(A=Sa(r)?SA:Js.current,A=fd(t,A));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==A)&&D5(t,o,n,A),Jl=!1;var h=t.memoizedState;o.state=h,Zm(t,n,o,s),c=t.memoizedState,l!==n||h!==c||Na.current||Jl?(typeof u=="function"&&(Ey(t,r,u,n),c=t.memoizedState),(l=Jl||L5(t,r,l,n,h,c,A))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=A,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,L3(e,t),l=t.memoizedProps,A=t.type===t.elementType?l:Vi(t.type,l),o.props=A,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=ki(c):(c=Sa(r)?SA:Js.current,c=fd(t,c));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&D5(t,o,n,c),Jl=!1,h=t.memoizedState,o.state=h,Zm(t,n,o,s);var x=t.memoizedState;l!==f||h!==x||Na.current||Jl?(typeof d=="function"&&(Ey(t,r,d,n),x=t.memoizedState),(A=Jl||L5(t,r,A,n,h,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=c,n=A):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Iy(e,t,r,n,a,s)}function Iy(e,t,r,n,s,a){ok(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&S5(t,r,!1),yl(e,t,a);n=t.stateNode,tL.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=pd(t,e.child,null,a),t.child=pd(t,null,l,a)):la(e,t,l,a),t.memoizedState=n.state,s&&S5(t,r,!0),t.child}function lk(e){var t=e.stateNode;t.pendingContext?N5(e,t.pendingContext,t.pendingContext!==t.context):t.context&&N5(e,t.context,!1),T2(e,t.containerInfo)}function K5(e,t,r,n,s){return hd(),N2(s),t.flags|=256,la(e,t,r,n),t.child}var Uy={dehydrated:null,treeContext:null,retryLane:0};function Ly(e){return{baseLanes:e,cachePool:null,transitions:null}}function ck(e,t,r){var n=t.pendingProps,s=An.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),$r(An,s&1),e===null)return Sy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Zg(o,n,0,null),e=vA(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ly(r),t.memoizedState=Uy,e):Q2(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return rL(e,t,o,n,l,s,r);if(a){a=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=vc(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=vc(l,a):(a=vA(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?Ly(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=Uy,n}return a=e.child,e=a.sibling,n=vc(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Q2(e,t){return t=Zg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cp(e,t,r,n){return n!==null&&N2(n),pd(t,e.child,null,r),e=Q2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rL(e,t,r,n,s,a,o){if(r)return t.flags&256?(t.flags&=-257,n=N1(Error(mt(422))),cp(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Zg({mode:"visible",children:n.children},s,0,null),a=vA(a,s,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&pd(t,e.child,null,o),t.child.memoizedState=Ly(o),t.memoizedState=Uy,a);if(!(t.mode&1))return cp(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(mt(419)),n=N1(a,n,void 0),cp(e,t,o,n)}if(l=(o&e.childLanes)!==0,Ca||l){if(n=fs,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,vl(e,s),Zi(n,e,s,-1))}return G2(),n=N1(Error(mt(421))),cp(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=pL.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,Za=pc(s.nextSibling),ti=t,sn=!0,zi=null,e!==null&&(yi[wi++]=cl,yi[wi++]=Al,yi[wi++]=kA,cl=e.id,Al=e.overflow,kA=t),t=Q2(t,n.children),t.flags|=4096,t)}function q5(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ky(e.return,t,r)}function S1(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function Ak(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(la(e,t,n.children,r),n=An.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&q5(e,r,t);else if(e.tag===19)q5(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if($r(An,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&eg(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),S1(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&eg(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}S1(t,!0,r,null,a);break;case"together":S1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function yl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),FA|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(mt(153));if(t.child!==null){for(e=t.child,r=vc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=vc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function nL(e,t,r){switch(t.tag){case 3:lk(t),hd();break;case 5:D3(t);break;case 1:Sa(t.type)&&$m(t);break;case 4:T2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;$r(Ym,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?($r(An,An.current&1),t.flags|=128,null):r&t.child.childLanes?ck(e,t,r):($r(An,An.current&1),e=yl(e,t,r),e!==null?e.sibling:null);$r(An,An.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Ak(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),$r(An,An.current),n)break;return null;case 22:case 23:return t.lanes=0,ik(e,t,r)}return yl(e,t,r)}var uk,Dy,dk,fk;uk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Dy=function(){};dk=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,hA(Eo.current);var a=null;switch(r){case"input":s=sy(e,s),n=sy(e,n),a=[];break;case"select":s=hn({},s,{value:void 0}),n=hn({},n,{value:void 0}),a=[];break;case"textarea":s=oy(e,s),n=oy(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Gm)}cy(r,n);var o;r=null;for(A in s)if(!n.hasOwnProperty(A)&&s.hasOwnProperty(A)&&s[A]!=null)if(A==="style"){var l=s[A];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(pf.hasOwnProperty(A)?a||(a=[]):(a=a||[]).push(A,null));for(A in n){var c=n[A];if(l=s!=null?s[A]:void 0,n.hasOwnProperty(A)&&c!==l&&(c!=null||l!=null))if(A==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(A,r)),r=c;else A==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(A,c)):A==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(A,""+c):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(pf.hasOwnProperty(A)?(c!=null&&A==="onScroll"&&Xr("scroll",e),a||l===c||(a=[])):(a=a||[]).push(A,c))}r&&(a=a||[]).push("style",r);var A=a;(t.updateQueue=A)&&(t.flags|=4)}};fk=function(e,t,r,n){r!==n&&(t.flags|=4)};function f0(e,t){if(!sn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Us(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function sL(e,t,r){var n=t.pendingProps;switch(C2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Us(t),null;case 1:return Sa(t.type)&&Wm(),Us(t),null;case 3:return n=t.stateNode,md(),Zr(Na),Zr(Js),U2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(op(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zi!==null&&(qy(zi),zi=null))),Dy(e,t),Us(t),null;case 5:I2(t);var s=hA(Sf.current);if(r=t.type,e!==null&&t.stateNode!=null)dk(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(mt(166));return Us(t),null}if(e=hA(Eo.current),op(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Co]=t,n[Cf]=a,e=(t.mode&1)!==0,r){case"dialog":Xr("cancel",n),Xr("close",n);break;case"iframe":case"object":case"embed":Xr("load",n);break;case"video":case"audio":for(s=0;s<F0.length;s++)Xr(F0[s],n);break;case"source":Xr("error",n);break;case"img":case"image":case"link":Xr("error",n),Xr("load",n);break;case"details":Xr("toggle",n);break;case"input":Z_(n,a),Xr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Xr("invalid",n);break;case"textarea":t5(n,a),Xr("invalid",n)}cy(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&ip(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&ip(n.textContent,l,e),s=["children",""+l]):pf.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Xr("scroll",n)}switch(r){case"input":Jh(n),e5(n,a,!0);break;case"textarea":Jh(n),r5(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Gm)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=MS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Co]=t,e[Cf]=n,uk(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ay(r,n),r){case"dialog":Xr("cancel",e),Xr("close",e),s=n;break;case"iframe":case"object":case"embed":Xr("load",e),s=n;break;case"video":case"audio":for(s=0;s<F0.length;s++)Xr(F0[s],e);s=n;break;case"source":Xr("error",e),s=n;break;case"img":case"image":case"link":Xr("error",e),Xr("load",e),s=n;break;case"details":Xr("toggle",e),s=n;break;case"input":Z_(e,n),s=sy(e,n),Xr("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=hn({},n,{value:void 0}),Xr("invalid",e);break;case"textarea":t5(e,n),s=oy(e,n),Xr("invalid",e);break;default:s=n}cy(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?qS(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&HS(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&mf(e,c):typeof c=="number"&&mf(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(pf.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Xr("scroll",e):c!=null&&A2(e,a,c,o))}switch(r){case"input":Jh(e),e5(e,n,!1);break;case"textarea":Jh(e),r5(e);break;case"option":n.value!=null&&e.setAttribute("value",""+bc(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?$u(e,!!n.multiple,a,!1):n.defaultValue!=null&&$u(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Gm)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Us(t),null;case 6:if(e&&t.stateNode!=null)fk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(mt(166));if(r=hA(Sf.current),hA(Eo.current),op(t)){if(n=t.stateNode,r=t.memoizedProps,n[Co]=t,(a=n.nodeValue!==r)&&(e=ti,e!==null))switch(e.tag){case 3:ip(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ip(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Co]=t,t.stateNode=n}return Us(t),null;case 13:if(Zr(An),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(sn&&Za!==null&&t.mode&1&&!(t.flags&128))j3(),hd(),t.flags|=98560,a=!1;else if(a=op(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(mt(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(mt(317));a[Co]=t}else hd(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Us(t),a=!1}else zi!==null&&(qy(zi),zi=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||An.current&1?ss===0&&(ss=3):G2())),t.updateQueue!==null&&(t.flags|=4),Us(t),null);case 4:return md(),Dy(e,t),e===null&&_f(t.stateNode.containerInfo),Us(t),null;case 10:return E2(t.type._context),Us(t),null;case 17:return Sa(t.type)&&Wm(),Us(t),null;case 19:if(Zr(An),a=t.memoizedState,a===null)return Us(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)f0(a,!1);else{if(ss!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=eg(e),o!==null){for(t.flags|=128,f0(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return $r(An,An.current&1|2),t.child}e=e.sibling}a.tail!==null&&En()>xd&&(t.flags|=128,n=!0,f0(a,!1),t.lanes=4194304)}else{if(!n)if(e=eg(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),f0(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!sn)return Us(t),null}else 2*En()-a.renderingStartTime>xd&&r!==1073741824&&(t.flags|=128,n=!0,f0(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=En(),t.sibling=null,r=An.current,$r(An,n?r&1|2:r&1),t):(Us(t),null);case 22:case 23:return V2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ga&1073741824&&(Us(t),t.subtreeFlags&6&&(t.flags|=8192)):Us(t),null;case 24:return null;case 25:return null}throw Error(mt(156,t.tag))}function aL(e,t){switch(C2(t),t.tag){case 1:return Sa(t.type)&&Wm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return md(),Zr(Na),Zr(Js),U2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return I2(t),null;case 13:if(Zr(An),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(mt(340));hd()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Zr(An),null;case 4:return md(),null;case 10:return E2(t.type._context),null;case 22:case 23:return V2(),null;case 24:return null;default:return null}}var Ap=!1,qs=!1,iL=typeof WeakSet=="function"?WeakSet:Set,Ft=null;function Ku(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){xn(e,t,n)}else r.current=null}function Py(e,t,r){try{r()}catch(n){xn(e,t,n)}}var V5=!1;function oL(e,t){if(yy=Km,e=x3(),_2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,A=0,u=0,f=e,h=null;t:for(;;){for(var d;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==a||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===e)break t;if(h===r&&++A===s&&(l=o),h===a&&++u===n&&(c=o),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(wy={focusedElem:e,selectionRange:r},Km=!1,Ft=t;Ft!==null;)if(t=Ft,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ft=e;else for(;Ft!==null;){t=Ft;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,y=x.memoizedState,m=t.stateNode,p=m.getSnapshotBeforeUpdate(t.elementType===t.type?g:Vi(t.type,g),y);m.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(mt(163))}}catch(v){xn(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,Ft=e;break}Ft=t.return}return x=V5,V5=!1,x}function $0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Py(t,r,a)}s=s.next}while(s!==n)}}function Yg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Oy(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function hk(e){var t=e.alternate;t!==null&&(e.alternate=null,hk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Co],delete t[Cf],delete t[By],delete t[K8],delete t[q8])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pk(e){return e.tag===5||e.tag===3||e.tag===4}function G5(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ry(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Gm));else if(n!==4&&(e=e.child,e!==null))for(Ry(e,t,r),e=e.sibling;e!==null;)Ry(e,t,r),e=e.sibling}function Qy(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Qy(e,t,r),e=e.sibling;e!==null;)Qy(e,t,r),e=e.sibling}var ws=null,Wi=!1;function ql(e,t,r){for(r=r.child;r!==null;)mk(e,t,r),r=r.sibling}function mk(e,t,r){if(ko&&typeof ko.onCommitFiberUnmount=="function")try{ko.onCommitFiberUnmount(Kg,r)}catch{}switch(r.tag){case 5:qs||Ku(r,t);case 6:var n=ws,s=Wi;ws=null,ql(e,t,r),ws=n,Wi=s,ws!==null&&(Wi?(e=ws,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ws.removeChild(r.stateNode));break;case 18:ws!==null&&(Wi?(e=ws,r=r.stateNode,e.nodeType===8?y1(e.parentNode,r):e.nodeType===1&&y1(e,r),yf(e)):y1(ws,r.stateNode));break;case 4:n=ws,s=Wi,ws=r.stateNode.containerInfo,Wi=!0,ql(e,t,r),ws=n,Wi=s;break;case 0:case 11:case 14:case 15:if(!qs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Py(r,t,o),s=s.next}while(s!==n)}ql(e,t,r);break;case 1:if(!qs&&(Ku(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){xn(r,t,l)}ql(e,t,r);break;case 21:ql(e,t,r);break;case 22:r.mode&1?(qs=(n=qs)||r.memoizedState!==null,ql(e,t,r),qs=n):ql(e,t,r);break;default:ql(e,t,r)}}function W5(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new iL),t.forEach(function(n){var s=mL.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ri(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ws=l.stateNode,Wi=!1;break e;case 3:ws=l.stateNode.containerInfo,Wi=!0;break e;case 4:ws=l.stateNode.containerInfo,Wi=!0;break e}l=l.return}if(ws===null)throw Error(mt(160));mk(a,o,s),ws=null,Wi=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(A){xn(s,t,A)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)gk(t,e),t=t.sibling}function gk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ri(t,e),mo(e),n&4){try{$0(3,e,e.return),Yg(3,e)}catch(g){xn(e,e.return,g)}try{$0(5,e,e.return)}catch(g){xn(e,e.return,g)}}break;case 1:Ri(t,e),mo(e),n&512&&r!==null&&Ku(r,r.return);break;case 5:if(Ri(t,e),mo(e),n&512&&r!==null&&Ku(r,r.return),e.flags&32){var s=e.stateNode;try{mf(s,"")}catch(g){xn(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&RS(s,a),Ay(l,o);var A=Ay(l,a);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?qS(s,f):u==="dangerouslySetInnerHTML"?HS(s,f):u==="children"?mf(s,f):A2(s,u,f,A)}switch(l){case"input":ay(s,a);break;case"textarea":QS(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var d=a.value;d!=null?$u(s,!!a.multiple,d,!1):h!==!!a.multiple&&(a.defaultValue!=null?$u(s,!!a.multiple,a.defaultValue,!0):$u(s,!!a.multiple,a.multiple?[]:"",!1))}s[Cf]=a}catch(g){xn(e,e.return,g)}}break;case 6:if(Ri(t,e),mo(e),n&4){if(e.stateNode===null)throw Error(mt(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){xn(e,e.return,g)}}break;case 3:if(Ri(t,e),mo(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{yf(t.containerInfo)}catch(g){xn(e,e.return,g)}break;case 4:Ri(t,e),mo(e);break;case 13:Ri(t,e),mo(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(K2=En())),n&4&&W5(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(qs=(A=qs)||u,Ri(t,e),qs=A):Ri(t,e),mo(e),n&8192){if(A=e.memoizedState!==null,(e.stateNode.isHidden=A)&&!u&&e.mode&1)for(Ft=e,u=e.child;u!==null;){for(f=Ft=u;Ft!==null;){switch(h=Ft,d=h.child,h.tag){case 0:case 11:case 14:case 15:$0(4,h,h.return);break;case 1:Ku(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){xn(n,r,g)}}break;case 5:Ku(h,h.return);break;case 22:if(h.memoizedState!==null){z5(f);continue}}d!==null?(d.return=h,Ft=d):z5(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,A?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=KS("display",o))}catch(g){xn(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=A?"":f.memoizedProps}catch(g){xn(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ri(t,e),mo(e),n&4&&W5(e);break;case 21:break;default:Ri(t,e),mo(e)}}function mo(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(pk(r)){var n=r;break e}r=r.return}throw Error(mt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(mf(s,""),n.flags&=-33);var a=G5(e);Qy(e,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=G5(e);Ry(e,l,o);break;default:throw Error(mt(161))}}catch(c){xn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lL(e,t,r){Ft=e,xk(e)}function xk(e,t,r){for(var n=(e.mode&1)!==0;Ft!==null;){var s=Ft,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Ap;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||qs;l=Ap;var A=qs;if(Ap=o,(qs=c)&&!A)for(Ft=s;Ft!==null;)o=Ft,c=o.child,o.tag===22&&o.memoizedState!==null?X5(s):c!==null?(c.return=o,Ft=c):X5(s);for(;a!==null;)Ft=a,xk(a),a=a.sibling;Ft=s,Ap=l,qs=A}$5(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ft=a):$5(e)}}function $5(e){for(;Ft!==null;){var t=Ft;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:qs||Yg(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!qs)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Vi(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&T5(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}T5(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var A=t.alternate;if(A!==null){var u=A.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&yf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(mt(163))}qs||t.flags&512&&Oy(t)}catch(h){xn(t,t.return,h)}}if(t===e){Ft=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ft=r;break}Ft=t.return}}function z5(e){for(;Ft!==null;){var t=Ft;if(t===e){Ft=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ft=r;break}Ft=t.return}}function X5(e){for(;Ft!==null;){var t=Ft;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Yg(4,t)}catch(c){xn(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){xn(t,s,c)}}var a=t.return;try{Oy(t)}catch(c){xn(t,a,c)}break;case 5:var o=t.return;try{Oy(t)}catch(c){xn(t,o,c)}}}catch(c){xn(t,t.return,c)}if(t===e){Ft=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Ft=l;break}Ft=t.return}}var cL=Math.ceil,ng=_l.ReactCurrentDispatcher,M2=_l.ReactCurrentOwner,Ni=_l.ReactCurrentBatchConfig,wr=0,fs=null,Vn=null,Ns=0,Ga=0,qu=Tc(0),ss=0,jf=null,FA=0,Jg=0,H2=0,z0=null,Ba=null,K2=0,xd=1/0,al=null,sg=!1,My=null,gc=null,up=!1,sc=null,ag=0,X0=0,Hy=null,_m=-1,Bm=0;function da(){return wr&6?En():_m!==-1?_m:_m=En()}function xc(e){return e.mode&1?wr&2&&Ns!==0?Ns&-Ns:G8.transition!==null?(Bm===0&&(Bm=r3()),Bm):(e=Pr,e!==0||(e=window.event,e=e===void 0?16:c3(e.type)),e):1}function Zi(e,t,r,n){if(50<X0)throw X0=0,Hy=null,Error(mt(185));rh(e,r,n),(!(wr&2)||e!==fs)&&(e===fs&&(!(wr&2)&&(Jg|=r),ss===4&&tc(e,Ns)),ka(e,n),r===1&&wr===0&&!(t.mode&1)&&(xd=En()+500,$g&&Ic()))}function ka(e,t){var r=e.callbackNode;GU(e,t);var n=Hm(e,e===fs?Ns:0);if(n===0)r!==null&&a5(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&a5(r),t===1)e.tag===0?V8(Y5.bind(null,e)):k3(Y5.bind(null,e)),M8(function(){!(wr&6)&&Ic()}),r=null;else{switch(n3(n)){case 1:r=p2;break;case 4:r=e3;break;case 16:r=Mm;break;case 536870912:r=t3;break;default:r=Mm}r=Nk(r,vk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function vk(e,t){if(_m=-1,Bm=0,wr&6)throw Error(mt(327));var r=e.callbackNode;if(Zu()&&e.callbackNode!==r)return null;var n=Hm(e,e===fs?Ns:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ig(e,n);else{t=n;var s=wr;wr|=2;var a=wk();(fs!==e||Ns!==t)&&(al=null,xd=En()+500,xA(e,t));do try{dL();break}catch(l){yk(e,l)}while(!0);k2(),ng.current=a,wr=s,Vn!==null?t=0:(fs=null,Ns=0,t=ss)}if(t!==0){if(t===2&&(s=py(e),s!==0&&(n=s,t=Ky(e,s))),t===1)throw r=jf,xA(e,0),tc(e,n),ka(e,En()),r;if(t===6)tc(e,n);else{if(s=e.current.alternate,!(n&30)&&!AL(s)&&(t=ig(e,n),t===2&&(a=py(e),a!==0&&(n=a,t=Ky(e,a))),t===1))throw r=jf,xA(e,0),tc(e,n),ka(e,En()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(mt(345));case 2:nA(e,Ba,al);break;case 3:if(tc(e,n),(n&130023424)===n&&(t=K2+500-En(),10<t)){if(Hm(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){da(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=_y(nA.bind(null,e,Ba,al),t);break}nA(e,Ba,al);break;case 4:if(tc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Ji(n);a=1<<o,o=t[o],o>s&&(s=o),n&=~a}if(n=s,n=En()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*cL(n/1960))-n,10<n){e.timeoutHandle=_y(nA.bind(null,e,Ba,al),n);break}nA(e,Ba,al);break;case 5:nA(e,Ba,al);break;default:throw Error(mt(329))}}}return ka(e,En()),e.callbackNode===r?vk.bind(null,e):null}function Ky(e,t){var r=z0;return e.current.memoizedState.isDehydrated&&(xA(e,t).flags|=256),e=ig(e,t),e!==2&&(t=Ba,Ba=r,t!==null&&qy(t)),e}function qy(e){Ba===null?Ba=e:Ba.push.apply(Ba,e)}function AL(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!no(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function tc(e,t){for(t&=~H2,t&=~Jg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ji(t),n=1<<r;e[r]=-1,t&=~n}}function Y5(e){if(wr&6)throw Error(mt(327));Zu();var t=Hm(e,0);if(!(t&1))return ka(e,En()),null;var r=ig(e,t);if(e.tag!==0&&r===2){var n=py(e);n!==0&&(t=n,r=Ky(e,n))}if(r===1)throw r=jf,xA(e,0),tc(e,t),ka(e,En()),r;if(r===6)throw Error(mt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,nA(e,Ba,al),ka(e,En()),null}function q2(e,t){var r=wr;wr|=1;try{return e(t)}finally{wr=r,wr===0&&(xd=En()+500,$g&&Ic())}}function jA(e){sc!==null&&sc.tag===0&&!(wr&6)&&Zu();var t=wr;wr|=1;var r=Ni.transition,n=Pr;try{if(Ni.transition=null,Pr=1,e)return e()}finally{Pr=n,Ni.transition=r,wr=t,!(wr&6)&&Ic()}}function V2(){Ga=qu.current,Zr(qu)}function xA(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Q8(r)),Vn!==null)for(r=Vn.return;r!==null;){var n=r;switch(C2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Wm();break;case 3:md(),Zr(Na),Zr(Js),U2();break;case 5:I2(n);break;case 4:md();break;case 13:Zr(An);break;case 19:Zr(An);break;case 10:E2(n.type._context);break;case 22:case 23:V2()}r=r.return}if(fs=e,Vn=e=vc(e.current,null),Ns=Ga=t,ss=0,jf=null,H2=Jg=FA=0,Ba=z0=null,fA!==null){for(t=0;t<fA.length;t++)if(r=fA[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}fA=null}return e}function yk(e,t){do{var r=Vn;try{if(k2(),ym.current=rg,tg){for(var n=fn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}tg=!1}if(EA=0,cs=ts=fn=null,W0=!1,kf=0,M2.current=null,r===null||r.return===null){ss=1,jf=t,Vn=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=Ns,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var A=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=O5(o);if(d!==null){d.flags&=-257,R5(d,o,l,a,t),d.mode&1&&P5(a,A,t),t=d,c=A;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){P5(a,A,t),G2();break e}c=Error(mt(426))}}else if(sn&&l.mode&1){var y=O5(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),R5(y,o,l,a,t),N2(gd(c,l));break e}}a=c=gd(c,l),ss!==4&&(ss=2),z0===null?z0=[a]:z0.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var m=nk(a,c,t);j5(a,m);break e;case 1:l=c;var p=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof p.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(gc===null||!gc.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var v=sk(a,l,t);j5(a,v);break e}}a=a.return}while(a!==null)}_k(r)}catch(C){t=C,Vn===r&&r!==null&&(Vn=r=r.return);continue}break}while(!0)}function wk(){var e=ng.current;return ng.current=rg,e===null?rg:e}function G2(){(ss===0||ss===3||ss===2)&&(ss=4),fs===null||!(FA&268435455)&&!(Jg&268435455)||tc(fs,Ns)}function ig(e,t){var r=wr;wr|=2;var n=wk();(fs!==e||Ns!==t)&&(al=null,xA(e,t));do try{uL();break}catch(s){yk(e,s)}while(!0);if(k2(),wr=r,ng.current=n,Vn!==null)throw Error(mt(261));return fs=null,Ns=0,ss}function uL(){for(;Vn!==null;)bk(Vn)}function dL(){for(;Vn!==null&&!PU();)bk(Vn)}function bk(e){var t=Ck(e.alternate,e,Ga);e.memoizedProps=e.pendingProps,t===null?_k(e):Vn=t,M2.current=null}function _k(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=aL(r,t),r!==null){r.flags&=32767,Vn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ss=6,Vn=null;return}}else if(r=sL(r,t,Ga),r!==null){Vn=r;return}if(t=t.sibling,t!==null){Vn=t;return}Vn=t=e}while(t!==null);ss===0&&(ss=5)}function nA(e,t,r){var n=Pr,s=Ni.transition;try{Ni.transition=null,Pr=1,fL(e,t,r,n)}finally{Ni.transition=s,Pr=n}return null}function fL(e,t,r,n){do Zu();while(sc!==null);if(wr&6)throw Error(mt(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(mt(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(WU(e,a),e===fs&&(Vn=fs=null,Ns=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||up||(up=!0,Nk(Mm,function(){return Zu(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ni.transition,Ni.transition=null;var o=Pr;Pr=1;var l=wr;wr|=4,M2.current=null,oL(e,r),gk(r,e),I8(wy),Km=!!yy,wy=yy=null,e.current=r,lL(r),OU(),wr=l,Pr=o,Ni.transition=a}else e.current=r;if(up&&(up=!1,sc=e,ag=s),a=e.pendingLanes,a===0&&(gc=null),MU(r.stateNode),ka(e,En()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(sg)throw sg=!1,e=My,My=null,e;return ag&1&&e.tag!==0&&Zu(),a=e.pendingLanes,a&1?e===Hy?X0++:(X0=0,Hy=e):X0=0,Ic(),null}function Zu(){if(sc!==null){var e=n3(ag),t=Ni.transition,r=Pr;try{if(Ni.transition=null,Pr=16>e?16:e,sc===null)var n=!1;else{if(e=sc,sc=null,ag=0,wr&6)throw Error(mt(331));var s=wr;for(wr|=4,Ft=e.current;Ft!==null;){var a=Ft,o=a.child;if(Ft.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var A=l[c];for(Ft=A;Ft!==null;){var u=Ft;switch(u.tag){case 0:case 11:case 15:$0(8,u,a)}var f=u.child;if(f!==null)f.return=u,Ft=f;else for(;Ft!==null;){u=Ft;var h=u.sibling,d=u.return;if(hk(u),u===A){Ft=null;break}if(h!==null){h.return=d,Ft=h;break}Ft=d}}}var x=a.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Ft=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Ft=o;else e:for(;Ft!==null;){if(a=Ft,a.flags&2048)switch(a.tag){case 0:case 11:case 15:$0(9,a,a.return)}var m=a.sibling;if(m!==null){m.return=a.return,Ft=m;break e}Ft=a.return}}var p=e.current;for(Ft=p;Ft!==null;){o=Ft;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Ft=b;else e:for(o=p;Ft!==null;){if(l=Ft,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yg(9,l)}}catch(C){xn(l,l.return,C)}if(l===o){Ft=null;break e}var v=l.sibling;if(v!==null){v.return=l.return,Ft=v;break e}Ft=l.return}}if(wr=s,Ic(),ko&&typeof ko.onPostCommitFiberRoot=="function")try{ko.onPostCommitFiberRoot(Kg,e)}catch{}n=!0}return n}finally{Pr=r,Ni.transition=t}}return!1}function J5(e,t,r){t=gd(r,t),t=nk(e,t,1),e=mc(e,t,1),t=da(),e!==null&&(rh(e,1,t),ka(e,t))}function xn(e,t,r){if(e.tag===3)J5(e,e,r);else for(;t!==null;){if(t.tag===3){J5(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(gc===null||!gc.has(n))){e=gd(r,e),e=sk(t,e,1),t=mc(t,e,1),e=da(),t!==null&&(rh(t,1,e),ka(t,e));break}}t=t.return}}function hL(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=da(),e.pingedLanes|=e.suspendedLanes&r,fs===e&&(Ns&r)===r&&(ss===4||ss===3&&(Ns&130023424)===Ns&&500>En()-K2?xA(e,0):H2|=r),ka(e,t)}function Bk(e,t){t===0&&(e.mode&1?(t=tp,tp<<=1,!(tp&130023424)&&(tp=4194304)):t=1);var r=da();e=vl(e,t),e!==null&&(rh(e,t,r),ka(e,r))}function pL(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Bk(e,r)}function mL(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(mt(314))}n!==null&&n.delete(t),Bk(e,r)}var Ck;Ck=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Na.current)Ca=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ca=!1,nL(e,t,r);Ca=!!(e.flags&131072)}else Ca=!1,sn&&t.flags&1048576&&E3(t,Xm,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;bm(e,t),e=t.pendingProps;var s=fd(t,Js.current);Ju(t,r),s=D2(null,t,n,e,s,r);var a=P2();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Sa(n)?(a=!0,$m(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,j2(t),s.updater=Xg,t.stateNode=s,s._reactInternals=t,Fy(t,n,e,r),t=Iy(null,t,n,!0,a,r)):(t.tag=0,sn&&a&&B2(t),la(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(bm(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=xL(n),e=Vi(n,e),s){case 0:t=Ty(null,t,n,e,r);break e;case 1:t=H5(null,t,n,e,r);break e;case 11:t=Q5(null,t,n,e,r);break e;case 14:t=M5(null,t,n,Vi(n.type,e),r);break e}throw Error(mt(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),Ty(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),H5(e,t,n,s,r);case 3:e:{if(lk(t),e===null)throw Error(mt(387));n=t.pendingProps,a=t.memoizedState,s=a.element,L3(e,t),Zm(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=gd(Error(mt(423)),t),t=K5(e,t,n,r,s);break e}else if(n!==s){s=gd(Error(mt(424)),t),t=K5(e,t,n,r,s);break e}else for(Za=pc(t.stateNode.containerInfo.firstChild),ti=t,sn=!0,zi=null,r=I3(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(hd(),n===s){t=yl(e,t,r);break e}la(e,t,n,r)}t=t.child}return t;case 5:return D3(t),e===null&&Sy(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,o=s.children,by(n,s)?o=null:a!==null&&by(n,a)&&(t.flags|=32),ok(e,t),la(e,t,o,r),t.child;case 6:return e===null&&Sy(t),null;case 13:return ck(e,t,r);case 4:return T2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=pd(t,null,n,r):la(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),Q5(e,t,n,s,r);case 7:return la(e,t,t.pendingProps,r),t.child;case 8:return la(e,t,t.pendingProps.children,r),t.child;case 12:return la(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,$r(Ym,n._currentValue),n._currentValue=o,a!==null)if(no(a.value,o)){if(a.children===s.children&&!Na.current){t=yl(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=dl(-1,r&-r),c.tag=2;var A=a.updateQueue;if(A!==null){A=A.shared;var u=A.pending;u===null?c.next=c:(c.next=u.next,u.next=c),A.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),ky(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(mt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),ky(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}la(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ju(t,r),s=ki(s),n=n(s),t.flags|=1,la(e,t,n,r),t.child;case 14:return n=t.type,s=Vi(n,t.pendingProps),s=Vi(n.type,s),M5(e,t,n,s,r);case 15:return ak(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Vi(n,s),bm(e,t),t.tag=1,Sa(n)?(e=!0,$m(t)):e=!1,Ju(t,r),rk(t,n,s),Fy(t,n,s,r),Iy(null,t,n,!0,e,r);case 19:return Ak(e,t,r);case 22:return ik(e,t,r)}throw Error(mt(156,t.tag))};function Nk(e,t){return ZS(e,t)}function gL(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _i(e,t,r,n){return new gL(e,t,r,n)}function W2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xL(e){if(typeof e=="function")return W2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===d2)return 11;if(e===f2)return 14}return 2}function vc(e,t){var r=e.alternate;return r===null?(r=_i(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Cm(e,t,r,n,s,a){var o=2;if(n=e,typeof e=="function")W2(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Uu:return vA(r.children,s,a,t);case u2:o=8,s|=8;break;case ey:return e=_i(12,r,t,s|2),e.elementType=ey,e.lanes=a,e;case ty:return e=_i(13,r,t,s),e.elementType=ty,e.lanes=a,e;case ry:return e=_i(19,r,t,s),e.elementType=ry,e.lanes=a,e;case DS:return Zg(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case US:o=10;break e;case LS:o=9;break e;case d2:o=11;break e;case f2:o=14;break e;case Yl:o=16,n=null;break e}throw Error(mt(130,e==null?e:typeof e,""))}return t=_i(o,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function vA(e,t,r,n){return e=_i(7,e,n,t),e.lanes=r,e}function Zg(e,t,r,n){return e=_i(22,e,n,t),e.elementType=DS,e.lanes=r,e.stateNode={isHidden:!1},e}function k1(e,t,r){return e=_i(6,e,null,t),e.lanes=r,e}function E1(e,t,r){return t=_i(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function vL(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=c1(0),this.expirationTimes=c1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=c1(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function $2(e,t,r,n,s,a,o,l,c){return e=new vL(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=_i(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},j2(a),e}function yL(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Iu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Sk(e){if(!e)return _c;e=e._reactInternals;e:{if(KA(e)!==e||e.tag!==1)throw Error(mt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Sa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(mt(171))}if(e.tag===1){var r=e.type;if(Sa(r))return S3(e,r,t)}return t}function kk(e,t,r,n,s,a,o,l,c){return e=$2(r,n,!0,e,s,a,o,l,c),e.context=Sk(null),r=e.current,n=da(),s=xc(r),a=dl(n,s),a.callback=t??null,mc(r,a,s),e.current.lanes=s,rh(e,s,n),ka(e,n),e}function ex(e,t,r,n){var s=t.current,a=da(),o=xc(s);return r=Sk(r),t.context===null?t.context=r:t.pendingContext=r,t=dl(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=mc(s,t,o),e!==null&&(Zi(e,s,o,a),vm(e,s,o)),o}function og(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Z5(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function z2(e,t){Z5(e,t),(e=e.alternate)&&Z5(e,t)}function wL(){return null}var Ek=typeof reportError=="function"?reportError:function(e){console.error(e)};function X2(e){this._internalRoot=e}tx.prototype.render=X2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(mt(409));ex(e,t,null,null)};tx.prototype.unmount=X2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;jA(function(){ex(null,e,null,null)}),t[xl]=null}};function tx(e){this._internalRoot=e}tx.prototype.unstable_scheduleHydration=function(e){if(e){var t=i3();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ec.length&&t!==0&&t<ec[r].priority;r++);ec.splice(r,0,e),r===0&&l3(e)}};function Y2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function rx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function eB(){}function bL(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var A=og(o);a.call(A)}}var o=kk(t,n,e,0,null,!1,!1,"",eB);return e._reactRootContainer=o,e[xl]=o.current,_f(e.nodeType===8?e.parentNode:e),jA(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var A=og(c);l.call(A)}}var c=$2(e,0,!1,null,null,!1,!1,"",eB);return e._reactRootContainer=c,e[xl]=c.current,_f(e.nodeType===8?e.parentNode:e),jA(function(){ex(t,c,r,n)}),c}function nx(e,t,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=og(o);l.call(c)}}ex(t,o,e,s)}else o=bL(r,t,e,s,n);return og(o)}s3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=E0(t.pendingLanes);r!==0&&(m2(t,r|1),ka(t,En()),!(wr&6)&&(xd=En()+500,Ic()))}break;case 13:jA(function(){var n=vl(e,1);if(n!==null){var s=da();Zi(n,e,1,s)}}),z2(e,1)}};g2=function(e){if(e.tag===13){var t=vl(e,134217728);if(t!==null){var r=da();Zi(t,e,134217728,r)}z2(e,134217728)}};a3=function(e){if(e.tag===13){var t=xc(e),r=vl(e,t);if(r!==null){var n=da();Zi(r,e,t,n)}z2(e,t)}};i3=function(){return Pr};o3=function(e,t){var r=Pr;try{return Pr=e,t()}finally{Pr=r}};dy=function(e,t,r){switch(t){case"input":if(ay(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Wg(n);if(!s)throw Error(mt(90));OS(n),ay(n,s)}}}break;case"textarea":QS(e,r);break;case"select":t=r.value,t!=null&&$u(e,!!r.multiple,t,!1)}};WS=q2;$S=jA;var _L={usingClientEntryPoint:!1,Events:[sh,Ou,Wg,VS,GS,q2]},h0={findFiberByHostInstance:dA,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BL={bundleType:h0.bundleType,version:h0.version,rendererPackageName:h0.rendererPackageName,rendererConfig:h0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_l.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=YS(e),e===null?null:e.stateNode},findFiberByHostInstance:h0.findFiberByHostInstance||wL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dp.isDisabled&&dp.supportsFiber)try{Kg=dp.inject(BL),ko=dp}catch{}}ai.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_L;ai.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y2(t))throw Error(mt(200));return yL(e,t,null,r)};ai.createRoot=function(e,t){if(!Y2(e))throw Error(mt(299));var r=!1,n="",s=Ek;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=$2(e,1,!1,null,null,r,!1,n,s),e[xl]=t.current,_f(e.nodeType===8?e.parentNode:e),new X2(t)};ai.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(mt(188)):(e=Object.keys(e).join(","),Error(mt(268,e)));return e=YS(t),e=e===null?null:e.stateNode,e};ai.flushSync=function(e){return jA(e)};ai.hydrate=function(e,t,r){if(!rx(t))throw Error(mt(200));return nx(null,e,t,!0,r)};ai.hydrateRoot=function(e,t,r){if(!Y2(e))throw Error(mt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=Ek;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=kk(t,null,e,1,r??null,s,!1,a,o),e[xl]=t.current,_f(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new tx(t)};ai.render=function(e,t,r){if(!rx(t))throw Error(mt(200));return nx(null,e,t,!1,r)};ai.unmountComponentAtNode=function(e){if(!rx(e))throw Error(mt(40));return e._reactRootContainer?(jA(function(){nx(null,null,e,!1,function(){e._reactRootContainer=null,e[xl]=null})}),!0):!1};ai.unstable_batchedUpdates=q2;ai.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!rx(r))throw Error(mt(200));if(e==null||e._reactInternals===void 0)throw Error(mt(38));return nx(e,t,r,!1,n)};ai.version="18.3.1-next-f1338f8080-20240426";function Fk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fk)}catch(e){console.error(e)}}Fk(),FS.exports=ai;var CL=FS.exports,jk,tB=CL;jk=tB.createRoot,tB.hydrateRoot;var Vy=function(e,t){return Vy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Vy(e,t)};function Tk(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Vy(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var lg=function(){return lg=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},lg.apply(this,arguments)};function Sd(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function Ik(e,t,r,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a}function Uk(e,t){return function(r,n){t(r,n,e)}}function Lk(e,t,r,n,s,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",A=!t&&e?n.static?e:e.prototype:null,u=t||(A?Object.getOwnPropertyDescriptor(A,n.name):{}),f,h=!1,d=r.length-1;d>=0;d--){var x={};for(var g in n)x[g]=g==="access"?{}:n[g];for(var g in n.access)x.access[g]=n.access[g];x.addInitializer=function(m){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var y=(0,r[d])(l==="accessor"?{get:u.get,set:u.set}:u[c],x);if(l==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(f=o(y.get))&&(u.get=f),(f=o(y.set))&&(u.set=f),(f=o(y.init))&&s.unshift(f)}else(f=o(y))&&(l==="field"?s.unshift(f):u[c]=f)}A&&Object.defineProperty(A,n.name,u),h=!0}function Dk(e,t,r){for(var n=arguments.length>2,s=0;s<t.length;s++)r=n?t[s].call(e,r):t[s].call(e);return n?r:void 0}function Pk(e){return typeof e=="symbol"?e:"".concat(e)}function Ok(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function Rk(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ot(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{A(n.next(u))}catch(f){o(f)}}function c(u){try{A(n.throw(u))}catch(f){o(f)}}function A(u){u.done?a(u.value):s(u.value).then(l,c)}A((n=n.apply(e,t||[])).next())})}function Qk(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(A){return function(u){return c([A,u])}}function c(A){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,A[0]&&(r=0)),r;)try{if(n=1,s&&(a=A[0]&2?s.return:A[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,A[1])).done)return a;switch(s=0,a&&(A=[A[0]&2,a.value]),A[0]){case 0:case 1:a=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,s=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!a||A[1]>a[0]&&A[1]<a[3])){r.label=A[1];break}if(A[0]===6&&r.label<a[1]){r.label=a[1],a=A;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(A);break}a[2]&&r.ops.pop(),r.trys.pop();continue}A=t.call(e,r)}catch(u){A=[6,u],s=0}finally{n=a=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}var sx=Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function Mk(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&sx(t,e,r)}function cg(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function J2(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,a=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function Hk(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(J2(arguments[t]));return e}function Kk(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var a=arguments[t],o=0,l=a.length;o<l;o++,s++)n[s]=a[o];return n}function qk(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function vd(e){return this instanceof vd?(this.v=e,this):new vd(e)}function Vk(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(d){return function(x){return Promise.resolve(x).then(d,f)}}function l(d,x){n[d]&&(s[d]=function(g){return new Promise(function(y,m){a.push([d,g,y,m])>1||c(d,g)})},x&&(s[d]=x(s[d])))}function c(d,x){try{A(n[d](x))}catch(g){h(a[0][3],g)}}function A(d){d.value instanceof vd?Promise.resolve(d.value.v).then(u,f):h(a[0][2],d)}function u(d){c("next",d)}function f(d){c("throw",d)}function h(d,x){d(x),a.shift(),a.length&&c(a[0][0],a[0][1])}}function Gk(e){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,a){t[s]=e[s]?function(o){return(r=!r)?{value:vd(e[s](o)),done:!1}:a?a(o):o}:a}}function Wk(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof cg=="function"?cg(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(o){return new Promise(function(l,c){o=e[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(A){a({value:A,done:l})},o)}}function $k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var NL=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Gy=function(e){return Gy=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Gy(e)};function zk(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Gy(e),n=0;n<r.length;n++)r[n]!=="default"&&sx(t,e,r[n]);return NL(t,e),t}function Xk(e){return e&&e.__esModule?e:{default:e}}function Yk(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function Jk(e,t,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(e,r):s?s.value=r:t.set(e,r),r}function Zk(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function eE(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var SL=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function tE(e){function t(a){e.error=e.hasError?new SL(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,n=0;function s(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(a).then(s,function(o){return t(o),s()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}function rE(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,s,a,o){return n?t?".jsx":".js":s&&(!a||!o)?r:s+a+"."+o.toLowerCase()+"js"}):e}const kL={__extends:Tk,__assign:lg,__rest:Sd,__decorate:Ik,__param:Uk,__esDecorate:Lk,__runInitializers:Dk,__propKey:Pk,__setFunctionName:Ok,__metadata:Rk,__awaiter:Ot,__generator:Qk,__createBinding:sx,__exportStar:Mk,__values:cg,__read:J2,__spread:Hk,__spreadArrays:Kk,__spreadArray:qk,__await:vd,__asyncGenerator:Vk,__asyncDelegator:Gk,__asyncValues:Wk,__makeTemplateObject:$k,__importStar:zk,__importDefault:Xk,__classPrivateFieldGet:Yk,__classPrivateFieldSet:Jk,__classPrivateFieldIn:Zk,__addDisposableResource:eE,__disposeResources:tE,__rewriteRelativeImportExtension:rE},EL=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:eE,get __assign(){return lg},__asyncDelegator:Gk,__asyncGenerator:Vk,__asyncValues:Wk,__await:vd,__awaiter:Ot,__classPrivateFieldGet:Yk,__classPrivateFieldIn:Zk,__classPrivateFieldSet:Jk,__createBinding:sx,__decorate:Ik,__disposeResources:tE,__esDecorate:Lk,__exportStar:Mk,__extends:Tk,__generator:Qk,__importDefault:Xk,__importStar:zk,__makeTemplateObject:$k,__metadata:Rk,__param:Uk,__propKey:Pk,__read:J2,__rest:Sd,__rewriteRelativeImportExtension:rE,__runInitializers:Dk,__setFunctionName:Ok,__spread:Hk,__spreadArray:qk,__spreadArrays:Kk,__values:cg,default:kL},Symbol.toStringTag,{value:"Module"})),FL=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Z2 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class jL extends Z2{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class rB extends Z2{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class nB extends Z2{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Wy;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Wy||(Wy={}));class TL{constructor(t,{headers:r={},customFetch:n,region:s=Wy.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=FL(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Ot(this,arguments,void 0,function*(r,n={}){var s;let a,o;try{const{headers:l,method:c,body:A,signal:u,timeout:f}=n;let h={},{region:d}=n;d||(d=this.region);const x=new URL(`${this.url}/${r}`);d&&d!=="any"&&(h["x-region"]=d,x.searchParams.set("forceFunctionRegion",d));let g;A&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&A instanceof Blob||A instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",g=A):typeof A=="string"?(h["Content-Type"]="text/plain",g=A):typeof FormData<"u"&&A instanceof FormData?g=A:(h["Content-Type"]="application/json",g=JSON.stringify(A)):g=A;let y=u;f&&(o=new AbortController,a=setTimeout(()=>o.abort(),f),u?(y=o.signal,u.addEventListener("abort",()=>o.abort())):y=o.signal);const m=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:g,signal:y}).catch(C=>{throw new jL(C)}),p=m.headers.get("x-relay-error");if(p&&p==="true")throw new rB(m);if(!m.ok)throw new nB(m);let b=((s=m.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),v;return b==="application/json"?v=yield m.json():b==="application/octet-stream"||b==="application/pdf"?v=yield m.blob():b==="text/event-stream"?v=m:b==="multipart/form-data"?v=yield m.formData():v=yield m.text(),{data:v,error:null,response:m}}catch(l){return{data:null,error:l,response:l instanceof nB||l instanceof rB?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var ua={};const kd=ZI(EL);var fp={},hp={},pp={},mp={},gp={},xp={},sB;function nE(){if(sB)return xp;sB=1,Object.defineProperty(xp,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return xp.default=e,xp}var aB;function sE(){if(aB)return gp;aB=1,Object.defineProperty(gp,"__esModule",{value:!0});const t=kd.__importDefault(nE());class r{constructor(s){var a,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(a=s.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=new Headers(this.headers),this.headers.set(s,a),this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var A,u,f,h;let d=null,x=null,g=null,y=c.status,m=c.statusText;if(c.ok){if(this.method!=="HEAD"){const C=await c.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((A=this.headers.get("Accept"))===null||A===void 0)&&A.includes("application/vnd.pgrst.plan+text"))?x=C:x=JSON.parse(C))}const b=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),v=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");b&&v&&v.length>1&&(g=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(d={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,g=null,y=406,m="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const b=await c.text();try{d=JSON.parse(b),Array.isArray(d)&&c.status===404&&(x=[],d=null,y=200,m="OK")}catch{c.status===404&&b===""?(y=204,m="No Content"):d={message:b}}if(d&&this.isMaybeSingle&&(!((h=d==null?void 0:d.details)===null||h===void 0)&&h.includes("0 rows"))&&(d=null,y=200,m="OK"),d&&this.shouldThrowOnError)throw new t.default(d)}return{error:d,data:x,count:g,status:y,statusText:m}});return this.shouldThrowOnError||(l=l.catch(c=>{var A,u,f,h,d,x;let g="";const y=c==null?void 0:c.cause;if(y){const m=(A=y==null?void 0:y.message)!==null&&A!==void 0?A:"",p=(u=y==null?void 0:y.code)!==null&&u!==void 0?u:"";g=`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,g+=`

Caused by: ${(h=y==null?void 0:y.name)!==null&&h!==void 0?h:"Error"}: ${m}`,p&&(g+=` (${p})`),y!=null&&y.stack&&(g+=`
${y.stack}`)}else g=(d=c==null?void 0:c.stack)!==null&&d!==void 0?d:"";return{error:{message:`${(x=c==null?void 0:c.name)!==null&&x!==void 0?x:"FetchError"}: ${c==null?void 0:c.message}`,details:g,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return gp.default=r,gp}var iB;function aE(){if(iB)return mp;iB=1,Object.defineProperty(mp,"__esModule",{value:!0});const t=kd.__importDefault(sE());class r extends t.default{select(s){let a=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const A=c?`${c}.order`:"order",u=this.url.searchParams.get(A);return this.url.searchParams.set(A,`${u?`${u},`:""}${s}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,A=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(A,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:A="text"}={}){var u;const f=[s?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${A}; for="${h}"; options=${f};`),A==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return mp.default=r,mp}var oB;function eb(){if(oB)return pp;oB=1,Object.defineProperty(pp,"__esModule",{value:!0});const t=kd.__importDefault(aE()),r=new RegExp("[,()]");class n extends t.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}regexMatch(a,o){return this.url.searchParams.append(a,`match.${o}`),this}regexIMatch(a,o){return this.url.searchParams.append(a,`imatch.${o}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}isDistinct(a,o){return this.url.searchParams.append(a,`isdistinct.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:c}={}){let A="";c==="plain"?A="pl":c==="phrase"?A="ph":c==="websearch"&&(A="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${A}fts${u}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}}return pp.default=n,pp}var lB;function iE(){if(lB)return hp;lB=1,Object.defineProperty(hp,"__esModule",{value:!0});const t=kd.__importDefault(eb());class r{constructor(s,{headers:a={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(s,a){const{head:o=!1,count:l}=a??{},c=o?"HEAD":"GET";let A=!1;const u=(s??"*").split("").map(f=>/\s/.test(f)&&!A?"":(f==='"'&&(A=!A),f)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:o=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const A=s.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(A.length>0){const u=[...new Set(A)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var A;const u="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const f=s.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(f.length>0){const h=[...new Set(f)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(A=this.fetch)!==null&&A!==void 0?A:fetch})}update(s,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var a;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return hp.default=r,hp}var cB;function IL(){if(cB)return fp;cB=1,Object.defineProperty(fp,"__esModule",{value:!0});const e=kd,t=e.__importDefault(iE()),r=e.__importDefault(eb());class n{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(a){if(!a||typeof a!="string"||a.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:A}={}){var u;let f;const h=new URL(`${this.url}/rpc/${a}`);let d;l||c?(f=l?"HEAD":"GET",Object.entries(o).filter(([g,y])=>y!==void 0).map(([g,y])=>[g,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([g,y])=>{h.searchParams.append(g,y)})):(f="POST",d=o);const x=new Headers(this.headers);return A&&x.set("Prefer",`count=${A}`),new r.default({method:f,url:h,headers:x,schema:this.schemaName,body:d,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return fp.default=n,fp}Object.defineProperty(ua,"__esModule",{value:!0});var oE=ua.PostgrestError=gE=ua.PostgrestBuilder=pE=ua.PostgrestTransformBuilder=fE=ua.PostgrestFilterBuilder=uE=ua.PostgrestQueryBuilder=cE=ua.PostgrestClient=void 0;const Ed=kd,lE=Ed.__importDefault(IL());var cE=ua.PostgrestClient=lE.default;const AE=Ed.__importDefault(iE());var uE=ua.PostgrestQueryBuilder=AE.default;const dE=Ed.__importDefault(eb());var fE=ua.PostgrestFilterBuilder=dE.default;const hE=Ed.__importDefault(aE());var pE=ua.PostgrestTransformBuilder=hE.default;const mE=Ed.__importDefault(sE());var gE=ua.PostgrestBuilder=mE.default;const xE=Ed.__importDefault(nE());oE=ua.PostgrestError=xE.default;var vE=ua.default={PostgrestClient:lE.default,PostgrestQueryBuilder:AE.default,PostgrestFilterBuilder:dE.default,PostgrestTransformBuilder:hE.default,PostgrestBuilder:mE.default,PostgrestError:xE.default};const UL=JI({__proto__:null,get PostgrestBuilder(){return gE},get PostgrestClient(){return cE},get PostgrestError(){return oE},get PostgrestFilterBuilder(){return fE},get PostgrestQueryBuilder(){return uE},get PostgrestTransformBuilder(){return pE},default:vE},[ua]),{PostgrestClient:LL,PostgrestQueryBuilder:gse,PostgrestFilterBuilder:xse,PostgrestTransformBuilder:vse,PostgrestBuilder:yse,PostgrestError:wse}=vE||UL;class DL{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const PL="2.84.0",OL=`realtime-js/${PL}`,yE="1.0.0",RL="2.0.0",AB=yE,$y=1e4,QL=1e3,ML=100;var iA;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(iA||(iA={}));var es;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(es||(es={}));var $i;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})($i||($i={}));var zy;(function(e){e.websocket="websocket"})(zy||(zy={}));var oA;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(oA||(oA={}));class HL{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n,s,a;const o=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(n=t.join_ref)!==null&&n!==void 0?n:"",A=t.payload.event,u=(a=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&a!==void 0?a:new ArrayBuffer(0),f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+A.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let d=new DataView(h),x=0;d.setUint8(x++,this.KINDS.userBroadcastPush),d.setUint8(x++,c.length),d.setUint8(x++,l.length),d.setUint8(x++,o.length),d.setUint8(x++,A.length),d.setUint8(x++,this.BINARY_ENCODING),Array.from(c,y=>d.setUint8(x++,y.charCodeAt(0))),Array.from(l,y=>d.setUint8(x++,y.charCodeAt(0))),Array.from(o,y=>d.setUint8(x++,y.charCodeAt(0))),Array.from(A,y=>d.setUint8(x++,y.charCodeAt(0)));var g=new Uint8Array(h.byteLength+u.byteLength);return g.set(new Uint8Array(h),0),g.set(new Uint8Array(u),h.byteLength),g.buffer}_encodeJsonUserBroadcastPush(t){var r,n,s,a;const o=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(n=t.join_ref)!==null&&n!==void 0?n:"",A=t.payload.event,u=(a=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&a!==void 0?a:{},h=new TextEncoder().encode(JSON.stringify(u)).buffer,d=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+A.length,x=new ArrayBuffer(this.HEADER_LENGTH+d);let g=new DataView(x),y=0;g.setUint8(y++,this.KINDS.userBroadcastPush),g.setUint8(y++,c.length),g.setUint8(y++,l.length),g.setUint8(y++,o.length),g.setUint8(y++,A.length),g.setUint8(y++,this.JSON_ENCODING),Array.from(c,p=>g.setUint8(y++,p.charCodeAt(0))),Array.from(l,p=>g.setUint8(y++,p.charCodeAt(0))),Array.from(o,p=>g.setUint8(y++,p.charCodeAt(0))),Array.from(A,p=>g.setUint8(y++,p.charCodeAt(0)));var m=new Uint8Array(x.byteLength+h.byteLength);return m.set(new Uint8Array(x),0),m.set(new Uint8Array(h),x.byteLength),m.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[s,a,o,l,c]=n;return r({join_ref:s,ref:a,topic:o,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const A=n.decode(t.slice(c,c+s));c=c+s;const u=n.decode(t.slice(c,c+a));c=c+a;const f=n.decode(t.slice(c,c+o));c=c+o;const h=t.slice(c,t.byteLength),d=l===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,x={type:this.BROADCAST_EVENT,event:u,payload:d};return o>0&&(x.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:A,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class wE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Gr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Gr||(Gr={}));const uB=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=KL(o,e,t,s),a),{}):{}},KL=(e,t,r,n)=>{const s=t.find(l=>l.name===e),a=s==null?void 0:s.type,o=r[e];return a&&!n.includes(a)?bE(a,o):Xy(o)},bE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return WL(t,r)}switch(e){case Gr.bool:return qL(t);case Gr.float4:case Gr.float8:case Gr.int2:case Gr.int4:case Gr.int8:case Gr.numeric:case Gr.oid:return VL(t);case Gr.json:case Gr.jsonb:return GL(t);case Gr.timestamp:return $L(t);case Gr.abstime:case Gr.date:case Gr.daterange:case Gr.int4range:case Gr.int8range:case Gr.money:case Gr.reltime:case Gr.text:case Gr.time:case Gr.timestamptz:case Gr.timetz:case Gr.tsrange:case Gr.tstzrange:return Xy(t);default:return Xy(t)}},Xy=e=>e,qL=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},VL=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},GL=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},WL=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>bE(t,l))}return e},$L=e=>typeof e=="string"?e.replace(" ","T"):e,_E=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class F1{constructor(t,r,n={},s=$y){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var dB;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(dB||(dB={}));class Y0{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Y0.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Y0.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Y0.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(a,(A,u)=>{o[A]||(c[A]=u)}),this.map(o,(A,u)=>{const f=a[A];if(f){const h=u.map(y=>y.presence_ref),d=f.map(y=>y.presence_ref),x=u.filter(y=>d.indexOf(y.presence_ref)<0),g=f.filter(y=>h.indexOf(y.presence_ref)<0);x.length>0&&(l[A]=x),g.length>0&&(c[A]=g)}else l[A]=u}),this.syncDiff(a,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var A;const u=(A=t[l])!==null&&A!==void 0?A:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(d=>d.presence_ref),h=u.filter(d=>f.indexOf(d.presence_ref)<0);t[l].unshift(...h)}n(l,u,c)}),this.map(o,(l,c)=>{let A=t[l];if(!A)return;const u=c.map(f=>f.presence_ref);A=A.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=A,s(l,A,c),A.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var fB;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(fB||(fB={}));var J0;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(J0||(J0={}));var il;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(il||(il={}));class tb{constructor(t,r={config:{}},n){var s,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=es.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new F1(this,$i.join,this.params,this.timeout),this.rejoinTimer=new wE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=es.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=es.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=es.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=es.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=es.errored,this.rejoinTimer.scheduleTimeout())}),this._on($i.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Y0(this),this.broadcastEndpointURL=_E(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==es.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,A=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[J0.PRESENCE]&&this.bindings[J0.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:A,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(d=>t==null?void 0:t(il.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(il.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var x;if(this.socket.setAuth(),d===void 0){t==null||t(il.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(x=g==null?void 0:g.length)!==null&&x!==void 0?x:0,m=[];for(let p=0;p<y;p++){const b=g[p],{filter:{event:v,schema:C,table:k,filter:S}}=b,I=d&&d[p];if(I&&I.event===v&&I.schema===C&&I.table===k&&I.filter===S)m.push(Object.assign(Object.assign({},b),{id:I.id}));else{this.unsubscribe(),this.state=es.errored,t==null||t(il.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,t&&t(il.SUBSCRIBED);return}}).receive("error",d=>{this.state=es.errored,t==null||t(il.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(il.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===es.joined&&t===J0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const A=await l.json();c=A.error||A.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const A=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=A.body)===null||s===void 0?void 0:s.cancel()),A.ok?"ok":"error"}catch(A){return A.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const A=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),A.receive("ok",()=>a("ok")),A.receive("error",()=>a("error")),A.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=es.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($i.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new F1(this,$i.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=es.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new F1(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ML){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:A,join:u}=$i;if(n&&[l,c,A,u].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(d=>{var x,g,y;return((x=d.filter)===null||x===void 0?void 0:x.event)==="*"||((y=(g=d.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(d=>d.callback(h,n)):(a=this.bindings[o])===null||a===void 0||a.filter(d=>{var x,g,y,m,p,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in d){const v=d.id,C=(x=d.filter)===null||x===void 0?void 0:x.event;return v&&((g=r.ids)===null||g===void 0?void 0:g.includes(v))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const v=(p=(m=d==null?void 0:d.filter)===null||m===void 0?void 0:m.event)===null||p===void 0?void 0:p.toLocaleLowerCase();return v==="*"||v===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===o}).map(d=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:g,table:y,commit_timestamp:m,type:p,errors:b}=x;h=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:m,eventType:p,new:{},old:{},errors:b}),this._getPayloadRecords(x))}d.callback(h,n)})}_isClosed(){return this.state===es.closed}_isJoined(){return this.state===es.joined}_isJoining(){return this.state===es.joining}_isLeaving(){return this.state===es.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&tb.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on($i.close,{},t)}_onError(t){this._on($i.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=es.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=uB(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=uB(t.columns,t.old_record)),r}}const j1=()=>{},vp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},zL=[1e3,2e3,5e3,1e4],XL=1e4,YL=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class JL{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=$y,this.transport=null,this.heartbeatIntervalMs=vp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=j1,this.ref=0,this.reconnectTimer=null,this.vsn=AB,this.logger=j1,this.conn=null,this.sendBuffer=[],this.serializer=new HL,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${zy.websocket}`,this.httpEndpoint=_E(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=DL.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case iA.connecting:return oA.Connecting;case iA.open:return oA.Open;case iA.closing:return oA.Closing;default:return oA.Closed}}isConnected(){return this.connectionState()===oA.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new tb(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(QL,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},vp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(A){this.log("error","error in heartbeat callback",A)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:o}=r,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),a),this.channels.filter(A=>A._isMember(n)).forEach(A=>A._trigger(s,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===iA.open||this.conn.readyState===iA.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger($i.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([YL],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:OL};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push($i.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new wE(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},vp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,o,l,c,A,u,f,h,d;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:$y,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:vp.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:j1,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:AB,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(A=t==null?void 0:t.reconnectAfterMs)!==null&&A!==void 0?A:x=>zL[x-1]||XL,this.vsn){case yE:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(x,g)=>g(JSON.stringify(x)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(x,g)=>g(JSON.parse(x));break;case RL:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class rb extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function cn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class ZL extends rb{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Yy extends rb{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const nb=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),eD=()=>Response,Jy=e=>{if(Array.isArray(e))return e.map(r=>Jy(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Jy(n)}),t},tD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},T1=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},rD=(e,t,r)=>Ot(void 0,void 0,void 0,function*(){const n=yield eD();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,o=(s==null?void 0:s.statusCode)||a+"";t(new ZL(T1(s),a,o))}).catch(s=>{t(new Yy(T1(s),s))}):t(new Yy(T1(e),e))}),nD=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(tD(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function ih(e,t,r,n,s,a){return Ot(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,nD(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>rD(c,l,n))})})}function Tf(e,t,r,n){return Ot(this,void 0,void 0,function*(){return ih(e,"GET",t,r,n)})}function Gi(e,t,r,n,s){return Ot(this,void 0,void 0,function*(){return ih(e,"POST",t,n,s,r)})}function Zy(e,t,r,n,s){return Ot(this,void 0,void 0,function*(){return ih(e,"PUT",t,n,s,r)})}function sD(e,t,r,n){return Ot(this,void 0,void 0,function*(){return ih(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function sb(e,t,r,n,s){return Ot(this,void 0,void 0,function*(){return ih(e,"DELETE",t,n,s,r)})}class aD{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Ot(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}}var BE;class iD{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[BE]="BlobDownloadBuilder",this.promise=null}asStream(){return new aD(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ot(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}}BE=Symbol.toStringTag;const oD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hB={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class lD{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=nb(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return Ot(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},hB),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const A=this._removeEmptyFolders(r),u=this._getFinalPath(A),f=yield(t=="PUT"?Zy:Gi)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:A,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cn(a))return{data:null,error:a};throw a}})}upload(t,r,n){return Ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Ot(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const A=Object.assign({upsert:hB.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(A.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",A.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",A.cacheControl)):(c=n,u["cache-control"]=`max-age=${A.cacheControl}`,u["content-type"]=A.contentType);const f=yield Zy(this.fetch,l.toString(),c,{headers:u});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(cn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Ot(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield Gi(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new rb("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}update(t,r,n){return Ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Ot(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Ot(this,void 0,void 0,function*(){try{return{data:{path:(yield Gi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Ot(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield Gi(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Ot(this,void 0,void 0,function*(){try{const s=yield Gi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"",l=this._getFinalPath(t),c=()=>Tf(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new iD(c,this.shouldThrowOnError)}info(t){return Ot(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Tf(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Jy(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}exists(t){return Ot(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield sD(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n)&&n instanceof Yy){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let A=s.join("&");return A!==""&&(A=`?${A}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${A}`)}}}remove(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield sb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}list(t,r,n){return Ot(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},oD),r),{prefix:t||""});return{data:yield Gi(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}listV2(t,r){return Ot(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Gi(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const CE="2.84.0",NE={"X-Client-Info":`storage-js/${CE}`};class cD{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const a=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},NE),r),this.fetch=nb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Ot(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield Tf(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}getBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Tf(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}createBucket(t){return Ot(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Gi(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return Ot(this,void 0,void 0,function*(){try{return{data:yield Zy(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield sb(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class AD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},NE),r),this.fetch=nb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}listBuckets(t){return Ot(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Tf(this.fetch,s,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield sb(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}}const ab={"X-Client-Info":`storage-js/${CE}`,"Content-Type":"application/json"};class SE extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function za(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class I1 extends SE{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class uD extends SE{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var pB;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(pB||(pB={}));const ib=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),dD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},mB=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),fD=(e,t,r)=>Ot(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e.status||500,a=e;if(typeof a.json=="function")a.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||s+"";t(new I1(mB(o),s,l))}).catch(()=>{const o=s+"",l=a.statusText||`HTTP ${s} error`;t(new I1(l,s,o))});else{const o=s+"",l=a.statusText||`HTTP ${s} error`;t(new I1(l,s,o))}}else t(new uD(mB(e),e))}),hD=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(dD(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r)):s};function pD(e,t,r,n,s,a){return Ot(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,hD(t,n,s,a)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const A=c.headers.get("content-type");return!A||!A.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>fD(c,l,n))})})}function Xa(e,t,r,n,s){return Ot(this,void 0,void 0,function*(){return pD(e,"POST",t,n,s,r)})}class mD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ab),r),this.fetch=ib(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Xa(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Ot(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(za(n))return{data:null,error:n};throw n}})}listIndexes(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Xa(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(za(n))return{data:null,error:n};throw n}})}}class gD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ab),r),this.fetch=ib(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Ot(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Xa(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}getVectors(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}listVectors(t){return Ot(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Xa(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}queryVectors(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Ot(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Xa(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}}class xD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ab),r),this.fetch=ib(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Xa(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}getBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}listBuckets(){return Ot(this,arguments,void 0,function*(t={}){try{return{data:yield Xa(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ot(this,void 0,void 0,function*(){try{return{data:(yield Xa(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(za(r))return{data:null,error:r};throw r}})}}class vD extends xD{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new yD(this.url,this.headers,t,this.fetch)}}class yD extends mD{constructor(t,r,n,s){super(t,r,s),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ot(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ot(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ot(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ot(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new wD(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class wD extends gD{constructor(t,r,n,s,a){super(t,r,a),this.vectorBucketName=n,this.indexName=s}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ot(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ot(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ot(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ot(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ot(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class bD extends cD{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new lD(this.url,this.headers,t,this.fetch)}get vectors(){return new vD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new AD(this.url+"/iceberg",this.headers,this.fetch)}}const _D="2.84.0";let j0="";typeof Deno<"u"?j0="deno":typeof document<"u"?j0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?j0="react-native":j0="node";const BD={"X-Client-Info":`supabase-js-${j0}/${_D}`},CD={headers:BD},ND={schema:"public"},SD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},kD={},ED=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),FD=()=>Headers,jD=(e,t,r)=>{const n=ED(r),s=FD();return async(a,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let A=new s(o==null?void 0:o.headers);return A.has("apikey")||A.set("apikey",e),A.has("Authorization")||A.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},o),{headers:A}))}};function TD(e){return e.endsWith("/")?e:e+"/"}function ID(e,t){var r,n;const{db:s,auth:a,realtime:o,global:l}=e,{db:c,auth:A,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},A),a),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function UD(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(TD(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const kE="2.84.0",Nu=30*1e3,ew=3,U1=ew*Nu,LD="http://localhost:9999",DD="supabase.auth.token",PD={"X-Client-Info":`gotrue-js/${kE}`},tw="X-Supabase-Api-Version",EE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},OD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,RD=10*60*1e3;class If extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function qt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class QD extends If{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function MD(e){return qt(e)&&e.name==="AuthApiError"}class lA extends If{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Uc extends If{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class qa extends Uc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function HD(e){return qt(e)&&e.name==="AuthSessionMissingError"}class cu extends Uc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class yp extends Uc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class wp extends Uc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function KD(e){return qt(e)&&e.name==="AuthImplicitGrantRedirectError"}class gB extends Uc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rw extends Uc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function L1(e){return qt(e)&&e.name==="AuthRetryableFetchError"}class xB extends Uc{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class nw extends Uc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ag="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),vB=` 	
\r=`.split(""),qD=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<vB.length;t+=1)e[vB[t].charCodeAt(0)]=-2;for(let t=0;t<Ag.length;t+=1)e[Ag[t].charCodeAt(0)]=t;return e})();function yB(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ag[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ag[n]),t.queuedBits-=6}}function FE(e,t,r){const n=qD[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function wB(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{WD(o,n,r)};for(let o=0;o<e.length;o+=1)FE(e.charCodeAt(o),s,a);return t.join("")}function VD(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function GD(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}VD(n,t)}}function WD(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ed(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)FE(e.charCodeAt(s),r,n);return new Uint8Array(t)}function $D(e){const t=[];return GD(e,r=>t.push(r)),new Uint8Array(t)}function pA(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>yB(s,r,n)),yB(null,r,n),t.join("")}function zD(e){return Math.round(Date.now()/1e3)+e}function XD(){return Symbol("auth-callback")}const vs=()=>typeof window<"u"&&typeof document<"u",Zc={tested:!1,writable:!1},jE=()=>{if(!vs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zc.tested)return Zc.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Zc.tested=!0,Zc.writable=!0}catch{Zc.tested=!0,Zc.writable=!1}return Zc.writable};function YD(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const TE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),JD=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Su=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},eA=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Vl=async(e,t)=>{await e.removeItem(t)};class ax{constructor(){this.promise=new ax.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}ax.promiseConstructor=Promise;function D1(e){const t=e.split(".");if(t.length!==3)throw new nw("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!OD.test(t[n]))throw new nw("JWT not in base64url format");return{header:JSON.parse(wB(t[0])),payload:JSON.parse(wB(t[1])),signature:ed(t[2]),raw:{header:t[0],payload:t[1]}}}async function ZD(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function eP(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){s(o);return}}})()})}function tP(e){return("0"+e.toString(16)).substr(-2)}function rP(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,tP).join("")}async function nP(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function sP(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await nP(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Au(e,t,r=!1){const n=rP();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Su(e,`${t}-code-verifier`,s);const a=await sP(n);return[a,n===a?"plain":"s256"]}const aP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function iP(e){const t=e.headers.get(tw);if(!t||!t.match(aP))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function oP(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function lP(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function uu(e){if(!cP.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function P1(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function AP(e,t){return new Proxy(e,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,s)}})}function bB(e){return JSON.parse(JSON.stringify(e))}const sA=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),uP=[502,503,504];async function _B(e){var t;if(!JD(e))throw new rw(sA(e),0);if(uP.includes(e.status))throw new rw(sA(e),e.status);let r;try{r=await e.json()}catch(a){throw new lA(sA(a),a)}let n;const s=iP(e);if(s&&s.getTime()>=EE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new xB(sA(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new qa}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new xB(sA(r),e.status,r.weak_password.reasons);throw new QD(sA(r),e.status||500,n)}const dP=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function $t(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[tw]||(a[tw]=EE["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await fP(e,t,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function fP(e,t,r,n,s,a){const o=dP(t,n,s,a);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new rw(sA(c),0)}if(l.ok||await _B(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await _B(c)}}function Hi(e){var t;let r=null;mP(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=zD(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function BB(e){const t=Hi(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function rc(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function hP(e){return{data:e,error:null}}function pP(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,o=Sd(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function CB(e){return e}function mP(e){return e.access_token&&e.refresh_token&&e.expires_in}const O1=["global","local","others"];class gP{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=TE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=O1[0]){if(O1.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${O1.join(", ")}`);try{return await $t(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(qt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await $t(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:rc})}catch(n){if(qt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Sd(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await $t(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:pP,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(qt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await $t(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:rc})}catch(r){if(qt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,o,l,c;try{const A={nextPage:null,lastPage:0,total:0},u=await $t(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:CB});if(u.error)throw u.error;const f=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,d=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return d.length>0&&(d.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(x.split(";")[1].split("=")[1]);A[`${y}Page`]=g}),A.total=parseInt(h)),{data:Object.assign(Object.assign({},f),A),error:null}}catch(A){if(qt(A))return{data:{users:[]},error:A};throw A}}async getUserById(t){uu(t);try{return await $t(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:rc})}catch(r){if(qt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){uu(t);try{return await $t(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:rc})}catch(n){if(qt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){uu(t);try{return await $t(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:rc})}catch(n){if(qt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){uu(t.userId);try{const{data:r,error:n}=await $t(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(qt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){uu(t.userId),uu(t.id);try{return{data:await $t(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,a,o,l,c;try{const A={nextPage:null,lastPage:0,total:0},u=await $t(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:CB});if(u.error)throw u.error;const f=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,d=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return d.length>0&&(d.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(x.split(";")[1].split("=")[1]);A[`${y}Page`]=g}),A.total=parseInt(h)),{data:Object.assign(Object.assign({},f),A),error:null}}catch(A){if(qt(A))return{data:{clients:[]},error:A};throw A}}async _createOAuthClient(t){try{return await $t(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(qt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await $t(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(qt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await $t(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(qt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await $t(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(qt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await $t(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(qt(r))return{data:null,error:r};throw r}}}function NB(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const du={debug:!!(globalThis&&jE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class IE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class xP extends IE{}async function vP(e,t,r){du.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),du.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){du.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{du.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw du.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new xP(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(du.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function yP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function UE(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function wP(e){return parseInt(e,16)}function bP(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function _P(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:A,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const d=UE(e.address),x=u?`${u}://${n}`:n,g=e.statement?`${e.statement}
`:"",y=`${x} wants you to sign in with your Ethereum account:
${d}

${g}`;let m=`URI: ${f}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(m+=`
Expiration Time: ${s.toISOString()}`),l&&(m+=`
Not Before: ${l.toISOString()}`),c&&(m+=`
Request ID: ${c}`),A){let p=`
Resources:`;for(const b of A){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);p+=`
- ${b}`}m+=p}return`${y}
${m}`}class Kn extends Error{constructor({message:t,code:r,cause:n,name:s}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class ug extends Kn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function BP({error:e,options:t}){var r,n,s;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Kn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Kn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Kn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Kn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Kn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Kn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Kn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(LE(o)){if(a.rp.id!==o)return new Kn({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Kn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Kn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function CP({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Kn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Kn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(LE(n)){if(r.rpId!==n)return new Kn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Kn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Kn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Kn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class NP{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const SP=new NP;function kP(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=Sd(e,["challenge","user","excludeCredentials"]),a=ed(t).buffer,o=Object.assign(Object.assign({},r),{id:ed(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const A=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},A),{id:ed(A.id).buffer,type:A.type||"public-key",transports:A.transports})}}return l}function EP(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Sd(e,["challenge","allowCredentials"]),s=ed(t).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:ed(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function FP(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:pA(new Uint8Array(e.response.attestationObject)),clientDataJSON:pA(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function jP(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:pA(new Uint8Array(s.authenticatorData)),clientDataJSON:pA(new Uint8Array(s.clientDataJSON)),signature:pA(new Uint8Array(s.signature)),userHandle:s.userHandle?pA(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function LE(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function SB(){var e,t;return!!(vs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function TP(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ug("Browser returned unexpected credential type",t)}:{data:null,error:new ug("Empty credential response",t)}}catch(t){return{data:null,error:BP({error:t,options:e})}}}async function IP(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ug("Browser returned unexpected credential type",t)}:{data:null,error:new ug("Empty credential response",t)}}catch(t){return{data:null,error:CP({error:t,options:e})}}}const UP={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},LP={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function dg(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))n[a]=o;else if(r(o))n[a]=o;else if(t(o)){const l=n[a];t(l)?n[a]=dg(l,o):n[a]=dg(o)}else n[a]=o}return n}function DP(e,t){return dg(UP,e,t||{})}function PP(e,t){return dg(LP,e,t||{})}class OP{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=s??SP.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:A}=o.webauthn.credential_options.publicKey;A.name||(A.name=`${A.id}:${n}`),A.displayName||(A.displayName=A.name)}switch(o.webauthn.type){case"create":{const A=DP(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:u,error:f}=await TP({publicKey:A,signal:c});return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const A=PP(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:u,error:f}=await IP(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:A,signal:c}));return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(o){return qt(o)?{data:null,error:o}:{data:null,error:new lA("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new If("rpId is required for WebAuthn authentication")};try{if(!SB())return{data:null,error:new lA("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return qt(o)?{data:null,error:o}:{data:null,error:new lA("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new If("rpId is required for WebAuthn registration")};try{if(!SB())return{data:null,error:new lA("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:A}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:A}}catch(o){return qt(o)?{data:null,error:o}:{data:null,error:new lA("Unexpected error in register",o)}}}}yP();const RP={url:LD,storageKey:DD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:PD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function kB(e,t,r){return await r()}const fu={};class Uf{get jwks(){var t,r;return(r=(t=fu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){fu[this.storageKey]=Object.assign(Object.assign({},fu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=fu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){fu[this.storageKey]=Object.assign(Object.assign({},fu[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},RP),t);if(this.storageKey=a.storageKey,this.instanceID=(r=Uf.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Uf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&vs()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new gP({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=TE(a.fetch),this.lock=a.lock||kB,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:vs()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=vP:this.lock=kB,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new OP(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:jE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=NB(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=NB(this.memoryStorage)),vs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${kE}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(vs()&&(r=YD(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),vs()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),KD(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return qt(r)?this._returnResult({error:r}):this._returnResult({error:new lA("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await $t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Hi}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,A=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:A,session:c},error:null})}catch(a){if(qt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:u,password:f,options:h}=t;let d=null,x=null;this.flowType==="pkce"&&([d,x]=await Au(this.storage,this.storageKey)),a=await $t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:d,code_challenge_method:x},xform:Hi})}else if("phone"in t){const{phone:u,password:f,options:h}=t;a=await $t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Hi})}else throw new yp("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,A=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:A,session:c},error:null})}catch(a){if(qt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:l}=t;r=await $t(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:BB})}else if("phone"in t){const{phone:a,password:o,options:l}=t;r=await $t(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:BB})}else throw new yp("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const a=new cu;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(qt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,a,o,l,c,A,u,f,h;let d,x;if("message"in t)d=t.message,x=t.signature;else{const{chain:g,wallet:y,statement:m,options:p}=t;let b;if(vs())if(typeof y=="object")b=y;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")b=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const v=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href),C=await b.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=UE(C[0]);let S=(n=p==null?void 0:p.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const N=await b.request({method:"eth_chainId"});S=wP(N)}const I={domain:v.host,address:k,statement:m,uri:v.href,version:"1",chainId:S,nonce:(s=p==null?void 0:p.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=p==null?void 0:p.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=p==null?void 0:p.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=p==null?void 0:p.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(A=p==null?void 0:p.signInWithEthereum)===null||A===void 0?void 0:A.requestId,resources:(u=p==null?void 0:p.signInWithEthereum)===null||u===void 0?void 0:u.resources};d=_P(I),x=await b.request({method:"personal_sign",params:[bP(d),k]})}try{const{data:g,error:y}=await $t(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:x},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Hi});if(y)throw y;if(!g||!g.session||!g.user){const m=new cu;return this._returnResult({data:{user:null,session:null},error:m})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:y})}catch(g){if(qt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,n,s,a,o,l,c,A,u,f,h,d;let x,g;if("message"in t)x=t.message,g=t.signature;else{const{chain:y,wallet:m,statement:p,options:b}=t;let v;if(vs())if(typeof m=="object")v=m;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))v=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=m}const C=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in v&&v.signIn){const k=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),p?{statement:p}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)x=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),g=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in v)||typeof v.signMessage!="function"||!("publicKey"in v)||typeof v!="object"||!v.publicKey||!("toBase58"in v.publicKey)||typeof v.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${C.host} wants you to sign in with your Solana account:`,v.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(s=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((A=b==null?void 0:b.signInWithSolana)===null||A===void 0)&&A.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((f=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...b.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await v.signMessage(new TextEncoder().encode(x),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=k}}try{const{data:y,error:m}=await $t(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:pA(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Hi});if(m)throw m;if(!y||!y.session||!y.user){const p=new cu;return this._returnResult({data:{user:null,session:null},error:p})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:m})}catch(y){if(qt(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(t){const r=await eA(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:o}=await $t(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Hi});if(await Vl(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new cu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(qt(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=t,l=await $t(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Hi}),{data:c,error:A}=l;if(A)return this._returnResult({data:{user:null,session:null},error:A});if(!c||!c.session||!c.user){const u=new cu;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:A})}catch(r){if(qt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,s,a,o;try{if("email"in t){const{email:l,options:c}=t;let A=null,u=null;this.flowType==="pkce"&&([A,u]=await Au(this.storage,this.storageKey));const{error:f}=await $t(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:A,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:l,options:c}=t,{data:A,error:u}=await $t(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:A==null?void 0:A.message_id},error:u})}throw new yp("You must provide either an email or phone number.")}catch(l){if(qt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await $t(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Hi});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,A=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:A,session:c},error:null})}catch(s){if(qt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,n,s,a,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Au(this.storage,this.storageKey));const A=await $t(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:hP});return!((a=A.data)===null||a===void 0)&&a.url&&vs()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(A.data.url),this._returnResult(A)}catch(l){if(qt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new qa;const{error:s}=await $t(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(qt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:o}=await $t(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:o,error:l}=await $t(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new yp("You must provide either an email or phone number and a type")}catch(r){if(qt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await eA(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<U1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await eA(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=P1()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=AP(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await $t(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:rc}):await this._useSession(async r=>{var n,s,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new qa}:await $t(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:rc})})}catch(r){if(qt(r))return HD(r)&&(await this._removeSession(),await Vl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new qa;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Au(this.storage,this.storageKey));const{data:A,error:u}=await $t(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:rc});if(u)throw u;return o.user=A.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(qt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new qa;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=D1(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(qt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new qa;const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(qt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!vs())throw new wp("No browser detected.");if(t.error||t.error_description||t.error_code)throw new wp(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new gB("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wp("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new gB("No code detected.");const{data:p,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const v=new URL(window.location.href);return v.searchParams.delete("code"),window.history.replaceState(window.history.state,"",v.toString()),{data:{session:p.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:A}=t;if(!a||!l||!o||!A)throw new wp("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const d=h-u;d*1e3<=Nu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${f}s`);const x=h-f;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,u);const{data:g,error:y}=await this._getUser(a);if(y)throw y;const m={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:f,expires_at:h,refresh_token:o,token_type:A,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:t.type},error:null})}catch(n){if(qt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await eA(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({error:a});const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(MD(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Vl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=XD(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Au(this.storage,this.storageKey,!0));try{return await $t(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(qt(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,l,c,A,u;const{data:f,error:h}=a;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await $t(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(A=f.session)===null||A===void 0?void 0:A.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return vs()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(qt(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:a}}=r;if(s)throw s;const{options:o,provider:l,token:c,access_token:A,nonce:u}=t,f=await $t(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:A,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Hi}),{data:h,error:d}=f;return d?this._returnResult({data:{user:null,session:null},error:d}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new cu}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:d}))}catch(s){if(qt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await $t(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await eP(async s=>(s>0&&await ZD(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await $t(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Hi})),(s,a)=>{const o=200*Math.pow(2,s);return a&&L1(a)&&Date.now()+o-n<Nu})}catch(n){if(this._debug(r,"error",n),qt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),vs()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await eA(this.storage,this.storageKey);if(s&&this.userStorage){let o=await eA(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Su(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:P1()}else if(s&&!s.user&&!s.user){const o=await eA(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Vl(this.storage,this.storageKey+"-user"),await Su(this.storage,this.storageKey,s)):s.user=P1()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<U1;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${U1}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),L1(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new qa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new ax;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new qa;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),qt(a)){const o={data:null,error:a};return L1(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Su(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=bB(s);await Su(this.storage,this.storageKey,a)}else{const s=bB(r);await Su(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Vl(this.storage,this.storageKey),await Vl(this.storage,this.storageKey+"-code-verifier"),await Vl(this.storage,this.storageKey+"-user"),this.userStorage&&await Vl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&vs()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Nu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Nu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Nu}ms, refresh threshold is ${ew} ticks`),s<=ew&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof IE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vs()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await Au(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?this._returnResult({data:null,error:a}):await $t(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:A}=await $t(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return A?this._returnResult({data:null,error:A}):(t.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?FP(t.webauthn.credential_response):jP(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await $t(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=await $t(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:kP(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:EP(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=D1(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const A=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:A},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await $t(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new qa})})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new qa});const o=await $t(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&vs()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(qt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new qa});const o=await $t(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&vs()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(qt(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await $t(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new qa})})}catch(t){if(qt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await $t(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new qa})})}catch(r){if(qt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+RD>s)return n;const{data:a,error:o}=await $t(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:d,error:x}=await this.getSession();if(x||!d.session)return this._returnResult({data:null,error:x});n=d.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=D1(n);r!=null&&r.allowExpired||oP(a.exp);const A=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!A){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:a,header:s,signature:o},error:null}}const u=lP(s.alg),f=await crypto.subtle.importKey("jwk",A,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,$D(`${l}.${c}`)))throw new nw("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(qt(n))return this._returnResult({data:null,error:n});throw n}}}Uf.nextInstanceID={};const QP=Uf;class MP extends QP{constructor(t){super(t)}}class HP{constructor(t,r,n){var s,a,o;this.supabaseUrl=t,this.supabaseKey=r;const l=UD(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,A={db:ND,realtime:kD,auth:Object.assign(Object.assign({},SD),{storageKey:c}),global:CD},u=ID(n??{},A);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=jD(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new LL(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new bD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new TL(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:A,throwOnError:u},f,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new MP({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),f),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,flowType:l,lock:c,debug:A,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new JL(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const KP=(e,t,r)=>new HP(e,t,r);function qP(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}qP()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const VP="https://dkrtsqienlhpouohmfki.supabase.co",GP="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY",oe=KP(VP,GP),DE=G.createContext(void 0);function WP({children:e}){const[t,r]=G.useState(null),[n,s]=G.useState(null),[a,o]=G.useState(!0);G.useEffect(()=>{oe.auth.getSession().then(({data:{session:h}})=>{r((h==null?void 0:h.user)??null),h!=null&&h.user?l(h.user.id):o(!1)});const{data:{subscription:f}}=oe.auth.onAuthStateChange((h,d)=>{r((d==null?void 0:d.user)??null),d!=null&&d.user?l(d.user.id):(s(null),o(!1))});return()=>f.unsubscribe()},[]);const l=async f=>{try{const{data:h,error:d}=await oe.from("user_profiles").select("*").eq("id",f).maybeSingle();if(d)throw d;s(h)}catch(h){console.error("Error loading profile:",h)}finally{o(!1)}},c=async(f,h)=>{let d=f;if(!f.includes("@")){console.log("Looking up username:",f.toLowerCase());const{data:g,error:y}=await oe.from("user_profiles").select("email, username, is_active").eq("username",f.toLowerCase()).maybeSingle();if(console.log("Username lookup result:",{data:g,error:y}),y)throw console.error("Error looking up username:",y),new Error("Invalid username or password");if(!g)throw console.error("Username not found:",f),new Error("Invalid username or password");if(!g.is_active)throw new Error("Account is inactive. Please contact administrator.");d=g.email,console.log("Resolved email:",d)}console.log("Attempting sign in with email:",d);const{error:x}=await oe.auth.signInWithPassword({email:d,password:h});if(x)throw console.error("Sign in error:",x),x;console.log("Sign in successful")},A=async(f,h,d,x)=>{const{data:g,error:y}=await oe.auth.signUp({email:f,password:h});if(y)throw y;if(g.user){const{error:m}=await oe.from("user_profiles").insert({id:g.user.id,email:f,full_name:d,role:x,language:"en",is_active:!0});if(m)throw m}},u=async()=>{const{error:f}=await oe.auth.signOut();if(f)throw f};return i.jsx(DE.Provider,{value:{user:t,profile:n,loading:a,signIn:c,signUp:A,signOut:u},children:e})}function Qr(){const e=G.useContext(DE);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const $P={en:{common:{search:"Search",filter:"Filter",export:"Export",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",close:"Close",submit:"Submit",actions:"Actions",loading:"Loading...",noData:"No data available",confirm:"Confirm",yes:"Yes",no:"No",success:"Success",error:"Error",warning:"Warning"},auth:{login:"Login",logout:"Logout",email:"Email",password:"Password",signIn:"Sign In",signOut:"Sign Out",welcomeBack:"Welcome Back",enterCredentials:"Enter your credentials to continue"},nav:{dashboard:"Dashboard",products:"Products",stock:"Stock",batches:"Batches",inventory:"Inventory",customers:"Customers",crm:"CRM",deliveryChallan:"Delivery Challan",sales:"Sales",finance:"Finance",settings:"Settings",users:"Users"},commandCenter:{title:"CRM Command Center",subtitle:"Ultra-fast inquiry processing with AI automation",emailList:"Email Inbox",inquiryForm:"Inquiry Form",quickActions:"Quick Actions",todaysActions:"Today's Actions",parseEmail:"Parse Email",parsing:"Parsing...",autoFilled:"Auto-filled by AI",confidence:"Confidence",saveInquiry:"Save Inquiry",saving:"Saving...",sendPrice:"Send Price",sendCOA:"Send COA",sendMSDS:"Send MSDS",sendSample:"Send Sample",logActivity:"Log Activity",noEmailSelected:"Select an email to parse",noInquirySelected:"Select an inquiry for quick actions",selectEmail:"Select an email from the list",emailFrom:"From",emailDate:"Date",requestedItems:"Requested",priority:"Priority",activityType:"Activity Type",activityOutcome:"Outcome",activityNotes:"Notes",dueReminders:"Due Reminders",upcomingFollowups:"Upcoming Follow-ups",recentActivity:"Recent Activity",viewAll:"View All",noReminders:"No due reminders",noFollowups:"No upcoming follow-ups",noActivity:"No recent activity",priorities:{low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},statuses:{new:"New Inquiry",price_quoted:"Price Quoted",coa_pending:"COA Pending",sample_sent:"Sample Sent",negotiation:"Negotiation",po_received:"PO Received",won:"Won",lost:"Lost"},activities:{email_sent:"Email Sent",phone_call:"Phone Call",meeting:"Meeting",document_sent:"Document Sent",follow_up:"Follow-up",note:"Note"},outcomes:{positive:"Positive",neutral:"Neutral",negative:"Negative",pending:"Pending Response"}},dashboard:{title:"Dashboard",totalProducts:"Total Products",lowStock:"Low Stock Items",nearExpiry:"Near Expiry",totalCustomers:"Total Customers",salesThisMonth:"Sales This Month",revenueThisMonth:"Revenue This Month",profitThisMonth:"Profit This Month",pendingFollowUps:"Pending Follow-ups"},products:{title:"Products",addProduct:"Add Product",editProduct:"Edit Product",productName:"Product Name",productCode:"Product Code",hsnCode:"HSN Code",category:"Category",unit:"Unit",packagingType:"Packaging Type",defaultSupplier:"Default Supplier",description:"Description",uploadFiles:"Upload Files",categories:{api:"API",excipient:"Excipient",solvent:"Solvent",other:"Other"},units:{kg:"Kilogram",litre:"Litre",ton:"Ton",piece:"Piece"}},batches:{title:"Batches",addBatch:"Add Batch",editBatch:"Edit Batch",batchNumber:"Batch Number",product:"Product",importDate:"Import Date",importQuantity:"Import Quantity",currentStock:"Current Stock",packagingDetails:"Packaging Details",importPrice:"Import Price",dutyCharges:"Duty Charges",freightCharges:"Freight Charges",otherCharges:"Other Charges",totalCost:"Total Cost",costPerUnit:"Cost Per Unit",expiryDate:"Expiry Date",warehouseLocation:"Warehouse Location",uploadDocuments:"Upload Documents"},inventory:{title:"Inventory",stockSummary:"Stock Summary",batchWiseStock:"Batch-wise Stock",lowStockAlert:"Low Stock Alert",expiryAlert:"Expiry Alert",stockMovement:"Stock Movement",adjustStock:"Adjust Stock"},customers:{title:"Customers",addCustomer:"Add Customer",editCustomer:"Edit Customer",customerName:"Customer Name",companyName:"Company Name",npwp:"NPWP (Tax ID)",address:"Address",city:"City",country:"Country",contactPerson:"Contact Person",email:"Email",phone:"Phone",gstVatType:"GST/VAT Type",paymentTerms:"Payment Terms"},crm:{title:"CRM",leads:"Leads",activities:"Activities",addLead:"Add Lead",editLead:"Edit Lead",companyName:"Company Name",contactPerson:"Contact Person",productInterest:"Product Interest",quantityInterest:"Quantity Interest",leadSource:"Lead Source",status:"Status",assignedTo:"Assigned To",expectedCloseDate:"Expected Close Date",estimatedValue:"Estimated Value",addActivity:"Add Activity",followUp:"Follow-up",statuses:{inquiry:"Inquiry",quotation:"Quotation",negotiation:"Negotiation",won:"Won",lost:"Lost"}},sales:{title:"Sales",invoices:"Invoices",createInvoice:"Create Invoice",invoiceNumber:"Invoice Number",customer:"Customer",invoiceDate:"Invoice Date",dueDate:"Due Date",items:"Items",addItem:"Add Item",quantity:"Quantity",unitPrice:"Unit Price",taxRate:"Tax Rate",subtotal:"Subtotal",tax:"Tax",discount:"Discount",total:"Total",paymentStatus:"Payment Status",deliveryChallan:"Delivery Challan",generatePDF:"Generate PDF",sendEmail:"Send Email"},salesOrders:{title:"Sales Orders",createSalesOrder:"Create Sales Order",customerPoNumber:"Customer PO Number",customerPoDate:"Customer PO Date",soDate:"Sales Order Date",expectedDeliveryDate:"Expected Delivery Date",uploadPo:"Upload Customer PO",product:"Product",freeStock:"Free Stock",discountPercent:"Discount %",taxPercent:"Tax %",lineTotal:"Line Total",itemDeliveryDate:"Item Delivery Date",notes:"Notes",grandTotal:"Grand Total",saveAsDraft:"Save as Draft",submitForApproval:"Submit for Approval"},finance:{title:"Finance",dashboard:"Dashboard",expenses:"Expenses",reports:"Reports",importCosts:"Import Costs",salesRevenue:"Sales Revenue",grossProfit:"Gross Profit",profitMargin:"Profit Margin",addExpense:"Add Expense",expenseCategory:"Category",amount:"Amount",expenseDate:"Date"},settings:{title:"Settings",companyProfile:"Company Profile",taxSettings:"Tax Settings",emailSettings:"Email Settings",systemSettings:"System Settings",companyName:"Company Name",companyAddress:"Company Address",companyPhone:"Company Phone",companyEmail:"Company Email",companyTaxId:"Company Tax ID",defaultTaxRate:"Default Tax Rate",invoicePrefix:"Invoice Prefix",lowStockThreshold:"Low Stock Threshold",expiryAlertDays:"Expiry Alert Days"}},id:{common:{search:"Cari",filter:"Filter",export:"Ekspor",add:"Tambah",edit:"Edit",delete:"Hapus",save:"Simpan",cancel:"Batal",close:"Tutup",submit:"Kirim",actions:"Aksi",loading:"Memuat...",noData:"Tidak ada data",confirm:"Konfirmasi",yes:"Ya",no:"Tidak",success:"Berhasil",error:"Error",warning:"Peringatan"},auth:{login:"Masuk",logout:"Keluar",email:"Email",password:"Kata Sandi",signIn:"Masuk",signOut:"Keluar",welcomeBack:"Selamat Datang Kembali",enterCredentials:"Masukkan kredensial Anda untuk melanjutkan"},nav:{dashboard:"Dasbor",products:"Produk",stock:"Stok",batches:"Batch",inventory:"Inventaris",customers:"Pelanggan",crm:"CRM",deliveryChallan:"Surat Jalan",sales:"Penjualan",finance:"Keuangan",settings:"Pengaturan",users:"Pengguna"},commandCenter:{title:"Pusat Komando CRM",subtitle:"Pemrosesan pertanyaan ultra-cepat dengan otomasi AI",emailList:"Kotak Masuk Email",inquiryForm:"Formulir Pertanyaan",quickActions:"Aksi Cepat",todaysActions:"Aksi Hari Ini",parseEmail:"Parse Email",parsing:"Memproses...",autoFilled:"Diisi otomatis oleh AI",confidence:"Kepercayaan",saveInquiry:"Simpan Pertanyaan",saving:"Menyimpan...",sendPrice:"Kirim Harga",sendCOA:"Kirim COA",sendMSDS:"Kirim MSDS",sendSample:"Kirim Sample",logActivity:"Catat Aktivitas",noEmailSelected:"Pilih email untuk diproses",noInquirySelected:"Pilih pertanyaan untuk aksi cepat",selectEmail:"Pilih email dari daftar",emailFrom:"Dari",emailDate:"Tanggal",requestedItems:"Diminta",priority:"Prioritas",activityType:"Jenis Aktivitas",activityOutcome:"Hasil",activityNotes:"Catatan",dueReminders:"Pengingat Jatuh Tempo",upcomingFollowups:"Tindak Lanjut Mendatang",recentActivity:"Aktivitas Terbaru",viewAll:"Lihat Semua",noReminders:"Tidak ada pengingat jatuh tempo",noFollowups:"Tidak ada tindak lanjut mendatang",noActivity:"Tidak ada aktivitas terbaru",priorities:{low:"Rendah",medium:"Sedang",high:"Tinggi",urgent:"Mendesak"},statuses:{new:"Pertanyaan Baru",price_quoted:"Harga Dikutip",coa_pending:"COA Tertunda",sample_sent:"Sample Terkirim",negotiation:"Negosiasi",po_received:"PO Diterima",won:"Menang",lost:"Kalah"},activities:{email_sent:"Email Terkirim",phone_call:"Panggilan Telepon",meeting:"Pertemuan",document_sent:"Dokumen Terkirim",follow_up:"Tindak Lanjut",note:"Catatan"},outcomes:{positive:"Positif",neutral:"Netral",negative:"Negatif",pending:"Menunggu Respons"}},dashboard:{title:"Dasbor",totalProducts:"Total Produk",lowStock:"Stok Rendah",nearExpiry:"Mendekati Kadaluarsa",totalCustomers:"Total Pelanggan",salesThisMonth:"Penjualan Bulan Ini",revenueThisMonth:"Pendapatan Bulan Ini",profitThisMonth:"Laba Bulan Ini",pendingFollowUps:"Follow-up Tertunda"},products:{title:"Produk",addProduct:"Tambah Produk",editProduct:"Edit Produk",productName:"Nama Produk",productCode:"Kode Produk",hsnCode:"Kode HSN",category:"Kategori",unit:"Satuan",packagingType:"Jenis Kemasan",defaultSupplier:"Pemasok Default",description:"Deskripsi",uploadFiles:"Unggah File",categories:{api:"API",excipient:"Excipient",solvent:"Pelarut",other:"Lainnya"},units:{kg:"Kilogram",litre:"Liter",ton:"Ton",piece:"Buah"}},batches:{title:"Batch",addBatch:"Tambah Batch",editBatch:"Edit Batch",batchNumber:"Nomor Batch",product:"Produk",importDate:"Tanggal Impor",importQuantity:"Jumlah Impor",currentStock:"Stok Saat Ini",packagingDetails:"Detail Kemasan",importPrice:"Harga Impor",dutyCharges:"Biaya Bea",freightCharges:"Biaya Pengiriman",otherCharges:"Biaya Lainnya",totalCost:"Total Biaya",costPerUnit:"Biaya Per Unit",expiryDate:"Tanggal Kadaluarsa",warehouseLocation:"Lokasi Gudang",uploadDocuments:"Unggah Dokumen"},inventory:{title:"Inventaris",stockSummary:"Ringkasan Stok",batchWiseStock:"Stok Per Batch",lowStockAlert:"Peringatan Stok Rendah",expiryAlert:"Peringatan Kadaluarsa",stockMovement:"Pergerakan Stok",adjustStock:"Sesuaikan Stok"},customers:{title:"Pelanggan",addCustomer:"Tambah Pelanggan",editCustomer:"Edit Pelanggan",customerName:"Nama Pelanggan",companyName:"Nama Perusahaan",npwp:"NPWP",address:"Alamat",city:"Kota",country:"Negara",contactPerson:"Orang yang Dihubungi",email:"Email",phone:"Telepon",gstVatType:"Jenis GST/VAT",paymentTerms:"Syarat Pembayaran"},crm:{title:"CRM",leads:"Prospek",activities:"Aktivitas",addLead:"Tambah Prospek",editLead:"Edit Prospek",companyName:"Nama Perusahaan",contactPerson:"Orang yang Dihubungi",productInterest:"Produk yang Diminati",quantityInterest:"Jumlah yang Diminati",leadSource:"Sumber Prospek",status:"Status",assignedTo:"Ditugaskan Kepada",expectedCloseDate:"Tanggal Penutupan yang Diharapkan",estimatedValue:"Nilai Perkiraan",addActivity:"Tambah Aktivitas",followUp:"Tindak Lanjut",statuses:{inquiry:"Pertanyaan",quotation:"Penawaran",negotiation:"Negosiasi",won:"Menang",lost:"Kalah"}},sales:{title:"Penjualan",invoices:"Faktur",createInvoice:"Buat Faktur",invoiceNumber:"Nomor Faktur",customer:"Pelanggan",invoiceDate:"Tanggal Faktur",dueDate:"Tanggal Jatuh Tempo",items:"Item",addItem:"Tambah Item",quantity:"Jumlah",unitPrice:"Harga Satuan",taxRate:"Tarif Pajak",subtotal:"Subtotal",tax:"Pajak",discount:"Diskon",total:"Total",paymentStatus:"Status Pembayaran",deliveryChallan:"Surat Jalan",generatePDF:"Buat PDF",sendEmail:"Kirim Email"},salesOrders:{title:"Sales Order",createSalesOrder:"Buat Sales Order",customerPoNumber:"Nomor PO Pelanggan",customerPoDate:"Tanggal PO Pelanggan",soDate:"Tanggal Sales Order",expectedDeliveryDate:"Tanggal Pengiriman Diharapkan",uploadPo:"Unggah PO Pelanggan",product:"Produk",freeStock:"Stok Tersedia",discountPercent:"Diskon %",taxPercent:"Pajak %",lineTotal:"Total Baris",itemDeliveryDate:"Tanggal Pengiriman Item",notes:"Catatan",grandTotal:"Total Keseluruhan",saveAsDraft:"Simpan sebagai Draft",submitForApproval:"Kirim untuk Persetujuan"},finance:{title:"Keuangan",dashboard:"Dasbor",expenses:"Pengeluaran",reports:"Laporan",importCosts:"Biaya Impor",salesRevenue:"Pendapatan Penjualan",grossProfit:"Laba Kotor",profitMargin:"Margin Laba",addExpense:"Tambah Pengeluaran",expenseCategory:"Kategori",amount:"Jumlah",expenseDate:"Tanggal"},settings:{title:"Pengaturan",companyProfile:"Profil Perusahaan",taxSettings:"Pengaturan Pajak",emailSettings:"Pengaturan Email",systemSettings:"Pengaturan Sistem",companyName:"Nama Perusahaan",companyAddress:"Alamat Perusahaan",companyPhone:"Telepon Perusahaan",companyEmail:"Email Perusahaan",companyTaxId:"ID Pajak Perusahaan",defaultTaxRate:"Tarif Pajak Default",invoicePrefix:"Awalan Faktur",lowStockThreshold:"Ambang Stok Rendah",expiryAlertDays:"Hari Peringatan Kadaluarsa"}}},PE=G.createContext(void 0);function zP({children:e}){const[t,r]=G.useState("en");G.useEffect(()=>{const a=localStorage.getItem("language");a&&(a==="en"||a==="id")&&r(a)},[]);const n=a=>{r(a),localStorage.setItem("language",a)},s=a=>{const o=a.split(".");let l=$P[t];for(const c of o)if(l&&typeof l=="object"&&c in l)l=l[c];else return a;return typeof l=="string"?l:a};return i.jsx(PE.Provider,{value:{language:t,setLanguage:n,t:s},children:e})}function Es(){const e=G.useContext(PE);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e}const OE=G.createContext(void 0);function XP({children:e}){const[t,r]=G.useState("dashboard"),[n,s]=G.useState(null),[a,o]=G.useState(!1),l=()=>s(null);return i.jsx(OE.Provider,{value:{currentPage:t,setCurrentPage:r,navigationData:n,setNavigationData:s,clearNavigationData:l,sidebarCollapsed:a,setSidebarCollapsed:o},children:e})}function Bl(){const e=G.useContext(OE);if(e===void 0)throw new Error("useNavigation must be used within a NavigationProvider");return e}const RE="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='48.8745mm'%20height='48.2317mm'%20version='1.1'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%2015686.55%2015480.24'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xmlns:xodm='http://www.corel.com/coreldraw/odm/2003'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.fil1%20{fill:%23FD6D26}%20.fil0%20{fill:%23FDB763}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='Layer_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_105553262742272'%3e%3cpath%20class='fil0'%20d='M69.94%2010438.12l10353.39%200%200%20-1798.67%201665.92%200%200%201868.6%200%20320.44%200%204552.28c0,38.48%20-31.45,69.94%20-69.94,69.94l-11949.38%200c-38.48,0%20-69.94,-31.45%20-69.94,-69.94l0%20-4872.72c0,-38.48%2031.45,-69.94%2069.94,-69.94zm1605.9%201710.15l8737.57%200c13.58,0%2024.68,11.11%2024.68,24.68l0%201719.84c0,13.58%20-11.11,24.68%20-24.68,24.68l-8737.57%200c-13.58,0%20-24.68,-11.11%20-24.68,-24.68l0%20-1719.84c0,-13.58%2011.11,-24.68%2024.68,-24.68z'/%3e%3cpath%20class='fil0'%20d='M15587.15%205136.67l-10353.49%200%200%201822.07%20-1665.92%200%200%20-1892.9%200%20-324.61%200%20-4611.43c0,-39%2031.45,-70.87%2069.94,-70.87l11949.47%200c38.48,0%2069.94,31.87%2069.94,70.87l0%204936.04c0,39%20-31.45,70.83%20-69.94,70.83zm-1605.9%20-1732.36l-8737.67%200c-13.58,0%20-24.68,-11.27%20-24.68,-25l0%20-1742.21c0,-13.74%2011.11,-25%2024.68,-25l8737.67%200c13.58,0%2024.68,11.27%2024.68,25l0%201742.21c0,13.74%20-11.11,25%20-24.68,25z'/%3e%3cpolygon%20class='fil1'%20points='-0,0%201651.16,0%201651.16,6929.27%2015657.09,6929.27%2015657.09,6958.74%2015686.55,6958.74%2015686.55,15480.24%2014022.85,15480.24%2014022.85,8639.45%201651.16,8639.45%20-0,8639.45%20-0,6929.27%20'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";function YP(){const[e,t]=G.useState(""),[r,n]=G.useState(""),[s,a]=G.useState(!1),[o,l]=G.useState(""),{signIn:c}=Qr(),{t:A}=Es(),u=async f=>{f.preventDefault(),l(""),a(!0);try{await c(e,r)}catch{l("Invalid username or password")}finally{a(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-8",children:[i.jsxs("div",{className:"flex flex-col items-center mb-8",children:[i.jsx("div",{className:"mb-4",children:i.jsx("img",{src:RE,alt:"Company Logo",className:"h-24 w-24 mx-auto"})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center",children:"PT. SHUBHAM ANZEN"}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:"PHARMA JAYA"})]}),i.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-2",children:A("auth.welcomeBack")}),i.jsx("p",{className:"text-gray-600 text-center mb-8",children:A("auth.enterCredentials")}),i.jsxs("form",{onSubmit:u,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),i.jsx("input",{id:"username",type:"text",value:e,onChange:f=>t(f.target.value),required:!0,autoComplete:"username",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"username"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your username (e.g., admin, kunal, sales)"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:A("auth.password")}),i.jsx("input",{id:"password",type:"password",value:r,onChange:f=>n(f.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:""})]}),o&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),i.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:A(s?"common.loading":"auth.signIn")})]})]})})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var JP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),gt=(e,t)=>{const r=G.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:c,...A},u)=>G.createElement("svg",{ref:u,...JP,width:s,height:s,stroke:n,strokeWidth:o?Number(a)*24/Number(s):a,className:["lucide",`lucide-${ZP(e)}`,l].join(" "),...A},[...t.map(([f,h])=>G.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=gt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=gt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=gt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=gt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tO=gt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=gt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=gt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=gt("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R1=gt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nO=gt("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q1=gt("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=gt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sO=gt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=gt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=gt("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=gt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=gt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=gt("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=gt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=gt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=gt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=gt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oO=gt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=gt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=gt("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=gt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=gt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=gt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=gt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=gt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=gt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=gt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=gt("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=gt("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=gt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=gt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=gt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uO=gt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=gt("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dO=gt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=gt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=gt("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=gt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=gt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=gt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pO=gt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=gt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=gt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=gt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=gt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=gt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aw=gt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=gt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=gt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=gt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xO=gt("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=gt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=gt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=gt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=gt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vO=gt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=gt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=gt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=gt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=gt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=gt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=gt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yO=gt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=gt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=gt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=gt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=gt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=gt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=gt("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=gt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=gt("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=gt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=gt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JE=gt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=gt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ow=gt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=gt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=gt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=gt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=gt("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=gt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=gt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=gt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function _O(){const[e,t]=G.useState(!1),[r,n]=G.useState([]),[s,a]=G.useState(0),{user:o}=Qr();G.useEffect(()=>{if(o){l();const h=setInterval(l,6e4);return()=>clearInterval(h)}},[o]);const l=async()=>{try{const{data:h,error:d}=await oe.from("notifications").select("*").eq("user_id",o==null?void 0:o.id).order("created_at",{ascending:!1}).limit(10);if(d)throw d;n(h||[]),a((h==null?void 0:h.filter(x=>!x.is_read).length)||0)}catch(h){console.error("Error loading notifications:",h)}},c=async h=>{try{const{error:d}=await oe.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",h);if(d)throw d;l()}catch(d){console.error("Error marking notification as read:",d)}},A=async()=>{try{const{error:h}=await oe.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("user_id",o==null?void 0:o.id).eq("is_read",!1);if(h)throw h;l()}catch(h){console.error("Error marking all as read:",h)}},u=h=>{switch(h){case"low_stock":return i.jsx(Fo,{className:"w-5 h-5 text-orange-600"});case"near_expiry":return i.jsx(Ws,{className:"w-5 h-5 text-red-600"});case"pending_invoice":return i.jsx(Nr,{className:"w-5 h-5 text-blue-600"});case"follow_up":return i.jsx(R1,{className:"w-5 h-5 text-purple-600"});case"task_assigned":return i.jsx(Lf,{className:"w-5 h-5 text-blue-600"});case"task_mention":return i.jsx(rO,{className:"w-5 h-5 text-purple-600"});case"task_comment":return i.jsx(lh,{className:"w-5 h-5 text-green-600"});case"task_status_change":return i.jsx(Lf,{className:"w-5 h-5 text-orange-600"});case"task_deadline":return i.jsx(Ws,{className:"w-5 h-5 text-red-600"});default:return i.jsx(ri,{className:"w-5 h-5 text-gray-600"})}},f=h=>{const d=new Date(h),g=new Date().getTime()-d.getTime(),y=Math.floor(g/6e4),m=Math.floor(g/36e5),p=Math.floor(g/864e5);return y<1?"Just now":y<60?`${y}m ago`:m<24?`${m}h ago`:p<7?`${p}d ago`:d.toLocaleDateString()};return i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>t(!e),className:"p-2 rounded hover:bg-gray-100 relative",children:[i.jsx(R1,{className:"w-5 h-5 text-gray-600"}),s>0&&i.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center font-semibold",children:s>9?"9+":s})]}),e&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>t(!1)}),i.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-40",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),i.jsxs("div",{className:"flex items-center gap-2",children:[s>0&&i.jsxs("button",{onClick:A,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[i.jsx(aO,{className:"w-4 h-4"}),"Mark all read"]}),i.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(Xs,{className:"w-5 h-5"})})]})]}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.length===0?i.jsxs("div",{className:"p-8 text-center text-gray-500",children:[i.jsx(R1,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{children:"No notifications"})]}):r.map(h=>i.jsx("div",{className:`p-4 border-b hover:bg-gray-50 cursor-pointer transition ${h.is_read?"":"bg-blue-50"}`,onClick:()=>{h.is_read||c(h.id)},children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:u(h.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("p",{className:`text-sm font-medium ${h.is_read?"text-gray-700":"text-gray-900"}`,children:h.title}),!h.is_read&&i.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0 mt-1.5"})]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:h.message}),i.jsx("p",{className:"text-xs text-gray-400 mt-2",children:f(h.created_at)})]})]})},h.id))}),r.length>0&&i.jsx("div",{className:"p-3 border-t bg-gray-50 text-center",children:i.jsxs("p",{className:"text-xs text-gray-500",children:["Showing last ",r.length," notifications"]})})]})]})]})}function as({children:e}){const[t,r]=G.useState(!1),{profile:n,signOut:s}=Qr(),{language:a,setLanguage:o,t:l}=Es(),{currentPage:c,setCurrentPage:A,sidebarCollapsed:u,setSidebarCollapsed:f}=Bl(),d=["crm","command-center"].includes(c);G.useEffect(()=>{d&&!u&&f(!0)},[c,d,u,f]);const g=[{id:"dashboard",label:l("nav.dashboard"),icon:fO,roles:["admin","accounts","sales","warehouse"]},{id:"products",label:l("nav.products"),icon:ri,roles:["admin","sales","warehouse"]},{id:"batches",label:l("nav.batches"),icon:nO,roles:["admin","warehouse","accounts"]},{id:"stock",label:l("nav.stock"),icon:DB,roles:["admin","sales","warehouse","accounts"]},{id:"customers",label:l("nav.customers"),icon:lb,roles:["admin","accounts","sales"]},{id:"sales-orders",label:"Sales Orders",icon:Nr,roles:["admin","accounts","sales"]},{id:"delivery-challan",label:l("nav.deliveryChallan"),icon:JE,roles:["admin","accounts","sales","warehouse"]},{id:"sales",label:l("nav.sales"),icon:yO,roles:["admin","accounts","sales"]},{id:"import-requirements",label:"Import Requirements",icon:ao,roles:["admin","warehouse","sales"]},{id:"finance",label:l("nav.finance"),icon:To,roles:["admin","accounts"]},{id:"crm",label:l("nav.crm"),icon:oO,roles:["admin","sales"]},{id:"command-center",label:"Command Center",icon:tF,roles:["admin","sales"]},{id:"tasks",label:"Tasks",icon:Lf,roles:["admin","accounts","sales","warehouse"]},{id:"inventory",label:l("nav.inventory"),icon:DB,roles:["admin","warehouse"]},{id:"settings",label:l("nav.settings"),icon:XE,roles:["admin"]}].filter(m=>n&&m.roles.includes(n.role)),y=()=>{o(a==="en"?"id":"en")};return i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&i.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 z-20 lg:hidden transition-opacity",onClick:()=>r(!1)}),i.jsxs("aside",{className:`fixed top-0 left-0 z-30 h-full bg-white border-r border-gray-200 transform transition-all lg:translate-x-0 ${t?"translate-x-0":"-translate-x-full"} ${u&&d?"w-16":"w-64"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("img",{src:RE,alt:"Logo",className:"h-8 w-8 flex-shrink-0"}),!(u&&d)&&i.jsxs("div",{className:"flex flex-col leading-tight",children:[i.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PT. SHUBHAM ANZEN"}),i.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PHARMA JAYA"})]})]}),i.jsx("button",{onClick:()=>r(!1),className:"lg:hidden p-1 rounded hover:bg-gray-100",children:i.jsx(Xs,{className:"w-5 h-5"})})]}),i.jsx("nav",{className:"flex-1 overflow-y-auto p-3 space-y-1",children:g.map(m=>{const p=m.icon,b=c===m.id;return i.jsxs("button",{onClick:()=>{A(m.id),r(!1)},className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg transition relative group ${b?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50"} ${u&&d?"justify-center":""}`,title:u&&d?m.label:"",children:[i.jsx(p,{className:"w-5 h-5 flex-shrink-0"}),!(u&&d)&&i.jsx("span",{className:"font-medium text-sm",children:m.label}),u&&d&&i.jsx("span",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity z-50",children:m.label})]},m.id)})})]}),i.jsxs("div",{className:`transition-all ${u&&d?"lg:pl-16":"lg:pl-64"}`,children:[i.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:i.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>r(!0),className:"lg:hidden p-2 rounded hover:bg-gray-100",children:i.jsx(IB,{className:"w-6 h-6"})}),d&&i.jsx("button",{onClick:()=>f(!u),className:"hidden lg:block p-2 rounded hover:bg-gray-100",title:u?"Expand sidebar":"Collapse sidebar",children:i.jsx(IB,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(_O,{}),i.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100",children:[i.jsx(dO,{className:"w-5 h-5 text-gray-600"}),i.jsx("span",{className:"text-sm font-medium text-gray-700 uppercase",children:a})]}),i.jsxs("button",{onClick:()=>s(),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100 text-gray-700",children:[i.jsx($E,{className:"w-5 h-5"}),i.jsx("span",{className:"text-sm font-medium",children:l("auth.logout")})]})]})]})}),i.jsx("main",{className:"p-4 lg:p-6",children:e})]})]})}function BO({onActionClick:e}){const{profile:t}=Qr(),{setCurrentPage:r}=Bl(),[n,s]=G.useState([]),[a,o]=G.useState([]),[l,c]=G.useState(0),[A,u]=G.useState(0),[f,h]=G.useState(!0);G.useEffect(()=>{d(),x();const b=oe.channel("reminders_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_reminders"},()=>{d()}).subscribe();return()=>{b.unsubscribe()}},[]);const d=async()=>{try{const b=new Date;b.setHours(0,0,0,0);const v=new Date(b);v.setDate(v.getDate()+1);const{data:C,error:k}=await oe.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).gte("due_date",b.toISOString()).lt("due_date",v.toISOString()).order("due_date",{ascending:!0}).limit(5);if(k)throw k;const{data:S,error:I}=await oe.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).lt("due_date",b.toISOString()).order("due_date",{ascending:!0}).limit(5);if(I)throw I;s(C||[]),o(S||[])}catch(b){console.error("Error loading reminders:",b)}finally{h(!1)}},x=async()=>{try{if((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales"){const{count:b}=await oe.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval");c(b||0)}if((t==null?void 0:t.role)==="admin"){const{count:b}=await oe.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval");u(b||0)}}catch(b){console.error("Error loading approvals:",b)}},g=async b=>{try{const{error:v}=await oe.from("crm_reminders").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",b);if(v)throw v;d()}catch(v){console.error("Error completing reminder:",v)}},y=b=>{switch(b){case"send_price":case"send_coa":case"send_sample":return Io;case"follow_up":return IA;default:return ha}},m=b=>{switch(b){case"send_price":return"text-green-600";case"send_coa":return"text-blue-600";case"send_sample":return"text-purple-600";case"follow_up":return"text-orange-600";default:return"text-gray-600"}};if(f)return i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"animate-pulse space-y-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),i.jsx("div",{className:"h-10 bg-gray-200 rounded"}),i.jsx("div",{className:"h-10 bg-gray-200 rounded"})]})});const p=n.length+a.length+l+A;return p===0?i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(Ws,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),i.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"All Clear!"})]}),i.jsxs("div",{className:"text-center py-8",children:[i.jsx(eo,{className:"w-16 h-16 text-green-500 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-600",children:"No pending actions for today"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Great job staying on top of everything!"})]})]}):i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(Ws,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),i.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:[p," ",p===1?"Action":"Actions"]})]})}),i.jsxs("div",{className:"p-4 space-y-3",children:[(l>0||A>0)&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Fa,{className:"w-4 h-4 text-yellow-600"}),i.jsx("h3",{className:"text-sm font-semibold text-yellow-600",children:"Pending Approvals"})]}),i.jsxs("div",{className:"space-y-2",children:[l>0&&i.jsxs("div",{onClick:()=>r("sales-orders"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[i.jsx(Nr,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Sales Orders Pending Approval"}),i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[l," order",l!==1?"s":""," waiting for your review"]})]}),i.jsx(Nm,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),A>0&&i.jsxs("div",{onClick:()=>r("delivery-challan"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[i.jsx(KE,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Delivery Challans Pending Approval"}),i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[A," challan",A!==1?"s":""," waiting for your review"]})]}),i.jsx(Nm,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})]})]}),a.length>0&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Fa,{className:"w-4 h-4 text-red-600"}),i.jsxs("h3",{className:"text-sm font-semibold text-red-600",children:["Overdue (",a.length,")"]})]}),i.jsx("div",{className:"space-y-2",children:a.map(b=>{const v=y(b.reminder_type),C=m(b.reminder_type);return i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg hover:shadow-sm transition",children:[i.jsx(v,{className:`w-4 h-4 ${C} mt-0.5 flex-shrink-0`}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:b.title}),b.crm_inquiries&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",b.crm_inquiries.inquiry_number," - ",b.crm_inquiries.company_name]}),i.jsxs("p",{className:"text-xs text-red-600 font-medium mt-1",children:[Math.abs(Math.floor((new Date().getTime()-new Date(b.due_date).getTime())/(1e3*60*60*24)))," days overdue"]})]}),i.jsx("button",{onClick:()=>g(b.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:i.jsx(eo,{className:"w-5 h-5"})})]},b.id)})})]}),n.length>0&&i.jsxs("div",{children:[a.length>0&&i.jsxs("div",{className:"flex items-center gap-2 mb-2 mt-4",children:[i.jsx(Ws,{className:"w-4 h-4 text-blue-600"}),i.jsxs("h3",{className:"text-sm font-semibold text-blue-600",children:["Today (",n.length,")"]})]}),i.jsx("div",{className:"space-y-2",children:n.map(b=>{const v=y(b.reminder_type),C=m(b.reminder_type);return i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 border border-blue-200 rounded-lg hover:shadow-sm transition",children:[i.jsx(v,{className:`w-4 h-4 ${C} mt-0.5 flex-shrink-0`}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:b.title}),b.crm_inquiries&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",b.crm_inquiries.inquiry_number," - ",b.crm_inquiries.company_name]}),i.jsx("p",{className:"text-xs text-blue-600 mt-1",children:new Date(b.due_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),i.jsx("button",{onClick:()=>g(b.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:i.jsx(eo,{className:"w-5 h-5"})})]},b.id)})})]})]}),p>5&&i.jsx("div",{className:"p-3 border-t border-gray-200",children:i.jsxs("button",{className:"w-full flex items-center justify-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[i.jsx("span",{children:"View All Actions"}),i.jsx(Nm,{className:"w-4 h-4"})]})})]})}function PB(){const{t:e}=Es(),{profile:t}=Qr(),{setCurrentPage:r}=Bl(),[n,s]=G.useState({totalProducts:0,lowStockItems:0,nearExpiryBatches:0,totalCustomers:0,salesThisMonth:0,revenueThisMonth:0,profitThisMonth:0,pendingFollowUps:0,pendingSalesOrders:0,pendingDeliveryChallans:0,overdueInvoicesCount:0,overdueInvoicesAmount:0}),[a,o]=G.useState(!0);G.useEffect(()=>{l()},[]);const l=async()=>{var h,d,x,g,y,m,p;try{const b=new Date,v=new Date(b.getFullYear(),b.getMonth(),1),C=new Date(b.getFullYear(),b.getMonth()+1,0,23,59,59),[k,S,I,N,Q,L,T,P,R]=await Promise.all([oe.from("products").select("id",{count:"exact",head:!0}).eq("is_active",!0),oe.from("batches").select("*").eq("is_active",!0),oe.from("customers").select("id",{count:"exact",head:!0}).eq("is_active",!0),oe.from("sales_invoices").select("total_amount, subtotal, created_at, invoice_date").gte("invoice_date",v.toISOString()).lte("invoice_date",C.toISOString()),oe.from("crm_activities").select("id",{count:"exact"}).eq("is_completed",!1).not("follow_up_date","is",null),oe.from("app_settings").select("low_stock_threshold").maybeSingle(),oe.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval"),oe.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval"),oe.from("sales_invoices").select("id, total_amount, due_date").in("payment_status",["pending","partial"]).lt("due_date",new Date().toISOString().split("T")[0])]),z=((h=L==null?void 0:L.data)==null?void 0:h.low_stock_threshold)||100,q=((d=S.data)==null?void 0:d.filter(F=>F.current_stock<z).length)||0,M=new Date;M.setDate(M.getDate()+30);const V=((x=S.data)==null?void 0:x.filter(F=>F.expiry_date&&new Date(F.expiry_date)<=M&&new Date(F.expiry_date)>=new Date).length)||0,H=((g=N.data)==null?void 0:g.reduce((F,D)=>F+(Number(D.total_amount)||0),0))||0,se=((y=N.data)==null?void 0:y.reduce((F,D)=>F+(Number(D.subtotal)||0),0))||0,ce=H-se*.7,U=(await Promise.all((R.data||[]).map(async F=>{const{data:D}=await oe.rpc("get_invoice_paid_amount",{p_invoice_id:F.id}),X=D||0;return F.total_amount-X}))).reduce((F,D)=>F+D,0);s({totalProducts:k.count||0,lowStockItems:q,nearExpiryBatches:V,totalCustomers:I.count||0,salesThisMonth:((m=N.data)==null?void 0:m.length)||0,revenueThisMonth:H,profitThisMonth:Math.max(0,ce),pendingFollowUps:Q.count||0,pendingSalesOrders:T.count||0,pendingDeliveryChallans:P.count||0,overdueInvoicesCount:((p=R.data)==null?void 0:p.length)||0,overdueInvoicesAmount:U})}catch(b){console.error("Error loading dashboard:",b)}finally{o(!1)}},c=[{title:e("dashboard.lowStock"),value:n.lowStockItems,icon:Fo,color:"orange"},{title:e("dashboard.nearExpiry"),value:n.nearExpiryBatches,icon:Ws,color:"red"},{title:e("dashboard.salesThisMonth"),value:n.salesThisMonth,icon:ao,color:"blue"}],A=[];((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts")&&A.push({title:"Overdue Invoices",value:n.overdueInvoicesCount,subtitle:`Rp ${n.overdueInvoicesAmount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,icon:Fo,color:"red-gradient",link:"sales"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales")&&A.push({title:"Pending PO Approvals",value:n.pendingSalesOrders,icon:Nr,color:"yellow",link:"sales-orders"}),(t==null?void 0:t.role)==="admin"&&A.push({title:"Pending DC Approvals",value:n.pendingDeliveryChallans,icon:KE,color:"yellow",link:"delivery-challan"});const u=[...A,...c],f={blue:{bg:"bg-blue-50",text:"text-blue-600",icon:"bg-blue-100"},orange:{bg:"bg-orange-50",text:"text-orange-600",icon:"bg-orange-100"},red:{bg:"bg-red-50",text:"text-red-600",icon:"bg-red-100"},"red-gradient":{bg:"bg-gradient-to-br from-red-500 to-orange-500",text:"text-white",icon:"bg-white/20"},green:{bg:"bg-green-50",text:"text-green-600",icon:"bg-green-100"},emerald:{bg:"bg-emerald-50",text:"text-emerald-600",icon:"bg-emerald-100"},purple:{bg:"bg-purple-50",text:"text-purple-600",icon:"bg-purple-100"},yellow:{bg:"bg-yellow-50",text:"text-yellow-600",icon:"bg-yellow-100"}};return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("dashboard.title")}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to your pharma trading management system"})]}),a?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:[...Array(8)].map((h,d)=>i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse",children:[i.jsx("div",{className:"h-10 bg-gray-200 rounded mb-3"}),i.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2"})]},d))}):i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:u.map((h,d)=>{const x=h.icon,g=f[h.color],y=!!h.link;return i.jsx("div",{className:`${g.bg} rounded-lg shadow p-3 md:p-4 transition hover:shadow-lg ${y?"cursor-pointer":""}`,onClick:()=>y&&r(h.link),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:`text-xs md:text-sm font-medium ${h.color==="red-gradient"?"text-white/80":"text-gray-600"} truncate`,children:h.title}),i.jsx("p",{className:`text-xl md:text-2xl font-bold ${g.text} mt-1`,children:h.value}),h.subtitle&&i.jsx("p",{className:`text-xs mt-0.5 ${h.color==="red-gradient"?"text-white/90":"text-gray-500"} truncate`,children:h.subtitle})]}),i.jsx("div",{className:`${g.icon} p-2 md:p-3 rounded-full flex-shrink-0 ml-2`,children:i.jsx(x,{className:`w-4 h-4 md:w-5 md:h-5 ${g.text}`})})]})},d)})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsx(BO,{})}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Links"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("a",{href:"#",className:"block p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition text-blue-700 font-medium",children:"Go to Command Center"}),i.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"View All Inquiries"}),i.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"Create Manual Inquiry"})]})]})]})]})})}function ja({data:e,columns:t,onRowClick:r,actions:n,loading:s}){const[a,o]=G.useState(""),[l,c]=G.useState(null),{t:A}=Es(),u=d=>{let x="asc";(l==null?void 0:l.key)===d&&l.direction==="asc"&&(x="desc"),c({key:d,direction:x})},f=d=>{const x=[],g=y=>{y!=null&&(typeof y=="object"&&!Array.isArray(y)?Object.values(y).forEach(g):Array.isArray(y)?y.forEach(g):x.push(String(y)))};return Object.values(d).forEach(g),x},h=(()=>{let d=[...e];return a&&(d=d.filter(x=>f(x).some(g=>g.toLowerCase().includes(a.toLowerCase())))),l&&d.sort((x,g)=>{const y=x[l.key],m=g[l.key];return y<m?l.direction==="asc"?-1:1:y>m?l.direction==="asc"?1:-1:0}),d})();return s?i.jsx("div",{className:"bg-white rounded-lg shadow",children:i.jsxs("div",{className:"p-8 text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:A("common.loading")})]})}):i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"relative",children:[i.jsx(Lc,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),i.jsx("input",{type:"text",value:a,onChange:d=>o(d.target.value),placeholder:A("common.search"),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[t.map(d=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d.sortable?i.jsxs("button",{onClick:()=>u(d.key),className:"flex items-center gap-1 hover:text-gray-700",children:[d.label,(l==null?void 0:l.key)===d.key?l.direction==="asc"?i.jsx(ME,{className:"w-4 h-4"}):i.jsx(ac,{className:"w-4 h-4"}):i.jsx(ac,{className:"w-4 h-4 opacity-30"})]}):d.label},d.key)),n&&i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:A("common.actions")})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:t.length+(n?1:0),className:"px-6 py-8 text-center text-gray-500",children:A("common.noData")})}):h.map((d,x)=>i.jsxs("tr",{onClick:()=>r==null?void 0:r(d),className:r?"cursor-pointer hover:bg-gray-50":"",children:[t.map(g=>i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.render?g.render(d):d[g.key]},g.key)),n&&i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:n(d)})]},x))})]})})]})}function fr({isOpen:e,onClose:t,title:r,children:n,size:s="md"}){const{t:a}=Es();if(!e)return null;const o={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[i.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity",onClick:t}),i.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl ${o[s]} w-full max-h-[90vh] flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:r}),i.jsx("button",{onClick:t,className:"p-1 rounded hover:bg-gray-100 transition",children:i.jsx(Xs,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:n})]})]})})}function CO(){const{t:e}=Es(),{profile:t}=Qr(),[r,n]=G.useState([]),[s,a]=G.useState(!0),[o,l]=G.useState(!1),[c,A]=G.useState(null),[u,f]=G.useState({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:""});G.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:p,error:b}=await oe.from("products").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(b)throw b;n(p||[])}catch(p){console.error("Error loading products:",p)}finally{a(!1)}},d=async p=>{p.preventDefault();try{const b=parseFloat(u.min_stock_level)||null,v={product_name:u.product_name,product_code:null,hsn_code:u.hsn_code,category:u.category,unit:u.unit,packaging_type:u.packaging_type,default_supplier:u.default_supplier,description:u.description,min_stock_level:b};if(c){const{error:C}=await oe.from("products").update(v).eq("id",c.id);if(C)throw C}else{const{error:C}=await oe.from("products").insert([{...v,created_by:t==null?void 0:t.id}]);if(C)throw C}l(!1),y(),h()}catch(b){console.error("Error saving product:",b),alert("Failed to save product")}},x=p=>{var b;A(p),f({product_name:p.product_name,hsn_code:p.hsn_code,category:p.category,unit:p.unit,packaging_type:p.packaging_type,default_supplier:p.default_supplier,description:p.description,min_stock_level:((b=p.min_stock_level)==null?void 0:b.toString())||""}),l(!0)},g=async p=>{try{const{data:b}=await oe.from("sales_invoice_items").select("id").eq("product_id",p.id).limit(1);if(b&&b.length>0){alert('Cannot delete this product. It has been used in sales invoices. Please use the "Deactivate" option instead or contact your administrator.');return}const{data:v}=await oe.from("delivery_challan_items").select("id").eq("product_id",p.id).limit(1);if(v&&v.length>0){alert('Cannot delete this product. It has been used in delivery challans. Please use the "Deactivate" option instead.');return}const{data:C}=await oe.from("batches").select("id, batch_number").eq("product_id",p.id);if(C&&C.length>0){if(!confirm(`This product has ${C.length} batch(es). Deleting this product will permanently remove:
- ${C.length} batches
- All related inventory transactions
- All related documents

Are you absolutely sure you want to continue?`))return}else if(!confirm("Are you sure you want to delete this product?"))return;if(C&&C.length>0){for(const S of C)await oe.from("batch_documents").delete().eq("batch_id",S.id),await oe.from("inventory_transactions").delete().eq("batch_id",S.id),await oe.from("finance_expenses").delete().eq("batch_id",S.id);await oe.from("batches").delete().eq("product_id",p.id)}await oe.from("inventory_transactions").delete().eq("product_id",p.id),await oe.from("product_files").delete().eq("product_id",p.id);const{error:k}=await oe.from("products").delete().eq("id",p.id);if(k)throw k;alert("Product deleted successfully"),await h()}catch(b){console.error("Error deleting product:",b);const v=(b==null?void 0:b.message)||"Unknown error occurred";alert(`Failed to delete product: ${v}

If this product is in use, consider deactivating it instead.`)}},y=()=>{A(null),f({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:""})},m=[{key:"product_name",label:"Product Name"},{key:"hsn_code",label:"HSN Code"},{key:"category",label:"Category",render:p=>i.jsx("span",{className:"capitalize",children:p.category})},{key:"unit",label:"Unit",render:p=>i.jsx("span",{className:"capitalize",children:p.unit})},{key:"min_stock",label:"Min Stock Level",render:p=>i.jsx("span",{children:p.min_stock_level?`${p.min_stock_level} ${p.unit}`:"-"})}];return i.jsxs(as,{children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your product catalog with packaging details"})]}),i.jsxs("button",{onClick:()=>{y(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Add Product"]})]}),i.jsx(ja,{data:r,columns:m,loading:s,actions:p=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>x(p),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>g(p),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:i.jsx(ks,{className:"w-4 h-4"})})]})})]}),i.jsx(fr,{isOpen:o,onClose:()=>{l(!1),y()},title:c?"Edit Product":"Add Product",children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),i.jsx("input",{type:"text",required:!0,value:u.product_name,onChange:p=>f({...u,product_name:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HSN Code"}),i.jsx("input",{type:"text",value:u.hsn_code,onChange:p=>f({...u,hsn_code:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),i.jsxs("select",{required:!0,value:u.category,onChange:p=>f({...u,category:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[i.jsx("option",{value:"api",children:"API"}),i.jsx("option",{value:"excipient",children:"Excipient"}),i.jsx("option",{value:"solvent",children:"Solvent"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit *"}),i.jsxs("select",{required:!0,value:u.unit,onChange:p=>f({...u,unit:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[i.jsx("option",{value:"kg",children:"Kilogram"}),i.jsx("option",{value:"litre",children:"Litre"}),i.jsx("option",{value:"ton",children:"Ton"}),i.jsx("option",{value:"piece",children:"Piece"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Stock Level"}),i.jsx("input",{type:"number",step:"0.001",value:u.min_stock_level,onChange:p=>f({...u,min_stock_level:p.target.value}),placeholder:"e.g., 100",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Alert when stock falls below this level (in ",u.unit,")"]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Supplier"}),i.jsx("input",{type:"text",value:u.default_supplier,onChange:p=>f({...u,default_supplier:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:u.description,onChange:p=>f({...u,description:p.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{l(!1),y()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Save"})]})]})})]})}const NO=["Jakarta Barat","Jakarta Pusat","Jakarta Selatan","Jakarta Timur","Jakarta Utara","Surabaya","Bandung","Bekasi","Tangerang","Depok","Semarang","Palembang","South Tangerang","Makassar","Bogor","Batam","Pekanbaru","Bandar Lampung","Padang","Malang","Denpasar","Samarinda","Tasikmalaya","Pontianak","Cimahi","Balikpapan","Jambi","Surakarta (Solo)","Serang","Manado","Cilegon","Mataram","Yogyakarta","Kupang","Banjarmasin","Ambon","Sukabumi","Cirebon","Palu","Tegal","Binjai","Pekalongan","Kediri","Jayapura","Palangkaraya","Probolinggo","Tanjung Pinang","Banjar","Madiun","Banjarbaru","Tarakan","Bitung","Pangkal Pinang","Pasuruan","Ternate","Sorong","Bengkulu","Tanjungbalai","Dumai","Batu","Gorontalo","Bontang","Blitar","Metro","Pematang Siantar","Mojokerto","Magelang","Salatiga","Parepare","Bukittinggi","Singkawang","Lubuklinggau","Prabumulih","Langsa","Padang Sidempuan","Tebing Tinggi","Tanjung Balai","Sabang","Lhokseumawe","Subulussalam","Banda Aceh","Medan","Sibolga","Gunungsitoli"].sort(),SO=["Cash on Delivery","Net 7 days","Net 10 days","Net 15 days","Net 30 days","Net 45 days","Net 60 days","Net 90 days","End of Month","2/10 Net 30","1/10 Net 30","Due on Receipt","Advance Payment","50% Advance, 50% on Delivery","Monthly Billing"];function kO(){const{t:e}=Es(),{profile:t}=Qr(),[r,n]=G.useState([]),[s,a]=G.useState(!0),[o,l]=G.useState(!1),[c,A]=G.useState(null),[u,f]=G.useState({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""});G.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:p,error:b}=await oe.from("customers").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(b)throw b;n(p||[])}catch(p){console.error("Error loading customers:",p)}finally{a(!1)}},d=async p=>{p.preventDefault();try{if(c){const{error:b}=await oe.from("customers").update(u).eq("id",c.id);if(b)throw b}else{const{error:b}=await oe.from("customers").insert([{...u,created_by:t==null?void 0:t.id}]);if(b)throw b}l(!1),A(null),x(),h()}catch(b){console.error("Error saving customer:",b),alert("Failed to save customer")}},x=()=>{f({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""})},g=p=>{A(p),f({company_name:p.company_name,npwp:p.npwp,address:p.address,city:p.city,country:p.country,contact_person:p.contact_person,email:p.email,phone:p.phone,pbf_license:p.pbf_license||"",gst_vat_type:p.gst_vat_type,payment_terms:p.payment_terms}),l(!0)},y=async p=>{if(confirm("Are you sure you want to delete this customer?"))try{const{error:b}=await oe.from("customers").update({is_active:!1}).eq("id",p.id);if(b)throw b;h()}catch(b){console.error("Error deleting customer:",b),alert("Failed to delete customer")}},m=[{key:"company_name",label:e("customers.companyName"),sortable:!0},{key:"contact_person",label:e("customers.contactPerson"),sortable:!0,render:p=>i.jsxs("div",{children:[i.jsx("div",{children:p.contact_person}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[p.email&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx($s,{className:"w-3 h-3"}),p.email]}),p.phone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(IA,{className:"w-3 h-3"}),p.phone]})]})]})},{key:"city",label:e("customers.city"),sortable:!0},{key:"payment_terms",label:e("customers.paymentTerms"),sortable:!0}];return i.jsxs(as,{children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("customers.title")}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your customer relationships"})]}),i.jsxs("button",{onClick:()=>{A(null),x(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),e("customers.addCustomer")]})]}),i.jsx(ja,{data:r,columns:m,loading:s,actions:p=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>g(p),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>y(p),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:i.jsx(ks,{className:"w-4 h-4"})})]})})]}),i.jsx(fr,{isOpen:o,onClose:()=>l(!1),title:e(c?"customers.editCustomer":"customers.addCustomer"),size:"xl",children:i.jsxs("form",{onSubmit:d,className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.companyName")," *"]}),i.jsx("input",{type:"text",required:!0,value:u.company_name,onChange:p=>f({...u,company_name:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.npwp")}),i.jsx("input",{type:"text",value:u.npwp,onChange:p=>f({...u,npwp:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.contactPerson")," *"]}),i.jsx("input",{type:"text",required:!0,value:u.contact_person,onChange:p=>f({...u,contact_person:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.email")}),i.jsx("input",{type:"email",value:u.email,onChange:p=>f({...u,email:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.phone")}),i.jsx("input",{type:"tel",value:u.phone,onChange:p=>f({...u,phone:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PBF License (No.Izin PBF)"}),i.jsx("input",{type:"text",value:u.pbf_license,onChange:p=>f({...u,pbf_license:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"e.g., 01.001.722.9-411.000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.city")}),i.jsxs("select",{value:u.city,onChange:p=>f({...u,city:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select City"}),NO.map(p=>i.jsx("option",{value:p,children:p},p))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.country")}),i.jsx("input",{type:"text",value:u.country,readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50 text-gray-600"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.gstVatType")}),i.jsx("input",{type:"text",value:u.gst_vat_type,onChange:p=>f({...u,gst_vat_type:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.paymentTerms")}),i.jsxs("select",{value:u.payment_terms,onChange:p=>f({...u,payment_terms:p.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select Payment Terms"}),SO.map(p=>i.jsx("option",{value:p,children:p},p))]})]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.address")}),i.jsx("textarea",{value:u.address,onChange:p=>f({...u,address:p.target.value}),rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[i.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-3 py-1.5 text-sm text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition",children:e("common.cancel")}),i.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:e("common.save")})]})]})})]})}function EO(){const{t:e}=Es(),{setCurrentPage:t}=Bl(),[r,n]=G.useState([]),[s,a]=G.useState(!0),[o,l]=G.useState(null),[c,A]=G.useState([]);G.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:S,error:I}=await oe.from("product_stock_summary").select("*").order("product_name");if(I)throw I;const{data:N}=await oe.from("import_requirements").select("product_id, shortage_quantity").in("status",["pending","ordered"]),Q=new Map;N==null||N.forEach(P=>{const R=Q.get(P.product_id)||0;Q.set(P.product_id,R+Number(P.shortage_quantity))});const T=(await Promise.all((S||[]).map(async P=>{const{data:R}=await oe.from("stock_reservations").select("reserved_quantity").eq("product_id",P.product_id).eq("is_released",!1),z=(R==null?void 0:R.reduce((H,se)=>H+Number(se.reserved_quantity),0))||0,q=Q.get(P.product_id)||0,M=q>0?-q:z,V=P.total_current_stock-z;return{...P,reserved_quantity:M,available_quantity:V}}))).filter(P=>P.total_current_stock>0||P.reserved_quantity!==0||Q.has(P.product_id));n(T)}catch(S){console.error("Error loading stock summary:",S)}finally{a(!1)}},f=async S=>{try{const{data:I,error:N}=await oe.from("batches").select("id, batch_number, current_stock, reserved_stock, expiry_date, import_date").eq("product_id",S).eq("is_active",!0).gt("current_stock",0).order("expiry_date",{ascending:!0,nullsFirst:!1});if(N)throw N;const Q=(I||[]).map(L=>({...L,reserved_quantity:L.reserved_stock||0,available_quantity:L.current_stock-(L.reserved_stock||0)}));A(Q)}catch(I){console.error("Error loading product batches:",I)}},h=async S=>{l(S),await f(S.product_id)},d=()=>{t("batches")},x=S=>S?new Date(S)<new Date:!1,g=S=>{if(!S)return!1;const I=new Date;return I.setDate(I.getDate()+30),new Date(S)<=I&&!x(S)},y=(S,I)=>S===0?"text-gray-400":S<500?"text-orange-600":"text-green-600",m=[{key:"product_name",label:"Product",render:S=>i.jsxs("div",{className:"py-1",children:[i.jsx("span",{className:"font-medium text-gray-900",children:S.product_name}),i.jsxs("span",{className:"text-xs text-gray-500 ml-2 capitalize",children:["(",S.category,")"]})]})},{key:"stock",label:"Total Stock",render:S=>i.jsxs("span",{className:`font-semibold ${y(S.total_current_stock,S.active_batch_count)}`,children:[S.total_current_stock.toLocaleString()," ",S.unit]})},{key:"reserved",label:"Reserved",render:S=>S.reserved_quantity===0?i.jsx("span",{className:"text-gray-400",children:"-"}):S.reserved_quantity<0?i.jsxs("span",{className:"text-red-600 font-semibold",children:[S.reserved_quantity.toLocaleString()," ",S.unit]}):i.jsxs("span",{className:"text-orange-600 font-medium",children:[S.reserved_quantity.toLocaleString()," ",S.unit]})},{key:"available",label:"Available",render:S=>i.jsxs("span",{className:"text-green-600 font-semibold",children:[S.available_quantity.toLocaleString()," ",S.unit]})},{key:"batches",label:"Batches",render:S=>i.jsxs("span",{className:"text-sm",children:[i.jsx("span",{className:"text-blue-600 font-medium",children:S.active_batch_count}),S.expired_batch_count>0&&i.jsxs("span",{className:"text-red-600 ml-1",children:["(",S.expired_batch_count," expired)"]})]})},{key:"expiry",label:"Nearest Expiry",render:S=>S.nearest_expiry_date?i.jsxs("span",{className:`text-sm ${x(S.nearest_expiry_date)?"text-red-700 font-semibold":g(S.nearest_expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:[new Date(S.nearest_expiry_date).toLocaleDateString(),g(S.nearest_expiry_date)&&i.jsx(Fo,{className:"w-3 h-3 inline ml-1"})]}):i.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}],p=[{key:"batch_number",label:"Batch",render:S=>i.jsx("span",{className:"font-mono text-sm",children:S.batch_number})},{key:"total_stock",label:"Total",render:S=>i.jsxs("span",{className:"font-semibold text-sm",children:[S.current_stock.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"reserved",label:"Reserved",render:S=>i.jsx("span",{className:"text-orange-600 font-medium text-sm",children:S.reserved_quantity>0?`${S.reserved_quantity.toLocaleString()} ${o==null?void 0:o.unit}`:"-"})},{key:"available",label:"Available",render:S=>i.jsxs("span",{className:"text-green-600 font-semibold text-sm",children:[S.available_quantity.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"import_date",label:"Imported",render:S=>i.jsx("span",{className:"text-sm text-gray-600",children:new Date(S.import_date).toLocaleDateString()})},{key:"expiry_date",label:"Expiry",render:S=>i.jsx("span",{className:`text-sm ${x(S.expiry_date)?"text-red-700 font-semibold":g(S.expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:S.expiry_date?new Date(S.expiry_date).toLocaleDateString():"-"})}],b=r.reduce((S,I)=>S+I.total_current_stock,0),v=r.length,C=r.filter(S=>S.total_current_stock<500).length,k=r.filter(S=>S.nearest_expiry_date&&g(S.nearest_expiry_date)).length;return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Stock Inventory"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Current stock levels across all products"})]}),i.jsxs("button",{onClick:d,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(ri,{className:"w-5 h-5"}),"View Batches"]})]}),o&&i.jsxs("div",{className:"bg-blue-50 rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[o.product_name," - Batch Details"]}),i.jsx("button",{onClick:()=>l(null),className:"text-gray-500 hover:text-gray-700 text-xl font-bold",children:""})]}),i.jsx(ja,{columns:p,data:c,loading:!1})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[i.jsx(ja,{columns:m,data:r,loading:s,onRowClick:h}),!s&&r.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(ri,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-500 text-lg",children:"No stock available"}),i.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"All products are currently out of stock"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Products In Stock"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:v})]}),i.jsx(ri,{className:"w-10 h-10 text-blue-200"})]})}),i.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Total Stock Units"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:b.toLocaleString()})]}),i.jsx(ao,{className:"w-10 h-10 text-green-200"})]})}),i.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Low Stock Items"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:C})]}),i.jsx(Fo,{className:"w-10 h-10 text-orange-200"})]})}),i.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-red-100 text-sm font-medium",children:"Near Expiry"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:k})]}),i.jsx(ha,{className:"w-10 h-10 text-red-200"})]})})]})]})})}const FO=["application/pdf","image/jpeg","image/jpg","image/png","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"],jO=10*1024*1024,TO=[{value:"invoice",label:"Invoice"},{value:"bill_of_lading",label:"Bill of Lading"},{value:"coa",label:"Certificate of Analysis"},{value:"packing_list",label:"Packing List"},{value:"other",label:"Other"}];function rF({batchId:e,existingFiles:t=[],onFilesChange:r,disabled:n=!1}){const[s,a]=G.useState(t),[o,l]=G.useState(!1),c=G.useRef(null),A=p=>{a(p),r==null||r(p)},u=p=>{if(!p||p.length===0)return;const b=[];Array.from(p).forEach(v=>{if(!FO.includes(v.type)){alert(`File ${v.name} is not a supported format. Please upload PDF, JPG, PNG, XLSX, or DOCX files.`);return}if(v.size>jO){alert(`File ${v.name} exceeds the 10MB size limit.`);return}b.push({file:v,file_name:v.name,file_type:"other",file_size:v.size,uploading:!1})}),A([...s,...b])},f=p=>{p.preventDefault(),l(!1),u(p.dataTransfer.files)},h=p=>{p.preventDefault(),l(!0)},d=()=>{l(!1)},x=async p=>{const b=s[p];if(b.id&&e){if(!confirm("Are you sure you want to delete this document?"))return;try{const{error:C}=await oe.from("batch_documents").delete().eq("id",b.id);if(C)throw C;if(b.file_url){const k=b.file_url.split("/"),S=k[k.length-1],I=`${e}/${S}`;await oe.storage.from("batch-documents").remove([I])}}catch(C){console.error("Error deleting file:",C),alert("Failed to delete file. Please try again.");return}}const v=s.filter((C,k)=>k!==p);A(v)},g=(p,b)=>{const v=[...s];v[p].file_type=b,A(v)},y=p=>{var v;const b=(v=p.split(".").pop())==null?void 0:v.toLowerCase();return["jpg","jpeg","png"].includes(b||"")?i.jsx(GE,{className:"w-5 h-5 text-blue-600"}):b==="pdf"?i.jsx(Nr,{className:"w-5 h-5 text-red-600"}):i.jsx(qE,{className:"w-5 h-5 text-gray-600"})},m=p=>p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB";return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{onDrop:f,onDragOver:h,onDragLeave:d,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{var p;return!n&&((p=c.current)==null?void 0:p.click())},children:[i.jsx(ZE,{className:`w-12 h-12 mx-auto mb-3 ${o?"text-blue-500":"text-gray-400"}`}),i.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[i.jsx("span",{className:"font-medium text-blue-600",children:"Click to upload"})," or drag and drop"]}),i.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG, XLSX, DOCX (max 10MB)"}),i.jsx("input",{ref:c,type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.xlsx,.xls,.docx,.doc",onChange:p=>u(p.target.files),className:"hidden",disabled:n})]}),s.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Documents (",s.length,")"]}),s.map((p,b)=>i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx("div",{className:"flex-shrink-0",children:y(p.file_name)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"flex items-center gap-2",children:p.file_url?i.jsx("a",{href:p.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-700 truncate",onClick:v=>v.stopPropagation(),children:p.file_name}):i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:p.file_name})}),i.jsx("p",{className:"text-xs text-gray-500",children:m(p.file_size)})]}),i.jsx("select",{value:p.file_type,onChange:v=>g(b,v.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:n,onClick:v=>v.stopPropagation(),children:TO.map(v=>i.jsx("option",{value:v.value,children:v.label},v.value))}),p.uploading&&i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}),p.error&&i.jsx("div",{className:"flex-shrink-0",title:p.error,children:i.jsx(Fa,{className:"w-5 h-5 text-red-600"})}),!n&&!p.uploading&&i.jsx("button",{type:"button",onClick:v=>{v.stopPropagation(),x(b)},className:"flex-shrink-0 p-1 text-red-600 hover:bg-red-50 rounded transition",children:i.jsx(Xs,{className:"w-4 h-4"})})]},b))]})]})}function IO(){const{t:e}=Es(),{profile:t}=Qr(),[r,n]=G.useState([]),[s,a]=G.useState([]),[o,l]=G.useState(!0),[c,A]=G.useState(!1),[u,f]=G.useState(!1),[h,d]=G.useState([]),[x,g]=G.useState(null),[y,m]=G.useState(null),[p,b]=G.useState([]),[v,C]=G.useState({batch_number:"",product_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_charges:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"});G.useEffect(()=>{k(),S()},[]);const k=async()=>{try{const{data:B,error:U}=await oe.from("batches").select(`
          *,
          products(product_name, product_code, unit)
        `).order("import_date",{ascending:!1});if(U)throw U;const F=await Promise.all((B||[]).map(async D=>{const{count:X}=await oe.from("batch_documents").select("*",{count:"exact",head:!0}).eq("batch_id",D.id);return{...D,document_count:X||0}}));n(F)}catch(B){console.error("Error loading batches:",B)}finally{l(!1)}},S=async()=>{try{const{data:B,error:U}=await oe.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(U)throw U;a(B||[])}catch(B){console.error("Error loading products:",B)}},I=async B=>{try{const{data:U,error:F}=await oe.from("batch_documents").select("*").eq("batch_id",B).order("uploaded_at",{ascending:!1});if(F)throw F;d(U||[]),g(B),f(!0)}catch(U){console.error("Error loading documents:",U),alert("Failed to load documents")}},N=async B=>{if(B.preventDefault(),v.import_price_usd>0&&v.exchange_rate_usd_to_idr<=0){alert("Please enter a valid exchange rate");return}try{let U=0;if(y){const{data:ee,error:Te}=await oe.from("sales_invoice_items").select("quantity").eq("batch_id",y.id);if(Te)throw Te;if(U=(ee==null?void 0:ee.reduce((Je,ie)=>Je+parseFloat(ie.quantity||0),0))||0,v.import_quantity<U){alert(`Cannot reduce import quantity to ${v.import_quantity}. You have already sold ${U} units from this batch.`);return}}const F=v.import_price_usd*v.exchange_rate_usd_to_idr,D=(ee,Te,Je)=>Te==="percentage"?Je*ee/100:ee,X=D(v.duty_charges,v.duty_charge_type,F),K=D(v.freight_charges,v.freight_charge_type,F),ae=D(v.other_charges,v.other_charge_type,F),he=v.import_quantity-U,Y={batch_number:v.batch_number,product_id:v.product_id,import_date:v.import_date,import_quantity:v.import_quantity,current_stock:he,packaging_details:v.packaging_details,import_price:F,import_price_usd:v.import_price_usd||null,exchange_rate_usd_to_idr:v.exchange_rate_usd_to_idr||null,duty_charges:X,duty_charge_type:v.duty_charge_type,freight_charges:K,freight_charge_type:v.freight_charge_type,other_charges:ae,other_charge_type:v.other_charge_type,expiry_date:v.expiry_date||null};let Be;if(y){const{error:ee}=await oe.from("batches").update(Y).eq("id",y.id);if(ee)throw ee;Be=y.id}else{const{data:{user:ee}}=await oe.auth.getUser();if(!ee)throw new Error("Not authenticated");const{data:Te,error:Je}=await oe.from("batches").insert([{...Y,is_active:!0,created_by:ee.id}]).select().single();if(Je)throw Je;Be=Te.id}await Q(Be),A(!1),P(),k()}catch(U){console.error("Error saving batch:",U),alert("Failed to save batch. Please try again.")}},Q=async B=>{const U=p.filter(F=>F.file&&!F.id);for(const F of U)try{const D=`${Date.now()}_${F.file.name}`,X=`${B}/${D}`,{error:K}=await oe.storage.from("batch-documents").upload(X,F.file);if(K)throw K;const{data:{publicUrl:ae}}=oe.storage.from("batch-documents").getPublicUrl(X),{error:he}=await oe.from("batch_documents").insert([{batch_id:B,file_url:ae,file_name:F.file.name,file_type:F.file_type,file_size:F.file_size}]);if(he)throw he}catch(D){console.error("Error uploading file:",D)}},L=async B=>{const{data:U}=await oe.from("sales_invoice_items").select("quantity").eq("batch_id",B.id),F=(U==null?void 0:U.reduce((he,Y)=>he+parseFloat(Y.quantity||0),0))||0,D={...B,current_stock:B.import_quantity-F};m(D);let X="",K="bag";if(B.packaging_details){const he=B.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/);he&&(X=he[3],K=he[2].toLowerCase())}C({batch_number:B.batch_number,product_id:B.product_id,import_date:B.import_date,import_quantity:B.import_quantity,packaging_details:B.packaging_details,import_price_usd:B.import_price_usd||0,exchange_rate_usd_to_idr:B.exchange_rate_usd_to_idr||0,duty_charges:B.duty_charges,duty_charge_type:"fixed",freight_charges:B.freight_charges,freight_charge_type:"fixed",other_charges:B.other_charges,other_charge_type:"fixed",expiry_date:B.expiry_date,per_pack_weight:X,pack_type:K});const{data:ae}=await oe.from("batch_documents").select("*").eq("batch_id",B.id);b(ae||[]),A(!0)},T=async B=>{try{const{data:U}=await oe.from("sales_invoice_items").select("id, sales_invoices(invoice_number)").eq("batch_id",B).limit(1);if(U&&U.length>0){alert("Cannot delete this batch. It has been used in sales invoices. Please delete the related invoices first or contact your administrator.");return}const{data:F}=await oe.from("delivery_challan_items").select("id").eq("batch_id",B).limit(1);if(F&&F.length>0){alert("Cannot delete this batch. It has been used in delivery challans. Please delete the related delivery challans first.");return}if(!confirm("Are you sure you want to delete this batch? This will permanently remove all related data."))return;const{error:D}=await oe.from("batch_documents").delete().eq("batch_id",B);if(D)throw D;const{error:X}=await oe.from("inventory_transactions").delete().eq("batch_id",B);if(X)throw X;const{error:K}=await oe.from("finance_expenses").delete().eq("batch_id",B);if(K)throw K;const{error:ae}=await oe.from("batches").delete().eq("id",B);if(ae)throw ae;alert("Batch deleted successfully"),await k()}catch(U){console.error("Error deleting batch:",U);const F=(U==null?void 0:U.message)||"Unknown error occurred";alert(`Failed to delete batch: ${F}`)}},P=()=>{m(null),b([]),C({batch_number:"",product_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_charges:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"})},R=B=>B.current_stock<B.import_quantity*.2,z=B=>B.expiry_date?new Date(B.expiry_date)<new Date:!1,q=B=>{if(!B.expiry_date)return!1;const U=new Date;return U.setDate(U.getDate()+30),new Date(B.expiry_date)<=U&&!z(B)},M=()=>{const B=v.import_price_usd*v.exchange_rate_usd_to_idr,U=(K,ae)=>ae==="percentage"?B*K/100:K,F=U(v.duty_charges,v.duty_charge_type),D=U(v.freight_charges,v.freight_charge_type),X=U(v.other_charges,v.other_charge_type);return B+F+D+X},V=(B,U)=>{const F=v.import_price_usd*v.exchange_rate_usd_to_idr;return U==="percentage"?F*B/100:B},H=(B,U="IDR")=>U==="USD"?`$${B.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${B.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,se=[{key:"batch_number",label:"Batch Number"},{key:"product",label:"Product",render:B=>{var U,F;return i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:(U=B.products)==null?void 0:U.product_name}),i.jsx("div",{className:"text-xs text-gray-500",children:(F=B.products)==null?void 0:F.product_code})]})}},{key:"import_date",label:"Import Date",render:B=>new Date(B.import_date).toLocaleDateString()},{key:"stock",label:"Stock",render:B=>{var F,D,X;const U=B.current_stock-(B.reserved_stock||0);return i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:R(B)?"text-orange-600 font-semibold":"font-medium",children:[B.current_stock," ",(F=B.products)==null?void 0:F.unit]}),R(B)&&i.jsx(Fo,{className:"w-4 h-4 text-orange-600"})]}),B.reserved_stock>0&&i.jsxs("div",{className:"text-xs space-y-0.5",children:[i.jsxs("div",{className:"text-amber-600",children:["Reserved: ",B.reserved_stock," ",(D=B.products)==null?void 0:D.unit]}),i.jsxs("div",{className:"text-green-600",children:["Free: ",U," ",(X=B.products)==null?void 0:X.unit]})]})]})}},{key:"pricing",label:"Import Price",render:B=>i.jsx("div",{className:"text-sm",children:B.import_price_usd&&B.exchange_rate_usd_to_idr?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"font-medium text-green-700",children:H(B.import_price_usd,"USD")}),i.jsx("div",{className:"text-xs text-gray-500",children:H(B.import_price)}),i.jsxs("div",{className:"text-xs text-gray-400",children:["@ ",B.exchange_rate_usd_to_idr.toLocaleString()]})]}):i.jsx("div",{className:"text-gray-500",children:H(B.import_price)})})},{key:"expiry_date",label:"Expiry Date",render:B=>i.jsx("span",{className:z(B)?"text-red-700 font-semibold":q(B)?"text-orange-600 font-semibold":"",children:B.expiry_date?new Date(B.expiry_date).toLocaleDateString():"N/A"})},{key:"documents",label:"Docs",render:B=>i.jsxs("button",{onClick:()=>I(B.id),className:"flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition",children:[i.jsx(Nr,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:B.document_count||0})]})},{key:"total_cost",label:"Total Cost",render:B=>{const U=B.import_price+B.duty_charges+B.freight_charges+B.other_charges;return i.jsx("span",{className:"font-medium",children:H(U)})}}],ce=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse"||(t==null?void 0:t.role)==="accounts";return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Batches"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage import batches with USD pricing and document tracking"})]}),ce&&i.jsxs("button",{onClick:()=>{P(),A(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Add Batch"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Batches"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:r.length})]}),i.jsx(ri,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-orange-600",children:"Low Stock"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:r.filter(R).length})]}),i.jsx(Fo,{className:"w-8 h-8 text-orange-600"})]})}),i.jsx("div",{className:"bg-red-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-red-600",children:"Near Expiry"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:r.filter(q).length})]}),i.jsx(Fo,{className:"w-8 h-8 text-red-600"})]})})]}),i.jsx(ja,{columns:se,data:r,loading:o,actions:ce?B=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>L(B),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>T(B.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(ks,{className:"w-4 h-4"})})]}):void 0}),i.jsx(fr,{isOpen:c,onClose:()=>{A(!1),P()},title:y?"Edit Batch":"Add New Batch",children:i.jsxs("form",{onSubmit:N,className:"space-y-3",children:[i.jsxs("div",{className:"border-b pb-2",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Batch Number *"}),i.jsx("input",{type:"text",value:v.batch_number,onChange:B=>C({...v,batch_number:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Product *"}),i.jsxs("select",{value:v.product_id,onChange:B=>C({...v,product_id:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),s.map(B=>i.jsxs("option",{value:B.id,children:[B.product_name," (",B.product_code,")"]},B.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Date *"}),i.jsx("input",{type:"date",value:v.import_date,onChange:B=>C({...v,import_date:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expiry Date"}),i.jsx("input",{type:"date",value:v.expiry_date,onChange:B=>C({...v,expiry_date:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]})]})]}),i.jsxs("div",{className:"border-b pb-2",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Quantity"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Quantity *"}),i.jsx("input",{type:"number",value:v.import_quantity===0?"":v.import_quantity,onChange:B=>C({...v,import_quantity:B.target.value===""?0:Number(B.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,min:"0",step:"0.001",placeholder:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total quantity being imported"})]}),y&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Current Stock"}),i.jsx("div",{className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50",children:i.jsx("span",{className:"text-gray-700 font-medium",children:y.current_stock.toLocaleString()})}),i.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Available: ",y.current_stock.toLocaleString()," | Sold: ",(y.import_quantity-y.current_stock).toLocaleString()]})]})]})]}),i.jsxs("div",{className:"border-b pb-2",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(ri,{className:"w-4 h-4"}),"Packaging Details (Optional)"]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Per Pack Weight"}),i.jsx("input",{type:"number",step:"0.001",value:v.per_pack_weight,onChange:B=>{const U={...v,per_pack_weight:B.target.value};if(v.import_quantity&&B.target.value){const F=parseFloat(B.target.value);if(F){const D=(v.import_quantity/F).toFixed(0);U.packaging_details=`${D} ${v.pack_type}${parseInt(D)!==1?"s":""} x ${F}kg`}}C(U)},placeholder:"e.g., 25",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"kg per pack"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pack Type"}),i.jsxs("select",{value:v.pack_type,onChange:B=>{const U={...v,pack_type:B.target.value};if(v.import_quantity&&v.per_pack_weight){const F=parseFloat(v.per_pack_weight);if(F){const D=(v.import_quantity/F).toFixed(0);U.packaging_details=`${D} ${B.target.value}${parseInt(D)!==1?"s":""} x ${F}kg`}}C(U)},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"bag",children:"Bag"}),i.jsx("option",{value:"drum",children:"Drum"}),i.jsx("option",{value:"tin",children:"Tin"}),i.jsx("option",{value:"box",children:"Box"}),i.jsx("option",{value:"carton",children:"Carton"}),i.jsx("option",{value:"pallet",children:"Pallet"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Calculated Packs"}),i.jsx("div",{className:"px-2 py-1.5 text-sm bg-gray-50 border border-gray-200 rounded",children:i.jsx("span",{className:"text-gray-700 font-medium",children:v.import_quantity&&v.per_pack_weight?Math.ceil(v.import_quantity/parseFloat(v.per_pack_weight)):"-"})}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total packs"})]})]}),v.packaging_details&&i.jsx("div",{className:"mt-1.5 p-2 bg-blue-50 border border-blue-200 rounded",children:i.jsxs("p",{className:"text-xs text-blue-900",children:[i.jsx("span",{className:"font-semibold",children:"Packaging: "}),v.packaging_details]})})]}),i.jsxs("div",{className:"border-b pb-2",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(To,{className:"w-4 h-4 text-green-600"}),"Import Pricing (USD)"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Price (USD)"}),i.jsx("input",{type:"number",value:v.import_price_usd===0?"":v.import_price_usd,onChange:B=>C({...v,import_price_usd:B.target.value===""?0:Number(B.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Exchange Rate (USD to IDR)"}),i.jsx("input",{type:"number",value:v.exchange_rate_usd_to_idr===0?"":v.exchange_rate_usd_to_idr,onChange:B=>C({...v,exchange_rate_usd_to_idr:B.target.value===""?0:Number(B.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.0001",placeholder:"15000"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["1 USD = ",v.exchange_rate_usd_to_idr.toLocaleString()," IDR"]})]})]}),v.import_price_usd>0&&v.exchange_rate_usd_to_idr>0&&i.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:[i.jsxs("p",{className:"text-xs text-green-800",children:[i.jsx("span",{className:"font-semibold",children:"Calculated Import Price (IDR):"})," ",H(v.import_price_usd*v.exchange_rate_usd_to_idr)]}),i.jsxs("p",{className:"text-xs text-green-600 mt-0.5",children:[H(v.import_price_usd,"USD"),"  ",v.exchange_rate_usd_to_idr.toLocaleString()," = ",H(v.import_price_usd*v.exchange_rate_usd_to_idr)]})]})]}),i.jsxs("div",{className:"border-b pb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Additional Charges"}),i.jsx("div",{className:"space-y-3",children:i.jsxs("div",{className:"grid grid-cols-[1fr_1fr_1fr] gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duty"}),i.jsxs("div",{className:"flex gap-0.5",children:[i.jsx("input",{type:"number",value:v.duty_charges===0?"":v.duty_charges,onChange:B=>C({...v,duty_charges:B.target.value===""?0:Number(B.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),i.jsxs("select",{value:v.duty_charge_type,onChange:B=>C({...v,duty_charge_type:B.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[i.jsx("option",{value:"percentage",children:"%"}),i.jsx("option",{value:"fixed",children:"Rp"})]})]}),v.duty_charges>0&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",H(V(v.duty_charges,v.duty_charge_type))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Freight"}),i.jsxs("div",{className:"flex gap-0.5",children:[i.jsx("input",{type:"number",value:v.freight_charges===0?"":v.freight_charges,onChange:B=>C({...v,freight_charges:B.target.value===""?0:Number(B.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),i.jsxs("select",{value:v.freight_charge_type,onChange:B=>C({...v,freight_charge_type:B.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[i.jsx("option",{value:"percentage",children:"%"}),i.jsx("option",{value:"fixed",children:"Rp"})]})]}),v.freight_charges>0&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",H(V(v.freight_charges,v.freight_charge_type))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Other"}),i.jsxs("div",{className:"flex gap-0.5",children:[i.jsx("input",{type:"number",value:v.other_charges===0?"":v.other_charges,onChange:B=>C({...v,other_charges:B.target.value===""?0:Number(B.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),i.jsxs("select",{value:v.other_charge_type,onChange:B=>C({...v,other_charge_type:B.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[i.jsx("option",{value:"percentage",children:"%"}),i.jsx("option",{value:"fixed",children:"Rp"})]})]}),v.other_charges>0&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",H(V(v.other_charges,v.other_charge_type))]})]})]})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-2",children:[i.jsx("h3",{className:"text-xs font-semibold text-blue-900 mb-1.5",children:"Total Cost Summary"}),i.jsxs("div",{className:"space-y-0.5 text-xs text-blue-800",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Import Price (IDR):"}),i.jsx("span",{className:"font-medium",children:H(v.import_price_usd*v.exchange_rate_usd_to_idr)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Duty Charges:"}),i.jsxs("span",{className:"font-medium",children:[H(V(v.duty_charges,v.duty_charge_type)),v.duty_charge_type==="percentage"&&v.duty_charges>0&&i.jsxs("span",{className:"text-xs ml-1",children:["(",v.duty_charges,"%)"]})]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Freight Charges:"}),i.jsxs("span",{className:"font-medium",children:[H(V(v.freight_charges,v.freight_charge_type)),v.freight_charge_type==="percentage"&&v.freight_charges>0&&i.jsxs("span",{className:"text-xs ml-1",children:["(",v.freight_charges,"%)"]})]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Other Charges:"}),i.jsxs("span",{className:"font-medium",children:[H(V(v.other_charges,v.other_charge_type)),v.other_charge_type==="percentage"&&v.other_charges>0&&i.jsxs("span",{className:"text-xs ml-1",children:["(",v.other_charges,"%)"]})]})]}),i.jsxs("div",{className:"border-t border-blue-300 pt-1.5 mt-1.5 flex justify-between",children:[i.jsx("span",{className:"font-bold",children:"Total Cost (IDR):"}),i.jsx("span",{className:"font-bold text-sm",children:H(M())})]})]})]}),i.jsxs("div",{className:"border-t pt-2",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(Nr,{className:"w-4 h-4"}),"Import Documents"]}),i.jsx(rF,{batchId:y==null?void 0:y.id,existingFiles:p,onFilesChange:b})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{A(!1),P()},className:"px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:y?"Update Batch":"Add Batch"})]})]})}),i.jsx(fr,{isOpen:u,onClose:()=>{f(!1),d([]),g(null)},title:"Batch Documents",children:i.jsx("div",{className:"space-y-3",children:h.length>0?h.map(B=>i.jsxs("a",{href:B.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[i.jsx(Nr,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:B.file_name}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[i.jsx("span",{className:"capitalize",children:B.file_type.replace("_"," ")}),i.jsx("span",{children:""}),i.jsxs("span",{children:[(B.file_size/1024).toFixed(1)," KB"]}),i.jsx("span",{children:""}),i.jsx("span",{children:new Date(B.uploaded_at).toLocaleDateString()})]})]}),i.jsx(ob,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]},B.id)):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Nr,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{children:"No documents uploaded for this batch"})]})})})]})})}function UO(){const{t:e}=Es(),{profile:t}=Qr(),[r,n]=G.useState([]),[s,a]=G.useState([]),[o,l]=G.useState([]),[c,A]=G.useState(!0),[u,f]=G.useState(!1),[h,d]=G.useState({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]});G.useEffect(()=>{x(),g(),y()},[]);const x=async()=>{try{const{data:S,error:I}=await oe.from("inventory_transactions").select(`
          *,
          products(product_name, product_code),
          batches(batch_number),
          user_profiles(full_name)
        `).order("transaction_date",{ascending:!1}).order("created_at",{ascending:!1});if(I)throw I;n(S||[])}catch(S){console.error("Error loading transactions:",S)}finally{A(!1)}},g=async()=>{try{const{data:S,error:I}=await oe.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(I)throw I;a(S||[])}catch(S){console.error("Error loading products:",S)}},y=async()=>{try{const{data:S,error:I}=await oe.from("batches").select("id, batch_number, product_id, current_stock").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!1});if(I)throw I;l(S||[])}catch(S){console.error("Error loading batches:",S)}},m=async S=>{S.preventDefault();try{const{data:{user:I}}=await oe.auth.getUser();if(!I)throw new Error("Not authenticated");const{error:N}=await oe.from("inventory_transactions").insert([{...h,batch_id:h.batch_id||null,reference_number:h.reference_number||null,notes:h.notes||null,created_by:I.id}]);if(N)throw N;if(h.batch_id){const Q=o.find(L=>L.id===h.batch_id);if(Q){let L=Q.current_stock;h.transaction_type==="purchase"||h.transaction_type==="adjustment"?L+=h.quantity:h.transaction_type==="sale"&&(L-=h.quantity);const{error:T}=await oe.from("batches").update({current_stock:L}).eq("id",h.batch_id);if(T)throw T}}f(!1),p(),x(),y()}catch(I){console.error("Error saving transaction:",I),alert("Failed to save transaction. Please try again.")}},p=()=>{d({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]})},b=o.filter(S=>S.product_id===h.product_id),v=[{key:"transaction_date",label:"Date",render:S=>new Date(S.transaction_date).toLocaleDateString()},{key:"transaction_type",label:"Type",render:S=>i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${S.transaction_type==="purchase"?"bg-green-100 text-green-800":S.transaction_type==="sale"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[S.transaction_type==="purchase"&&i.jsx(ao,{className:"w-3 h-3"}),S.transaction_type==="sale"&&i.jsx(iw,{className:"w-3 h-3"}),S.transaction_type==="adjustment"&&i.jsx(td,{className:"w-3 h-3"}),S.transaction_type.charAt(0).toUpperCase()+S.transaction_type.slice(1)]})},{key:"product",label:"Product",render:S=>{var I,N;return i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:(I=S.products)==null?void 0:I.product_name}),i.jsx("div",{className:"text-xs text-gray-500",children:(N=S.products)==null?void 0:N.product_code})]})}},{key:"batch_number",label:"Batch",render:S=>{var I;return((I=S.batches)==null?void 0:I.batch_number)||"N/A"}},{key:"quantity",label:"Quantity",render:S=>i.jsxs("span",{className:`font-semibold ${S.transaction_type==="purchase"?"text-green-600":S.transaction_type==="sale"?"text-red-600":"text-blue-600"}`,children:[S.transaction_type==="purchase"?"+":S.transaction_type==="sale"?"-":"",S.quantity]})},{key:"reference_number",label:"Reference",render:S=>S.reference_number||(S.transaction_type==="purchase"?"Batch Import":"-")},{key:"created_by",label:"Created By",render:S=>{var I;return((I=S.user_profiles)==null?void 0:I.full_name)||(S.transaction_type==="purchase"?"System":"Unknown")}}],C=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse",k={totalTransactions:r.length,purchases:r.filter(S=>S.transaction_type==="purchase").length,sales:r.filter(S=>S.transaction_type==="sale").length,adjustments:r.filter(S=>S.transaction_type==="adjustment").length};return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Inventory Transactions"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Track all stock movements and adjustments"})]}),C&&i.jsxs("button",{onClick:()=>{p(),f(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Add Transaction"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Transactions"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:k.totalTransactions})]}),i.jsx(td,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-green-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-green-600",children:"Purchases"}),i.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:k.purchases})]}),i.jsx(ao,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-red-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-red-600",children:"Sales"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:k.sales})]}),i.jsx(iw,{className:"w-8 h-8 text-red-600"})]})}),i.jsx("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-600",children:"Adjustments"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:k.adjustments})]}),i.jsx(td,{className:"w-8 h-8 text-blue-600"})]})})]}),i.jsx(ja,{columns:v,data:r,loading:c}),i.jsx(fr,{isOpen:u,onClose:()=>{f(!1),p()},title:"Add Inventory Transaction",children:i.jsxs("form",{onSubmit:m,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type *"}),i.jsxs("select",{value:h.transaction_type,onChange:S=>d({...h,transaction_type:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"purchase",children:"Purchase"}),i.jsx("option",{value:"sale",children:"Sale"}),i.jsx("option",{value:"adjustment",children:"Adjustment"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),i.jsxs("select",{value:h.product_id,onChange:S=>d({...h,product_id:S.target.value,batch_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),s.map(S=>i.jsxs("option",{value:S.id,children:[S.product_name," (",S.product_code,")"]},S.id))]})]}),h.product_id&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch (Optional)"}),i.jsxs("select",{value:h.batch_id,onChange:S=>d({...h,batch_id:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select Batch"}),b.map(S=>i.jsxs("option",{value:S.id,children:[S.batch_number," (Stock: ",S.current_stock,")"]},S.id))]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),i.jsx("input",{type:"number",value:h.quantity,onChange:S=>d({...h,quantity:Number(S.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Date *"}),i.jsx("input",{type:"date",value:h.transaction_date,onChange:S=>d({...h,transaction_date:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),i.jsx("input",{type:"text",value:h.reference_number,onChange:S=>d({...h,reference_number:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., SAPJ-001, PO-002"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:h.notes,onChange:S=>d({...h,notes:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional notes about this transaction"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{f(!1),p()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Transaction"})]})]})})]})})}function LO(){const[e,t]=G.useState(null),[r,n]=G.useState(!0),[s,a]=G.useState(!1),[o,l]=G.useState([]),[c,A]=G.useState(null),[u,f]=G.useState("INBOX"),[h,d]=G.useState(""),[x,g]=G.useState(null),[y,m]=G.useState(null);G.useEffect(()=>{p()},[]),G.useEffect(()=>{e&&C()},[e,u]);const p=async()=>{try{const{data:{user:T}}=await oe.auth.getUser();if(!T){g("Not authenticated"),n(!1);return}const{data:P,error:R}=await oe.from("gmail_connections").select("*").eq("user_id",T.id).eq("is_connected",!0).maybeSingle();if(R)throw R;if(!P){g("No Gmail account connected. Please connect your Gmail account in Settings."),n(!1);return}t(P)}catch(T){console.error("Error loading Gmail connection:",T),g("Failed to load Gmail connection")}finally{n(!1)}},b=async T=>{if(new Date(T.access_token_expires_at)>new Date)return T.access_token;const R=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:void 0,client_secret:void 0,refresh_token:T.refresh_token,grant_type:"refresh_token"})});if(!R.ok)throw new Error("Failed to refresh token");const z=await R.json(),q=z.access_token,M=new Date(Date.now()+z.expires_in*1e3).toISOString();return await oe.from("gmail_connections").update({access_token:q,access_token_expires_at:M}).eq("id",T.id),t({...T,access_token:q,access_token_expires_at:M}),q},v=T=>{switch(T){case"INBOX":return"in:inbox";case"SENT":return"in:sent";case"STARRED":return"is:starred";case"TRASH":return"in:trash";case"DRAFT":return"in:drafts";case"ALL":return"in:anywhere";default:return"in:inbox"}},C=async T=>{if(e){a(!0),g(null);try{const P=await b(e),R=v(u);let q=`https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=50&q=${encodeURIComponent(R)}`;T&&(q+=`&pageToken=${T}`);const M=await fetch(q,{headers:{Authorization:`Bearer ${P}`}});if(!M.ok)throw new Error("Failed to fetch emails from Gmail");const V=await M.json(),H=V.messages||[];m(V.nextPageToken||null);const se=H.map(async U=>{const F=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${U.id}?format=full`,{headers:{Authorization:`Bearer ${P}`}});if(!F.ok)return null;const D=await F.json();return k(D)}),B=(await Promise.all(se)).filter(U=>U!==null);l(T?[...o,...B]:B)}catch(P){console.error("Error loading emails:",P),g("Failed to load emails from Gmail")}finally{a(!1)}}},k=T=>{var P,R,z;try{const q=T.payload.headers,M=S(q,"subject")||"(No Subject)",V=S(q,"from")||"",H=((P=V.match(/<(.+?)>/))==null?void 0:P[1])||V,se=V.replace(/<.+?>/,"").trim()||H,ce=new Date(parseInt(T.internalDate)),B=((R=T.labelIds)==null?void 0:R.includes("UNREAD"))||!1,U=((z=T.labelIds)==null?void 0:z.includes("STARRED"))||!1;return{id:T.id,threadId:T.threadId,subject:M,from:se,fromEmail:H,snippet:T.snippet||"",date:ce,isUnread:B,isStarred:U,labels:T.labelIds||[]}}catch(q){return console.error("Error parsing email:",q),null}},S=(T,P)=>{const R=T.find(z=>z.name.toLowerCase()===P.toLowerCase());return(R==null?void 0:R.value)||""},I=T=>{A(T),T.isUnread&&N(T.id)},N=async T=>{if(e)try{const P=await b(e);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${T}/modify`,{method:"POST",headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json"},body:JSON.stringify({removeLabelIds:["UNREAD"]})}),l(o.map(R=>R.id===T?{...R,isUnread:!1}:R)),(c==null?void 0:c.id)===T&&A({...c,isUnread:!1})}catch(P){console.error("Error marking as read:",P)}},Q=async(T,P)=>{if(e)try{const R=await b(e);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${T}/modify`,{method:"POST",headers:{Authorization:`Bearer ${R}`,"Content-Type":"application/json"},body:JSON.stringify({addLabelIds:P?[]:["STARRED"],removeLabelIds:P?["STARRED"]:[]})}),l(o.map(z=>z.id===T?{...z,isStarred:!P}:z)),(c==null?void 0:c.id)===T&&A({...c,isStarred:!P})}catch(R){console.error("Error toggling star:",R)}},L=T=>{const R=new Date().getTime()-T.getTime(),z=Math.floor(R/(1e3*60*60*24));return z===0?T.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):z<7?T.toLocaleDateString("en-US",{weekday:"short"}):T.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return r?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(Bc,{className:"w-6 h-6 animate-spin text-blue-500"})}):x?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Fa,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Connection Error"}),i.jsx("p",{className:"text-sm text-gray-500",children:x})]})}):i.jsxs("div",{className:"flex h-[calc(100vh-16rem)] bg-white rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"w-56 border-r border-gray-200 flex flex-col bg-gray-50",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Folders"})}),i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs("button",{onClick:()=>f("INBOX"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm transition ${u==="INBOX"?"bg-blue-50 text-blue-700 font-medium border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(WE,{className:"w-4 h-4"}),i.jsx("span",{children:"Inbox"})]}),i.jsxs("button",{onClick:()=>f("STARRED"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm transition ${u==="STARRED"?"bg-blue-50 text-blue-700 font-medium border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(LB,{className:"w-4 h-4"}),i.jsx("span",{children:"Starred"})]}),i.jsxs("button",{onClick:()=>f("SENT"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm transition ${u==="SENT"?"bg-blue-50 text-blue-700 font-medium border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(Io,{className:"w-4 h-4"}),i.jsx("span",{children:"Sent"})]}),i.jsxs("button",{onClick:()=>f("DRAFT"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm transition ${u==="DRAFT"?"bg-blue-50 text-blue-700 font-medium border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx($s,{className:"w-4 h-4"}),i.jsx("span",{children:"Drafts"})]}),i.jsxs("button",{onClick:()=>f("ALL"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm transition ${u==="ALL"?"bg-blue-50 text-blue-700 font-medium border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(QE,{className:"w-4 h-4"}),i.jsx("span",{children:"All Mail"})]}),i.jsxs("button",{onClick:()=>f("TRASH"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm transition ${u==="TRASH"?"bg-blue-50 text-blue-700 font-medium border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(bO,{className:"w-4 h-4"}),i.jsx("span",{children:"Trash"})]})]}),i.jsx("div",{className:"p-4 border-t border-gray-200",children:i.jsxs("button",{onClick:()=>C(),disabled:s,className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50",children:[i.jsx(td,{className:`w-3.5 h-3.5 ${s?"animate-spin":""}`}),"Refresh"]})})]}),i.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-200",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"relative",children:[i.jsx(Lc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",value:h,onChange:T=>d(T.target.value),placeholder:"Search emails...",className:"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:s&&o.length===0?i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx(Bc,{className:"w-6 h-6 animate-spin text-blue-500"})}):o.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[i.jsx($s,{className:"w-12 h-12 mb-4 text-gray-300"}),i.jsx("p",{className:"text-sm",children:"No emails found"})]}):i.jsxs("div",{children:[o.filter(T=>h===""||T.subject.toLowerCase().includes(h.toLowerCase())||T.from.toLowerCase().includes(h.toLowerCase())||T.snippet.toLowerCase().includes(h.toLowerCase())).map(T=>i.jsxs("div",{onClick:()=>I(T),className:`flex items-start gap-3 p-4 border-b border-gray-100 cursor-pointer transition ${(c==null?void 0:c.id)===T.id?"bg-blue-50":T.isUnread?"bg-white hover:bg-gray-50":"bg-gray-50 hover:bg-gray-100"}`,children:[i.jsx("button",{onClick:P=>{P.stopPropagation(),Q(T.id,T.isStarred)},className:"mt-1",children:i.jsx(LB,{className:`w-4 h-4 ${T.isStarred?"fill-yellow-400 text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition`})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-baseline justify-between gap-2 mb-1",children:[i.jsx("p",{className:`text-sm truncate ${T.isUnread?"font-semibold text-gray-900":"text-gray-700"}`,children:T.from}),i.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:L(T.date)})]}),i.jsx("p",{className:`text-sm truncate mb-1 ${T.isUnread?"font-medium text-gray-900":"text-gray-600"}`,children:T.subject}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:T.snippet})]}),T.isUnread&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2"})]},T.id)),y&&i.jsx("div",{className:"p-4 text-center",children:i.jsx("button",{onClick:()=>C(y),disabled:s,className:"px-4 py-2 text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50",children:s?"Loading...":"Load More"})})]})})]}),i.jsx("div",{className:"w-1/2 flex flex-col bg-white",children:c?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:c.subject}),i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.from}),i.jsx("p",{className:"text-xs text-gray-500",children:c.fromEmail})]}),i.jsx("p",{className:"text-sm text-gray-500",children:c.date.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsx("div",{className:"prose prose-sm max-w-none",children:i.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:c.snippet})})}),i.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:"Reply"}),i.jsx("button",{className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:"Forward"}),i.jsx("button",{className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:"Create Inquiry"})]})})]}):i.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:i.jsxs("div",{className:"text-center",children:[i.jsx($s,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-sm",children:"Select an email to view"})]})})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var pg={};pg.version="0.18.5";var nF=1252,DO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],cb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ab=function(e){DO.indexOf(e)!=-1&&(nF=cb[0]=e)};function PO(){Ab(1252)}var Xi=function(e){Ab(e)};function ub(){Xi(1200),PO()}function OB(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function OO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function sF(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var T0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?OO(e.slice(2)):t==254&&r==255?sF(e.slice(2)):t==65279?e.slice(1):e},bp=function(t){return String.fromCharCode(t)},RB=function(t){return String.fromCharCode(t)},Df,ic="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pf(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0,A=0;A<e.length;)r=e.charCodeAt(A++),a=r>>2,n=e.charCodeAt(A++),o=(r&3)<<4|n>>4,s=e.charCodeAt(A++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=ic.charAt(a)+ic.charAt(o)+ic.charAt(l)+ic.charAt(c);return t}function si(e){var t="",r=0,n=0,s=0,a=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<e.length;)a=ic.indexOf(e.charAt(A++)),o=ic.indexOf(e.charAt(A++)),r=a<<2|o>>4,t+=String.fromCharCode(r),l=ic.indexOf(e.charAt(A++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=ic.indexOf(e.charAt(A++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var ur=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Cl=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Cc(e){return ur?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function QB(e){return ur?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ya=function(t){return ur?Cl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ix(e){if(typeof ArrayBuffer>"u")return Ya(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Dc(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function RO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function db(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return db(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var us=ur?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Cl(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function QO(e){for(var t=[],r=0,n=e.length+250,s=Cc(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Cc(65535),n=65530)}return t.push(s.slice(0,r)),us(t)}var fa=/\u0000/g,I0=/[\u0001-\u0006]/g;function nd(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yi(e,t){var r=""+e;return r.length>=t?r:vn("0",t-r.length)+r}function fb(e,t){var r=""+e;return r.length>=t?r:vn(" ",t-r.length)+r}function mg(e,t){var r=""+e;return r.length>=t?r:r+vn(" ",t-r.length)}function MO(e,t){var r=""+Math.round(e);return r.length>=t?r:vn("0",t-r.length)+r}function HO(e,t){var r=""+e;return r.length>=t?r:vn("0",t-r.length)+r}var MB=Math.pow(2,32);function hu(e,t){if(e>MB||e<-MB)return MO(e,t);var r=Math.round(e);return HO(r,t)}function gg(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var HB=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],H1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function KO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var zt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},KB={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xg(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,o=1,l=0,c=1,A=0,u=0,f=Math.floor(s);A<t&&(f=Math.floor(s),l=f*o+a,u=f*A+c,!(s-f<5e-8));)s=1/(s-f),a=o,o=l,c=A,A=u;if(u>t&&(A>t?(u=c,l=a):(u=A,l=o)),!r)return[0,n*l,u];var h=Math.floor(n*l/u);return[h,n*l-h*u,u]}function mA(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=XO(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var aF=new Date(1899,11,31,0,0,0),VO=aF.getTime(),GO=new Date(1900,2,1,0,0,0);function iF(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=GO&&(r+=24*60*60*1e3),(r-(VO+(e.getTimezoneOffset()-aF.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function hb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function WO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function $O(e){var t=e<0?12:11,r=hb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function zO(e){var t=hb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Of(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=$O(e):t===10?r=e.toFixed(10).substr(0,12):r=zO(e),hb(WO(r.toUpperCase()))}function UA(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Of(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fi(14,iF(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function XO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function YO(e,t,r,n){var s="",a=0,o=0,l=r.y,c,A=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,A=2;break;default:c=l%1e4,A=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,A=t.length;break;case 3:return H1[r.m-1][1];case 5:return H1[r.m-1][0];default:return H1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,A=t.length;break;case 3:return HB[r.q][0];default:return HB[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,A=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,A=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,A=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Yi(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(s=Yi(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}A=t.length===3?1:2;break;case 101:c=l,A=1;break}var u=A>0?Yi(c,A):"";return u}function oc(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var oF=/%/g;function JO(e,t,r){var n=t.replace(oF,""),s=t.length-n.length;return fl(e,n,r*Math.pow(10,2*s))+vn("%",s)}function ZO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return fl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function lF(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+lF(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cF=/# (\?+)( ?)\/( ?)(\d+)/;function e7(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),o=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(o===0?vn(" ",e[1].length+1+e[4].length):fb(o,e[1].length)+e[2]+"/"+e[3]+Yi(l,e[4].length))}function t7(e,t,r){return r+(t===0?"":""+t)+vn(" ",e[1].length+2+e[4].length)}var AF=/^#*0*\.([0#]+)/,uF=/\).*[0#]/,dF=/\(###\) ###\\?-####/;function ca(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function qB(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function VB(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function r7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function n7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function fi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(uF)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fi("n",n,r):"("+fi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ZO(e,t,r);if(t.indexOf("%")!==-1)return JO(e,t,r);if(t.indexOf("E")!==-1)return lF(t,r);if(t.charCodeAt(0)===36)return"$"+fi(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+hu(c,t.length);if(t.match(/^[#?]+$/))return s=hu(r,0),s==="0"&&(s=""),s.length>t.length?s:ca(t.substr(0,t.length-s.length))+s;if(a=t.match(cF))return e7(a,c,A);if(t.match(/^#+0+$/))return A+hu(c,t.length-t.indexOf("0"));if(a=t.match(AF))return s=qB(r,a[1].length).replace(/^([^\.]+)$/,"$1."+ca(a[1])).replace(/\.$/,"."+ca(a[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+vn("0",ca(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return A+qB(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return A+oc(hu(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fi(e,t,-r):oc(""+(Math.floor(r)+r7(r,a[1].length)))+"."+Yi(VB(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return fi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=nd(fi(e,t.replace(/[\\-]/g,""),r)),o=0,nd(nd(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(dF))return s=fi(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=xg(c,Math.pow(10,o)-1,!1),s=""+A,u=fl("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=mg(l[2],o),u.length<a[4].length&&(u=ca(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=xg(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?fb(l[1],o)+a[2]+"/"+a[3]+mg(l[2],o):vn(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=hu(r,0),t.length<=s.length?s:ca(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return ca(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=VB(r,a[1].length),r<0?"-"+fi(e,t,-r):oc(n7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Yi(0,3-x.length):"")+x})+"."+Yi(o,a[1].length);switch(t){case"###,##0.00":return fi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=oc(hu(c,0));return d!=="0"?A+d:"";case"###,###.00":return fi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return fi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function s7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return fl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function a7(e,t,r){var n=t.replace(oF,""),s=t.length-n.length;return fl(e,n,r*Math.pow(10,2*s))+vn("%",s)}function fF(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fF(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,A,u){return c+A+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function yo(e,t,r){if(e.charCodeAt(0)===40&&!t.match(uF)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yo("n",n,r):"("+yo("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return s7(e,t,r);if(t.indexOf("%")!==-1)return a7(e,t,r);if(t.indexOf("E")!==-1)return fF(t,r);if(t.charCodeAt(0)===36)return"$"+yo(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,l,c=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+Yi(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ca(t.substr(0,t.length-s.length))+s;if(a=t.match(cF))return t7(a,c,A);if(t.match(/^#+0+$/))return A+Yi(c,t.length-t.indexOf("0"));if(a=t.match(AF))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ca(a[1])).replace(/\.$/,"."+ca(a[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+vn("0",ca(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return A+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return A+oc(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yo(e,t,-r):oc(""+r)+"."+vn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return yo(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=nd(yo(e,t.replace(/[\\-]/g,""),r)),o=0,nd(nd(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(dF))return s=yo(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),l=xg(c,Math.pow(10,o)-1,!1),s=""+A,u=fl("n",a[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=mg(l[2],o),u.length<a[4].length&&(u=ca(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),l=xg(c,Math.pow(10,o)-1,!0),A+(l[0]||(l[1]?"":"0"))+" "+(l[1]?fb(l[1],o)+a[2]+"/"+a[3]+mg(l[2],o):vn(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ca(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return ca(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+yo(e,t,-r):oc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Yi(0,3-x.length):"")+x})+"."+Yi(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=oc(""+c);return d!=="0"?A+d:"";default:if(t.match(/\.[0#?]*$/))return yo(e,t.slice(0,t.lastIndexOf(".")),r)+ca(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function fl(e,t,r){return(r|0)===r?yo(e,t,r):fi(e,t,r)}function i7(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var hF=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":gg(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(hF))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function o7(e,t,r,n){for(var s=[],a="",o=0,l="",c="t",A,u,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!gg(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(f=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++o;break;case"\\":var d=e.charAt(++o),x=d==="("||d===")"?d:"t";s[s.length]={t:x,v:d},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(A==null&&(A=mA(t,r,e.charAt(o+1)==="2"),A==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||A==null&&(A=mA(t,r),A==null))return"";for(a=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(A==null&&(A=mA(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(A!=null&&(g.v=A.H>=12?"P":"A"),g.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(A!=null&&(g.v=A.H>=12?"PM":"AM"),g.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(A!=null&&(g.v=A.H>=12?"":""),g.t="T",o+=5,h="h"):(g.t="t",++o),A==null&&g.t==="T")return"";s[s.length]=g,c=l;break;case"[":for(a=l;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(hF)){if(A==null&&(A=mA(t,r),A==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fd(e)||(s[s.length]={t:"t",v:a}));break;case".":if(A!=null){for(a=l;++o<e.length&&(l=e.charAt(o))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++o)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var y=0,m=0,p;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,c="h",y<1&&(y=1);break;case"s":(p=s[o].v.match(/\.0+$/))&&(m=Math.max(m,p[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[o].v.match(/[Hh]/)&&(y=1),y<2&&s[o].v.match(/[Mm]/)&&(y=2),y<3&&s[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var b="",v;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=YO(s[o].t.charCodeAt(0),s[o].v,A,m),s[o].t="t";break;case"n":case"?":for(v=o+1;s[v]!=null&&((l=s[v].t)==="?"||l==="D"||(l===" "||l==="t")&&s[v+1]!=null&&(s[v+1].t==="?"||s[v+1].t==="t"&&s[v+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[v].v==="/"||s[v].v===" "&&s[v+1]!=null&&s[v+1].t=="?"));)s[o].v+=s[v].v,s[v]={v:"",t:";"},++v;b+=s[o].v,o=v-1;break;case"G":s[o].t="t",s[o].v=UA(t,r);break}var C="",k,S;if(b.length>0){b.charCodeAt(0)==40?(k=t<0&&b.charCodeAt(0)===45?-t:t,S=fl("n",b,k)):(k=t<0&&n>1?-t:t,S=fl("n",b,k),k<0&&s[0]&&s[0].t=="t"&&(S=S.substr(1),s[0].v="-"+s[0].v)),v=S.length-1;var I=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){I=o;break}var N=s.length;if(I===s.length&&S.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(v>=s[o].v.length-1?(v-=s[o].v.length,s[o].v=S.substr(v+1,s[o].v.length)):v<0?s[o].v="":(s[o].v=S.substr(0,v+1),v=-1),s[o].t="t",N=o);v>=0&&N<s.length&&(s[N].v=S.substr(0,v+1)+s[N].v)}else if(I!==s.length&&S.indexOf("E")===-1){for(v=S.indexOf(".")-1,o=I;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===I?s[o].v.indexOf(".")-1:s[o].v.length-1,C=s[o].v.substr(u+1);u>=0;--u)v>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(C=S.charAt(v--)+C);s[o].v=C,s[o].t="t",N=o}for(v>=0&&N<s.length&&(s[N].v=S.substr(0,v+1)+s[N].v),v=S.indexOf(".")+1,o=I;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==I)){for(u=s[o].v.indexOf(".")>-1&&o===I?s[o].v.indexOf(".")+1:0,C=s[o].v.substr(0,u);u<s[o].v.length;++u)v<S.length&&(C+=S.charAt(v++));s[o].v=C,s[o].t="t",N=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(k=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=fl(s[o].t,s[o].v,k),s[o].t="t");var Q="";for(o=0;o!==s.length;++o)s[o]!=null&&(Q+=s[o].v);return Q}var GB=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function WB(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function l7(e,t){var r=i7(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(GB),l=r[1].match(GB);return WB(t,o)?[n,r[0]]:WB(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,a]}function Fi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:zt)[e],n==null&&(n=r.table&&r.table[KB[e]]||zt[KB[e]]),n==null&&(n=qO[e]||"General");break}if(gg(n,0))return UA(t,r);t instanceof Date&&(t=iF(t,r.date1904));var s=l7(n,t);if(gg(s[1]))return UA(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return o7(s[1],t,r,s[0])}function hl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(zt[r]==null){t<0&&(t=r);continue}if(zt[r]==e){t=r;break}}t<0&&(t=391)}return zt[t]=e,t}function ox(e){for(var t=0;t!=392;++t)e[t]!==void 0&&hl(e[t],t)}function jd(){zt=KO()}var c7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pF=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function A7(e){var t=typeof e=="number"?zt[e]:e;return t=t.replace(pF,"(\\d+)"),new RegExp("^"+t+"$")}function u7(e,t,r){var n=-1,s=-1,a=-1,o=-1,l=-1,c=-1;(t.match(pF)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":o=d;break;case"s":c=d;break;case"m":o>=0?l=d:s=d;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var A=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?A:n==-1&&s==-1&&a==-1?u:A+"T"+u}var d7=function(){var e={};e.version="1.2.0";function t(){for(var S=0,I=new Array(256),N=0;N!=256;++N)S=N,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,I[N]=S;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(S){var I=0,N=0,Q=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)L[Q]=S[Q];for(Q=0;Q!=256;++Q)for(N=S[Q],I=256+Q;I<4096;I+=256)N=L[I]=N>>>8^S[N&255];var T=[];for(Q=1;Q!=16;++Q)T[Q-1]=typeof Int32Array<"u"?L.subarray(Q*256,Q*256+256):L.slice(Q*256,Q*256+256);return T}var s=n(r),a=s[0],o=s[1],l=s[2],c=s[3],A=s[4],u=s[5],f=s[6],h=s[7],d=s[8],x=s[9],g=s[10],y=s[11],m=s[12],p=s[13],b=s[14];function v(S,I){for(var N=I^-1,Q=0,L=S.length;Q<L;)N=N>>>8^r[(N^S.charCodeAt(Q++))&255];return~N}function C(S,I){for(var N=I^-1,Q=S.length-15,L=0;L<Q;)N=b[S[L++]^N&255]^p[S[L++]^N>>8&255]^m[S[L++]^N>>16&255]^y[S[L++]^N>>>24]^g[S[L++]]^x[S[L++]]^d[S[L++]]^h[S[L++]]^f[S[L++]]^u[S[L++]]^A[S[L++]]^c[S[L++]]^l[S[L++]]^o[S[L++]]^a[S[L++]]^r[S[L++]];for(Q+=15;L<Q;)N=N>>>8^r[(N^S[L++])&255];return~N}function k(S,I){for(var N=I^-1,Q=0,L=S.length,T=0,P=0;Q<L;)T=S.charCodeAt(Q++),T<128?N=N>>>8^r[(N^T)&255]:T<2048?(N=N>>>8^r[(N^(192|T>>6&31))&255],N=N>>>8^r[(N^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,P=S.charCodeAt(Q++)&1023,N=N>>>8^r[(N^(240|T>>8&7))&255],N=N>>>8^r[(N^(128|T>>2&63))&255],N=N>>>8^r[(N^(128|P>>6&15|(T&3)<<4))&255],N=N>>>8^r[(N^(128|P&63))&255]):(N=N>>>8^r[(N^(224|T>>12&15))&255],N=N>>>8^r[(N^(128|T>>6&63))&255],N=N>>>8^r[(N^(128|T&63))&255]);return~N}return e.table=r,e.bstr=v,e.buf=C,e.str=k,e}(),Gt=function(){var t={};t.version="1.2.1";function r(W,ue){for(var re=W.split("/"),Ae=ue.split("/"),pe=0,me=0,De=Math.min(re.length,Ae.length);pe<De;++pe){if(me=re[pe].length-Ae[pe].length)return me;if(re[pe]!=Ae[pe])return re[pe]<Ae[pe]?-1:1}return re.length-Ae.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var ue=W.lastIndexOf("/");return ue===-1?W:W.slice(0,ue+1)}function s(W){if(W.charAt(W.length-1)=="/")return s(W.slice(0,-1));var ue=W.lastIndexOf("/");return ue===-1?W:W.slice(ue+1)}function a(W,ue){typeof ue=="string"&&(ue=new Date(ue));var re=ue.getHours();re=re<<6|ue.getMinutes(),re=re<<5|ue.getSeconds()>>>1,W.write_shift(2,re);var Ae=ue.getFullYear()-1980;Ae=Ae<<4|ue.getMonth()+1,Ae=Ae<<5|ue.getDate(),W.write_shift(2,Ae)}function o(W){var ue=W.read_shift(2)&65535,re=W.read_shift(2)&65535,Ae=new Date,pe=re&31;re>>>=5;var me=re&15;re>>>=4,Ae.setMilliseconds(0),Ae.setFullYear(re+1980),Ae.setMonth(me-1),Ae.setDate(pe);var De=ue&31;ue>>>=5;var Ge=ue&63;return ue>>>=6,Ae.setHours(ue),Ae.setMinutes(Ge),Ae.setSeconds(De<<1),Ae}function l(W){_s(W,0);for(var ue={},re=0;W.l<=W.length-4;){var Ae=W.read_shift(2),pe=W.read_shift(2),me=W.l+pe,De={};switch(Ae){case 21589:re=W.read_shift(1),re&1&&(De.mtime=W.read_shift(4)),pe>5&&(re&2&&(De.atime=W.read_shift(4)),re&4&&(De.ctime=W.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}W.l=me,ue[Ae]=De}return ue}var c;function A(){return c||(c={})}function u(W,ue){if(W[0]==80&&W[1]==75)return Ct(W,ue);if((W[0]|32)==109&&(W[1]|32)==105)return Pt(W,ue);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var re=3,Ae=512,pe=0,me=0,De=0,Ge=0,Oe=0,Qe=[],be=W.slice(0,512);_s(be,0);var fe=f(be);switch(re=fe[0],re){case 3:Ae=512;break;case 4:Ae=4096;break;case 0:if(fe[1]==0)return Ct(W,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+re)}Ae!==512&&(be=W.slice(0,Ae),_s(be,28));var Ie=W.slice(0,Ae);h(be,re);var We=be.read_shift(4,"i");if(re===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);be.l+=4,De=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),Ge=be.read_shift(4,"i"),pe=be.read_shift(4,"i"),Oe=be.read_shift(4,"i"),me=be.read_shift(4,"i");for(var nt=-1,ft=0;ft<109&&(nt=be.read_shift(4,"i"),!(nt<0));++ft)Qe[ft]=nt;var bt=d(W,Ae);y(Oe,me,bt,Ae,Qe);var Vt=p(bt,De,Qe,Ae);Vt[De].name="!Directory",pe>0&&Ge!==P&&(Vt[Ge].name="!MiniFAT"),Vt[Qe[0]].name="!FAT",Vt.fat_addrs=Qe,Vt.ssz=Ae;var Ht={},Br=[],js=[],Er=[];b(De,Vt,bt,Br,pe,Ht,js,Ge),x(js,Er,Br),Br.shift();var Ua={FileIndex:js,FullPaths:Er};return ue&&ue.raw&&(Ua.raw={header:Ie,sectors:bt}),Ua}function f(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(R,"Header Signature: "),W.l+=16;var ue=W.read_shift(2,"u");return[W.read_shift(2,"u"),ue]}function h(W,ue){var re=9;switch(W.l+=2,re=W.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+re);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+re);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+re)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function d(W,ue){for(var re=Math.ceil(W.length/ue)-1,Ae=[],pe=1;pe<re;++pe)Ae[pe-1]=W.slice(pe*ue,(pe+1)*ue);return Ae[re-1]=W.slice(re*ue),Ae}function x(W,ue,re){for(var Ae=0,pe=0,me=0,De=0,Ge=0,Oe=re.length,Qe=[],be=[];Ae<Oe;++Ae)Qe[Ae]=be[Ae]=Ae,ue[Ae]=re[Ae];for(;Ge<be.length;++Ge)Ae=be[Ge],pe=W[Ae].L,me=W[Ae].R,De=W[Ae].C,Qe[Ae]===Ae&&(pe!==-1&&Qe[pe]!==pe&&(Qe[Ae]=Qe[pe]),me!==-1&&Qe[me]!==me&&(Qe[Ae]=Qe[me])),De!==-1&&(Qe[De]=Ae),pe!==-1&&Ae!=Qe[Ae]&&(Qe[pe]=Qe[Ae],be.lastIndexOf(pe)<Ge&&be.push(pe)),me!==-1&&Ae!=Qe[Ae]&&(Qe[me]=Qe[Ae],be.lastIndexOf(me)<Ge&&be.push(me));for(Ae=1;Ae<Oe;++Ae)Qe[Ae]===Ae&&(me!==-1&&Qe[me]!==me?Qe[Ae]=Qe[me]:pe!==-1&&Qe[pe]!==pe&&(Qe[Ae]=Qe[pe]));for(Ae=1;Ae<Oe;++Ae)if(W[Ae].type!==0){if(Ge=Ae,Ge!=Qe[Ge])do Ge=Qe[Ge],ue[Ae]=ue[Ge]+"/"+ue[Ae];while(Ge!==0&&Qe[Ge]!==-1&&Ge!=Qe[Ge]);Qe[Ae]=-1}for(ue[0]+="/",Ae=1;Ae<Oe;++Ae)W[Ae].type!==2&&(ue[Ae]+="/")}function g(W,ue,re){for(var Ae=W.start,pe=W.size,me=[],De=Ae;re&&pe>0&&De>=0;)me.push(ue.slice(De*T,De*T+T)),pe-=T,De=cA(re,De*4);return me.length===0?Xe(0):us(me).slice(0,W.size)}function y(W,ue,re,Ae,pe){var me=P;if(W===P){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var De=re[W],Ge=(Ae>>>2)-1;if(!De)return;for(var Oe=0;Oe<Ge&&(me=cA(De,Oe*4))!==P;++Oe)pe.push(me);y(cA(De,Ae-4),ue-1,re,Ae,pe)}}function m(W,ue,re,Ae,pe){var me=[],De=[];pe||(pe=[]);var Ge=Ae-1,Oe=0,Qe=0;for(Oe=ue;Oe>=0;){pe[Oe]=!0,me[me.length]=Oe,De.push(W[Oe]);var be=re[Math.floor(Oe*4/Ae)];if(Qe=Oe*4&Ge,Ae<4+Qe)throw new Error("FAT boundary crossed: "+Oe+" 4 "+Ae);if(!W[be])break;Oe=cA(W[be],Qe)}return{nodes:me,data:a4([De])}}function p(W,ue,re,Ae){var pe=W.length,me=[],De=[],Ge=[],Oe=[],Qe=Ae-1,be=0,fe=0,Ie=0,We=0;for(be=0;be<pe;++be)if(Ge=[],Ie=be+ue,Ie>=pe&&(Ie-=pe),!De[Ie]){Oe=[];var nt=[];for(fe=Ie;fe>=0;){nt[fe]=!0,De[fe]=!0,Ge[Ge.length]=fe,Oe.push(W[fe]);var ft=re[Math.floor(fe*4/Ae)];if(We=fe*4&Qe,Ae<4+We)throw new Error("FAT boundary crossed: "+fe+" 4 "+Ae);if(!W[ft]||(fe=cA(W[ft],We),nt[fe]))break}me[Ie]={nodes:Ge,data:a4([Oe])}}return me}function b(W,ue,re,Ae,pe,me,De,Ge){for(var Oe=0,Qe=Ae.length?2:0,be=ue[W].data,fe=0,Ie=0,We;fe<be.length;fe+=128){var nt=be.slice(fe,fe+128);_s(nt,64),Ie=nt.read_shift(2),We=wb(nt,0,Ie-Qe),Ae.push(We);var ft={name:We,type:nt.read_shift(1),color:nt.read_shift(1),L:nt.read_shift(4,"i"),R:nt.read_shift(4,"i"),C:nt.read_shift(4,"i"),clsid:nt.read_shift(16),state:nt.read_shift(4,"i"),start:0,size:0},bt=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);bt!==0&&(ft.ct=v(nt,nt.l-8));var Vt=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);Vt!==0&&(ft.mt=v(nt,nt.l-8)),ft.start=nt.read_shift(4,"i"),ft.size=nt.read_shift(4,"i"),ft.size<0&&ft.start<0&&(ft.size=ft.type=0,ft.start=P,ft.name=""),ft.type===5?(Oe=ft.start,pe>0&&Oe!==P&&(ue[Oe].name="!StreamData")):ft.size>=4096?(ft.storage="fat",ue[ft.start]===void 0&&(ue[ft.start]=m(re,ft.start,ue.fat_addrs,ue.ssz)),ue[ft.start].name=ft.name,ft.content=ue[ft.start].data.slice(0,ft.size)):(ft.storage="minifat",ft.size<0?ft.size=0:Oe!==P&&ft.start!==P&&ue[Oe]&&(ft.content=g(ft,ue[Oe].data,(ue[Ge]||{}).data))),ft.content&&_s(ft.content,0),me[We]=ft,De.push(ft)}}function v(W,ue){return new Date(($a(W,ue+4)/1e7*Math.pow(2,32)+$a(W,ue)/1e7-11644473600)*1e3)}function C(W,ue){return A(),u(c.readFileSync(W),ue)}function k(W,ue){var re=ue&&ue.type;switch(re||ur&&Buffer.isBuffer(W)&&(re="buffer"),re||"base64"){case"file":return C(W,ue);case"base64":return u(Ya(si(W)),ue);case"binary":return u(Ya(W),ue)}return u(W,ue)}function S(W,ue){var re=ue||{},Ae=re.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=Ae+"/",W.FileIndex[0]={name:Ae,type:5}),re.CLSID&&(W.FileIndex[0].clsid=re.CLSID),I(W)}function I(W){var ue="Sh33tJ5";if(!Gt.find(W,"/"+ue)){var re=Xe(4);re[0]=55,re[1]=re[3]=50,re[2]=54,W.FileIndex.push({name:ue,type:2,content:re,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+ue),N(W)}}function N(W,ue){S(W);for(var re=!1,Ae=!1,pe=W.FullPaths.length-1;pe>=0;--pe){var me=W.FileIndex[pe];switch(me.type){case 0:Ae?re=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:Ae=!0,isNaN(me.R*me.L*me.C)&&(re=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(re=!0);break;default:re=!0;break}}if(!(!re&&!ue)){var De=new Date(1987,1,19),Ge=0,Oe=Object.create?Object.create(null):{},Qe=[];for(pe=0;pe<W.FullPaths.length;++pe)Oe[W.FullPaths[pe]]=!0,W.FileIndex[pe].type!==0&&Qe.push([W.FullPaths[pe],W.FileIndex[pe]]);for(pe=0;pe<Qe.length;++pe){var be=n(Qe[pe][0]);Ae=Oe[be],Ae||(Qe.push([be,{name:s(be).replace("/",""),type:1,clsid:q,ct:De,mt:De,content:null}]),Oe[be]=!0)}for(Qe.sort(function(We,nt){return r(We[0],nt[0])}),W.FullPaths=[],W.FileIndex=[],pe=0;pe<Qe.length;++pe)W.FullPaths[pe]=Qe[pe][0],W.FileIndex[pe]=Qe[pe][1];for(pe=0;pe<Qe.length;++pe){var fe=W.FileIndex[pe],Ie=W.FullPaths[pe];if(fe.name=s(Ie).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||q,pe===0)fe.C=Qe.length>1?1:-1,fe.size=0,fe.type=5;else if(Ie.slice(-1)=="/"){for(Ge=pe+1;Ge<Qe.length&&n(W.FullPaths[Ge])!=Ie;++Ge);for(fe.C=Ge>=Qe.length?-1:Ge,Ge=pe+1;Ge<Qe.length&&n(W.FullPaths[Ge])!=n(Ie);++Ge);fe.R=Ge>=Qe.length?-1:Ge,fe.type=1}else n(W.FullPaths[pe+1]||"")==n(Ie)&&(fe.R=pe+1),fe.type=2}}}function Q(W,ue){var re=ue||{};if(re.fileType=="mad")return Ln(W,re);switch(N(W),re.fileType){case"zip":return Wt(W,re)}var Ae=function(We){for(var nt=0,ft=0,bt=0;bt<We.FileIndex.length;++bt){var Vt=We.FileIndex[bt];if(Vt.content){var Ht=Vt.content.length;Ht>0&&(Ht<4096?nt+=Ht+63>>6:ft+=Ht+511>>9)}}for(var Br=We.FullPaths.length+3>>2,js=nt+7>>3,Er=nt+127>>7,Ua=js+ft+Br+Er,ta=Ua+127>>7,kl=ta<=109?0:Math.ceil((ta-109)/127);Ua+ta+kl+127>>7>ta;)kl=++ta<=109?0:Math.ceil((ta-109)/127);var Dn=[1,kl,ta,Er,Br,ft,nt,0];return We.FileIndex[0].size=nt<<6,Dn[7]=(We.FileIndex[0].start=Dn[0]+Dn[1]+Dn[2]+Dn[3]+Dn[4]+Dn[5])+(Dn[6]+7>>3),Dn}(W),pe=Xe(Ae[7]<<9),me=0,De=0;{for(me=0;me<8;++me)pe.write_shift(1,z[me]);for(me=0;me<8;++me)pe.write_shift(2,0);for(pe.write_shift(2,62),pe.write_shift(2,3),pe.write_shift(2,65534),pe.write_shift(2,9),pe.write_shift(2,6),me=0;me<3;++me)pe.write_shift(2,0);for(pe.write_shift(4,0),pe.write_shift(4,Ae[2]),pe.write_shift(4,Ae[0]+Ae[1]+Ae[2]+Ae[3]-1),pe.write_shift(4,0),pe.write_shift(4,4096),pe.write_shift(4,Ae[3]?Ae[0]+Ae[1]+Ae[2]-1:P),pe.write_shift(4,Ae[3]),pe.write_shift(-4,Ae[1]?Ae[0]-1:P),pe.write_shift(4,Ae[1]),me=0;me<109;++me)pe.write_shift(-4,me<Ae[2]?Ae[1]+me:-1)}if(Ae[1])for(De=0;De<Ae[1];++De){for(;me<236+De*127;++me)pe.write_shift(-4,me<Ae[2]?Ae[1]+me:-1);pe.write_shift(-4,De===Ae[1]-1?P:De+1)}var Ge=function(We){for(De+=We;me<De-1;++me)pe.write_shift(-4,me+1);We&&(++me,pe.write_shift(-4,P))};for(De=me=0,De+=Ae[1];me<De;++me)pe.write_shift(-4,M.DIFSECT);for(De+=Ae[2];me<De;++me)pe.write_shift(-4,M.FATSECT);Ge(Ae[3]),Ge(Ae[4]);for(var Oe=0,Qe=0,be=W.FileIndex[0];Oe<W.FileIndex.length;++Oe)be=W.FileIndex[Oe],be.content&&(Qe=be.content.length,!(Qe<4096)&&(be.start=De,Ge(Qe+511>>9)));for(Ge(Ae[6]+7>>3);pe.l&511;)pe.write_shift(-4,M.ENDOFCHAIN);for(De=me=0,Oe=0;Oe<W.FileIndex.length;++Oe)be=W.FileIndex[Oe],be.content&&(Qe=be.content.length,!(!Qe||Qe>=4096)&&(be.start=De,Ge(Qe+63>>6)));for(;pe.l&511;)pe.write_shift(-4,M.ENDOFCHAIN);for(me=0;me<Ae[4]<<2;++me){var fe=W.FullPaths[me];if(!fe||fe.length===0){for(Oe=0;Oe<17;++Oe)pe.write_shift(4,0);for(Oe=0;Oe<3;++Oe)pe.write_shift(4,-1);for(Oe=0;Oe<12;++Oe)pe.write_shift(4,0);continue}be=W.FileIndex[me],me===0&&(be.start=be.size?be.start-1:P);var Ie=me===0&&re.root||be.name;if(Qe=2*(Ie.length+1),pe.write_shift(64,Ie,"utf16le"),pe.write_shift(2,Qe),pe.write_shift(1,be.type),pe.write_shift(1,be.color),pe.write_shift(-4,be.L),pe.write_shift(-4,be.R),pe.write_shift(-4,be.C),be.clsid)pe.write_shift(16,be.clsid,"hex");else for(Oe=0;Oe<4;++Oe)pe.write_shift(4,0);pe.write_shift(4,be.state||0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,be.start),pe.write_shift(4,be.size),pe.write_shift(4,0)}for(me=1;me<W.FileIndex.length;++me)if(be=W.FileIndex[me],be.size>=4096)if(pe.l=be.start+1<<9,ur&&Buffer.isBuffer(be.content))be.content.copy(pe,pe.l,0,be.size),pe.l+=be.size+511&-512;else{for(Oe=0;Oe<be.size;++Oe)pe.write_shift(1,be.content[Oe]);for(;Oe&511;++Oe)pe.write_shift(1,0)}for(me=1;me<W.FileIndex.length;++me)if(be=W.FileIndex[me],be.size>0&&be.size<4096)if(ur&&Buffer.isBuffer(be.content))be.content.copy(pe,pe.l,0,be.size),pe.l+=be.size+63&-64;else{for(Oe=0;Oe<be.size;++Oe)pe.write_shift(1,be.content[Oe]);for(;Oe&63;++Oe)pe.write_shift(1,0)}if(ur)pe.l=pe.length;else for(;pe.l<pe.length;)pe.write_shift(1,0);return pe}function L(W,ue){var re=W.FullPaths.map(function(Oe){return Oe.toUpperCase()}),Ae=re.map(function(Oe){var Qe=Oe.split("/");return Qe[Qe.length-(Oe.slice(-1)=="/"?2:1)]}),pe=!1;ue.charCodeAt(0)===47?(pe=!0,ue=re[0].slice(0,-1)+ue):pe=ue.indexOf("/")!==-1;var me=ue.toUpperCase(),De=pe===!0?re.indexOf(me):Ae.indexOf(me);if(De!==-1)return W.FileIndex[De];var Ge=!me.match(I0);for(me=me.replace(fa,""),Ge&&(me=me.replace(I0,"!")),De=0;De<re.length;++De)if((Ge?re[De].replace(I0,"!"):re[De]).replace(fa,"")==me||(Ge?Ae[De].replace(I0,"!"):Ae[De]).replace(fa,"")==me)return W.FileIndex[De];return null}var T=64,P=-2,R="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",M={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(W,ue,re){A();var Ae=Q(W,re);c.writeFileSync(ue,Ae)}function H(W){for(var ue=new Array(W.length),re=0;re<W.length;++re)ue[re]=String.fromCharCode(W[re]);return ue.join("")}function se(W,ue){var re=Q(W,ue);switch(ue&&ue.type||"buffer"){case"file":return A(),c.writeFileSync(ue.filename,re),re;case"binary":return typeof re=="string"?re:H(re);case"base64":return Pf(typeof re=="string"?re:H(re));case"buffer":if(ur)return Buffer.isBuffer(re)?re:Cl(re);case"array":return typeof re=="string"?Ya(re):re}return re}var ce;function B(W){try{var ue=W.InflateRaw,re=new ue;if(re._processChunk(new Uint8Array([3,0]),re._finishFlushFlag),re.bytesRead)ce=W;else throw new Error("zlib does not expose bytesRead")}catch(Ae){console.error("cannot use native zlib: "+(Ae.message||Ae))}}function U(W,ue){if(!ce)return kt(W,ue);var re=ce.InflateRaw,Ae=new re,pe=Ae._processChunk(W.slice(W.l),Ae._finishFlushFlag);return W.l+=Ae.bytesRead,pe}function F(W){return ce?ce.deflateRawSync(W):Me(W)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(W){var ue=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var he=typeof Uint8Array<"u",Y=he?new Uint8Array(256):[],Be=0;Be<256;++Be)Y[Be]=ae(Be);function ee(W,ue){var re=Y[W&255];return ue<=8?re>>>8-ue:(re=re<<8|Y[W>>8&255],ue<=16?re>>>16-ue:(re=re<<8|Y[W>>16&255],re>>>24-ue))}function Te(W,ue){var re=ue&7,Ae=ue>>>3;return(W[Ae]|(re<=6?0:W[Ae+1]<<8))>>>re&3}function Je(W,ue){var re=ue&7,Ae=ue>>>3;return(W[Ae]|(re<=5?0:W[Ae+1]<<8))>>>re&7}function ie(W,ue){var re=ue&7,Ae=ue>>>3;return(W[Ae]|(re<=4?0:W[Ae+1]<<8))>>>re&15}function $e(W,ue){var re=ue&7,Ae=ue>>>3;return(W[Ae]|(re<=3?0:W[Ae+1]<<8))>>>re&31}function ze(W,ue){var re=ue&7,Ae=ue>>>3;return(W[Ae]|(re<=1?0:W[Ae+1]<<8))>>>re&127}function Fe(W,ue,re){var Ae=ue&7,pe=ue>>>3,me=(1<<re)-1,De=W[pe]>>>Ae;return re<8-Ae||(De|=W[pe+1]<<8-Ae,re<16-Ae)||(De|=W[pe+2]<<16-Ae,re<24-Ae)||(De|=W[pe+3]<<24-Ae),De&me}function Re(W,ue,re){var Ae=ue&7,pe=ue>>>3;return Ae<=5?W[pe]|=(re&7)<<Ae:(W[pe]|=re<<Ae&255,W[pe+1]=(re&7)>>8-Ae),ue+3}function at(W,ue,re){var Ae=ue&7,pe=ue>>>3;return re=(re&1)<<Ae,W[pe]|=re,ue+1}function we(W,ue,re){var Ae=ue&7,pe=ue>>>3;return re<<=Ae,W[pe]|=re&255,re>>>=8,W[pe+1]=re,ue+8}function ve(W,ue,re){var Ae=ue&7,pe=ue>>>3;return re<<=Ae,W[pe]|=re&255,re>>>=8,W[pe+1]=re&255,W[pe+2]=re>>>8,ue+16}function Le(W,ue){var re=W.length,Ae=2*re>ue?2*re:ue+5,pe=0;if(re>=ue)return W;if(ur){var me=QB(Ae);if(W.copy)W.copy(me);else for(;pe<W.length;++pe)me[pe]=W[pe];return me}else if(he){var De=new Uint8Array(Ae);if(De.set)De.set(W);else for(;pe<re;++pe)De[pe]=W[pe];return De}return W.length=Ae,W}function tt(W){for(var ue=new Array(W),re=0;re<W;++re)ue[re]=0;return ue}function lt(W,ue,re){var Ae=1,pe=0,me=0,De=0,Ge=0,Oe=W.length,Qe=he?new Uint16Array(32):tt(32);for(me=0;me<32;++me)Qe[me]=0;for(me=Oe;me<re;++me)W[me]=0;Oe=W.length;var be=he?new Uint16Array(Oe):tt(Oe);for(me=0;me<Oe;++me)Qe[pe=W[me]]++,Ae<pe&&(Ae=pe),be[me]=0;for(Qe[0]=0,me=1;me<=Ae;++me)Qe[me+16]=Ge=Ge+Qe[me-1]<<1;for(me=0;me<Oe;++me)Ge=W[me],Ge!=0&&(be[me]=Qe[Ge+16]++);var fe=0;for(me=0;me<Oe;++me)if(fe=W[me],fe!=0)for(Ge=ee(be[me],Ae)>>Ae-fe,De=(1<<Ae+4-fe)-1;De>=0;--De)ue[Ge|De<<fe]=fe&15|me<<4;return Ae}var it=he?new Uint16Array(512):tt(512),Ne=he?new Uint16Array(32):tt(32);if(!he){for(var ke=0;ke<512;++ke)it[ke]=0;for(ke=0;ke<32;++ke)Ne[ke]=0}(function(){for(var W=[],ue=0;ue<32;ue++)W.push(5);lt(W,Ne,32);var re=[];for(ue=0;ue<=143;ue++)re.push(8);for(;ue<=255;ue++)re.push(9);for(;ue<=279;ue++)re.push(7);for(;ue<=287;ue++)re.push(8);lt(re,it,288)})();var qe=function(){for(var ue=he?new Uint8Array(32768):[],re=0,Ae=0;re<K.length-1;++re)for(;Ae<K[re+1];++Ae)ue[Ae]=re;for(;Ae<32768;++Ae)ue[Ae]=29;var pe=he?new Uint8Array(259):[];for(re=0,Ae=0;re<X.length-1;++re)for(;Ae<X[re+1];++Ae)pe[Ae]=re;function me(Ge,Oe){for(var Qe=0;Qe<Ge.length;){var be=Math.min(65535,Ge.length-Qe),fe=Qe+be==Ge.length;for(Oe.write_shift(1,+fe),Oe.write_shift(2,be),Oe.write_shift(2,~be&65535);be-- >0;)Oe[Oe.l++]=Ge[Qe++]}return Oe.l}function De(Ge,Oe){for(var Qe=0,be=0,fe=he?new Uint16Array(32768):[];be<Ge.length;){var Ie=Math.min(65535,Ge.length-be);if(Ie<10){for(Qe=Re(Oe,Qe,+(be+Ie==Ge.length)),Qe&7&&(Qe+=8-(Qe&7)),Oe.l=Qe/8|0,Oe.write_shift(2,Ie),Oe.write_shift(2,~Ie&65535);Ie-- >0;)Oe[Oe.l++]=Ge[be++];Qe=Oe.l*8;continue}Qe=Re(Oe,Qe,+(be+Ie==Ge.length)+2);for(var We=0;Ie-- >0;){var nt=Ge[be];We=(We<<5^nt)&32767;var ft=-1,bt=0;if((ft=fe[We])&&(ft|=be&-32768,ft>be&&(ft-=32768),ft<be))for(;Ge[ft+bt]==Ge[be+bt]&&bt<250;)++bt;if(bt>2){nt=pe[bt],nt<=22?Qe=we(Oe,Qe,Y[nt+1]>>1)-1:(we(Oe,Qe,3),Qe+=5,we(Oe,Qe,Y[nt-23]>>5),Qe+=3);var Vt=nt<8?0:nt-4>>2;Vt>0&&(ve(Oe,Qe,bt-X[nt]),Qe+=Vt),nt=ue[be-ft],Qe=we(Oe,Qe,Y[nt]>>3),Qe-=3;var Ht=nt<4?0:nt-2>>1;Ht>0&&(ve(Oe,Qe,be-ft-K[nt]),Qe+=Ht);for(var Br=0;Br<bt;++Br)fe[We]=be&32767,We=(We<<5^Ge[be])&32767,++be;Ie-=bt-1}else nt<=143?nt=nt+48:Qe=at(Oe,Qe,1),Qe=we(Oe,Qe,Y[nt]),fe[We]=be&32767,++be}Qe=we(Oe,Qe,0)-1}return Oe.l=(Qe+7)/8|0,Oe.l}return function(Oe,Qe){return Oe.length<8?me(Oe,Qe):De(Oe,Qe)}}();function Me(W){var ue=Xe(50+Math.floor(W.length*1.1)),re=qe(W,ue);return ue.slice(0,re)}var Ve=he?new Uint16Array(32768):tt(32768),Et=he?new Uint16Array(32768):tt(32768),xt=he?new Uint16Array(128):tt(128),st=1,pt=1;function It(W,ue){var re=$e(W,ue)+257;ue+=5;var Ae=$e(W,ue)+1;ue+=5;var pe=ie(W,ue)+4;ue+=4;for(var me=0,De=he?new Uint8Array(19):tt(19),Ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Oe=1,Qe=he?new Uint8Array(8):tt(8),be=he?new Uint8Array(8):tt(8),fe=De.length,Ie=0;Ie<pe;++Ie)De[D[Ie]]=me=Je(W,ue),Oe<me&&(Oe=me),Qe[me]++,ue+=3;var We=0;for(Qe[0]=0,Ie=1;Ie<=Oe;++Ie)be[Ie]=We=We+Qe[Ie-1]<<1;for(Ie=0;Ie<fe;++Ie)(We=De[Ie])!=0&&(Ge[Ie]=be[We]++);var nt=0;for(Ie=0;Ie<fe;++Ie)if(nt=De[Ie],nt!=0){We=Y[Ge[Ie]]>>8-nt;for(var ft=(1<<7-nt)-1;ft>=0;--ft)xt[We|ft<<nt]=nt&7|Ie<<3}var bt=[];for(Oe=1;bt.length<re+Ae;)switch(We=xt[ze(W,ue)],ue+=We&7,We>>>=3){case 16:for(me=3+Te(W,ue),ue+=2,We=bt[bt.length-1];me-- >0;)bt.push(We);break;case 17:for(me=3+Je(W,ue),ue+=3;me-- >0;)bt.push(0);break;case 18:for(me=11+ze(W,ue),ue+=7;me-- >0;)bt.push(0);break;default:bt.push(We),Oe<We&&(Oe=We);break}var Vt=bt.slice(0,re),Ht=bt.slice(re);for(Ie=re;Ie<286;++Ie)Vt[Ie]=0;for(Ie=Ae;Ie<30;++Ie)Ht[Ie]=0;return st=lt(Vt,Ve,286),pt=lt(Ht,Et,30),ue}function ut(W,ue){if(W[0]==3&&!(W[1]&3))return[Cc(ue),2];for(var re=0,Ae=0,pe=QB(ue||1<<18),me=0,De=pe.length>>>0,Ge=0,Oe=0;!(Ae&1);){if(Ae=Je(W,re),re+=3,Ae>>>1)Ae>>1==1?(Ge=9,Oe=5):(re=It(W,re),Ge=st,Oe=pt);else{re&7&&(re+=8-(re&7));var Qe=W[re>>>3]|W[(re>>>3)+1]<<8;if(re+=32,Qe>0)for(!ue&&De<me+Qe&&(pe=Le(pe,me+Qe),De=pe.length);Qe-- >0;)pe[me++]=W[re>>>3],re+=8;continue}for(;;){!ue&&De<me+32767&&(pe=Le(pe,me+32767),De=pe.length);var be=Fe(W,re,Ge),fe=Ae>>>1==1?it[be]:Ve[be];if(re+=fe&15,fe>>>=4,!(fe>>>8&255))pe[me++]=fe;else{if(fe==256)break;fe-=257;var Ie=fe<8?0:fe-4>>2;Ie>5&&(Ie=0);var We=me+X[fe];Ie>0&&(We+=Fe(W,re,Ie),re+=Ie),be=Fe(W,re,Oe),fe=Ae>>>1==1?Ne[be]:Et[be],re+=fe&15,fe>>>=4;var nt=fe<4?0:fe-2>>1,ft=K[fe];for(nt>0&&(ft+=Fe(W,re,nt),re+=nt),!ue&&De<We&&(pe=Le(pe,We+100),De=pe.length);me<We;)pe[me]=pe[me-ft],++me}}}return ue?[pe,re+7>>>3]:[pe.slice(0,me),re+7>>>3]}function kt(W,ue){var re=W.slice(W.l||0),Ae=ut(re,ue);return W.l+=Ae[1],Ae[0]}function yt(W,ue){if(W)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function Ct(W,ue){var re=W;_s(re,0);var Ae=[],pe=[],me={FileIndex:Ae,FullPaths:pe};S(me,{root:ue.root});for(var De=re.length-4;(re[De]!=80||re[De+1]!=75||re[De+2]!=5||re[De+3]!=6)&&De>=0;)--De;re.l=De+4,re.l+=4;var Ge=re.read_shift(2);re.l+=6;var Oe=re.read_shift(4);for(re.l=Oe,De=0;De<Ge;++De){re.l+=20;var Qe=re.read_shift(4),be=re.read_shift(4),fe=re.read_shift(2),Ie=re.read_shift(2),We=re.read_shift(2);re.l+=8;var nt=re.read_shift(4),ft=l(re.slice(re.l+fe,re.l+fe+Ie));re.l+=fe+Ie+We;var bt=re.l;re.l=nt+4,er(re,Qe,be,me,ft),re.l=bt}return me}function er(W,ue,re,Ae,pe){W.l+=2;var me=W.read_shift(2),De=W.read_shift(2),Ge=o(W);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var Oe=W.read_shift(4),Qe=W.read_shift(4),be=W.read_shift(4),fe=W.read_shift(2),Ie=W.read_shift(2),We="",nt=0;nt<fe;++nt)We+=String.fromCharCode(W[W.l++]);if(Ie){var ft=l(W.slice(W.l,W.l+Ie));(ft[21589]||{}).mt&&(Ge=ft[21589].mt),((pe||{})[21589]||{}).mt&&(Ge=pe[21589].mt)}W.l+=Ie;var bt=W.slice(W.l,W.l+Qe);switch(De){case 8:bt=U(W,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var Vt=!1;me&8&&(Oe=W.read_shift(4),Oe==134695760&&(Oe=W.read_shift(4),Vt=!0),Qe=W.read_shift(4),be=W.read_shift(4)),Qe!=ue&&yt(Vt,"Bad compressed size: "+ue+" != "+Qe),be!=re&&yt(Vt,"Bad uncompressed size: "+re+" != "+be),_e(Ae,We,bt,{unsafe:!0,mt:Ge})}function Wt(W,ue){var re=ue||{},Ae=[],pe=[],me=Xe(1),De=re.compression?8:0,Ge=0,Oe=0,Qe=0,be=0,fe=0,Ie=W.FullPaths[0],We=Ie,nt=W.FileIndex[0],ft=[],bt=0;for(Oe=1;Oe<W.FullPaths.length;++Oe)if(We=W.FullPaths[Oe].slice(Ie.length),nt=W.FileIndex[Oe],!(!nt.size||!nt.content||We=="Sh33tJ5")){var Vt=be,Ht=Xe(We.length);for(Qe=0;Qe<We.length;++Qe)Ht.write_shift(1,We.charCodeAt(Qe)&127);Ht=Ht.slice(0,Ht.l),ft[fe]=d7.buf(nt.content,0);var Br=nt.content;De==8&&(Br=F(Br)),me=Xe(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,Ge),me.write_shift(2,De),nt.mt?a(me,nt.mt):me.write_shift(4,0),me.write_shift(-4,ft[fe]),me.write_shift(4,Br.length),me.write_shift(4,nt.content.length),me.write_shift(2,Ht.length),me.write_shift(2,0),be+=me.length,Ae.push(me),be+=Ht.length,Ae.push(Ht),be+=Br.length,Ae.push(Br),me=Xe(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,Ge),me.write_shift(2,De),me.write_shift(4,0),me.write_shift(-4,ft[fe]),me.write_shift(4,Br.length),me.write_shift(4,nt.content.length),me.write_shift(2,Ht.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,Vt),bt+=me.l,pe.push(me),bt+=Ht.length,pe.push(Ht),++fe}return me=Xe(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,fe),me.write_shift(2,fe),me.write_shift(4,bt),me.write_shift(4,be),me.write_shift(2,0),us([us(Ae),us(pe),me])}var St={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ar(W,ue){if(W.ctype)return W.ctype;var re=W.name||"",Ae=re.match(/\.([^\.]+)$/);return Ae&&St[Ae[1]]||ue&&(Ae=(re=ue).match(/[\.\\]([^\.\\])+$/),Ae&&St[Ae[1]])?St[Ae[1]]:"application/octet-stream"}function Fs(W){for(var ue=Pf(W),re=[],Ae=0;Ae<ue.length;Ae+=76)re.push(ue.slice(Ae,Ae+76));return re.join(`\r
`)+`\r
`}function sr(W){var ue=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Qe){var be=Qe.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var re=[],Ae=ue.split(`\r
`),pe=0;pe<Ae.length;++pe){var me=Ae[pe];if(me.length==0){re.push("");continue}for(var De=0;De<me.length;){var Ge=76,Oe=me.slice(De,De+Ge);Oe.charAt(Ge-1)=="="?Ge--:Oe.charAt(Ge-2)=="="?Ge-=2:Oe.charAt(Ge-3)=="="&&(Ge-=3),Oe=me.slice(De,De+Ge),De+=Ge,De<me.length&&(Oe+="="),re.push(Oe)}}return re.join(`\r
`)}function an(W){for(var ue=[],re=0;re<W.length;++re){for(var Ae=W[re];re<=W.length&&Ae.charAt(Ae.length-1)=="=";)Ae=Ae.slice(0,Ae.length-1)+W[++re];ue.push(Ae)}for(var pe=0;pe<ue.length;++pe)ue[pe]=ue[pe].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return Ya(ue.join(`\r
`))}function Wn(W,ue,re){for(var Ae="",pe="",me="",De,Ge=0;Ge<10;++Ge){var Oe=ue[Ge];if(!Oe||Oe.match(/^\s*$/))break;var Qe=Oe.match(/^(.*?):\s*([^\s].*)$/);if(Qe)switch(Qe[1].toLowerCase()){case"content-location":Ae=Qe[2].trim();break;case"content-type":me=Qe[2].trim();break;case"content-transfer-encoding":pe=Qe[2].trim();break}}switch(++Ge,pe.toLowerCase()){case"base64":De=Ya(si(ue.slice(Ge).join("")));break;case"quoted-printable":De=an(ue.slice(Ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+pe)}var be=_e(W,Ae.slice(re.length),De,{unsafe:!0});me&&(be.ctype=me)}function Pt(W,ue){if(H(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var re=ue&&ue.root||"",Ae=(ur&&Buffer.isBuffer(W)?W.toString("binary"):H(W)).split(`\r
`),pe=0,me="";for(pe=0;pe<Ae.length;++pe)if(me=Ae[pe],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),re||(re=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,re.length)!=re))for(;re.length>0&&(re=re.slice(0,re.length-1),re=re.slice(0,re.lastIndexOf("/")+1),me.slice(0,re.length)!=re););var De=(Ae[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var Ge="--"+(De[1]||""),Oe=[],Qe=[],be={FileIndex:Oe,FullPaths:Qe};S(be);var fe,Ie=0;for(pe=0;pe<Ae.length;++pe){var We=Ae[pe];We!==Ge&&We!==Ge+"--"||(Ie++&&Wn(be,Ae.slice(fe,pe),re),fe=pe)}return be}function Ln(W,ue){var re=ue||{},Ae=re.boundary||"SheetJS";Ae="------="+Ae;for(var pe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Ae.slice(2)+'"',"","",""],me=W.FullPaths[0],De=me,Ge=W.FileIndex[0],Oe=1;Oe<W.FullPaths.length;++Oe)if(De=W.FullPaths[Oe].slice(me.length),Ge=W.FileIndex[Oe],!(!Ge.size||!Ge.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var Qe=Ge.content,be=ur&&Buffer.isBuffer(Qe)?Qe.toString("binary"):H(Qe),fe=0,Ie=Math.min(1024,be.length),We=0,nt=0;nt<=Ie;++nt)(We=be.charCodeAt(nt))>=32&&We<128&&++fe;var ft=fe>=Ie*4/5;pe.push(Ae),pe.push("Content-Location: "+(re.root||"file:///C:/SheetJS/")+De),pe.push("Content-Transfer-Encoding: "+(ft?"quoted-printable":"base64")),pe.push("Content-Type: "+Ar(Ge,De)),pe.push(""),pe.push(ft?sr(be):Fs(be))}return pe.push(Ae+`--\r
`),pe.join(`\r
`)}function on(W){var ue={};return S(ue,W),ue}function _e(W,ue,re,Ae){var pe=Ae&&Ae.unsafe;pe||S(W);var me=!pe&&Gt.find(W,ue);if(!me){var De=W.FullPaths[0];ue.slice(0,De.length)==De?De=ue:(De.slice(-1)!="/"&&(De+="/"),De=(De+ue).replace("//","/")),me={name:s(ue),type:2},W.FileIndex.push(me),W.FullPaths.push(De),pe||Gt.utils.cfb_gc(W)}return me.content=re,me.size=re?re.length:0,Ae&&(Ae.CLSID&&(me.clsid=Ae.CLSID),Ae.mt&&(me.mt=Ae.mt),Ae.ct&&(me.ct=Ae.ct)),me}function Ee(W,ue){S(W);var re=Gt.find(W,ue);if(re){for(var Ae=0;Ae<W.FileIndex.length;++Ae)if(W.FileIndex[Ae]==re)return W.FileIndex.splice(Ae,1),W.FullPaths.splice(Ae,1),!0}return!1}function dt(W,ue,re){S(W);var Ae=Gt.find(W,ue);if(Ae){for(var pe=0;pe<W.FileIndex.length;++pe)if(W.FileIndex[pe]==Ae)return W.FileIndex[pe].name=s(re),W.FullPaths[pe]=re,!0}return!1}function Mt(W){N(W,!0)}return t.find=L,t.read=k,t.parse=u,t.write=se,t.writeFile=V,t.utils={cfb_new:on,cfb_add:_e,cfb_del:Ee,cfb_mov:dt,cfb_gc:Mt,ReadShift:Z0,CheckField:PF,prep_blob:_s,bconcat:us,use_zlib:B,_deflateRaw:Me,_inflateRaw:kt,consts:M},t}();function f7(e){return typeof e=="string"?ix(e):Array.isArray(e)?RO(e):e}function ch(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ix(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?No(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([f7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Dc(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function h7(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function wn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function $B(e,t){for(var r=[],n=wn(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function lx(e){for(var t=[],r=wn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function cx(e){for(var t=[],r=wn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function p7(e){for(var t=[],r=wn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var vg=new Date(1899,11,30,0,0,0);function is(e,t){var r=e.getTime(),n=vg.getTime()+(e.getTimezoneOffset()-vg.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var mF=new Date,m7=vg.getTime()+(mF.getTimezoneOffset()-vg.getTimezoneOffset())*6e4,zB=mF.getTimezoneOffset();function Ax(e){var t=new Date;return t.setTime(e*24*60*60*1e3+m7),t.getTimezoneOffset()!==zB&&t.setTime(t.getTime()+(t.getTimezoneOffset()-zB)*6e4),t}function g7(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var XB=new Date("2017-02-19T19:06:09.000Z"),gF=isNaN(XB.getFullYear())?new Date("2/19/17"):XB,x7=gF.getFullYear()==2017;function en(e,t){var r=new Date(e);if(x7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(gF.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function LA(e,t){if(ur&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return No(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return No(sF(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return No(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return No(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function tn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=tn(e[r]));return t}function vn(e,t){for(var r="";r.length<t;)r+=e;return r}function to(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var v7=["january","february","march","april","may","june","july","august","september","october","november","december"];function yd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&v7.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var y7=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],l=1;l<a.length;++l)o.push(s),o.push(a[l]);return o}}();function xF(e){return e?e.content&&e.type?LA(e.content,!0):e.data?T0(e.data):e.asNodeBuffer&&ur?T0(e.asNodeBuffer().toString("binary")):e.asBinary?T0(e.asBinary()):e._data&&e._data.getContent?T0(LA(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function vF(e){if(!e)return null;if(e.data)return OB(e.data);if(e.asNodeBuffer&&ur)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?OB(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function w7(e){return e&&e.name.slice(-4)===".bin"?vF(e):xF(e)}function mi(e,t){for(var r=e.FullPaths||wn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function pb(e,t){var r=mi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mn(e,t,r){if(!r)return w7(pb(e,t));if(!t)return null;try{return Mn(e,t)}catch{return null}}function Ja(e,t,r){if(!r)return xF(pb(e,t));if(!t)return null;try{return Ja(e,t)}catch{return null}}function b7(e,t,r){return vF(pb(e,t))}function YB(e){for(var t=e.FullPaths||wn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function cr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ur?n=Cl(r):n=QO(r),Gt.utils.cfb_add(e,t,n)}Gt.utils.cfb_add(e,t,r)}else e.file(t,r)}function mb(){return Gt.utils.cfb_new()}function yF(e,t){switch(t.type){case"base64":return Gt.read(e,{type:"base64"});case"binary":return Gt.read(e,{type:"binary"});case"buffer":case"array":return Gt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function U0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Un=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,JB=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,B7=/<[^>]*>/g,ea=Un.match(JB)?JB:B7,C7=/<\w*:/,N7=/<(\/?)\w+:/;function Yt(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(_7),l=0,c="",A=0,u="",f="",h=1;if(o)for(A=0;A!=o.length;++A){for(f=o[A],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(u=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+h,f.length-h),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var d=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[d]&&u.slice(l-3,l)=="ext")continue;n[d]=c,n[d.toLowerCase()]=c}}return n}function Uo(e){return e.replace(N7,"<$1")}var wF={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gb=lx(wF),br=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(l,c){return wF[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,o)+r(s.slice(o+3))}}(),xb=/[&<>'"]/g,S7=/[\u0000-\u0008\u000b-\u001f]/g;function Dr(e){var t=e+"";return t.replace(xb,function(r){return gb[r]}).replace(S7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ZB(e){return Dr(e).replace(/ /g,"_x0020_")}var bF=/[\u0000-\u001f]/g;function vb(e){var t=e+"";return t.replace(xb,function(r){return gb[r]}).replace(/\n/g,"<br/>").replace(bF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function k7(e){var t=e+"";return t.replace(xb,function(r){return gb[r]}).replace(bF,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var e4=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function E7(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Yr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function K1(e){for(var t="",r=0,n=0,s=0,a=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function t4(e){var t=Cc(2*e.length),r,n,s=1,a=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function r4(e){return Cl(e,"binary").toString("utf8")}var _p="foo bar baz",Rr=ur&&(r4(_p)==K1(_p)&&r4||t4(_p)==K1(_p)&&t4)||K1,No=ur?function(e){return Cl(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Rf=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),_F=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),F7=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),j7=/<\/?(?:vt:)?variant>/g,T7=/<(?:vt:)([^>]*)>([\s\S]*)</;function n4(e,t){var r=Yt(e),n=e.match(F7(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var o=a.replace(j7,"").match(T7);o&&s.push({v:Rr(o[2]),t:o[1]})}),s}var BF=/(^\s|\s$|\n)/;function Bs(e,t){return"<"+e+(t.match(BF)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Qf(e){return wn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function vt(e,t,r){return"<"+e+(r!=null?Qf(r):"")+(t!=null?(t.match(BF)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function lw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function I7(e,t){switch(typeof e){case"string":var r=vt("vt:lpwstr",Dr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return vt((e|0)==e?"vt:i4":"vt:r8",Dr(String(e)));case"boolean":return vt("vt:bool",e?"true":"false")}if(e instanceof Date)return vt("vt:filetime",lw(e));throw new Error("Unable to serialize "+e)}function yb(e){if(ur&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Rr(Dc(db(e)));throw new Error("Bad input format: expected Buffer or string")}var Mf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ns={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qA=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Wa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function U7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function L7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,o=n?-t:t;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var s4=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},a4=ur?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Cl(t)})):s4(e)}:s4,i4=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(ul(e,s)));return n.join("").replace(fa,"")},wb=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(fa,""):i4(e,t,r)}:i4,o4=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},CF=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):o4(e,t,r)}:o4,l4=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(ku(e,s)));return n.join("")},Ah=ur?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):l4(t,r,n)}:l4,NF=function(e,t){var r=$a(e,t);return r>0?Ah(e,t+4,t+4+r-1):""},SF=NF,kF=function(e,t){var r=$a(e,t);return r>0?Ah(e,t+4,t+4+r-1):""},EF=kF,FF=function(e,t){var r=2*$a(e,t);return r>0?Ah(e,t+4,t+4+r-1):""},jF=FF,TF=function(t,r){var n=$a(t,r);return n>0?wb(t,r+4,r+4+n):""},IF=TF,UF=function(e,t){var r=$a(e,t);return r>0?Ah(e,t+4,t+4+r):""},LF=UF,DF=function(e,t){return U7(e,t)},yg=DF,bb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ur&&(SF=function(t,r){if(!Buffer.isBuffer(t))return NF(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},EF=function(t,r){if(!Buffer.isBuffer(t))return kF(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},jF=function(t,r){if(!Buffer.isBuffer(t))return FF(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},IF=function(t,r){if(!Buffer.isBuffer(t))return TF(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},LF=function(t,r){if(!Buffer.isBuffer(t))return UF(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},yg=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):DF(t,r)},bb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ku=function(e,t){return e[t]},ul=function(e,t){return e[t+1]*256+e[t]},D7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},$a=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},cA=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},P7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Z0(e,t){var r="",n,s,a=[],o,l,c,A;switch(t){case"dbcs":if(A=this.l,ur&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(ul(this,A)),A+=2;e*=2;break;case"utf8":r=Ah(this,this.l,this.l+e);break;case"utf16le":e*=2,r=wb(this,this.l,this.l+e);break;case"wstr":return Z0.call(this,e,"dbcs");case"lpstr-ansi":r=SF(this,this.l),e=4+$a(this,this.l);break;case"lpstr-cp":r=EF(this,this.l),e=4+$a(this,this.l);break;case"lpwstr":r=jF(this,this.l),e=4+2*$a(this,this.l);break;case"lpp4":e=4+$a(this,this.l),r=IF(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+$a(this,this.l),r=LF(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=ku(this,this.l+e++))!==0;)a.push(bp(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=ul(this,this.l+e))!==0;)a.push(bp(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",A=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=ku(this,A),this.l=A+1,l=Z0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(bp(ul(this,A))),A+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",A=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(A)!==-1)return o=ku(this,A),this.l=A+1,l=Z0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(bp(ku(this,A))),A+=1}r=a.join("");break;default:switch(e){case 1:return n=ku(this,this.l),this.l++,n;case 2:return n=(t==="i"?D7:ul)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?cA:P7)(this,this.l),this.l+=4,n):(s=$a(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=yg(this,this.l):s=yg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=CF(this,this.l,e);break}}return this.l+=e,r}var O7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},R7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Q7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function M7(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)Q7(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,O7(this,t,this.l);break;case 8:if(n=8,r==="f"){L7(this,t,this.l);break}case 16:break;case-4:n=4,R7(this,t,this.l);break}return this.l+=n,this}function PF(e,t){var r=CF(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function _s(e,t){e.l=t,e.read_shift=Z0,e.chk=PF,e.write_shift=M7}function Zs(e,t){e.l+=t}function Xe(e){var t=Cc(e);return _s(t,0),t}function Nl(e,t,r){if(e){var n,s,a;_s(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var A=Wf[l]||Wf[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var u=A.f&&A.f(e,a,r);if(e.l=c,t(u,A,l))return}}}function Ea(){var e=[],t=ur?256:2048,r=function(A){var u=Xe(A);return _s(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(A){return n&&A<n.length-n.l?n:(s(),n=r(Math.max(A+1,t)))},o=function(){return s(),us(e)},l=function(A){s(),n=A,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:l,end:o,_bufs:e}}function ot(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=Wf[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=e.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&bb(r)&&e.push(r)}}function ef(e,t,r){var n=tn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function c4(e,t,r){var n=tn(e);return n.s=ef(n.s,t.s,r),n.e=ef(n.e,t.s,r),n}function tf(e,t){if(e.cRel&&e.c<0)for(e=tn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=tn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Xt(e);return!e.cRel&&e.cRel!=null&&(r=q7(r)),!e.rRel&&e.rRel!=null&&(r=H7(r)),r}function q1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+un(e.s.c)+":"+(e.e.cRel?"":"$")+un(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+In(e.s.r)+":"+(e.e.rRel?"":"$")+In(e.e.r):tf(e.s,t.biff)+":"+tf(e.e,t.biff)}function _b(e){return parseInt(K7(e),10)-1}function In(e){return""+(e+1)}function H7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K7(e){return e.replace(/\$(\d+)$/,"$1")}function Bb(e){for(var t=V7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function un(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function q7(e){return e.replace(/^([A-Z])/,"$$$1")}function V7(e){return e.replace(/^\$([A-Z])/,"$1")}function G7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Xt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ta(e){var t=e.indexOf(":");return t==-1?{s:dn(e),e:dn(e)}:{s:dn(e.slice(0,t)),e:dn(e.slice(t+1))}}function ir(e,t){return typeof t>"u"||typeof t=="number"?ir(e.s,e.e):(typeof e!="string"&&(e=Xt(e)),typeof t!="string"&&(t=Xt(t)),e==t?e:e+":"+t)}function _r(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function A4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fi(e.z,r?is(t):t)}catch{}try{return e.w=Fi((e.XF||{}).numFmtId||(r?14:0),r?is(t):t)}catch{return""+t}}function wl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Sl[e.v]||e.v:t==null?A4(e,e.v):A4(e,t))}function Pc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function OF(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),o=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?dn(n.origin):n.origin;o=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=_r(a["!ref"]);A.s.c=u.s.c,A.s.r=u.s.r,A.e.c=Math.max(A.e.c,u.e.c),A.e.r=Math.max(A.e.r,u.e.r),o==-1&&(A.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},x=o+f,g=l+h;if(A.s.r>x&&(A.s.r=x),A.s.c>g&&(A.s.c=g),A.e.r<x&&(A.e.r=x),A.e.c<g&&(A.e.c=g),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||zt[14],n.cellDates?(d.t="d",d.w=Fi(d.z,is(d.v))):(d.t="n",d.v=is(d.v),d.w=Fi(d.z,d.v))):d.t="s";if(s)a[x]||(a[x]=[]),a[x][g]&&a[x][g].z&&(d.z=a[x][g].z),a[x][g]=d;else{var y=Xt({c:g,r:x});a[y]&&a[y].z&&(d.z=a[y].z),a[y]=d}}}return A.s.c<1e7&&(a["!ref"]=ir(A)),a}function Td(e,t){return OF(null,e,t)}function W7(e){return e.read_shift(4,"i")}function ro(e,t){return t||(t=Xe(4)),t.write_shift(4,e),t}function Ys(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ds(e,t){var r=!1;return t==null&&(r=!0,t=Xe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function $7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function z7(e,t){return t||(t=Xe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Cb(e,t){var r=e.l,n=e.read_shift(1),s=Ys(e),a=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push($7(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function X7(e,t){var r=!1;return t==null&&(r=!0,t=Xe(15+4*e.t.length)),t.write_shift(1,0),ds(e.t,t),r?t.slice(0,t.l):t}var Y7=Cb;function J7(e,t){var r=!1;return t==null&&(r=!0,t=Xe(23+4*e.t.length)),t.write_shift(1,1),ds(e.t,t),t.write_shift(4,1),z7({},t),r?t.slice(0,t.l):t}function Ii(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function VA(e,t){return t==null&&(t=Xe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function GA(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function WA(e,t){return t==null&&(t=Xe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Z7=Ys,RF=ds;function Nb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function wg(e,t){var r=!1;return t==null&&(r=!0,t=Xe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var eR=Ys,cw=Nb,Sb=wg;function kb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?yg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):cA(t,0)>>2;return r?s/100:s}function QF(e,t){t==null&&(t=Xe(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function MF(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function tR(e,t){return t||(t=Xe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var $A=MF,Id=tR;function Gs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function DA(e,t){return(t||Xe(8)).write_shift(8,e,"f")}function rR(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var A=yA[s];A&&(t.rgb=Kf(A));break;case 2:t.rgb=Kf([o,l,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function bg(e,t){if(t||(t=Xe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function nR(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function sR(e,t){t||(t=Xe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function HF(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function aR(e){return HF(e,1)}function iR(e){return HF(e,2)}var Eb=2,ba=3,Bp=11,u4=12,_g=19,Cp=64,oR=65,lR=71,cR=4108,AR=4126,ls=80,KF=81,uR=[ls,KF],Aw={1:{n:"CodePage",t:Eb},2:{n:"Category",t:ls},3:{n:"PresentationFormat",t:ls},4:{n:"ByteCount",t:ba},5:{n:"LineCount",t:ba},6:{n:"ParagraphCount",t:ba},7:{n:"SlideCount",t:ba},8:{n:"NoteCount",t:ba},9:{n:"HiddenCount",t:ba},10:{n:"MultimediaClipCount",t:ba},11:{n:"ScaleCrop",t:Bp},12:{n:"HeadingPairs",t:cR},13:{n:"TitlesOfParts",t:AR},14:{n:"Manager",t:ls},15:{n:"Company",t:ls},16:{n:"LinksUpToDate",t:Bp},17:{n:"CharacterCount",t:ba},19:{n:"SharedDoc",t:Bp},22:{n:"HyperlinksChanged",t:Bp},23:{n:"AppVersion",t:ba,p:"version"},24:{n:"DigSig",t:oR},26:{n:"ContentType",t:ls},27:{n:"ContentStatus",t:ls},28:{n:"Language",t:ls},29:{n:"Version",t:ls},255:{},2147483648:{n:"Locale",t:_g},2147483651:{n:"Behavior",t:_g},1919054434:{}},uw={1:{n:"CodePage",t:Eb},2:{n:"Title",t:ls},3:{n:"Subject",t:ls},4:{n:"Author",t:ls},5:{n:"Keywords",t:ls},6:{n:"Comments",t:ls},7:{n:"Template",t:ls},8:{n:"LastAuthor",t:ls},9:{n:"RevNumber",t:ls},10:{n:"EditTime",t:Cp},11:{n:"LastPrinted",t:Cp},12:{n:"CreatedDate",t:Cp},13:{n:"ModifiedDate",t:Cp},14:{n:"PageCount",t:ba},15:{n:"WordCount",t:ba},16:{n:"CharCount",t:ba},17:{n:"Thumbnail",t:lR},18:{n:"Application",t:ls},19:{n:"DocSecurity",t:ba},255:{},2147483648:{n:"Locale",t:_g},2147483651:{n:"Behavior",t:_g},1919054434:{}},d4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},dR=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function fR(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var hR=fR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yA=tn(hR),Sl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},dw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Np={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Fb(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pR(e){var t=Fb();if(!e||!e.match)return t;var r={};if((e.match(ea)||[]).forEach(function(n){var s=Yt(n);switch(s[0].replace(C7,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[dw[s.ContentType]]!==void 0&&t[dw[s.ContentType]].push(s.PartName);break}}),t.xmlns!==ns.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function VF(e,t){var r=p7(dw),n=[],s;n[n.length]=Un,n[n.length]=vt("Types",null,{xmlns:ns.CT,"xmlns:xsd":ns.xsd,"xmlns:xsi":ns.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return vt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=vt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Np[c][t.bookType]||Np[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(A){n[n.length]=vt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:Np[c][t.bookType]||Np[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(A){n[n.length]=vt("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:r[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var dr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Hf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function rf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ea)||[]).forEach(function(s){var a=Yt(s);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:U0(a.Target,t);r[l]=o,n[a.Id]=o}}),r["!id"]=n,r}function sd(e){var t=[Un,vt("Relationships",null,{xmlns:ns.RELS})];return wn(e["!id"]).forEach(function(r){t[t.length]=vt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ur(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[dr.HLINK,dr.XPATH,dr.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var mR="application/vnd.oasis.opendocument.spreadsheet";function gR(e,t){for(var r=yb(e),n,s;n=Mf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Yt(n[0],!1),s.path=="/"&&s.type!==mR)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function xR(e){var t=[Un];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function f4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function vR(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function yR(e){var t=[Un];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(f4(e[r][0],e[r][1])),t.push(vR("",e[r][0]));return t.push(f4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function GF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+pg.version+"</meta:generator></office:meta></office:document-meta>"}var Si=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],wR=function(){for(var e=new Array(Si.length),t=0;t<Si.length;++t){var r=Si[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function WF(e){var t={};e=Rr(e);for(var r=0;r<Si.length;++r){var n=Si[r],s=e.match(wR[r]);s!=null&&s.length>0&&(t[n[1]]=br(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=en(t[n[1]]))}return t}function V1(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Dr(t),n[n.length]=r?vt(e,t,r):Bs(e,t))}function $F(e,t){var r=t||{},n=[Un,vt("cp:coreProperties",null,{"xmlns:cp":ns.CORE_PROPS,"xmlns:dc":ns.dc,"xmlns:dcterms":ns.dcterms,"xmlns:dcmitype":ns.dcmitype,"xmlns:xsi":ns.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&V1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:lw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&V1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:lw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Si.length;++a){var o=Si[a],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&V1(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var wA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],zF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function XF(e,t,r,n){var s=[];if(typeof e=="string")s=n4(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(u){return{v:u}}));var o=typeof t=="string"?n4(t,n).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var A=0;A!==s.length;A+=2){switch(c=+s[A+1].v,s[A].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function bR(e,t,r){var n={};return t||(t={}),e=Rr(e),wA.forEach(function(s){var a=(e.match(Rf(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=br(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&XF(n.HeadingPairs,n.TitlesOfParts,t,r),t}function YF(e){var t=[],r=vt;return e||(e={}),e.Application="SheetJS",t[t.length]=Un,t[t.length]=vt("Properties",null,{xmlns:ns.EXT_PROPS,"xmlns:vt":ns.vt}),wA.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Dr(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Dr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var _R=/<[^>]+>[^<]*/g;function BR(e,t){var r={},n="",s=e.match(_R);if(s)for(var a=0;a!=s.length;++a){var o=s[a],l=Yt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=br(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),A=c[0].slice(4),u=c[1];switch(A){case"lpstr":case"bstr":case"lpwstr":r[n]=br(u);break;case"bool":r[n]=Yr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=en(u);break;case"cy":case"error":r[n]=br(u);break;default:if(A.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,A,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function JF(e){var t=[Un,vt("Properties",null,{xmlns:ns.CUST_PROPS,"xmlns:vt":ns.vt})];if(!e)return t.join("");var r=1;return wn(e).forEach(function(s){++r,t[t.length]=vt("property",I7(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Dr(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},G1;function CR(e,t,r){G1||(G1=lx(fw)),t=G1[t]||t,e[t]=r}function NR(e,t){var r=[];return wn(fw).map(function(n){for(var s=0;s<Si.length;++s)if(Si[s][1]==n)return Si[s];for(s=0;s<wA.length;++s)if(wA[s][1]==n)return wA[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Bs(fw[n[1]]||n[1],s))}}),vt("DocumentProperties",r.join(""),{xmlns:Wa.o})}function SR(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&wn(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<Si.length;++o)if(a==Si[o][1])return;for(o=0;o<wA.length;++o)if(a==wA[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(vt(ZB(a),l,{"dt:dt":c}))}}),t&&wn(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(vt(ZB(a),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Wa.o+'">'+s.join("")+"</"+n+">"}function jb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kR(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=Xe(8);return o.write_shift(4,n),o.write_shift(4,s),o}function ZF(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function ej(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function tj(e,t,r){return t===31?ej(e):ZF(e,t,r)}function hw(e,t,r){return tj(e,t,r===!1?0:4)}function ER(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return tj(e,t,0)}function FR(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(fa,""),e.l-s&2&&(e.l+=2)}return r}function jR(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(fa,"");return r}function TR(e){var t=e.l,r=Bg(e,KF);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Bg(e,ba);return[r,n]}function IR(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(TR(e));return r}function h4(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(fa,"").replace(I0,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function rj(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function UR(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Bg(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==u4&&n!==t&&uR.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===u4?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return ZF(e,n,4).replace(fa,"");case 31:return ej(e);case 64:return jb(e);case 65:return rj(e);case 71:return UR(e);case 80:return hw(e,n,!a.raw).replace(fa,"");case 81:return ER(e,n).replace(fa,"");case 4108:return IR(e);case 4126:case 4127:return n==4127?FR(e):jR(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function p4(e,t){var r=Xe(4),n=Xe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Xe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=kR(t);break;case 31:case 80:for(n=Xe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return us([r,n])}function m4(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0,l=0,c=-1,A={};for(o=0;o!=s;++o){var u=e.read_shift(4),f=e.read_shift(4);a[o]=[u,f+r]}a.sort(function(p,b){return p[1]-b[1]});var h={};for(o=0;o!=s;++o){if(e.l!==a[o][1]){var d=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(d=!1,e.l=a[o][1]),d)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[a[o][0]];if(h[x.n]=Bg(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xi(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(a[o][0]===1){if(l=h.CodePage=Bg(e,Eb),Xi(l),c!==-1){var g=e.l;e.l=a[c][1],A=h4(e,l),e.l=g}}else if(a[o][0]===0){if(l===0){c=o,e.l=a[o+1][1];continue}A=h4(e,l)}else{var y=A[a[o][0]],m;switch(e[e.l]){case 65:e.l+=4,m=rj(e);break;case 30:e.l+=4,m=hw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,m=hw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=Sn(e,4);break;case 64:e.l+=4,m=en(jb(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=m}}return e.l=r+n,h}var nj=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function LR(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function g4(e,t,r){var n=Xe(8),s=[],a=[],o=8,l=0,c=Xe(8),A=Xe(8);if(c.write_shift(4,2),c.write_shift(4,1200),A.write_shift(4,1),a.push(c),s.push(A),o+=8+c.length,!t){A=Xe(8),A.write_shift(4,0),s.unshift(A);var u=[Xe(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=Xe(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=us(u),a.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(nj.indexOf(e[l][0])>-1||zF.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],d=0;if(t){d=+t[e[l][0]];var x=r[d];if(x.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=p4(x.t,h)}else{var y=LR(h);y==-1&&(y=31,h=String(h)),c=p4(y,h)}a.push(c),A=Xe(8),A.write_shift(4,t?d:2+l),s.push(A),o+=8+c.length}var m=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,m),m+=a[l].length;return n.write_shift(4,o),n.write_shift(4,a.length),us([n].concat(s).concat(a))}function x4(e,t,r){var n=e.content;if(!n)return{};_s(n,0);var s,a,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var A=n.read_shift(4),u=n.read_shift(16);if(u!==Gt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=m4(n,t),h={SystemIdentifier:A};for(var d in f)h[d]=f[d];if(h.FMTID=a,s===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=m4(n,null)}catch{}for(d in x)h[d]=x[d];return h.FMTID=[a,o],h}function v4(e,t,r,n,s,a){var o=Xe(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Gt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=g4(e,r,n);if(l.push(c),s){var A=g4(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+c.length),l.push(A)}return us(l)}function Gl(e,t){return e.read_shift(t),null}function DR(e,t){t||(t=Xe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function PR(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Sn(e,t){return e.read_shift(t)===1}function Aa(e,t){return t||(t=Xe(2)),t.write_shift(2,+!!e),t}function Hn(e){return e.read_shift(2,"u")}function vi(e,t){return t||(t=Xe(2)),t.write_shift(2,e),t}function sj(e,t){return PR(e,t,Hn)}function OR(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function aj(e,t,r){return r||(r=Xe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function uh(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function RR(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var A=a==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,A);return s&&(e.l+=4*o),n&&(e.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function QR(e){var t=e.t||"",r=Xe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Xe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return us(s)}function PA(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function dh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):PA(e,n,r)}function zA(e,t,r){if(r.biff>5)return dh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ij(e,t,r){return r||(r=Xe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function MR(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function HR(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(fa,"");return n&&(e.l+=24),s}function KR(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(fa,"");return r+o}function qR(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return HR(e);case"0303000000000000c000000000000046":return KR(e);default:throw new Error("Unsupported Moniker "+r)}}function Sp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(fa,""):"";return r}function y4(e,t){t||(t=Xe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function VR(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,o,l,c,A="",u,f;s&16&&(a=Sp(e,r-e.l)),s&128&&(o=Sp(e,r-e.l)),(s&257)===257&&(l=Sp(e,r-e.l)),(s&257)===1&&(c=qR(e,r-e.l)),s&8&&(A=Sp(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(f=jb(e)),e.l=r;var h=o||l||c||"";h&&A&&(h+="#"+A),h||(h="#"+A),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),a&&(d.Tooltip=a),d}function GR(e){var t=Xe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)n=n.slice(1),y4(n,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&y4(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function oj(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function lj(e,t){var r=oj(e);return r[3]=0,r}function Lo(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function OA(e,t,r,n){return n||(n=Xe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function WR(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function $R(e,t,r){return t===0?"":zA(e,t,r)}function zR(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,a,o]}function cj(e){var t=e.read_shift(2),r=kb(e);return[t,r]}function XR(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=uh(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function ux(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Aj(e,t){return t||(t=Xe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function uj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var YR=uj;function dj(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function JR(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ZR(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ls(e){e.l+=2,e.l+=e.read_shift(2)}var eQ={0:Ls,4:Ls,5:Ls,6:Ls,7:ZR,8:Ls,9:Ls,10:Ls,11:Ls,12:Ls,13:JR,14:Ls,15:Ls,16:Ls,17:Ls,18:Ls,19:Ls,20:Ls,21:dj};function tQ(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(eQ[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function kp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Tb(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Xe(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function rQ(e,t){return t===0||e.read_shift(2),1200}function nQ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=zA(e,0,r);return e.read_shift(t+n-e.l),s}function sQ(e,t){var r=!t||t.biff==8,n=Xe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function aQ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function iQ(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=uh(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:a,name:o}}function oQ(e,t){var r=!t||t.biff>=8?2:1,n=Xe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function lQ(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0;o!=s&&e.l<r;++o)a.push(RR(e));return a.Count=n,a.Unique=s,a}function cQ(e,t){var r=Xe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=QR(e[s]);var a=us([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function AQ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function uQ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function dQ(e){var t=WR(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function fQ(e){return e.read_shift(2),e.read_shift(4)}function w4(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function hQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),A=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:o,FirstTab:l,Selected:c,TabRatio:A}}function pQ(){var e=Xe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function mQ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function gQ(e){var t=Xe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function xQ(){}function vQ(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=uh(e,0,r),n}function yQ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=Xe(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function wQ(e){var t=Lo(e);return t.isst=e.read_shift(4),t}function bQ(e,t,r,n){var s=Xe(10);return OA(e,t,n,s),s.write_shift(4,r),s}function _Q(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Lo(e);r.biff==2&&e.l++;var a=dh(e,n-e.l,r);return s.val=a,s}function BQ(e,t,r,n,s){var a=!s||s.biff==8,o=Xe(8+ +a+(1+a)*r.length);return OA(e,t,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function CQ(e,t,r){var n=e.read_shift(2),s=zA(e,0,r);return[n,s]}function NQ(e,t,r,n){var s=r&&r.biff==5;n||(n=Xe(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var SQ=zA;function b4(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:l},e:{r:o,c}}}function kQ(e,t){var r=t.biff==8||!t.biff?4:2,n=Xe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function EQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=cj(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function FQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(cj(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:a}}function jQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:a}}function TQ(e,t,r,n){var s={},a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=dR[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function IQ(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=TQ(e,t,n.fStyle,r),n}function _4(e,t,r,n){var s=r&&r.biff==5;n||(n=Xe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function UQ(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function LQ(e){var t=Xe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function B4(e,t,r){var n=Lo(e);(r.biff==2||t==9)&&++e.l;var s=OR(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function DQ(e,t,r,n,s,a){var o=Xe(8);return OA(e,t,n,o),aj(r,a,o),o}function PQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Lo(e),s=Gs(e);return n.val=s,n}function OQ(e,t,r,n){var s=Xe(14);return OA(e,t,n,s),DA(r,s),s}var C4=$R;function RQ(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=PA(e,a),l=[];n>e.l;)l.push(dh(e));return[a,s,o,l]}function N4(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=XR(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var QQ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function S4(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var A=PA(e,o,r);s&32&&(A=QQ[A.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||l===0||!(u>0)?[]:tq(e,u,r,l);return{chKey:a,Name:A,itab:c,rgce:f}}function fj(e,t,r){if(r.biff<8)return MQ(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(zR(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function MQ(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=uh(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function HQ(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=PA(e,n,r),o=PA(e,s,r);return[a,o]}function KQ(e,t,r){var n=uj(e);e.l++;var s=e.read_shift(1);return t-=8,[rq(e,t,r),s,n]}function k4(e,t,r){var n=YR(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,ZK(e,t,r)]}function qQ(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function VQ(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=zA(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,o,a]}}function GQ(e,t,r){return VQ(e,t,r)}function WQ(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ux(e));return r}function $Q(e){var t=Xe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Aj(e[r],t);return t}function zQ(e,t,r){if(r&&r.biff<8)return YQ(e,t,r);var n=dj(e),s=tQ(e,t-22,n[1]);return{cmo:n,ft:s}}var XQ={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function YQ(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((XQ[n]||Zs)(e,t,r)),{cmo:[s,n,a],ft:o}}function JQ(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=MR(e,6,r);var l=e.read_shift(2);e.read_shift(2),Hn(e,2);var c=e.read_shift(2);e.l+=c;for(var A=1;A<e.lens.length-1;++A){if(e.l-n!=e.lens[A])throw new Error("TxO: bad continue record");var u=e[e.l],f=PA(e,e.lens[A+1]-e.lens[A]-1);if(s+=f,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function ZQ(e,t){var r=ux(e);e.l+=16;var n=VR(e,t-24);return[r,n]}function eM(e){var t=Xe(24),r=dn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return us([t,GR(e[1])])}function tM(e,t){e.read_shift(2);var r=ux(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(fa,""),[r,n]}function rM(e){var t=e[1].Tooltip,r=Xe(10+2*(t.length+1));r.write_shift(2,2048);var n=dn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function nM(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=d4[r]||r,r=e.read_shift(2),t[1]=d4[r]||r,t}function sM(e){return e||(e=Xe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function aM(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(lj(e));return r}function iM(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(lj(e));return r}function oM(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function hj(e,t,r){if(!r.cellStyles)return Zs(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var A={s,e:a,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(A.level=c>>8&7),A}function lM(e,t){var r=Xe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function cM(e,t){var r={};return t<32||(e.l+=16,r.header=Gs(e),r.footer=Gs(e),e.l+=2),r}function AM(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function uM(e){for(var t=Xe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var dM=Lo,fM=sj,hM=dh;function pM(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function mM(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Lo(e);++e.l;var s=zA(e,t-7,r);return n.t="str",n.val=s,n}function gM(e){var t=Lo(e);++e.l;var r=Gs(e);return t.t="n",t.val=r,t}function xM(e,t,r){var n=Xe(15);return mh(n,e,t),n.write_shift(8,r,"f"),n}function vM(e){var t=Lo(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function yM(e,t,r){var n=Xe(9);return mh(n,e,t),n.write_shift(2,r),n}function wM(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function bM(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function _M(e,t,r){var n=e.l+t,s=Lo(e),a=e.read_shift(2),o=PA(e,a,r);return e.l=n,s.t="str",s.val=o,s}var BM=[2,3,48,49,131,139,140,245],pw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var A=[],u=Cc(1);switch(c.type){case"base64":u=Ya(si(l));break;case"binary":u=Ya(l);break;case"buffer":case"array":u=l;break}_s(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=u.read_shift(2)),u.l+=3,f!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=u.read_shift(2));var m=u.read_shift(2),p=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(p=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var b=[],v={},C=Math.min(u.length,f==2?521:y-10-(d?264:0)),k=x?32:11;u.l<C&&u[u.l]!=13;)switch(v={},v.name=Df.utils.decode(p,u.slice(u.l,u.l+k)).replace(/[\u0000\r\n].*$/g,""),u.l+=k,v.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(v.offset=u.read_shift(4)),v.len=u.read_shift(1),f==2&&(v.offset=u.read_shift(2)),v.dec=u.read_shift(1),v.name.length&&b.push(v),f!=2&&(u.l+=x?13:14),v.type){case"B":(!d||v.len!=8)&&c.WTF&&console.log("Skipping "+v.name+":"+v.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+v.name+":"+v.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+v.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var S=0,I=0;for(A[0]=[],I=0;I!=b.length;++I)A[0][I]=b[I].name;for(;g-- >0;){if(u[u.l]===42){u.l+=m;continue}for(++u.l,A[++S]=[],I=0,I=0;I!=b.length;++I){var N=u.slice(u.l,u.l+b[I].len);u.l+=b[I].len,_s(N,0);var Q=Df.utils.decode(p,N);switch(b[I].type){case"C":Q.trim().length&&(A[S][I]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?A[S][I]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):A[S][I]=Q;break;case"F":A[S][I]=parseFloat(Q.trim());break;case"+":case"I":A[S][I]=x?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":A[S][I]=!0;break;case"N":case"F":A[S][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));A[S][I]="##MEMO##"+(x?parseInt(Q.trim(),10):N.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(A[S][I]=+Q||0);break;case"@":A[S][I]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":A[S][I]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":A[S][I]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[S][I]=-N.read_shift(-8,"f");break;case"B":if(d&&b[I].len==8){A[S][I]=N.read_shift(8,"f");break}case"G":case"P":N.l+=b[I].len;break;case"0":if(b[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[I].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(A=A.slice(0,c.sheetRows)),c.DBF=b,A}function n(l,c){var A=c||{};A.dateNF||(A.dateNF="yyyymmdd");var u=Td(r(l,A),A);return u["!cols"]=A.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete A.DBF,u}function s(l,c){try{return Pc(n(l,c),c)}catch(A){if(c&&c.WTF)throw A}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var A=c||{};if(+A.codepage>=0&&Xi(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ea(),f=Sg(l,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),x=l["!cols"]||[],g=0,y=0,m=0,p=1;for(g=0;g<h.length;++g){if(((x[g]||{}).DBF||{}).name){h[g]=x[g].DBF.name,++m;continue}if(h[g]!=null){if(++m,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var b=_r(l["!ref"]),v=[],C=[],k=[];for(g=0;g<=b.e.c-b.s.c;++g){var S="",I="",N=0,Q=[];for(y=0;y<d.length;++y)d[y][g]!=null&&Q.push(d[y][g]);if(Q.length==0||h[g]==null){v[g]="?";continue}for(y=0;y<Q.length;++y){switch(typeof Q[y]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=Q[y]instanceof Date?"D":"C";break;default:I="C"}N=Math.max(N,String(Q[y]).length),S=S&&S!=I?"C":I}N>250&&(N=250),I=((x[g]||{}).DBF||{}).type,I=="C"&&x[g].DBF.len>N&&(N=x[g].DBF.len),S=="B"&&I=="N"&&(S="N",k[g]=x[g].DBF.dec,N=x[g].DBF.len),C[g]=S=="C"||I=="N"?N:a[S]||0,p+=C[g],v[g]=S}var L=u.next(32);for(L.write_shift(4,318902576),L.write_shift(4,d.length),L.write_shift(2,296+32*m),L.write_shift(2,p),g=0;g<4;++g)L.write_shift(4,0);for(L.write_shift(4,0|(+t[nF]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var T=u.next(32),P=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,P,"sbcs"),T.write_shift(1,v[g]=="?"?"C":v[g],"sbcs"),T.write_shift(4,y),T.write_shift(1,C[g]||a[v[g]]||0),T.write_shift(1,k[g]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),y+=C[g]||a[v[g]]||0}var R=u.next(264);for(R.write_shift(4,13),g=0;g<65;++g)R.write_shift(4,0);for(g=0;g<d.length;++g){var z=u.next(p);for(z.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(v[y]){case"L":z.write_shift(1,d[g][y]==null?63:d[g][y]?84:70);break;case"B":z.write_shift(8,d[g][y]||0,"f");break;case"N":var q="0";for(typeof d[g][y]=="number"&&(q=d[g][y].toFixed(k[y]||0)),m=0;m<C[y]-q.length;++m)z.write_shift(1,32);z.write_shift(1,q,"sbcs");break;case"D":d[g][y]?(z.write_shift(4,("0000"+d[g][y].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(d[g][y].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+d[g][y].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var M=String(d[g][y]!=null?d[g][y]:"").slice(0,C[y]);for(z.write_shift(1,M,"sbcs"),m=0;m<C[y]-M.length;++m)z.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),pj=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var x=e[d];return typeof x=="number"?RB(x):x},n=function(h,d,x){var g=d.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?h:RB(g)};e["|"]=254;function s(h,d){switch(d.type){case"base64":return a(si(h),d);case"binary":return a(h,d);case"buffer":return a(ur&&Buffer.isBuffer(h)?h.toString("binary"):Dc(h),d);case"array":return a(LA(h),d)}throw new Error("Unrecognized type "+d.type)}function a(h,d){var x=h.split(/[\n\r]+/),g=-1,y=-1,m=0,p=0,b=[],v=[],C=null,k={},S=[],I=[],N=[],Q=0,L;for(+d.codepage>=0&&Xi(+d.codepage);m!==x.length;++m){Q=0;var T=x[m].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),P=T.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),R=P[0],z;if(T.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&v.push(T.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,M=!1,V=!1,H=!1,se=-1,ce=-1;for(p=1;p<P.length;++p)switch(P[p].charAt(0)){case"A":break;case"X":y=parseInt(P[p].slice(1))-1,M=!0;break;case"Y":for(g=parseInt(P[p].slice(1))-1,M||(y=0),L=b.length;L<=g;++L)b[L]=[];break;case"K":z=P[p].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(to(z))?isNaN(yd(z).getDate())||(z=en(z)):(z=to(z),C!==null&&Fd(C)&&(z=Ax(z))),q=!0;break;case"E":H=!0;var B=ad(P[p].slice(1),{r:g,c:y});b[g][y]=[b[g][y],B];break;case"S":V=!0,b[g][y]=[b[g][y],"S5S"];break;case"G":break;case"R":se=parseInt(P[p].slice(1))-1;break;case"C":ce=parseInt(P[p].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}if(q&&(b[g][y]&&b[g][y].length==2?b[g][y][0]=z:b[g][y]=z,C=null),V){if(H)throw new Error("SYLK shared formula cannot have own formula");var U=se>-1&&b[se][ce];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");b[g][y][1]=Ij(U[1],{r:g-se,c:y-ce})}break;case"F":var F=0;for(p=1;p<P.length;++p)switch(P[p].charAt(0)){case"X":y=parseInt(P[p].slice(1))-1,++F;break;case"Y":for(g=parseInt(P[p].slice(1))-1,L=b.length;L<=g;++L)b[L]=[];break;case"M":Q=parseInt(P[p].slice(1))/20;break;case"F":break;case"G":break;case"P":C=v[parseInt(P[p].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=P[p].slice(1).split(" "),L=parseInt(N[0],10);L<=parseInt(N[1],10);++L)Q=parseInt(N[2],10),I[L-1]=Q===0?{hidden:!0}:{wch:Q},Nc(I[L-1]);break;case"C":y=parseInt(P[p].slice(1))-1,I[y]||(I[y]={});break;case"R":g=parseInt(P[p].slice(1))-1,S[g]||(S[g]={}),Q>0?(S[g].hpt=Q,S[g].hpx=bd(Q)):Q===0&&(S[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}F<1&&(C=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}}return S.length>0&&(k["!rows"]=S),I.length>0&&(k["!cols"]=I),d&&d.sheetRows&&(b=b.slice(0,d.sheetRows)),[b,k]}function o(h,d){var x=s(h,d),g=x[0],y=x[1],m=Td(g,d);return wn(y).forEach(function(p){m[p]=y[p]}),m}function l(h,d){return Pc(o(h,d),d)}function c(h,d,x,g){var y="C;Y"+(x+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+Ob(h.f,{r:x,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function A(h,d){d.forEach(function(x,g){var y="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=qf(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Vf(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function u(h,d){d.forEach(function(x,g){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*Gf(x.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function f(h,d){var x=["ID;PWXL;N;E"],g=[],y=_r(h["!ref"]),m,p=Array.isArray(h),b=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&A(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var v=y.s.r;v<=y.e.r;++v)for(var C=y.s.c;C<=y.e.c;++C){var k=Xt({r:v,c:C});m=p?(h[v]||[])[C]:h[k],!(!m||m.v==null&&(!m.f||m.F))&&g.push(c(m,h,v,C))}return x.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),mj=function(){function e(a,o){switch(o.type){case"base64":return t(si(a),o);case"binary":return t(a,o);case"buffer":return t(ur&&Buffer.isBuffer(a)?a.toString("binary"):Dc(a),o);case"array":return t(LA(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var l=a.split(`
`),c=-1,A=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],A=0;continue}if(!(c<0)){var h=l[u].trim().split(","),d=h[0],x=h[1];++u;for(var g=l[u]||"";(g.match(/["]/g)||[]).length&1&&u<l.length-1;)g+=`
`+l[++u];switch(g=g.trim(),+d){case-1:if(g==="BOT"){f[++c]=[],A=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][A]=!0:g==="FALSE"?f[c][A]=!1:isNaN(to(x))?isNaN(yd(x).getDate())?f[c][A]=x:f[c][A]=en(x):f[c][A]=to(x),++A;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][A++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(a,o){return Td(e(a,o),o)}function n(a,o){return Pc(r(a,o),o)}var s=function(){var a=function(c,A,u,f,h){c.push(A),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,A,u,f){c.push(A+","+u),c.push(A==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var A=[],u=_r(c["!ref"]),f,h=Array.isArray(c);a(A,"TABLE",0,1,"sheetjs"),a(A,"VECTORS",0,u.e.r-u.s.r+1,""),a(A,"TUPLES",0,u.e.c-u.s.c+1,""),a(A,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){o(A,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var g=Xt({r:d,c:x});if(f=h?(c[d]||[])[x]:c[g],!f){o(A,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(A,1,0,"="+f.f):o(A,1,0,""):o(A,0,y,"V");break;case"b":o(A,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(A,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Fi(f.z||zt[14],is(en(f.v)))),o(A,0,f.w,"V");break;default:o(A,1,0,"")}}}o(A,-1,0,"EOD");var m=`\r
`,p=A.join(m);return p}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),gj=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),x=-1,g=-1,y=0,m=[];y!==d.length;++y){var p=d[y].trim().split(":");if(p[0]==="cell"){var b=dn(p[1]);if(m.length<=b.r)for(x=m.length;x<=b.r;++x)m[x]||(m[x]=[]);switch(x=b.r,g=b.c,p[2]){case"t":m[x][g]=e(p[3]);break;case"v":m[x][g]=+p[3];break;case"vtf":var v=p[p.length-1];case"vtc":switch(p[3]){case"nl":m[x][g]=!!+p[4];break;default:m[x][g]=+p[4];break}p[2]=="vtf"&&(m[x][g]=[m[x][g],v])}}}return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}function n(f,h){return Td(r(f,h),h)}function s(f,h){return Pc(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function A(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],x,g="",y=Ta(f["!ref"]),m=Array.isArray(f),p=y.s.r;p<=y.e.r;++p)for(var b=y.s.c;b<=y.e.c;++b)if(g=Xt({r:p,c:b}),x=m?(f[p]||[])[b]:f[g],!(!x||x.v==null||x.t==="z")){switch(d=["cell",g,"t"],x.t){case"s":case"str":d.push(t(x.v));break;case"n":x.f?(d[2]="vtf",d[3]="n",d[4]=x.v,d[5]=t(x.f)):(d[2]="v",d[3]=x.v);break;case"b":d[2]="vt"+(x.f?"f":"c"),d[3]="nl",d[4]=x.v?"1":"0",d[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var v=is(en(x.v));d[2]="vtc",d[3]="nd",d[4]=""+v,d[5]=x.w||Fi(x.z||zt[14],v);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[a,o,l,o,A(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),wd=function(){function e(u,f,h,d,x){x.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(to(u))?isNaN(yd(u).getDate())?f[h][d]=u:f[h][d]=en(u):f[h][d]=to(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var x=u.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var y=10,m=0,p=0;p<=g;++p)m=x[p].indexOf(" "),m==-1?m=x[p].length:m++,y=Math.max(y,m);for(p=0;p<=g;++p){d[p]=[];var b=0;for(e(x[p].slice(0,y).trim(),d,p,b,h),b=1;b<=(x[p].length-y)/10+1;++b)e(x[p].slice(y+(b-1)*10,y+b*10).trim(),d,p,b,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,d=0,x=0;d<u.length;++d)(x=u.charCodeAt(d))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&x.push([f[d],d]);if(!x.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&x.push([f[d],d])}return x.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[x.pop()[1]]||44}function a(u,f){var h=f||{},d="",x=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=s(u.slice(0,1024)):h&&h.FS?d=h.FS:d=s(u.slice(0,1024));var y=0,m=0,p=0,b=0,v=0,C=d.charCodeAt(0),k=!1,S=0,I=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var N=h.dateNF!=null?A7(h.dateNF):null;function Q(){var L=u.slice(b,v),T={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)T.t="z";else if(h.raw)T.t="s",T.v=L;else if(L.trim().length===0)T.t="s",T.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(T.t="s",T.v=L.slice(2,-1).replace(/""/g,'"')):RH(L)?(T.t="n",T.f=L.slice(1)):(T.t="s",T.v=L);else if(L=="TRUE")T.t="b",T.v=!0;else if(L=="FALSE")T.t="b",T.v=!1;else if(!isNaN(p=to(L)))T.t="n",h.cellText!==!1&&(T.w=L),T.v=p;else if(!isNaN(yd(L).getDate())||N&&L.match(N)){T.z=h.dateNF||zt[14];var P=0;N&&L.match(N)&&(L=u7(L,h.dateNF,L.match(N)||[]),P=1),h.cellDates?(T.t="d",T.v=en(L,P)):(T.t="n",T.v=is(en(L,P))),h.cellText!==!1&&(T.w=Fi(T.z,T.v instanceof Date?is(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=L;if(T.t=="z"||(h.dense?(x[y]||(x[y]=[]),x[y][m]=T):x[Xt({c:m,r:y})]=T),b=v+1,I=u.charCodeAt(b),g.e.c<m&&(g.e.c=m),g.e.r<y&&(g.e.r=y),S==C)++m;else if(m=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;v<u.length;++v)switch(S=u.charCodeAt(v)){case 34:I===34&&(k=!k);break;case C:case 10:case 13:if(!k&&Q())break e;break}return v-b>0&&Q(),x["!ref"]=ir(g),x}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,f):Td(t(u,f),f)}function l(u,f){var h="",d=f.type=="string"?[0,0,0,0]:Gb(u,f);switch(f.type){case"base64":h=si(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Df<"u"||(h=ur&&Buffer.isBuffer(u)?u.toString("binary"):Dc(u));break;case"array":h=LA(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Rr(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Rr(h):f.type=="binary"&&typeof Df<"u",h.slice(0,19)=="socialcalc:version:"?gj.to_sheet(f.type=="string"?h:Rr(h),f):o(h,f)}function c(u,f){return Pc(l(u,f),f)}function A(u){for(var f=[],h=_r(u["!ref"]),d,x=Array.isArray(u),g=h.s.r;g<=h.e.r;++g){for(var y=[],m=h.s.c;m<=h.e.c;++m){var p=Xt({r:g,c:m});if(d=x?(u[g]||[])[m]:u[p],!d||d.v==null){y.push("          ");continue}for(var b=(d.w||(wl(d),d.w)||"").slice(0,10);b.length<10;)b+=" ";y.push(b+(m===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:A}}();function CM(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=pj.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return wd.to_workbook(e,t)}}var bA=function(){function e(B,U,F){if(B){_s(B,B.l||0);for(var D=F.Enum||se;B.l<B.length;){var X=B.read_shift(2),K=D[X]||D[65535],ae=B.read_shift(2),he=B.l+ae,Y=K.f&&K.f(B,ae,F);if(B.l=he,U(Y,K,X))return}}}function t(B,U){switch(U.type){case"base64":return r(Ya(si(B)),U);case"binary":return r(Ya(B),U);case"buffer":case"array":return r(B,U)}throw"Unsupported type "+U.type}function r(B,U){if(!B)return B;var F=U||{},D=F.dense?[]:{},X="Sheet1",K="",ae=0,he={},Y=[],Be=[],ee={s:{r:0,c:0},e:{r:0,c:0}},Te=F.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)F.Enum=se,e(B,function(ze,Fe,Re){switch(Re){case 0:F.vers=ze,ze>=4096&&(F.qpro=!0);break;case 6:ee=ze;break;case 204:ze&&(K=ze);break;case 222:K=ze;break;case 15:case 51:F.qpro||(ze[1].v=ze[1].v.slice(1));case 13:case 14:case 16:Re==14&&(ze[2]&112)==112&&(ze[2]&15)>1&&(ze[2]&15)<15&&(ze[1].z=F.dateNF||zt[14],F.cellDates&&(ze[1].t="d",ze[1].v=Ax(ze[1].v))),F.qpro&&ze[3]>ae&&(D["!ref"]=ir(ee),he[X]=D,Y.push(X),D=F.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ae=ze[3],X=K||"Sheet"+(ae+1),K="");var at=F.dense?(D[ze[0].r]||[])[ze[0].c]:D[Xt(ze[0])];if(at){at.t=ze[1].t,at.v=ze[1].v,ze[1].z!=null&&(at.z=ze[1].z),ze[1].f!=null&&(at.f=ze[1].f);break}F.dense?(D[ze[0].r]||(D[ze[0].r]=[]),D[ze[0].r][ze[0].c]=ze[1]):D[Xt(ze[0])]=ze[1];break}},F);else if(B[2]==26||B[2]==14)F.Enum=ce,B[2]==14&&(F.qpro=!0,B.l=0),e(B,function(ze,Fe,Re){switch(Re){case 204:X=ze;break;case 22:ze[1].v=ze[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ze[3]>ae&&(D["!ref"]=ir(ee),he[X]=D,Y.push(X),D=F.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ae=ze[3],X="Sheet"+(ae+1)),Te>0&&ze[0].r>=Te)break;F.dense?(D[ze[0].r]||(D[ze[0].r]=[]),D[ze[0].r][ze[0].c]=ze[1]):D[Xt(ze[0])]=ze[1],ee.e.c<ze[0].c&&(ee.e.c=ze[0].c),ee.e.r<ze[0].r&&(ee.e.r=ze[0].r);break;case 27:ze[14e3]&&(Be[ze[14e3][0]]=ze[14e3][1]);break;case 1537:Be[ze[0]]=ze[1],ze[0]==ae&&(X=ze[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(D["!ref"]=ir(ee),he[K||X]=D,Y.push(K||X),!Be.length)return{SheetNames:Y,Sheets:he};for(var Je={},ie=[],$e=0;$e<Be.length;++$e)he[Y[$e]]?(ie.push(Be[$e]||Y[$e]),Je[Be[$e]]=he[Be[$e]]||he[Y[$e]]):(ie.push(Be[$e]),Je[Be[$e]]={"!ref":"A1"});return{SheetNames:ie,Sheets:Je}}function n(B,U){var F=U||{};if(+F.codepage>=0&&Xi(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Ea(),X=_r(B["!ref"]),K=Array.isArray(B),ae=[];wt(D,0,a(1030)),wt(D,6,c(X));for(var he=Math.min(X.e.r,8191),Y=X.s.r;Y<=he;++Y)for(var Be=In(Y),ee=X.s.c;ee<=X.e.c;++ee){Y===X.s.r&&(ae[ee]=un(ee));var Te=ae[ee]+Be,Je=K?(B[Y]||[])[ee]:B[Te];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?wt(D,13,d(Y,ee,Je.v)):wt(D,14,g(Y,ee,Je.v));else{var ie=wl(Je);wt(D,15,f(Y,ee,ie.slice(0,239)))}}return wt(D,1),D.end()}function s(B,U){var F=U||{};if(+F.codepage>=0&&Xi(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Ea();wt(D,0,o(B));for(var X=0,K=0;X<B.SheetNames.length;++X)(B.Sheets[B.SheetNames[X]]||{})["!ref"]&&wt(D,27,H(B.SheetNames[X],K++));var ae=0;for(X=0;X<B.SheetNames.length;++X){var he=B.Sheets[B.SheetNames[X]];if(!(!he||!he["!ref"])){for(var Y=_r(he["!ref"]),Be=Array.isArray(he),ee=[],Te=Math.min(Y.e.r,8191),Je=Y.s.r;Je<=Te;++Je)for(var ie=In(Je),$e=Y.s.c;$e<=Y.e.c;++$e){Je===Y.s.r&&(ee[$e]=un($e));var ze=ee[$e]+ie,Fe=Be?(he[Je]||[])[$e]:he[ze];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")wt(D,23,Q(Je,$e,ae,Fe.v));else{var Re=wl(Fe);wt(D,22,S(Je,$e,ae,Re.slice(0,239)))}}++ae}}return wt(D,1),D.end()}function a(B){var U=Xe(2);return U.write_shift(2,B),U}function o(B){var U=Xe(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var F=0,D=0,X=0,K=0;K<B.SheetNames.length;++K){var ae=B.SheetNames[K],he=B.Sheets[ae];if(!(!he||!he["!ref"])){++X;var Y=Ta(he["!ref"]);F<Y.e.r&&(F=Y.e.r),D<Y.e.c&&(D=Y.e.c)}}return F>8191&&(F=8191),U.write_shift(2,F),U.write_shift(1,X),U.write_shift(1,D),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function l(B,U,F){var D={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&F.qpro?(D.s.c=B.read_shift(1),B.l++,D.s.r=B.read_shift(2),D.e.c=B.read_shift(1),B.l++,D.e.r=B.read_shift(2),D):(D.s.c=B.read_shift(2),D.s.r=B.read_shift(2),U==12&&F.qpro&&(B.l+=2),D.e.c=B.read_shift(2),D.e.r=B.read_shift(2),U==12&&F.qpro&&(B.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function c(B){var U=Xe(8);return U.write_shift(2,B.s.c),U.write_shift(2,B.s.r),U.write_shift(2,B.e.c),U.write_shift(2,B.e.r),U}function A(B,U,F){var D=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(D[0].c=B.read_shift(1),D[3]=B.read_shift(1),D[0].r=B.read_shift(2),B.l+=2):(D[2]=B.read_shift(1),D[0].c=B.read_shift(2),D[0].r=B.read_shift(2)),D}function u(B,U,F){var D=B.l+U,X=A(B,U,F);if(X[1].t="s",F.vers==20768){B.l++;var K=B.read_shift(1);return X[1].v=B.read_shift(K,"utf8"),X}return F.qpro&&B.l++,X[1].v=B.read_shift(D-B.l,"cstr"),X}function f(B,U,F){var D=Xe(7+F.length);D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,B),D.write_shift(1,39);for(var X=0;X<D.length;++X){var K=F.charCodeAt(X);D.write_shift(1,K>=128?95:K)}return D.write_shift(1,0),D}function h(B,U,F){var D=A(B,U,F);return D[1].v=B.read_shift(2,"i"),D}function d(B,U,F){var D=Xe(7);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,B),D.write_shift(2,F,"i"),D}function x(B,U,F){var D=A(B,U,F);return D[1].v=B.read_shift(8,"f"),D}function g(B,U,F){var D=Xe(13);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,B),D.write_shift(8,F,"f"),D}function y(B,U,F){var D=B.l+U,X=A(B,U,F);if(X[1].v=B.read_shift(8,"f"),F.qpro)B.l=D;else{var K=B.read_shift(2);v(B.slice(B.l,B.l+K),X),B.l+=K}return X}function m(B,U,F){var D=U&32768;return U&=-32769,U=(D?B:0)+(U>=8192?U-16384:U),(D?"":"$")+(F?un(U):In(U))}var p={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function v(B,U){_s(B,0);for(var F=[],D=0,X="",K="",ae="",he="";B.l<B.length;){var Y=B[B.l++];switch(Y){case 0:F.push(B.read_shift(8,"f"));break;case 1:K=m(U[0].c,B.read_shift(2),!0),X=m(U[0].r,B.read_shift(2),!1),F.push(K+X);break;case 2:{var Be=m(U[0].c,B.read_shift(2),!0),ee=m(U[0].r,B.read_shift(2),!1);K=m(U[0].c,B.read_shift(2),!0),X=m(U[0].r,B.read_shift(2),!1),F.push(Be+ee+":"+K+X)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(B.read_shift(2));break;case 6:{for(var Te="";Y=B[B.l++];)Te+=String.fromCharCode(Y);F.push('"'+Te.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:he=F.pop(),ae=F.pop(),F.push(["AND","OR"][Y-20]+"("+ae+","+he+")");break;default:if(Y<32&&b[Y])he=F.pop(),ae=F.pop(),F.push(ae+b[Y]+he);else if(p[Y]){if(D=p[Y][1],D==69&&(D=B[B.l++]),D>F.length){console.error("WK1 bad formula parse 0x"+Y.toString(16)+":|"+F.join("|")+"|");return}var Je=F.slice(-D);F.length-=D,F.push(p[Y][0]+"("+Je.join(",")+")")}else return Y<=7?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=24?console.error("WK1 unsupported op "+Y.toString(16)):Y<=30?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=115?console.error("WK1 unsupported function opcode "+Y.toString(16)):console.error("WK1 unrecognized opcode "+Y.toString(16))}}F.length==1?U[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function C(B){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=B.read_shift(2),U[3]=B[B.l++],U[0].c=B[B.l++],U}function k(B,U){var F=C(B);return F[1].t="s",F[1].v=B.read_shift(U-4,"cstr"),F}function S(B,U,F,D){var X=Xe(6+D.length);X.write_shift(2,B),X.write_shift(1,F),X.write_shift(1,U),X.write_shift(1,39);for(var K=0;K<D.length;++K){var ae=D.charCodeAt(K);X.write_shift(1,ae>=128?95:ae)}return X.write_shift(1,0),X}function I(B,U){var F=C(B);F[1].v=B.read_shift(2);var D=F[1].v>>1;if(F[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return F[1].v=D,F}function N(B,U){var F=C(B),D=B.read_shift(4),X=B.read_shift(4),K=B.read_shift(2);if(K==65535)return D===0&&X===3221225472?(F[1].t="e",F[1].v=15):D===0&&X===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var ae=K&32768;return K=(K&32767)-16446,F[1].v=(1-ae*2)*(X*Math.pow(2,K+32)+D*Math.pow(2,K)),F}function Q(B,U,F,D){var X=Xe(14);if(X.write_shift(2,B),X.write_shift(1,F),X.write_shift(1,U),D==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var K=0,ae=0,he=0,Y=0;return D<0&&(K=1,D=-D),ae=Math.log2(D)|0,D/=Math.pow(2,ae-31),Y=D>>>0,Y&2147483648||(D/=2,++ae,Y=D>>>0),D-=Y,Y|=2147483648,Y>>>=0,D*=Math.pow(2,32),he=D>>>0,X.write_shift(4,he),X.write_shift(4,Y),ae+=16383+(K?32768:0),X.write_shift(2,ae),X}function L(B,U){var F=N(B);return B.l+=U-14,F}function T(B,U){var F=C(B),D=B.read_shift(4);return F[1].v=D>>6,F}function P(B,U){var F=C(B),D=B.read_shift(8,"f");return F[1].v=D,F}function R(B,U){var F=P(B);return B.l+=U-10,F}function z(B,U){return B[B.l+U-1]==0?B.read_shift(U,"cstr"):""}function q(B,U){var F=B[B.l++];F>U-1&&(F=U-1);for(var D="";D.length<F;)D+=String.fromCharCode(B[B.l++]);return D}function M(B,U,F){if(!(!F.qpro||U<21)){var D=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var X=B.read_shift(U-21,"cstr");return[D,X]}}function V(B,U){for(var F={},D=B.l+U;B.l<D;){var X=B.read_shift(2);if(X==14e3){for(F[X]=[0,""],F[X][0]=B.read_shift(2);B[B.l];)F[X][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return F}function H(B,U){var F=Xe(5+B.length);F.write_shift(2,14e3),F.write_shift(2,U);for(var D=0;D<B.length;++D){var X=B.charCodeAt(D);F[F.l++]=X>127?95:X}return F[F.l++]=0,F}var se={0:{n:"BOF",f:Hn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:M},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function NM(e){var t={},r=e.match(ea),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Yt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=cb[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var SM=function(){var e=Rf("t"),t=Rf("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:br(o[1])},c=a.match(t);return c&&(l.s=NM(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),kM=function(){var t=/(\r\n|\n)/g;function r(s,a,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),o.push("</b>")),s.i&&(a.push("<i>"),o.push("</i>")),s.strike&&(a.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),EM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,FM=/<(?:\w+:)?r>/,jM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ib(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=br(Rr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Rr(e),r&&(n.h=vb(n.t))):e.match(FM)&&(n.r=Rr(e),n.t=br(Rr((e.replace(jM,"").match(EM)||[]).join("").replace(ea,""))),r&&(n.h=kM(SM(n.r)))),n):{t:""}}var TM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,IM=/<(?:\w+:)?(?:si|sstItem)>/g,UM=/<\/(?:\w+:)?(?:si|sstItem)>/;function LM(e,t){var r=[],n="";if(!e)return r;var s=e.match(TM);if(s){n=s[2].replace(IM,"").split(UM);for(var a=0;a!=n.length;++a){var o=Ib(n[a].trim(),t);o!=null&&(r[r.length]=o)}s=Yt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var DM=/^\s|\s$|[\t\n\r]/;function xj(e,t){if(!t.bookSST)return"";var r=[Un];r[r.length]=vt("sst",null,{xmlns:qA[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(DM)&&(a+=' xml:space="preserve"'),a+=">"+Dr(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function PM(e){return[e.read_shift(4),e.read_shift(4)]}function OM(e,t){var r=[],n=!1;return Nl(e,function(a,o,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function RM(e,t){return t||(t=Xe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var QM=X7;function MM(e){var t=Ea();ot(t,159,RM(e));for(var r=0;r<e.length;++r)ot(t,19,QM(e[r]));return ot(t,160),t.end()}function vj(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function pl(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function HM(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=pl(e,4),t.U=pl(e,4),t.W=pl(e,4),t}function KM(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function qM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(KM(e));return t}function VM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function GM(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=pl(e,4),t.U=pl(e,4),t.W=pl(e,4),t}function WM(e){var t=GM(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function yj(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function wj(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function $M(e){var t=pl(e);switch(t.Minor){case 2:return[t.Minor,zM(e)];case 3:return[t.Minor,XM()];case 4:return[t.Minor,YM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function zM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=yj(e,r),s=wj(e,e.length-e.l);return{t:"Std",h:n,v:s}}function XM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function YM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ea,function(a){var o=Yt(a);switch(Uo(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function JM(e,t){var r={},n=r.EncryptionVersionInfo=pl(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=yj(e,s),t-=s,r.EncryptionVerifier=wj(e,t),r}function ZM(e){var t={},r=t.EncryptionVersionInfo=pl(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ub(e){var t=0,r,n=vj(e),s=n.length+1,a,o,l,c,A;for(r=Cc(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],l=t&16384?1:0,c=t<<1&32767,A=l|c,t=A^o;return t^52811}var bj=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},a=function(o){for(var l=t[o.length-1],c=104,A=o.length-1;A>=0;--A)for(var u=o[A],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=vj(o),c=a(l),A=l.length,u=Cc(16),f=0;f!=16;++f)u[f]=0;var h,d,x;for((A&1)===1&&(h=c>>8,u[A]=s(e[0],h),--A,h=c&255,d=l[l.length-1],u[A]=s(d,h));A>0;)--A,h=c>>8,u[A]=s(l[A],h),--A,h=c&255,u[A]=s(l[A],h);for(A=15,x=15-l.length;x>0;)h=c>>8,u[A]=s(e[x],h),--A,--x,h=c&255,u[A]=s(l[A],h),--A,--x;return u}}(),e9=function(e,t,r,n,s){s||(s=t),n||(n=bj(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,s[a]=o,++r;return[s,r,n]},t9=function(e){var t=0,r=bj(e);return function(n){var s=e9("",n,t,r);return t=s[1],s[0]}};function r9(e,t,r,n){var s={key:Hn(e),verificationBytes:Hn(e)};return r.password&&(s.verifier=Ub(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=t9(r.password)),s}function n9(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=ZM(e):n.Data=JM(e,t),n}function s9(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?n9(e,t-2,n):r9(e,r.biff>=8?t:t-2,r,n),n}var _j=function(){function e(s,a){switch(a.type){case"base64":return t(si(s),a);case"binary":return t(s,a);case"buffer":return t(ur&&Buffer.isBuffer(s)?s.toString("binary"):Dc(s),a);case"array":return t(LA(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var o=a||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,d=0,x,g=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var y=u.slice(d,h.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var m={v:y,t:"s"};Array.isArray(l)?l[f][g]=m:l[Xt({r:f,c:g})]=m}break}d=h.lastIndex}g>A.e.c&&(A.e.c=g)}),l["!ref"]=ir(A),l}function r(s,a){return Pc(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=_r(s["!ref"]),l,c=Array.isArray(s),A=o.s.r;A<=o.e.r;++A){a.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Xt({r:A,c:u});l=c?(s[A]||[])[u]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(wl(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function a9(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Kf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function i9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),o=s-a;if(o===0)return[0,0,t];var l=0,c=0,A=s+a;switch(c=o/(A>1?2-A:A),s){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,A/2]}function o9(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,o=[a,a,a],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var A=0;A!=3;++A)o[A]=Math.round(o[A]*255);return o}function Cg(e,t){if(t===0)return e;var r=i9(a9(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Kf(o9(r))}var Bj=6,l9=15,c9=1,Vs=Bj;function qf(e){return Math.floor((e+Math.round(128/Vs)/256)*Vs)}function Vf(e){return Math.floor((e-5)/Vs*100+.5)/100}function Ng(e){return Math.round((e*Vs+5)/Vs*256)/256}function W1(e){return Ng(Vf(qf(e)))}function Lb(e){var t=Math.abs(e-W1(e)),r=Vs;if(t>.005)for(Vs=c9;Vs<l9;++Vs)Math.abs(e-W1(e))<=t&&(t=Math.abs(e-W1(e)),r=Vs);Vs=r}function Nc(e){e.width?(e.wpx=qf(e.width),e.wch=Vf(e.wpx),e.MDW=Vs):e.wpx?(e.wch=Vf(e.wpx),e.width=Ng(e.wch),e.MDW=Vs):typeof e.wch=="number"&&(e.width=Ng(e.wch),e.wpx=qf(e.width),e.MDW=Vs),e.customWidth&&delete e.customWidth}var A9=96,Cj=A9;function Gf(e){return e*96/Cj}function bd(e){return e*Cj/96}var u9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function d9(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(ea)||[]).forEach(function(o){var l=Yt(o);switch(Uo(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Yr(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Yr(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function f9(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(ea)||[]).forEach(function(o){var l=Yt(o);switch(Uo(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function h9(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(ea)||[]).forEach(function(o){var l=Yt(o);switch(Uo(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Rr(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Yr(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Yr(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Yr(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Yr(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Yr(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Yr(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Yr(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=cb[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Yr(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=yA[s.color.index];s.color.index==81&&(c=yA[1]),c||(c=yA[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Cg(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function p9(e,t,r){t.NumberFmt=[];for(var n=wn(zt),s=0;s<n.length;++s)t.NumberFmt[n[s]]=zt[n[s]];var a=e[0].match(ea);if(a)for(s=0;s<a.length;++s){var o=Yt(a[s]);switch(Uo(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=br(Rr(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}hl(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function m9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=vt("numFmt",null,{numFmtId:n,formatCode:Dr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=vt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Ep=["numFmtId","fillId","fontId","borderId","xfId"],Fp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function g9(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(ea)||[]).forEach(function(a){var o=Yt(a),l=0;switch(Uo(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Ep.length;++l)n[Ep[l]]&&(n[Ep[l]]=parseInt(n[Ep[l]],10));for(l=0;l<Fp.length;++l)n[Fp[l]]&&(n[Fp[l]]=Yr(n[Fp[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Yr(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function x9(e){var t=[];return t[t.length]=vt("cellXfs",null),e.forEach(function(r){t[t.length]=vt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=vt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var v9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,A){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&p9(f,u,A),(f=l.match(s))&&h9(f,u,c,A),(f=l.match(n))&&f9(f,u,c,A),(f=l.match(a))&&d9(f,u,c,A),(f=l.match(r))&&g9(f,u,A),u}}();function Nj(e,t){var r=[Un,vt("styleSheet",null,{xmlns:qA[0],"xmlns:vt":ns.vt})],n;return e.SSF&&(n=m9(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=x9(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function y9(e,t){var r=e.read_shift(2),n=Ys(e);return[r,n]}function w9(e,t,r){r||(r=Xe(6+4*t.length)),r.write_shift(2,e),ds(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function b9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=nR(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=rR(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ys(e),n}function _9(e,t){t||(t=Xe(25+4*32)),t.write_shift(2,e.sz*20),sR(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),bg(e.color,t);var n=0;return n=2,t.write_shift(1,n),ds(e.name,t),t.length>t.l?t.slice(0,t.l):t}var B9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$1,C9=Zs;function E4(e,t){t||(t=Xe(4*3+8*7+16*1)),$1||($1=lx(B9));var r=$1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(bg({auto:1},t),bg({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function N9(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function Sj(e,t,r){r||(r=Xe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function p0(e,t){return t||(t=Xe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var S9=Zs;function k9(e,t){return t||(t=Xe(51)),t.write_shift(1,0),p0(null,t),p0(null,t),p0(null,t),p0(null,t),p0(null,t),t.length>t.l?t.slice(0,t.l):t}function E9(e,t){return t||(t=Xe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),wg(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function F9(e,t,r){var n=Xe(2052);return n.write_shift(4,e),wg(t,n),wg(r,n),n.length>n.l?n.slice(0,n.l):n}function j9(e,t,r){var n={};n.NumberFmt=[];for(var s in zt)n.NumberFmt[s]=zt[s];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Nl(e,function(c,A,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],hl(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Cg(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(u),o=!0;break;case 38:a.pop(),o=!1;break;default:if(A.T>0)a.push(u);else if(A.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function T9(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(ot(e,615,ro(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ot(e,44,w9(s,t[s]))}),ot(e,616))}}function I9(e){var t=1;ot(e,611,ro(t)),ot(e,43,_9({sz:12,color:{theme:1},name:"Calibri",family:2})),ot(e,612)}function U9(e){var t=2;ot(e,603,ro(t)),ot(e,45,E4({patternType:"none"})),ot(e,45,E4({patternType:"gray125"})),ot(e,604)}function L9(e){var t=1;ot(e,613,ro(t)),ot(e,46,k9()),ot(e,614)}function D9(e){var t=1;ot(e,626,ro(t)),ot(e,47,Sj({numFmtId:0},65535)),ot(e,627)}function P9(e,t){ot(e,617,ro(t.length)),t.forEach(function(r){ot(e,47,Sj(r,0))}),ot(e,618)}function O9(e){var t=1;ot(e,619,ro(t)),ot(e,48,E9({xfId:0,name:"Normal"})),ot(e,620)}function R9(e){var t=0;ot(e,505,ro(t)),ot(e,506)}function Q9(e){var t=0;ot(e,508,F9(t,"TableStyleMedium9","PivotStyleMedium4")),ot(e,509)}function M9(e,t){var r=Ea();return ot(r,278),T9(r,e.SSF),I9(r),U9(r),L9(r),D9(r),P9(r,t.cellXfs),O9(r),R9(r),Q9(r),ot(r,279),r.end()}var H9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function K9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ea)||[]).forEach(function(s){var a=Yt(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[H9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function q9(){}function V9(){}var G9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,W9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,$9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function z9(e,t,r){t.themeElements={};var n;[["clrScheme",G9,K9],["fontScheme",W9,q9],["fmtScheme",$9,V9]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var X9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function kj(e,t){(!e||e.length===0)&&(e=Db());var r,n={};if(!(r=e.match(X9)))throw new Error("themeElements not found in theme");return z9(r[0],n,t),n.raw=e,n}function Db(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Un];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Y9(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=yF(a,{type:"array"})}catch{return}var l=Ja(o,"theme/theme/theme1.xml",!0);if(l)return kj(l,r)}}function J9(e){return e.read_shift(4)}function Z9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=eH(e,4);break;case 2:t.xclrValue=oj(e);break;case 3:t.xclrValue=J9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function eH(e,t){return Zs(e,t)}function tH(e,t){return Zs(e,t)}function rH(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Z9(e);break;case 6:n[1]=tH(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function nH(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(rH(e,r-e.l));return{ixfe:n,ext:a}}function sH(e,t){t.forEach(function(r){switch(r[0]){}})}function aH(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ys(e)}}function iH(e){var t=Xe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ds(e.name,t),t.slice(0,t.l)}function oH(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function lH(e){var t=Xe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function cH(e,t){var r=Xe(8+2*t.length);return r.write_shift(4,e),ds(t,r),r.slice(0,r.l)}function AH(e){return e.l+=4,e.read_shift(4)!=0}function uH(e,t){var r=Xe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function dH(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],o=!1,l=2;return Nl(e,function(c,A,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(u),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!A.T){if(!o||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function fH(){var e=Ea();return ot(e,332),ot(e,334,ro(1)),ot(e,335,iH({name:"XLDAPR",version:12e4,flags:3496657072})),ot(e,336),ot(e,339,cH(1,"XLDAPR")),ot(e,52),ot(e,35,ro(514)),ot(e,4096,ro(0)),ot(e,4097,vi(1)),ot(e,36),ot(e,53),ot(e,340),ot(e,337,uH(1)),ot(e,51,lH([[1,0]])),ot(e,338),ot(e,333),e.end()}function hH(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,o;return e.replace(ea,function(l){var c=Yt(l);switch(Uo(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<n.Types.length;++A)n.Types[A].name==c.name&&(o=n.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function Ej(){var e=[Un];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function pH(e){var t=[];if(!e)return t;var r=1;return(e.match(ea)||[]).forEach(function(n){var s=Yt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function mH(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Xt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function gH(e,t,r){var n=[];return Nl(e,function(a,o,l){switch(l){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function xH(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Nl(e,function(l,c,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},s)}function vH(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Vu=1024;function Fj(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[vt("xml",null,{"xmlns:v":Wa.v,"xmlns:o":Wa.o,"xmlns:x":Wa.x,"xmlns:mv":Wa.mv}).replace(/\/>/,">"),vt("o:shapelayout",vt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),vt("v:shapetype",[vt("v:stroke",null,{joinstyle:"miter"}),vt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Vu<e*1e3;)Vu+=1e3;return t.forEach(function(a){var o=dn(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?vt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,A=vt("v:fill",c,l),u={on:"t",obscured:"t"};++Vu,s=s.concat(["<v:shape"+Qf({id:"_x0000_s"+Vu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",A,vt("v:shadow",null,u),vt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Bs("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Bs("x:AutoFill","False"),Bs("x:Row",String(o.r)),Bs("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function F4(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(o){var l=dn(o.ref);if(s?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[o.ref],!a){a={t:"z"},s?e[l.r][l.c]=a:e[o.ref]=a;var c=_r(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var A=ir(c);A!==e["!ref"]&&(e["!ref"]=A)}a.c||(a.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}a.c.push(u)})}function yH(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Yt(l[0]),A={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=dn(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Ib(f[1])||{r:"",t:"",h:""};A.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),A.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(A.h=h.h),n.push(A)}}}}),n}function jj(e){var t=[Un,vt("comments",null,{xmlns:qA[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Dr(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Dr(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Bs("t",Dr(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)o+=`Reply:
    `+a[l]+`
`;t.push(Bs("t",Dr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function wH(e,t){var r=[],n=!1,s={},a=0;return e.replace(ea,function(l,c){var A=Yt(l);switch(Uo(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return l}),r}function bH(e,t,r){var n=[Un,vt("ThreadedComments",null,{xmlns:ns.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(vt("threadedComment",Bs("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function _H(e,t){var r=[],n=!1;return e.replace(ea,function(a){var o=Yt(a);switch(Uo(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function BH(e){var t=[Un,vt("personList",null,{xmlns:ns.TCMNT,"xmlns:x":qA[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(vt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function CH(e){var t={};t.iauthor=e.read_shift(4);var r=$A(e);return t.rfx=r.s,t.ref=Xt(r.s),e.l+=16,t}function NH(e,t){return t==null&&(t=Xe(36)),t.write_shift(4,e[1].iauthor),Id(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var SH=Ys;function kH(e){return ds(e.slice(0,54))}function EH(e,t){var r=[],n=[],s={},a=!1;return Nl(e,function(l,c,A){switch(A){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),r}function FH(e){var t=Ea(),r=[];return ot(t,628),ot(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ot(t,632,kH(s.a)))})}),ot(t,631),ot(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:dn(n[0]),e:dn(n[0])};ot(t,635,NH([a,s])),s.t&&s.t.length>0&&ot(t,637,J7(s)),ot(t,636),delete s.iauthor})}),ot(t,634),ot(t,629),t.end()}var jH="application/vnd.ms-office.vbaProject";function TH(e){var t=Gt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Gt.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Gt.write(t)}function IH(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Gt.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var Tj=["xlsb","xlsm","xlam","biff8","xla"];function UH(){return{"!type":"dialog"}}function LH(){return{"!type":"dialog"}}function DH(){return{"!type":"macro"}}function PH(){return{"!type":"macro"}}var ad=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,o){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var A=a.length>0?parseInt(a,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?A+=t.r:--A,s+(l?"":"$")+un(u)+(c?"":"$")+In(A)}return function(s,a){return t=a,s.replace(e,r)}}(),Pb=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ob=function(){return function(t,r){return t.replace(Pb,function(n,s,a,o,l,c){var A=Bb(o)-(a?0:r.c),u=_b(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",h=A==0?"":a?A+1:"["+A+"]";return s+"R"+f+"C"+h})}}();function Ij(e,t){return e.replace(Pb,function(r,n,s,a,o,l){return n+(s=="$"?s+a:un(Bb(a)+t.c))+(o=="$"?o+l:In(_b(l)+t.r))})}function OH(e,t,r){var n=Ta(t),s=n.s,a=dn(r),o={r:a.r-s.r,c:a.c-s.c};return Ij(e,o)}function RH(e){return e.length!=1}function j4(e){return e.replace(/_xlfn\./g,"")}function Qn(e){e.l+=1}function Sc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Uj(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Lj(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),o=Sc(e),l=Sc(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function Lj(e){var t=Sc(e),r=Sc(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function QH(e,t,r){if(r.biff<8)return Lj(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Sc(e),o=Sc(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Dj(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return MH(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Sc(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function MH(e){var t=Sc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function HH(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function KH(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return qH(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:l}}function qH(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function VH(e,t,r){var n=(e[e.l++]&96)>>5,s=Uj(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function GH(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=Uj(e,a,r);return[n,s,o]}function WH(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function $H(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function zH(e,t,r){var n=(e[e.l++]&96)>>5,s=QH(e,t-1,r);return[n,s]}function XH(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function T4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function YH(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function JH(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ZH(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function eK(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function tK(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Pj(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function rK(e){return e.read_shift(2),Pj(e)}function nK(e){return e.read_shift(2),Pj(e)}function sK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Dj(e,0,r);return[n,s]}function aK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=KH(e,0,r);return[n,s]}function iK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=Dj(e,0,r);return[n,s,a]}function oK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Aq[s],Qj[s],n]}function lK(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:cK(e);return[s,(a[0]===0?Qj:cq)[a[1]]]}function cK(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function AK(e,t,r){e.l+=r&&r.biff==2?3:4}function uK(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function dK(e){return e.l++,Sl[e.read_shift(1)]}function fK(e){return e.l++,e.read_shift(2)}function hK(e){return e.l++,e.read_shift(1)!==0}function pK(e){return e.l++,Gs(e)}function mK(e,t,r){return e.l++,uh(e,t-1,r)}function gK(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Sn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Sl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Gs(e);break;case 2:r[1]=zA(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function xK(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?$A:ux)(e));return s}function vK(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var l=0;l!=s;++l)o[a][l]=gK(e,r.biff);return o}function yK(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function wK(e,t,r){if(r.biff==5)return bK(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function bK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function _K(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function BK(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function CK(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function NK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var SK=Zs,kK=Zs,EK=Zs;function fh(e,t,r){return e.l+=2,[HH(e)]}function Rb(e){return e.l+=6,[]}var FK=fh,jK=Rb,TK=Rb,IK=fh;function Oj(e){return e.l+=2,[Hn(e),e.read_shift(2)&1]}var UK=fh,LK=Oj,DK=Rb,PK=fh,OK=fh,RK=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QK(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),o=RK[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:a}}function MK(e){return e.l+=2,[e.read_shift(4)]}function HK(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function KK(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function qK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function GK(e){return e.l+=4,[0,0]}var I4={1:{n:"PtgExp",f:uK},2:{n:"PtgTbl",f:EK},3:{n:"PtgAdd",f:Qn},4:{n:"PtgSub",f:Qn},5:{n:"PtgMul",f:Qn},6:{n:"PtgDiv",f:Qn},7:{n:"PtgPower",f:Qn},8:{n:"PtgConcat",f:Qn},9:{n:"PtgLt",f:Qn},10:{n:"PtgLe",f:Qn},11:{n:"PtgEq",f:Qn},12:{n:"PtgGe",f:Qn},13:{n:"PtgGt",f:Qn},14:{n:"PtgNe",f:Qn},15:{n:"PtgIsect",f:Qn},16:{n:"PtgUnion",f:Qn},17:{n:"PtgRange",f:Qn},18:{n:"PtgUplus",f:Qn},19:{n:"PtgUminus",f:Qn},20:{n:"PtgPercent",f:Qn},21:{n:"PtgParen",f:Qn},22:{n:"PtgMissArg",f:Qn},23:{n:"PtgStr",f:mK},26:{n:"PtgSheet",f:HK},27:{n:"PtgEndSheet",f:KK},28:{n:"PtgErr",f:dK},29:{n:"PtgBool",f:hK},30:{n:"PtgInt",f:fK},31:{n:"PtgNum",f:pK},32:{n:"PtgArray",f:XH},33:{n:"PtgFunc",f:oK},34:{n:"PtgFuncVar",f:lK},35:{n:"PtgName",f:yK},36:{n:"PtgRef",f:sK},37:{n:"PtgArea",f:VH},38:{n:"PtgMemArea",f:_K},39:{n:"PtgMemErr",f:SK},40:{n:"PtgMemNoMem",f:kK},41:{n:"PtgMemFunc",f:BK},42:{n:"PtgRefErr",f:CK},43:{n:"PtgAreaErr",f:WH},44:{n:"PtgRefN",f:aK},45:{n:"PtgAreaN",f:zH},46:{n:"PtgMemAreaN",f:qK},47:{n:"PtgMemNoMemN",f:VK},57:{n:"PtgNameX",f:wK},58:{n:"PtgRef3d",f:iK},59:{n:"PtgArea3d",f:GH},60:{n:"PtgRefErr3d",f:NK},61:{n:"PtgAreaErr3d",f:$H},255:{}},WK={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$K={1:{n:"PtgElfLel",f:Oj},2:{n:"PtgElfRw",f:PK},3:{n:"PtgElfCol",f:FK},6:{n:"PtgElfRwV",f:OK},7:{n:"PtgElfColV",f:IK},10:{n:"PtgElfRadical",f:UK},11:{n:"PtgElfRadicalS",f:DK},13:{n:"PtgElfColS",f:jK},15:{n:"PtgElfColSV",f:TK},16:{n:"PtgElfRadicalLel",f:LK},25:{n:"PtgList",f:QK},29:{n:"PtgSxName",f:MK},255:{}},zK={0:{n:"PtgAttrNoop",f:GK},1:{n:"PtgAttrSemi",f:tK},2:{n:"PtgAttrIf",f:ZH},4:{n:"PtgAttrChoose",f:YH},8:{n:"PtgAttrGoto",f:JH},16:{n:"PtgAttrSum",f:AK},32:{n:"PtgAttrBaxcel",f:T4},33:{n:"PtgAttrBaxcel",f:T4},64:{n:"PtgAttrSpace",f:rK},65:{n:"PtgAttrSpaceSemi",f:nK},128:{n:"PtgAttrIfError",f:eK},255:{}};function hh(e,t,r,n){if(n.biff<8)return Zs(e,t);for(var s=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=vK(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=xK(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&a.push(Zs(e,t)),a}function ph(e,t,r){for(var n=e.l+t,s,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],s=I4[a]||I4[WK[a]],(a===24||a===25)&&(s=(a===24?$K:zK)[e[e.l+1]]),!s||!s.f?Zs(e,t):o.push([s.n,s.f(e,t,r)]);return o}function XK(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var YK={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JK(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Rj(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function U4(e,t,r){var n=Rj(e,t,r);return n=="#REF"?n:JK(n,r)}function Hs(e,t,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,A,u,f=0,h=0,d,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",m=0,p=e[0].length;m<p;++m){var b=e[0][m];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),A=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=vn(" ",e[0][g][1][1]);break;case 1:y=vn("\r",e[0][g][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}A=A+y,g=-1}l.push(A+YK[b[0]]+c);break;case"PtgIsect":c=l.pop(),A=l.pop(),l.push(A+" "+c);break;case"PtgUnion":c=l.pop(),A=l.pop(),l.push(A+","+c);break;case"PtgRange":c=l.pop(),A=l.pop(),l.push(A+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ef(b[1][1],o,s),l.push(tf(u,a));break;case"PtgRefN":u=r?ef(b[1][1],r,s):b[1][1],l.push(tf(u,a));break;case"PtgRef3d":f=b[1][1],u=ef(b[1][2],o,s),x=U4(n,f,s),l.push(x+"!"+tf(u,a));break;case"PtgFunc":case"PtgFuncVar":var v=b[1][0],C=b[1][1];v||(v=0),v&=127;var k=v==0?[]:l.slice(-v);l.length-=v,C==="User"&&(C=k.shift()),l.push(C+"("+k.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":d=c4(b[1][1],r?{s:r}:o,s),l.push(q1(d,s));break;case"PtgArea":d=c4(b[1][1],o,s),l.push(q1(d,s));break;case"PtgArea3d":f=b[1][1],d=b[1][2],x=U4(n,f,s),l.push(x+"!"+q1(d,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],I=S?S.Name:"SH33TJSNAME"+String(h);I&&I.slice(0,6)=="_xlfn."&&!s.xlfn&&(I=I.slice(6)),l.push(I);break;case"PtgNameX":var N=b[1][1];h=b[1][2];var Q;if(s.biff<=5)N<0&&(N=-N),n[N]&&(Q=n[N][h]);else{var L="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][h]&&n[N][h].itab>0&&(L=n.SheetNames[n[N][h].itab-1]+"!"):L=n.SheetNames[h-1]+"!"),n[N]&&n[N][h])L+=n[N][h].Name;else if(n[0]&&n[0][h])L+=n[0][h].Name;else{var T=(Rj(n,N,s)||"").split(";;");T[h-1]?L=T[h-1]:L+="SH33TJSERRX"}l.push(L);break}Q||(Q={Name:"SH33TJSERRY"}),l.push(Q.Name);break;case"PtgParen":var P="(",R=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:P=vn(" ",e[0][g][1][1])+P;break;case 3:P=vn("\r",e[0][g][1][1])+P;break;case 4:R=vn(" ",e[0][g][1][1])+R;break;case 5:R=vn("\r",e[0][g][1][1])+R;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(P+l.pop()+R);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var z={c:r.c,r:r.r};if(n.sharedf[Xt(u)]){var q=n.sharedf[Xt(u)];l.push(Hs(q,o,z,n,s))}else{var M=!1;for(c=0;c!=n.arrayf.length;++c)if(A=n.arrayf[c],!(u.c<A[0].s.c||u.c>A[0].e.c)&&!(u.r<A[0].s.r||u.r>A[0].e.r)){l.push(Hs(A[1],o,z,n,s)),M=!0;break}M||l.push(b[1])}break;case"PtgArray":l.push("{"+XK(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=m;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&V.indexOf(e[0][m][0])==-1){b=e[0][g];var H=!0;switch(b[1][0]){case 4:H=!1;case 0:y=vn(" ",b[1][1]);break;case 5:H=!1;case 1:y=vn("\r",b[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((H?y:"")+l.pop()+(H?"":y)),g=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function ZK(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],Zs(e,t-2)];var l=ph(e,o,r);return t!==o+s&&(a=hh(e,t-o-s,l,r)),e.l=n,[l,a]}function eq(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],Zs(e,t-2)];var l=ph(e,o,r);return t!==o+s&&(a=hh(e,t-o-s,l,r)),e.l=n,[l,a]}function tq(e,t,r,n){var s=e.l+t,a=ph(e,n,r),o;return s!==e.l&&(o=hh(e,s-e.l,a,r)),[a,o]}function rq(e,t,r){var n=e.l+t,s,a=e.read_shift(2),o=ph(e,a,r);return a==65535?[[],Zs(e,t-2)]:(t!==a+2&&(s=hh(e,n-a-2,o,r)),[o,s])}function nq(e){var t;if(ul(e,e.l+6)!==65535)return[Gs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function sq(e){if(e==null){var t=Xe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return DA(e);return DA(0)}function z1(e,t,r){var n=e.l+t,s=Lo(e);r.biff==2&&++e.l;var a=nq(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=eq(e,n-e.l,r);return{cell:s,val:a[0],formula:l,shared:o>>3&1,tt:a[1]}}function aq(e,t,r,n,s){var a=OA(t,r,s),o=sq(e.v),l=Xe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var A=Xe(e.bf.length),u=0;u<e.bf.length;++u)A[u]=e.bf[u];var f=us([a,o,l,A]);return f}function dx(e,t,r){var n=e.read_shift(4),s=ph(e,n,r),a=e.read_shift(4),o=a>0?hh(e,a,s,r):null;return[s,o]}var iq=dx,fx=dx,oq=dx,lq=dx,cq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Qj={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Aq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function L4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function uq(e){var t="of:="+e.replace(Pb,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function X1(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function dq(e){return e.replace(/\./,"!")}var nf={},id={},sf=typeof Map<"u";function Qb(e,t,r){var n=0,s=e.length;if(r){if(sf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=sf?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(sf?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function hx(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Vs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Vf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Ng(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function _A(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Oc(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){hl(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Mj(e,t,r,n,s,a){try{n.cellNF&&(e.z=zt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=en(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(zt[t]==null&&hl(c7[t]||"General",t),e.t==="e")e.w=e.w||Sl[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Of(e.v);else if(e.t==="d"){var o=is(e.v);(o|0)===o?e.w=o.toString(10):e.w=Of(o)}else{if(e.v===void 0)return"";e.w=UA(e.v,id)}else e.t==="d"?e.w=Fi(t,is(e.v),id):e.w=Fi(t,e.v,id)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Cg(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Cg(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function fq(e,t,r){if(e&&e["!ref"]){var n=_r(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function hq(e,t){var r=_r(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ir(r))}var pq=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,mq=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gq=/<(?:\w:)?hyperlink [^>]*>/mg,xq=/"(\w*:\w*)"/,vq=/<(?:\w:)?col\b[^>]*[\/]?>/g,yq=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wq=/<(?:\w:)?pageMargins[^>]*\/>/g,Hj=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,bq=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,_q=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bq(e,t,r,n,s,a,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",u="",f=e.match(mq);f?(A=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):A=u=e;var h=A.match(Hj);h?Mb(h[0],l,s,r):(h=A.match(bq))&&Nq(h[0],h[1]||"",l,s,r);var d=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var x=A.slice(d,d+50).match(xq);x&&hq(l,x[1])}var g=A.match(_q);g&&g[1]&&Rq(g[1],s);var y=[];if(t.cellStyles){var m=A.match(vq);m&&Uq(y,m)}f&&Hq(f[1],l,t,c,a,o);var p=u.match(yq);p&&(l["!autofilter"]=Dq(p[0]));var b=[],v=u.match(pq);if(v)for(d=0;d!=v.length;++d)b[d]=_r(v[d].slice(v[d].indexOf('"')+1));var C=u.match(gq);C&&jq(l,C,n);var k=u.match(wq);if(k&&(l["!margins"]=Tq(Yt(k[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=ir(c)),t.sheetRows>0&&l["!ref"]){var S=_r(l["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ir(S))}return y.length>0&&(l["!cols"]=y),b.length>0&&(l["!merges"]=b),l}function Cq(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ir(e[r])+'"/>';return t+"</mergeCells>"}function Mb(e,t,r,n){var s=Yt(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=br(Rr(s.codeName)))}function Nq(e,t,r,n,s){Mb(e.slice(0,e.indexOf(">")),r,n,s)}function Sq(e,t,r,n,s){var a=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,o.codeName=No(Dr(c))}if(e&&e["!outline"]){var A={summaryBelow:1,summaryRight:1};e["!outline"].above&&(A.summaryBelow=0),e["!outline"].left&&(A.summaryRight=0),l=(l||"")+vt("outlinePr",null,A)}!a&&!l||(s[s.length]=vt("sheetPr",l,o))}var kq=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Eq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Fq(e){var t={sheet:1};return kq.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Eq.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Ub(e.password).toString(16).toUpperCase()),vt("sheetProtection",null,t)}function jq(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Yt(Rr(t[s]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+br(a.location))):(a.Target="#"+br(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=_r(a.ref),c=l.s.r;c<=l.e.r;++c)for(var A=l.s.c;A<=l.e.c;++A){var u=Xt({c:A,r:c});n?(e[c]||(e[c]=[]),e[c][A]||(e[c][A]={t:"z",v:void 0}),e[c][A].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function Tq(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Iq(e){return _A(e),vt("pageMargins",null,e)}function Uq(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Yt(t[n],!0);s.hidden&&(s.hidden=Yr(s.hidden));var a=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Lb(s.width)),Nc(s);a<=o;)e[a++]=tn(s)}}function Lq(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=vt("col",null,hx(s,n)));return r[r.length]="</cols>",r.join("")}function Dq(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Pq(e,t,r,n){var s=typeof e.ref=="string"?e.ref:ir(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ta(s);o.s.r==o.e.r&&(o.e.r=Ta(t["!ref"]).e.r,s=ir(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),vt("autoFilter",null,{ref:s})}var Oq=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Rq(e,t){t.Views||(t.Views=[{}]),(e.match(Oq)||[]).forEach(function(r,n){var s=Yt(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Yr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function Qq(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),vt("sheetViews",vt("sheetView",null,s),{})}function Mq(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Sl[e.v];break;case"d":n&&n.cellDates?s=en(e.v,-1).toISOString():(e=tn(e),e.t="n",s=""+(e.v=is(en(e.v)))),typeof e.z>"u"&&(e.z=zt[14]);break;default:s=e.v;break}var l=Bs("v",Dr(s)),c={r:t},A=Oc(n.cellXfs,e,n);switch(A!==0&&(c.s=A),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Bs("v",""+Qb(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=vt("f",Dr(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),vt("c",l,c)}var Hq=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Rf("v"),o=Rf("f");return function(c,A,u,f,h,d){for(var x=0,g="",y=[],m=[],p=0,b=0,v=0,C="",k,S,I=0,N=0,Q,L,T=0,P=0,R=Array.isArray(d.CellXf),z,q=[],M=[],V=Array.isArray(A),H=[],se={},ce=!1,B=!!u.sheetStubs,U=c.split(t),F=0,D=U.length;F!=D;++F){g=U[F].trim();var X=g.length;if(X!==0){var K=0;e:for(x=0;x<X;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(S=Yt(g.slice(K,x),!0),I=S.r!=null?parseInt(S.r,10):I+1,N=-1,u.sheetRows&&u.sheetRows<I)continue;se={},ce=!1,S.ht&&(ce=!0,se.hpt=parseFloat(S.ht),se.hpx=bd(se.hpt)),S.hidden=="1"&&(ce=!0,se.hidden=!0),S.outlineLevel!=null&&(ce=!0,se.level=+S.outlineLevel),ce&&(H[I-1]=se)}break;case"<":K=x;break}if(K>=x)break;if(S=Yt(g.slice(K,x),!0),I=S.r!=null?parseInt(S.r,10):I+1,N=-1,!(u.sheetRows&&u.sheetRows<I)){f.s.r>I-1&&(f.s.r=I-1),f.e.r<I-1&&(f.e.r=I-1),u&&u.cellStyles&&(se={},ce=!1,S.ht&&(ce=!0,se.hpt=parseFloat(S.ht),se.hpx=bd(se.hpt)),S.hidden=="1"&&(ce=!0,se.hidden=!0),S.outlineLevel!=null&&(ce=!0,se.level=+S.outlineLevel),ce&&(H[I-1]=se)),y=g.slice(x).split(e);for(var ae=0;ae!=y.length&&y[ae].trim().charAt(0)=="<";++ae);for(y=y.slice(ae),x=0;x!=y.length;++x)if(g=y[x].trim(),g.length!==0){if(m=g.match(r),p=x,b=0,v=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,m!=null&&m.length===2){for(p=0,C=m[1],b=0;b!=C.length&&!((v=C.charCodeAt(b)-64)<1||v>26);++b)p=26*p+v;--p,N=p}else++N;for(b=0;b!=g.length&&g.charCodeAt(b)!==62;++b);if(++b,S=Yt(g.slice(0,b),!0),S.r||(S.r=Xt({r:I-1,c:N})),C=g.slice(b),k={t:""},(m=C.match(a))!=null&&m[1]!==""&&(k.v=br(m[1])),u.cellFormula){if((m=C.match(o))!=null&&m[1]!==""){if(k.f=br(Rr(m[1])).replace(/\r\n/g,`
`),u.xlfn||(k.f=j4(k.f)),m[0].indexOf('t="array"')>-1)k.F=(C.match(s)||[])[1],k.F.indexOf(":")>-1&&q.push([_r(k.F),k.F]);else if(m[0].indexOf('t="shared"')>-1){L=Yt(m[0]);var he=br(Rr(m[1]));u.xlfn||(he=j4(he)),M[parseInt(L.si,10)]=[L,he,S.r]}}else(m=C.match(/<f[^>]*\/>/))&&(L=Yt(m[0]),M[L.si]&&(k.f=OH(M[L.si][1],M[L.si][2],S.r)));var Y=dn(S.r);for(b=0;b<q.length;++b)Y.r>=q[b][0].s.r&&Y.r<=q[b][0].e.r&&Y.c>=q[b][0].s.c&&Y.c<=q[b][0].e.c&&(k.F=q[b][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(B)k.t="z";else continue;else k.t=S.t||"n";switch(f.s.c>N&&(f.s.c=N),f.e.c<N&&(f.e.c=N),k.t){case"n":if(k.v==""||k.v==null){if(!B)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!B)continue;k.t="z"}else Q=nf[parseInt(k.v,10)],k.v=Q.t,k.r=Q.r,u.cellHTML&&(k.h=Q.h);break;case"str":k.t="s",k.v=k.v!=null?Rr(k.v):"",u.cellHTML&&(k.h=vb(k.v));break;case"inlineStr":m=C.match(n),k.t="s",m!=null&&(Q=Ib(m[1]))?(k.v=Q.t,u.cellHTML&&(k.h=Q.h)):k.v="";break;case"b":k.v=Yr(k.v);break;case"d":u.cellDates?k.v=en(k.v,1):(k.v=is(en(k.v,1)),k.t="n");break;case"e":(!u||u.cellText!==!1)&&(k.w=k.v),k.v=qF[k.v];break}if(T=P=0,z=null,R&&S.s!==void 0&&(z=d.CellXf[S.s],z!=null&&(z.numFmtId!=null&&(T=z.numFmtId),u.cellStyles&&z.fillId!=null&&(P=z.fillId))),Mj(k,T,P,u,h,d),u.cellDates&&R&&k.t=="n"&&Fd(zt[T])&&(k.t="d",k.v=Ax(k.v)),S.cm&&u.xlmeta){var Be=(u.xlmeta.Cell||[])[+S.cm-1];Be&&Be.type=="XLDAPR"&&(k.D=!0)}if(V){var ee=dn(S.r);A[ee.r]||(A[ee.r]=[]),A[ee.r][ee.c]=k}else A[S.r]=k}}}}H.length>0&&(A["!rows"]=H)}}();function Kq(e,t,r,n){var s=[],a=[],o=_r(e["!ref"]),l="",c,A="",u=[],f=0,h=0,d=e["!rows"],x=Array.isArray(e),g={r:A},y,m=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=un(h);for(f=o.s.r;f<=o.e.r;++f){for(a=[],A=In(f),h=o.s.c;h<=o.e.c;++h){c=u[h]+A;var p=x?(e[f]||[])[h]:e[c];p!==void 0&&(l=Mq(p,c,e,t))!=null&&a.push(l)}(a.length>0||d&&d[f])&&(g={r:A},d&&d[f]&&(y=d[f],y.hidden&&(g.hidden=1),m=-1,y.hpx?m=Gf(y.hpx):y.hpt&&(m=y.hpt),m>-1&&(g.ht=m,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),s[s.length]=vt("row",a.join(""),g))}if(d)for(;f<d.length;++f)d&&d[f]&&(g={r:f+1},y=d[f],y.hidden&&(g.hidden=1),m=-1,y.hpx?m=Gf(y.hpx):y.hpt&&(m=y.hpt),m>-1&&(g.ht=m,g.customHeight=1),y.level&&(g.outlineLevel=y.level),s[s.length]=vt("row","",g));return s.join("")}function Kj(e,t,r,n){var s=[Un,vt("worksheet",null,{xmlns:qA[0],"xmlns:r":ns.r})],a=r.SheetNames[e],o=0,l="",c=r.Sheets[a];c==null&&(c={});var A=c["!ref"]||"A1",u=_r(A);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+A+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),A=ir(u)}n||(n={}),c["!comments"]=[];var f=[];Sq(c,r,e,t,s),s[s.length]=vt("dimension",null,{ref:A}),s[s.length]=Qq(c,t,e,r),t.sheetFormat&&(s[s.length]=vt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Lq(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Kq(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=Fq(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=Pq(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Cq(c["!merges"]));var h=-1,d,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(d={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=Ur(n,-1,Dr(g[1].Target).replace(/#.*$/,""),dr.HLINK),d["r:id"]="rId"+x),(h=g[1].Target.indexOf("#"))>-1&&(d.location=Dr(g[1].Target.slice(h+1))),g[1].Tooltip&&(d.tooltip=Dr(g[1].Tooltip)),s[s.length]=vt("hyperlink",null,d))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Iq(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Bs("ignoredErrors",vt("ignoredError",null,{numberStoredAsText:1,sqref:A}))),f.length>0&&(x=Ur(n,-1,"../drawings/drawing"+(e+1)+".xml",dr.DRAW),s[s.length]=vt("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Ur(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",dr.VML),s[s.length]=vt("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function qq(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function Vq(e,t,r){var n=Xe(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=Gf(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var A={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,d=u<<10;d<u+1<<10;++d){A.c=d;var x=Array.isArray(r)?(r[A.r]||[])[A.c]:r[Xt(A)];x&&(f<0&&(f=d),h=d)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Gq(e,t,r,n){var s=Vq(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&ot(e,0,s)}var Wq=$A,$q=Id;function zq(){}function Xq(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Z7(e),r}function Yq(e,t,r){r==null&&(r=Xe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return bg({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),RF(e,r),r.slice(0,r.l)}function Jq(e){var t=Ii(e);return[t]}function Zq(e,t,r){return r==null&&(r=Xe(8)),VA(t,r)}function eV(e){var t=GA(e);return[t]}function tV(e,t,r){return r==null&&(r=Xe(4)),WA(t,r)}function rV(e){var t=Ii(e),r=e.read_shift(1);return[t,r,"b"]}function nV(e,t,r){return r==null&&(r=Xe(9)),VA(t,r),r.write_shift(1,e.v?1:0),r}function sV(e){var t=GA(e),r=e.read_shift(1);return[t,r,"b"]}function aV(e,t,r){return r==null&&(r=Xe(5)),WA(t,r),r.write_shift(1,e.v?1:0),r}function iV(e){var t=Ii(e),r=e.read_shift(1);return[t,r,"e"]}function oV(e,t,r){return r==null&&(r=Xe(9)),VA(t,r),r.write_shift(1,e.v),r}function lV(e){var t=GA(e),r=e.read_shift(1);return[t,r,"e"]}function cV(e,t,r){return r==null&&(r=Xe(8)),WA(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function AV(e){var t=Ii(e),r=e.read_shift(4);return[t,r,"s"]}function uV(e,t,r){return r==null&&(r=Xe(12)),VA(t,r),r.write_shift(4,t.v),r}function dV(e){var t=GA(e),r=e.read_shift(4);return[t,r,"s"]}function fV(e,t,r){return r==null&&(r=Xe(8)),WA(t,r),r.write_shift(4,t.v),r}function hV(e){var t=Ii(e),r=Gs(e);return[t,r,"n"]}function pV(e,t,r){return r==null&&(r=Xe(16)),VA(t,r),DA(e.v,r),r}function qj(e){var t=GA(e),r=Gs(e);return[t,r,"n"]}function mV(e,t,r){return r==null&&(r=Xe(12)),WA(t,r),DA(e.v,r),r}function gV(e){var t=Ii(e),r=kb(e);return[t,r,"n"]}function xV(e,t,r){return r==null&&(r=Xe(12)),VA(t,r),QF(e.v,r),r}function vV(e){var t=GA(e),r=kb(e);return[t,r,"n"]}function yV(e,t,r){return r==null&&(r=Xe(8)),WA(t,r),QF(e.v,r),r}function wV(e){var t=Ii(e),r=Cb(e);return[t,r,"is"]}function bV(e){var t=Ii(e),r=Ys(e);return[t,r,"str"]}function _V(e,t,r){return r==null&&(r=Xe(12+4*e.v.length)),VA(t,r),ds(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BV(e){var t=GA(e),r=Ys(e);return[t,r,"str"]}function CV(e,t,r){return r==null&&(r=Xe(8+4*e.v.length)),WA(t,r),ds(e.v,r),r.length>r.l?r.slice(0,r.l):r}function NV(e,t,r){var n=e.l+t,s=Ii(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"b"];if(r.cellFormula){e.l+=2;var l=fx(e,n-e.l,r);o[3]=Hs(l,null,s,r.supbooks,r)}else e.l=n;return o}function SV(e,t,r){var n=e.l+t,s=Ii(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"e"];if(r.cellFormula){e.l+=2;var l=fx(e,n-e.l,r);o[3]=Hs(l,null,s,r.supbooks,r)}else e.l=n;return o}function kV(e,t,r){var n=e.l+t,s=Ii(e);s.r=r["!row"];var a=Gs(e),o=[s,a,"n"];if(r.cellFormula){e.l+=2;var l=fx(e,n-e.l,r);o[3]=Hs(l,null,s,r.supbooks,r)}else e.l=n;return o}function EV(e,t,r){var n=e.l+t,s=Ii(e);s.r=r["!row"];var a=Ys(e),o=[s,a,"str"];if(r.cellFormula){e.l+=2;var l=fx(e,n-e.l,r);o[3]=Hs(l,null,s,r.supbooks,r)}else e.l=n;return o}var FV=$A,jV=Id;function TV(e,t){return t==null&&(t=Xe(4)),t.write_shift(4,e),t}function IV(e,t){var r=e.l+t,n=$A(e),s=Nb(e),a=Ys(e),o=Ys(e),l=Ys(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:l};return o&&(c.Tooltip=o),c}function UV(e,t){var r=Xe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Id({s:dn(e[0]),e:dn(e[0])},r),Sb("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return ds(s||"",r),ds(e[1].Tooltip||"",r),ds("",r),r.slice(0,r.l)}function LV(){}function DV(e,t,r){var n=e.l+t,s=MF(e),a=e.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var l=iq(e,n-e.l,r);o[1]=l}else e.l=n;return o}function PV(e,t,r){var n=e.l+t,s=$A(e),a=[s];if(r.cellFormula){var o=lq(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}function OV(e,t,r){r==null&&(r=Xe(18));var n=hx(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Vj=["left","right","top","bottom","header","footer"];function RV(e){var t={};return Vj.forEach(function(r){t[r]=Gs(e)}),t}function QV(e,t){return t==null&&(t=Xe(6*8)),_A(e),Vj.forEach(function(r){DA(e[r],t)}),t}function MV(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function HV(e,t,r){r==null&&(r=Xe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function KV(e){var t=Xe(24);return t.write_shift(4,4),t.write_shift(4,1),Id(e,t),t}function qV(e,t){return t==null&&(t=Xe(16*4+2)),t.write_shift(2,e.password?Ub(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function VV(){}function GV(){}function WV(e,t,r,n,s,a,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},A,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,d,x,g,y,m,p,b,v,C,k=[];l.biff=12,l["!row"]=0;var S=0,I=!1,N=[],Q={},L=l.supbooks||s.supbooks||[[]];if(L.sharedf=Q,L.arrayf=N,L.SheetNames=s.SheetNames||s.Sheets.map(function(V){return V.name}),!l.supbooks&&(l.supbooks=L,s.Names))for(var T=0;T<s.Names.length;++T)L[0][T+1]=s.Names[T];var P=[],R=[],z=!1;Wf[16]={n:"BrtShortReal",f:qj};var q;if(Nl(e,function(H,se,ce){if(!h)switch(ce){case 148:A=H;break;case 0:d=H,l.sheetRows&&l.sheetRows<=d.r&&(h=!0),v=In(y=d.r),l["!row"]=d.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=bd(H.hpt)),R[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:H[2]},H[2]){case"n":x.v=H[1];break;case"s":b=nf[H[1]],x.v=b.t,x.r=b.r;break;case"b":x.v=!!H[1];break;case"e":x.v=H[1],l.cellText!==!1&&(x.w=Sl[x.v]);break;case"str":x.t="s",x.v=H[1];break;case"is":x.t="s",x.v=H[1].t;break}if((g=o.CellXf[H[0].iStyleRef])&&Mj(x,g.numFmtId,null,l,a,o),m=H[0].c==-1?m+1:H[0].c,l.dense?(c[y]||(c[y]=[]),c[y][m]=x):c[un(m)+v]=x,l.cellFormula){for(I=!1,S=0;S<N.length;++S){var B=N[S];d.r>=B[0].s.r&&d.r<=B[0].e.r&&m>=B[0].s.c&&m<=B[0].e.c&&(x.F=ir(B[0]),I=!0)}!I&&H.length>3&&(x.f=H[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>m&&(u.s.c=m),u.e.r<d.r&&(u.e.r=d.r),u.e.c<m&&(u.e.c=m),l.cellDates&&g&&x.t=="n"&&Fd(zt[g.numFmtId])){var U=mA(x.v);U&&(x.t="d",x.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},m=H[0].c==-1?m+1:H[0].c,l.dense?(c[y]||(c[y]=[]),c[y][m]=x):c[un(m)+v]=x,u.s.r>d.r&&(u.s.r=d.r),u.s.c>m&&(u.s.c=m),u.e.r<d.r&&(u.e.r=d.r),u.e.c<m&&(u.e.c=m),q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 176:k.push(H);break;case 49:q=((l.xlmeta||{}).Cell||[])[H-1];break;case 494:var F=n["!id"][H.relId];for(F?(H.Target=F.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=F):H.relId==""&&(H.Target="#"+H.loc),y=H.rfx.s.r;y<=H.rfx.e.r;++y)for(m=H.rfx.s.c;m<=H.rfx.e.c;++m)l.dense?(c[y]||(c[y]=[]),c[y][m]||(c[y][m]={t:"z",v:void 0}),c[y][m].l=H):(p=Xt({c:m,r:y}),c[p]||(c[p]={t:"z",v:void 0}),c[p].l=H);break;case 426:if(!l.cellFormula)break;N.push(H),C=l.dense?c[y][m]:c[un(m)+v],C.f=Hs(H[1],u,{r:d.r,c:m},L,l),C.F=ir(H[0]);break;case 427:if(!l.cellFormula)break;Q[Xt(H[0].s)]=H[1],C=l.dense?c[y][m]:c[un(m)+v],C.f=Hs(H[1],u,{r:d.r,c:m},L,l);break;case 60:if(!l.cellStyles)break;for(;H.e>=H.s;)P[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},z||(z=!0,Lb(H.w/256)),Nc(P[H.e+1]);break;case 161:c["!autofilter"]={ref:ir(H)};break;case 476:c["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(c["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!se.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(c["!ref"]=ir(A||u)),l.sheetRows&&c["!ref"]){var M=_r(c["!ref"]);l.sheetRows<=+M.e.r&&(M.e.r=l.sheetRows-1,M.e.r>u.e.r&&(M.e.r=u.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>u.e.c&&(M.e.c=u.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ir(M))}return k.length>0&&(c["!merges"]=k),P.length>0&&(c["!cols"]=P),R.length>0&&(c["!rows"]=R),c}function $V(e,t,r,n,s,a,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=tn(t),t.z=t.z||zt[14],t.v=is(en(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Oc(s.cellXfs,t,s),t.l&&a["!links"].push([Xt(c),t.l]),t.c&&a["!comments"].push([Xt(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=Qb(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?ot(e,18,fV(t,c)):ot(e,7,uV(t,c))):(c.t="str",o?ot(e,17,CV(t,c)):ot(e,6,_V(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ot(e,13,yV(t,c)):ot(e,2,xV(t,c)):o?ot(e,16,mV(t,c)):ot(e,5,pV(t,c)),!0;case"b":return c.t="b",o?ot(e,15,aV(t,c)):ot(e,4,nV(t,c)),!0;case"e":return c.t="e",o?ot(e,14,cV(t,c)):ot(e,3,oV(t,c)),!0}return o?ot(e,12,tV(t,c)):ot(e,1,Zq(t,c)),!0}function zV(e,t,r,n){var s=_r(t["!ref"]||"A1"),a,o="",l=[];ot(e,145);var c=Array.isArray(t),A=s.e.r;t["!rows"]&&(A=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=A;++u){o=In(u),Gq(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=un(h)),a=l[h]+o;var d=c?(t[u]||[])[h]:t[a];if(!d){f=!1;continue}f=$V(e,d,u,h,n,t,f)}}ot(e,146)}function XV(e,t){!t||!t["!merges"]||(ot(e,177,TV(t["!merges"].length)),t["!merges"].forEach(function(r){ot(e,176,jV(r))}),ot(e,178))}function YV(e,t){!t||!t["!cols"]||(ot(e,390),t["!cols"].forEach(function(r,n){r&&ot(e,60,OV(n,r))}),ot(e,391))}function JV(e,t){!t||!t["!ref"]||(ot(e,648),ot(e,649,KV(_r(t["!ref"]))),ot(e,650))}function ZV(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Ur(r,-1,n[1].Target.replace(/#.*$/,""),dr.HLINK);ot(e,494,UV(n,s))}}),delete t["!links"]}function eG(e,t,r,n){if(t["!comments"].length>0){var s=Ur(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",dr.VML);ot(e,551,Sb("rId"+s)),t["!legacy"]=s}}function tG(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:ir(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ta(a);l.s.r==l.e.r&&(l.e.r=Ta(t["!ref"]).e.r,a=ir(l));for(var c=0;c<o.length;++c){var A=o[c];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==n){A.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ot(e,161,Id(_r(a))),ot(e,162)}}function rG(e,t,r){ot(e,133),ot(e,137,HV(t,r)),ot(e,138),ot(e,134)}function nG(e,t){t["!protect"]&&ot(e,535,qV(t["!protect"]))}function sG(e,t,r,n){var s=Ea(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=_r(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ot(s,129),(r.vbaraw||o["!outline"])&&ot(s,147,Yq(l,o["!outline"])),ot(s,148,$q(c)),rG(s,o,r.Workbook),YV(s,o),zV(s,o,e,t),nG(s,o),tG(s,o,r,e),XV(s,o),ZV(s,o,n),o["!margins"]&&ot(s,476,QV(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&JV(s,o),eG(s,o,e,n),ot(s,130),s.end()}function aG(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=br((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function iG(e,t,r,n,s,a){var o=a||{"!type":"chart"};if(!e)return a;var l=0,c=0,A="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=aG(f);u.s.r=u.s.c=0,u.e.c=l,A=un(l),h[0].forEach(function(d,x){o[A+In(x)]={t:"n",v:d,z:h[1]},c=x}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=ir(u)),o}function oG(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Hj);return l&&Mb(l[0],a,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function lG(e,t){e.l+=10;var r=Ys(e);return{name:r}}function cG(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Nl(e,function(c,A,u){switch(u){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Hb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],AG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uG=[],dG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function D4(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Yr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function P4(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Yr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Gj(e){P4(e.WBProps,Hb),P4(e.CalcPr,dG),D4(e.WBView,AG),D4(e.Sheets,uG),id.date1904=Yr(e.WBProps.date1904)}function fG(e){return!e.Workbook||!e.Workbook.WBProps?"false":Yr(e.Workbook.WBProps.date1904)?"true":"false"}var hG="][*?/\\".split("");function Wj(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hG.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pG(e,t,r){e.forEach(function(n,s){Wj(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function mG(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pG(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)fq(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var gG=/<\w+:workbook/;function xG(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},o=0;if(e.replace(ea,function(c,A){var u=Yt(c);switch(Uo(u[0])){case"<?xml":break;case"<workbook":c.match(gG)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Hb.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Yr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Rr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=br(Rr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Rr(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Yr(u.hidden||"0")&&(a.Hidden=!0),o=A+c.length;break;case"</definedName>":a.Ref=br(Rr(e.slice(o,A))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),qA.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Gj(r),r}function $j(e){var t=[Un];t[t.length]=vt("workbook",null,{xmlns:qA[0],"xmlns:r":ns.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Hb.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=vt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:Dr(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=vt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=vt("definedName",Dr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function vG(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=cw(e),r.name=Ys(e),r}function yG(e,t){return t||(t=Xe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Sb(e.strRelID,t),ds(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function wG(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ys(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function bG(e,t){t||(t=Xe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),RF(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function _G(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function BG(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=eR(e),o=oq(e,0,r),l=Nb(e);e.l=n;var c={Name:a,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function CG(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],Wf[16]={n:"BrtFRTArchID$",f:_G},Nl(e,function(c,A,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Hs(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!A.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),Gj(r),r.Names=a,r.supbooks=o,r}function NG(e,t){ot(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ot(e,156,yG(s))}ot(e,144)}function SG(e,t){t||(t=Xe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ds("SheetJS",t),ds(pg.version,t),ds(pg.version,t),ds("7262",t),t.length>t.l?t.slice(0,t.l):t}function kG(e,t){t||(t=Xe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function EG(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(ot(e,135),ot(e,158,kG(s)),ot(e,136))}}function FG(e,t){var r=Ea();return ot(r,131),ot(r,128,SG()),ot(r,153,bG(e.Workbook&&e.Workbook.WBProps||null)),EG(r,e),NG(r,e),ot(r,132),r.end()}function jG(e,t,r){return t.slice(-4)===".bin"?CG(e,r):xG(e,r)}function TG(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?WV(e,n,r,s,a,o,l):Bq(e,n,r,s,a,o,l)}function IG(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?cG(e,n,r,s,a):oG(e,n,r,s,a)}function UG(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?DH():PH()}function LG(e,t,r,n,s,a,o,l){return t.slice(-4)===".bin"?UH():LH()}function DG(e,t,r,n){return t.slice(-4)===".bin"?j9(e,r,n):v9(e,r,n)}function PG(e,t,r){return kj(e,r)}function OG(e,t,r){return t.slice(-4)===".bin"?OM(e,r):LM(e,r)}function RG(e,t,r){return t.slice(-4)===".bin"?EH(e,r):yH(e,r)}function QG(e,t,r){return t.slice(-4)===".bin"?gH(e):pH(e)}function MG(e,t,r,n){return r.slice(-4)===".bin"?xH(e,t,r,n):void 0}function HG(e,t,r){return t.slice(-4)===".bin"?dH(e,t,r):hH(e,t,r)}function KG(e,t,r){return(t.slice(-4)===".bin"?FG:$j)(e)}function qG(e,t,r,n,s){return(t.slice(-4)===".bin"?sG:Kj)(e,r,n,s)}function VG(e,t,r){return(t.slice(-4)===".bin"?M9:Nj)(e,r)}function GG(e,t,r){return(t.slice(-4)===".bin"?MM:xj)(e,r)}function WG(e,t,r){return(t.slice(-4)===".bin"?FH:jj)(e)}function $G(e){return(e.slice(-4)===".bin"?fH:Ej)()}var zj=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Xj=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(zj),a,o,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(Xj),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}function zG(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(zj),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(Xj),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}var af;function XG(e,t){var r=af[e]||br(e);return r==="General"?UA(t):Fi(r,t)}function YG(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Yr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=en(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[br(t)]=s}function JG(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Sl[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Of(e.v):e.w=UA(e.v):e.w=XG(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=af[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Fd(n)){var s=mA(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function ZG(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=u9[n.Pattern]||n.Pattern)}e[t.ID]=t}function eW(e,t,r,n,s,a,o,l,c,A){var u="General",f=n.StyleID,h={};A=A||{};var d=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);a[f]!==void 0&&(a[f].nf&&(u=a[f].nf),a[f].Interior&&d.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Yr(e);break;case"String":n.t="s",n.r=e4(br(e)),n.v=e.indexOf("<")>-1?br(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(en(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=br(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qF[e],A.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=e4(t||e));break}if(JG(n,u,A),A.cellFormula!==!1)if(n.Formula){var g=br(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=ad(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=ad("RC:RC",s):n.ArrayRange&&(n.F=ad(n.ArrayRange,s),c.push([_r(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);A.cellStyles&&(d.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function tW(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Y1(e,t){var r=t||{};jd();var n=T0(yb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Rr(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=tn(r);return o.type="string",wd.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Fe){s.indexOf("<"+Fe)>=0&&(a=!0)}),a)return QW(n,r);af={"General Number":"General","General Date":zt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":zt[15],"Short Date":zt[14],"Long Time":zt[19],"Medium Time":zt[18],"Short Time":zt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:zt[2],Standard:zt[4],Percent:zt[10],Scientific:zt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],A,u={},f=[],h=r.dense?[]:{},d="",x={},g={},y=Qi('<Data ss:Type="String">'),m=0,p=0,b=0,v={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},k={},S="",I=0,N=[],Q={},L={},T=0,P=[],R=[],z={},q=[],M,V=!1,H=[],se=[],ce={},B=0,U=0,F={Sheets:[],WBProps:{date1904:!1}},D={};Mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";l=Mf.exec(n);)switch(l[3]=(X=l[3]).toLowerCase()){case"data":if(X=="data"){if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?eW(n.slice(m,l.index),S,y,c[c.length-1][0]=="comment"?z:x,{c:p,r:b},C,q[p],g,H,r):(S="",y=Qi(l[0]),m=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(R.length>0&&(x.c=R),(!r.sheetRows||r.sheetRows>b)&&x.v!==void 0&&(r.dense?(h[b]||(h[b]=[]),h[b][p]=x):h[un(p)+In(b)]=x),x.HRef&&(x.l={Target:br(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=p+(parseInt(x.MergeAcross,10)|0),U=b+(parseInt(x.MergeDown,10)|0),N.push({s:{c:p,r:b},e:{c:B,r:U}})),!r.sheetStubs)x.MergeAcross?p=B+1:++p;else if(x.MergeAcross||x.MergeDown){for(var K=p;K<=B;++K)for(var ae=b;ae<=U;++ae)(K>p||ae>b)&&(r.dense?(h[ae]||(h[ae]=[]),h[ae][K]={t:"z"}):h[un(K)+In(ae)]={t:"z"});p=B+1}else++p;else x=zG(l[0]),x.Index&&(p=+x.Index-1),p<v.s.c&&(v.s.c=p),p>v.e.c&&(v.e.c=p),l[0].slice(-2)==="/>"&&++p,R=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<v.s.r&&(v.s.r=b),b>v.e.r&&(v.e.r=b),l[0].slice(-2)==="/>"&&(g=Qi(l[0]),g.Index&&(b=+g.Index-1)),p=0,++b):(g=Qi(l[0]),g.Index&&(b=+g.Index-1),ce={},(g.AutoFitHeight=="0"||g.Height)&&(ce.hpx=parseInt(g.Height,10),ce.hpt=Gf(ce.hpx),se[b]=ce),g.Hidden=="1"&&(ce.hidden=!0,se[b]=ce));break;case"worksheet":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));f.push(d),v.s.r<=v.e.r&&v.s.c<=v.e.c&&(h["!ref"]=ir(v),r.sheetRows&&r.sheetRows<=v.e.r&&(h["!fullref"]=h["!ref"],v.e.r=r.sheetRows-1,h["!ref"]=ir(v))),N.length&&(h["!merges"]=N),q.length>0&&(h["!cols"]=q),se.length>0&&(h["!rows"]=se),u[d]=h}else v={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=p=0,c.push([l[3],!1]),A=Qi(l[0]),d=br(A.Name),h=r.dense?[]:{},N=[],H=[],se=[],D={name:d,Hidden:0},F.Sheets.push(D);break;case"table":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),q=[],V=!1}break;case"style":l[1]==="/"?ZG(C,k,r):k=Qi(l[0]);break;case"numberformat":k.nf=br(Qi(l[0]).Format||"General"),af[k.nf]&&(k.nf=af[k.nf]);for(var he=0;he!=392&&zt[he]!=k.nf;++he);if(he==392){for(he=57;he!=392;++he)if(zt[he]==null){hl(k.nf,he);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(M=Qi(l[0]),M.Hidden&&(M.hidden=!0,delete M.Hidden),M.Width&&(M.wpx=parseInt(M.Width,10)),!V&&M.wpx>10){V=!0,Vs=Bj;for(var Y=0;Y<q.length;++Y)q[Y]&&Nc(q[Y])}V&&Nc(M),q[M.Index-1||q.length]=M;for(var Be=0;Be<+M.Span;++Be)q[q.length]=tn(M);break;case"namedrange":if(l[1]==="/")break;F.Names||(F.Names=[]);var ee=Yt(l[0]),Te={Name:ee.Name,Ref:ad(ee.RefersTo.slice(1),{r:0,c:0})};F.Sheets.length>0&&(Te.Sheet=F.Sheets.length-1),F.Names.push(Te);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?S+=n.slice(I,l.index):I=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Qi(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?CR(Q,X,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"));tW(z),R.push(z)}else c.push([l[3],!1]),A=Qi(l[0]),z={a:A.Author};break;case"autofilter":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Je=Qi(l[0]);h["!autofilter"]={ref:ad(Je.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((A=c.pop())[0]!==l[3])throw new Error("Bad state: "+A.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return H4(n,r);var ie=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ie=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ie=!1}break;case"excelworkbook":switch(l[3]){case"date1904":F.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ie=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:ie=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else T=l.index+l[0].length;break;case"header":h["!margins"]||_A(h["!margins"]={},"xlml"),isNaN(+Yt(l[0]).Margin)||(h["!margins"].header=+Yt(l[0]).Margin);break;case"footer":h["!margins"]||_A(h["!margins"]={},"xlml"),isNaN(+Yt(l[0]).Margin)||(h["!margins"].footer=+Yt(l[0]).Margin);break;case"pagemargins":var $e=Yt(l[0]);h["!margins"]||_A(h["!margins"]={},"xlml"),isNaN(+$e.Top)||(h["!margins"].top=+$e.Top),isNaN(+$e.Left)||(h["!margins"].left=+$e.Left),isNaN(+$e.Right)||(h["!margins"].right=+$e.Right),isNaN(+$e.Bottom)||(h["!margins"].bottom=+$e.Bottom);break;case"displayrighttoleft":F.Views||(F.Views=[]),F.Views[0]||(F.Views[0]={}),F.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ie=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ie=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ie=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ie=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ie=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ie=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ie=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ie=!1}break;case"smarttags":break;default:ie=!1;break}if(ie||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?YG(L,X,P,n.slice(T,l.index)):(P=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ze={};return!r.bookSheets&&!r.bookProps&&(ze.Sheets=u),ze.SheetNames=f,ze.Workbook=F,ze.SSF=tn(zt),ze.Props=Q,ze.Custprops=L,ze}function mw(e,t){switch(qb(t=t||{}),t.type||"base64"){case"base64":return Y1(si(e),t);case"binary":case"buffer":case"file":return Y1(e,t);case"array":return Y1(Dc(e),t)}}function rW(e,t){var r=[];return e.Props&&r.push(NR(e.Props,t)),e.Custprops&&r.push(SR(e.Props,e.Custprops)),r.join("")}function nW(){return""}function sW(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(vt("NumberFormat",null,{"ss:Format":Dr(zt[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(vt("Style",a.join(""),o))}),vt("Styles",r.join(""))}function Yj(e){return vt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ob(e.Ref,{r:0,c:0})})}function aW(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Yj(s)))}return vt("Names",r.join(""))}function iW(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(Yj(l)))}return a.join("")}function oW(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(vt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(vt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(vt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(vt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Bs("ProtectContents","True")),e["!protect"].objects&&s.push(Bs("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Bs("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Bs("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Bs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":vt("WorksheetOptions",s.join(""),{xmlns:Wa.x})}function lW(e){return e.map(function(t){var r=E7(t.t||""),n=vt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return vt("Comment",n,{"ss:Author":t.a})}).join("")}function cW(e,t,r,n,s,a,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Dr(Ob(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=dn(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Dr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Dr(e.l.Tooltip))),r["!merges"])for(var A=r["!merges"],u=0;u!=A.length;++u)A[u].s.c!=o.c||A[u].s.r!=o.r||(A[u].e.c>A[u].s.c&&(l["ss:MergeAcross"]=A[u].e.c-A[u].s.c),A[u].e.r>A[u].s.r&&(l["ss:MergeDown"]=A[u].e.r-A[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Sl[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||zt[14]);break;case"s":f="String",h=k7(e.v||"");break}var d=Oc(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+d),l["ss:Index"]=o.c+1;var x=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=lW(e.c)),vt("Cell",g,l)}function AW(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=bd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uW(e,t,r,n){if(!e["!ref"])return"";var s=_r(e["!ref"]),a=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,m){Nc(y);var p=!!y.width,b=hx(m,y),v={"ss:Index":m+1};p&&(v["ss:Width"]=qf(b.width)),y.hidden&&(v["ss:Hidden"]="1"),l.push(vt("Column",null,v))});for(var c=Array.isArray(e),A=s.s.r;A<=s.e.r;++A){for(var u=[AW(A,(e["!rows"]||[])[A])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>f)&&!(a[o].s.r>A)&&!(a[o].e.c<f)&&!(a[o].e.r<A)){(a[o].s.c!=f||a[o].s.r!=A)&&(h=!0);break}if(!h){var d={r:A,c:f},x=Xt(d),g=c?(e[A]||[])[f]:e[x];u.push(cW(g,x,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function dW(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],o=a?iW(a,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?uW(a,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(oW(a,t,e,r)),n.join("")}function fW(e,t){t||(t={}),e.SSF||(e.SSF=tn(zt)),e.SSF&&(jd(),ox(e.SSF),t.revssf=cx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Oc(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(rW(e,t)),r.push(nW()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(vt("Worksheet",dW(n,t,e),{"ss:Name":Dr(e.SheetNames[n])}));return r[2]=sW(e,t),r[3]=aW(e),Un+vt("Workbook",r.join(""),{xmlns:Wa.ss,"xmlns:o":Wa.o,"xmlns:x":Wa.x,"xmlns:ss":Wa.ss,"xmlns:dt":Wa.dt,"xmlns:html":Wa.html})}function hW(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=aR(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=iR(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var pW=[60,1084,2066,2165,2175];function mW(e,t,r,n,s){var a=n,o=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=a;for(var c=ul(r,r.l),A=gw[c],u=0;A!=null&&pW.indexOf(c)>-1;)a=ul(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+a),o.push(l),r.l+=4+a,A=gw[c=ul(r,r.l)];var f=us(o);_s(f,0);var h=0;f.lens=[];for(var d=0;d<o.length;++d)f.lens.push(h),h+=o[d].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function go(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=zt[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Sl[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Of(e.v):e.w=UA(e.v):e.w=Fi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Fd(zt[n]||String(n))){var s=mA(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function jp(e,t,r){return{v:e,ixfe:t,t:r}}function gW(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},o={},l=null,c=[],A="",u={},f,h="",d,x,g,y,m={},p=[],b,v,C=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},N=function(Me){return Me<8?yA[Me]:Me<64&&k[Me-8]||yA[Me]},Q=function(Me,Ve,Et){var xt=Ve.XF.data;if(!(!xt||!xt.patternType||!Et||!Et.cellStyles)){Ve.s={},Ve.s.patternType=xt.patternType;var st;(st=Kf(N(xt.icvFore)))&&(Ve.s.fgColor={rgb:st}),(st=Kf(N(xt.icvBack)))&&(Ve.s.bgColor={rgb:st})}},L=function(Me,Ve,Et){if(!(ce>1)&&!(Et.sheetRows&&Me.r>=Et.sheetRows)){if(Et.cellStyles&&Ve.XF&&Ve.XF.data&&Q(Me,Ve,Et),delete Ve.ixfe,delete Ve.XF,f=Me,h=Xt(Me),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Me.r<o.s.r&&(o.s.r=Me.r),Me.c<o.s.c&&(o.s.c=Me.c),Me.r+1>o.e.r&&(o.e.r=Me.r+1),Me.c+1>o.e.c&&(o.e.c=Me.c+1),Et.cellFormula&&Ve.f){for(var xt=0;xt<p.length;++xt)if(!(p[xt][0].s.c>Me.c||p[xt][0].s.r>Me.r)&&!(p[xt][0].e.c<Me.c||p[xt][0].e.r<Me.r)){Ve.F=ir(p[xt][0]),(p[xt][0].s.c!=Me.c||p[xt][0].s.r!=Me.r)&&delete Ve.f,Ve.f&&(Ve.f=""+Hs(p[xt][1],o,Me,H,T));break}}Et.dense?(s[Me.r]||(s[Me.r]=[]),s[Me.r][Me.c]=Ve):s[h]=Ve}},T={enc:!1,sbcch:0,snames:[],sharedf:m,arrayf:p,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var P,R=[],z=[],q=[],M=[],V=!1,H=[];H.SheetNames=T.snames,H.sharedf=T.sharedf,H.arrayf=T.arrayf,H.names=[],H.XTI=[];var se=0,ce=0,B=0,U=[],F=[],D;T.codepage=1200,Xi(1200);for(var X=!1;e.l<e.length-1;){var K=e.l,ae=e.read_shift(2);if(ae===0&&se===10)break;var he=e.l===e.length?0:e.read_shift(2),Y=gw[ae];if(Y&&Y.f){if(t.bookSheets&&se===133&&ae!==133)break;if(se=ae,Y.r===2||Y.r==12){var Be=e.read_shift(2);if(he-=2,!T.enc&&Be!==ae&&((Be&255)<<8|Be>>8)!==ae)throw new Error("rt mismatch: "+Be+"!="+ae);Y.r==12&&(e.l+=10,he-=10)}var ee={};if(ae===10?ee=Y.f(e,he,T):ee=mW(ae,Y,e,he,T),ce==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(ae){case 34:r.opts.Date1904=S.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=ee,!t.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=ee;break;case 66:var Te=Number(ee);switch(Te){case 21010:Te=1200;break;case 32768:Te=1e4;break;case 32769:Te=1252;break}Xi(T.codepage=Te),X=!0;break;case 317:T.rrtabid=ee;break;case 25:T.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:T.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(s["!type"]="dialog"),ee.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ee.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:C.push(ee);break;case 430:H.push([ee]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(ee);break;case 24:case 536:D={Name:ee.Name,Ref:Hs(ee.rgce,o,null,H,T)},ee.itab>0&&(D.Sheet=ee.itab-1),H.names.push(D),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(F[ee.itab-1]={ref:ir(ee.rgce[0][0][1][2])});break;case 22:T.ExternCount=ee;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(ee),H.XTI=H.XTI.concat(ee);break;case 2196:if(T.biff<8)break;D!=null&&(D.Comment=ee[1]);break;case 18:s["!protect"]=ee;break;case 19:ee!==0&&T.WTF&&console.error("Password verifier: "+ee);break;case 133:a[ee.pos]=ee,T.snames.push(ee.name);break;case 10:{if(--ce)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=ir(o),t.sheetRows&&t.sheetRows<=o.e.r){var Je=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ir(o),o.e.r=Je}o.e.r++,o.e.c++}R.length>0&&(s["!merges"]=R),z.length>0&&(s["!objects"]=z),q.length>0&&(s["!cols"]=q),M.length>0&&(s["!rows"]=M),S.Sheets.push(I)}A===""?u=s:n[A]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),T.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(T.biff=5,X=!0,Xi(T.codepage=28591)),T.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(T.biff=2),ce++)break;if(s=t.dense?[]:{},T.biff<8&&!X&&(X=!0,Xi(T.codepage=t.codepage||1252)),T.biff<5||ee.BIFFVer==0&&ee.dt==4096){A===""&&(A="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ie={pos:e.l-he,name:A};a[ie.pos]=ie,T.snames.push(A)}else A=(a[K]||{name:""}).name;ee.dt==32&&(s["!type"]="chart"),ee.dt==64&&(s["!type"]="macro"),R=[],z=[],T.arrayf=p=[],q=[],M=[],V=!1,I={Hidden:(a[K]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[ee.r]||[])[ee.c]:s[Xt({c:ee.c,r:ee.r})])&&++ee.c,b={ixfe:ee.ixfe,XF:C[ee.ixfe]||{},v:ee.val,t:"n"},B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:ee.c,r:ee.r},b,t);break;case 5:case 517:b={ixfe:ee.ixfe,XF:C[ee.ixfe],v:ee.val,t:ee.t},B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:ee.c,r:ee.r},b,t);break;case 638:b={ixfe:ee.ixfe,XF:C[ee.ixfe],v:ee.rknum,t:"n"},B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:ee.c,r:ee.r},b,t);break;case 189:for(var $e=ee.c;$e<=ee.C;++$e){var ze=ee.rkrec[$e-ee.c][0];b={ixfe:ze,XF:C[ze],v:ee.rkrec[$e-ee.c][1],t:"n"},B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:$e,r:ee.r},b,t)}break;case 6:case 518:case 1030:{if(ee.val=="String"){l=ee;break}if(b=jp(ee.val,ee.cell.ixfe,ee.tt),b.XF=C[b.ixfe],t.cellFormula){var Fe=ee.formula;if(Fe&&Fe[0]&&Fe[0][0]&&Fe[0][0][0]=="PtgExp"){var Re=Fe[0][0][1][0],at=Fe[0][0][1][1],we=Xt({r:Re,c:at});m[we]?b.f=""+Hs(ee.formula,o,ee.cell,H,T):b.F=((t.dense?(s[Re]||[])[at]:s[we])||{}).F}else b.f=""+Hs(ee.formula,o,ee.cell,H,T)}B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L(ee.cell,b,t),l=ee}break;case 7:case 519:if(l)l.val=ee,b=jp(ee,l.cell.ixfe,"s"),b.XF=C[b.ixfe],t.cellFormula&&(b.f=""+Hs(l.formula,o,l.cell,H,T)),B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L(l.cell,b,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{p.push(ee);var ve=Xt(ee[0].s);if(d=t.dense?(s[ee[0].s.r]||[])[ee[0].s.c]:s[ve],t.cellFormula&&d){if(!l||!ve||!d)break;d.f=""+Hs(ee[1],o,ee[0],H,T),d.F=ir(ee[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;m[Xt(l.cell)]=ee[0],d=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Xt(l.cell)],(d||{}).f=""+Hs(ee[0],o,f,H,T)}}break;case 253:b=jp(c[ee.isst].t,ee.ixfe,"s"),c[ee.isst].h&&(b.h=c[ee.isst].h),b.XF=C[b.ixfe],B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:ee.c,r:ee.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:ee.ixfe,XF:C[ee.ixfe],t:"z"},B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:ee.c,r:ee.r},b,t));break;case 190:if(t.sheetStubs)for(var Le=ee.c;Le<=ee.C;++Le){var tt=ee.ixfe[Le-ee.c];b={ixfe:tt,XF:C[tt],t:"z"},B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:Le,r:ee.r},b,t)}break;case 214:case 516:case 4:b=jp(ee.val,ee.ixfe,"s"),b.XF=C[b.ixfe],B>0&&(b.z=U[b.ixfe>>8&63]),go(b,t,r.opts.Date1904),L({c:ee.c,r:ee.r},b,t);break;case 0:case 512:ce===1&&(o=ee);break;case 252:c=ee;break;case 1054:if(T.biff==4){U[B++]=ee[1];for(var lt=0;lt<B+163&&zt[lt]!=ee[1];++lt);lt>=163&&hl(ee[1],B+163)}else hl(ee[1],ee[0]);break;case 30:{U[B++]=ee;for(var it=0;it<B+163&&zt[it]!=ee;++it);it>=163&&hl(ee,B+163)}break;case 229:R=R.concat(ee);break;case 93:z[ee.cmo[0]]=T.lastobj=ee;break;case 438:T.lastobj.TxO=ee;break;case 127:T.lastobj.ImData=ee;break;case 440:for(y=ee[0].s.r;y<=ee[0].e.r;++y)for(g=ee[0].s.c;g<=ee[0].e.c;++g)d=t.dense?(s[y]||[])[g]:s[Xt({c:g,r:y})],d&&(d.l=ee[1]);break;case 2048:for(y=ee[0].s.r;y<=ee[0].e.r;++y)for(g=ee[0].s.c;g<=ee[0].e.c;++g)d=t.dense?(s[y]||[])[g]:s[Xt({c:g,r:y})],d&&d.l&&(d.l.Tooltip=ee[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;d=t.dense?(s[ee[0].r]||[])[ee[0].c]:s[Xt(ee[0])];var Ne=z[ee[2]];d||(t.dense?(s[ee[0].r]||(s[ee[0].r]=[]),d=s[ee[0].r][ee[0].c]={t:"z"}):d=s[Xt(ee[0])]={t:"z"},o.e.r=Math.max(o.e.r,ee[0].r),o.s.r=Math.min(o.s.r,ee[0].r),o.e.c=Math.max(o.e.c,ee[0].c),o.s.c=Math.min(o.s.c,ee[0].c)),d.c||(d.c=[]),x={a:ee[1],t:Ne.TxO.t},d.c.push(x)}break;case 2173:sH(C[ee.ixfe],ee.ext);break;case 125:{if(!T.cellStyles)break;for(;ee.e>=ee.s;)q[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},V||(V=!0,Lb(ee.w/256)),Nc(q[ee.e+1])}break;case 520:{var ke={};ee.level!=null&&(M[ee.r]=ke,ke.level=ee.level),ee.hidden&&(M[ee.r]=ke,ke.hidden=!0),ee.hpt&&(M[ee.r]=ke,ke.hpt=ee.hpt,ke.hpx=bd(ee.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||_A(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=ee;break;case 161:s["!margins"]||_A(s["!margins"]={}),s["!margins"].header=ee.header,s["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(S.Views[0].RTL=!0);break;case 146:k=ee;break;case 2198:P=ee;break;case 140:v=ee;break;case 442:A?I.CodeName=ee||I.name:S.WBProps.CodeName=ee||"ThisWorkbook";break}}else Y||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=he}return r.SheetNames=wn(a).sort(function(qe,Me){return Number(qe)-Number(Me)}).map(function(qe){return a[qe].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&F.forEach(function(qe,Me){r.Sheets[r.SheetNames[Me]]["!autofilter"]=qe}),r.Strings=c,r.SSF=tn(zt),T.enc&&(r.Encryption=T.enc),P&&(r.Themes=P),r.Metadata={},v!==void 0&&(r.Metadata.Country=v),H.names.length>0&&(S.Names=H.names),r.Workbook=S,r}var of={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xW(e,t,r){var n=Gt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=x4(n,Aw,of.DSI);for(var a in s)t[a]=s[a]}catch(A){if(r.WTF)throw A}var o=Gt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=x4(o,uw,of.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(A){if(r.WTF)throw A}t.HeadingPairs&&t.TitlesOfParts&&(XF(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vW(e,t){var r=[],n=[],s=[],a=0,o,l=$B(Aw,"n"),c=$B(uw,"n");if(e.Props)for(o=wn(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=wn(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(l,o[a])?r:Object.prototype.hasOwnProperty.call(c,o[a])?n:s).push([o[a],e.Custprops[o[a]]]);var A=[];for(a=0;a<s.length;++a)nj.indexOf(s[a][0])>-1||zF.indexOf(s[a][0])>-1||s[a][1]!=null&&A.push(s[a]);n.length&&Gt.utils.cfb_add(t,"/SummaryInformation",v4(n,of.SI,c,uw)),(r.length||A.length)&&Gt.utils.cfb_add(t,"/DocumentSummaryInformation",v4(r,of.DSI,l,Aw,A.length?A:null,of.UDI))}function Jj(e,t){t||(t={}),qb(t),ub(),t.codepage&&Ab(t.codepage);var r,n;if(e.FullPaths){if(Gt.find(e,"/encryption"))throw new Error("File is password-protected");r=Gt.find(e,"!CompObj"),n=Gt.find(e,"/Workbook")||Gt.find(e,"/Book")}else{switch(t.type){case"base64":e=Ya(si(e));break;case"binary":e=Ya(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}_s(e,0),n={content:e}}var s,a;if(r&&hW(r),t.bookProps&&!t.bookSheets)s={};else{var o=ur?"buffer":"array";if(n&&n.content)s=gW(n.content,t);else if((a=Gt.find(e,"PerfectOffice_MAIN"))&&a.content)s=bA.to_workbook(a.content,(t.type=o,t));else if((a=Gt.find(e,"NativeContent_MAIN"))&&a.content)s=bA.to_workbook(a.content,(t.type=o,t));else throw(a=Gt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Gt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=TH(e))}var l={};return e.FullPaths&&xW(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function yW(e,t){var r=t||{},n=Gt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Gt.utils.cfb_add(n,s,Zj(e,r)),r.biff==8&&(e.Props||e.Custprops)&&vW(e,n),r.biff==8&&e.vbaraw&&IH(n,Gt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Wf={0:{f:qq},1:{f:Jq},2:{f:gV},3:{f:iV},4:{f:rV},5:{f:hV},6:{f:bV},7:{f:AV},8:{f:EV},9:{f:kV},10:{f:NV},11:{f:SV},12:{f:eV},13:{f:vV},14:{f:lV},15:{f:sV},16:{f:qj},17:{f:BV},18:{f:dV},19:{f:Cb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:BG},40:{},42:{},43:{f:b9},44:{f:y9},45:{f:C9},46:{f:S9},47:{f:N9},48:{},49:{f:W7},50:{},51:{f:oH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:hj},62:{f:wV},63:{f:mH},64:{f:VV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:MV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Xq},148:{f:Wq,p:16},151:{f:LV},152:{},153:{f:wG},154:{},155:{},156:{f:vG},157:{},158:{},159:{T:1,f:PM},160:{T:-1},161:{T:1,f:$A},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:FV},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:aH},336:{T:-1},337:{f:AH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fj},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DV},427:{f:PV},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:RV},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zq},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IV},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:SH},633:{T:1},634:{T:-1},635:{T:1,f:CH},636:{T:-1},637:{f:Y7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:GV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},gw={6:{f:z1},10:{f:Gl},12:{f:Hn},13:{f:Hn},14:{f:Sn},15:{f:Sn},16:{f:Gs},17:{f:Sn},18:{f:Sn},19:{f:Hn},20:{f:C4},21:{f:C4},23:{f:fj},24:{f:S4},25:{f:Sn},26:{},27:{},28:{f:GQ},29:{},34:{f:Sn},35:{f:N4},38:{f:Gs},39:{f:Gs},40:{f:Gs},41:{f:Gs},42:{f:Sn},43:{f:Sn},47:{f:s9},49:{f:vQ},51:{f:Hn},60:{},61:{f:hQ},64:{f:Sn},65:{f:xQ},66:{f:Hn},77:{},80:{},81:{},82:{},85:{f:Hn},89:{},90:{},91:{},92:{f:nQ},93:{f:zQ},94:{},95:{f:Sn},96:{},97:{},99:{f:Sn},125:{f:hj},128:{f:UQ},129:{f:aQ},130:{f:Hn},131:{f:Sn},132:{f:Sn},133:{f:iQ},134:{},140:{f:nM},141:{f:Hn},144:{},146:{f:iM},151:{},152:{},153:{},154:{},155:{},156:{f:Hn},157:{},158:{},160:{f:fM},161:{f:cM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:FQ},190:{f:jQ},193:{f:Gl},197:{},198:{},199:{},200:{},201:{},202:{f:Sn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Hn},220:{},221:{f:Sn},222:{},224:{f:IQ},225:{f:rQ},226:{f:Gl},227:{},229:{f:WQ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:lQ},253:{f:wQ},255:{f:AQ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sj},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Sn},353:{f:Gl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:RQ},431:{f:Sn},432:{},433:{},434:{},437:{},438:{f:JQ},439:{f:Sn},440:{f:ZQ},441:{},442:{f:dh},443:{},444:{f:Hn},445:{},446:{},448:{f:Gl},449:{f:fQ,r:2},450:{f:Gl},512:{f:b4},513:{f:dM},515:{f:PQ},516:{f:_Q},517:{f:B4},519:{f:hM},520:{f:uQ},523:{},545:{f:k4},549:{f:w4},566:{},574:{f:mQ},638:{f:EQ},659:{},1048:{},1054:{f:CQ},1084:{},1212:{f:KQ},2048:{f:tM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:kp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Gl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:oM,r:12},2173:{f:nH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Sn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HQ,r:12},2197:{},2198:{f:Y9,r:12},2199:{},2200:{},2201:{},2202:{f:qQ,r:12},2203:{f:Gl},2204:{},2205:{},2206:{},2207:{},2211:{f:dQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Hn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:AM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:aM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:b4},1:{},2:{f:vM},3:{f:gM},4:{f:mM},5:{f:B4},7:{f:wM},8:{},9:{f:kp},11:{},22:{f:Hn},30:{f:SQ},31:{},32:{},33:{f:k4},36:{},37:{f:w4},50:{f:bM},62:{},52:{},67:{},68:{f:Hn},69:{},86:{},126:{},127:{f:pM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:_M},223:{},234:{},354:{},421:{},518:{f:z1},521:{f:kp},536:{f:S4},547:{f:N4},561:{},579:{},1030:{f:z1},1033:{f:kp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function wt(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&bb(r)&&e.push(r)}}function wW(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return wt(e,t,r,s);var a=t;if(!isNaN(a)){for(var o=r.parts||[],l=0,c=0,A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,a),u.write_shift(2,A),e.push(r.slice(c,c+A)),c+=A;c<s;){for(u=e.next(4),u.write_shift(2,60),A=0;A+(o[l]||8224)<=8224;)A+=o[l]||8224,l++;u.write_shift(2,A),e.push(r.slice(c,c+A)),c+=A}}}function mh(e,t,r){return e||(e=Xe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function bW(e,t,r,n){var s=Xe(9);return mh(s,e,t),aj(r,n||"b",s),s}function _W(e,t,r){var n=Xe(8+2*r.length);return mh(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function BW(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?is(en(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?wt(e,2,yM(r,n,s)):wt(e,3,xM(r,n,s));return;case"b":case"e":wt(e,5,bW(r,n,t.v,t.t));return;case"s":case"str":wt(e,4,_W(r,n,(t.v||"").slice(0,255)));return}wt(e,1,mh(null,r,n))}function CW(e,t,r,n){var s=Array.isArray(t),a=_r(t["!ref"]||"A1"),o,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=ir(a)}for(var A=a.s.r;A<=a.e.r;++A){l=In(A);for(var u=a.s.c;u<=a.e.c;++u){A===a.s.r&&(c[u]=un(u)),o=c[u]+l;var f=s?(t[A]||[])[u]:t[o];f&&BW(e,f,A,u)}}}function NW(e,t){for(var r=t||{},n=Ea(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return wt(n,r.biff==4?1033:r.biff==3?521:9,Tb(e,16,r)),CW(n,e.Sheets[e.SheetNames[s]],s,r),wt(n,10),n.end()}function SW(e,t,r){wt(e,49,yQ({sz:12,name:"Arial"},r))}function kW(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&wt(e,1054,NQ(s,t[s],r))})}function EW(e,t){var r=Xe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),wt(e,2151,r),r=Xe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Aj(_r(t["!ref"]||"A1"),r),r.write_shift(4,4),wt(e,2152,r)}function FW(e,t){for(var r=0;r<16;++r)wt(e,224,_4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){wt(e,224,_4(n,0,t))})}function jW(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];wt(e,440,eM(n)),n[1].Tooltip&&wt(e,2048,rM(n))}delete t["!links"]}function TW(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&wt(e,125,lM(hx(s,n),s))})}}function IW(e,t,r,n,s){var a=16+Oc(s.cellXfs,t,s);if(t.v==null&&!t.bf){wt(e,513,OA(r,n,a));return}if(t.bf)wt(e,6,aq(t,r,n,s,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?is(en(t.v)):t.v;wt(e,515,OQ(r,n,o,a));break;case"b":case"e":wt(e,517,DQ(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var l=Qb(s.Strings,t.v,s.revStrings);wt(e,253,bQ(r,n,l,a))}else wt(e,516,BQ(r,n,(t.v||"").slice(0,255),a,s));break;default:wt(e,513,OA(r,n,a))}}function UW(e,t,r){var n=Ea(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(a),A=t.biff==8,u,f="",h=[],d=_r(a["!ref"]||"A1"),x=A?65536:16384;if(d.e.c>255||d.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,x-1)}wt(n,2057,Tb(r,16,t)),wt(n,13,vi(1)),wt(n,12,vi(100)),wt(n,15,Aa(!0)),wt(n,17,Aa(!1)),wt(n,16,DA(.001)),wt(n,95,Aa(!0)),wt(n,42,Aa(!1)),wt(n,43,Aa(!1)),wt(n,130,vi(1)),wt(n,128,LQ()),wt(n,131,Aa(!1)),wt(n,132,Aa(!1)),A&&TW(n,a["!cols"]),wt(n,512,kQ(d,t)),A&&(a["!links"]=[]);for(var g=d.s.r;g<=d.e.r;++g){f=In(g);for(var y=d.s.c;y<=d.e.c;++y){g===d.s.r&&(h[y]=un(y)),u=h[y]+f;var m=c?(a[g]||[])[y]:a[u];m&&(IW(n,m,g,y,t),A&&m.l&&a["!links"].push([u,m.l]))}}var p=l.CodeName||l.name||s;return A&&wt(n,574,gQ((o.Views||[])[0])),A&&(a["!merges"]||[]).length&&wt(n,229,$Q(a["!merges"])),A&&jW(n,a),wt(n,442,ij(p)),A&&EW(n,a),wt(n,10),n.end()}function LW(e,t,r){var n=Ea(),s=(e||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(wt(n,2057,Tb(e,5,r)),r.bookType=="xla"&&wt(n,135),wt(n,225,l?vi(1200):null),wt(n,193,DR(2)),c&&wt(n,191),c&&wt(n,192),wt(n,226),wt(n,92,sQ("SheetJS",r)),wt(n,66,vi(l?1200:1252)),l&&wt(n,353,vi(0)),l&&wt(n,448),wt(n,317,uM(e.SheetNames.length)),l&&e.vbaraw&&wt(n,211),l&&e.vbaraw){var A=o.CodeName||"ThisWorkbook";wt(n,442,ij(A))}wt(n,156,vi(17)),wt(n,25,Aa(!1)),wt(n,18,Aa(!1)),wt(n,19,vi(0)),l&&wt(n,431,Aa(!1)),l&&wt(n,444,vi(0)),wt(n,61,pQ()),wt(n,64,Aa(!1)),wt(n,141,vi(0)),wt(n,34,Aa(fG(e)=="true")),wt(n,14,Aa(!0)),l&&wt(n,439,Aa(!1)),wt(n,218,vi(0)),SW(n,e,r),kW(n,e.SSF,r),FW(n,r),l&&wt(n,352,Aa(!1));var u=n.end(),f=Ea();l&&wt(f,140,sM()),l&&r.Strings&&wW(f,252,cQ(r.Strings)),wt(f,10);var h=f.end(),d=Ea(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var y=u.length+x+h.length;for(g=0;g<e.SheetNames.length;++g){var m=a[g]||{};wt(d,133,oQ({pos:y,hs:m.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var p=d.end();if(x!=p.length)throw new Error("BS8 "+x+" != "+p.length);var b=[];return u.length&&b.push(u),p.length&&b.push(p),h.length&&b.push(h),us(b)}function DW(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=tn(zt)),e&&e.SSF&&(jd(),ox(e.SSF),r.revssf=cx(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Vb(r),r.cellXfs=[],Oc(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=UW(s,r,e);return n.unshift(LW(e,n,r)),us(n)}function Zj(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Ta(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return DW(e,t);case 4:case 3:case 2:return NW(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function O4(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=s.index,l=a&&a.index||e.length,c=y7(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,u=0,f=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var g=c[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++A,r.sheetRows&&r.sheetRows<=A){--A;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var m=g.split(/<\/t[dh]>/i);for(l=0;l<m.length;++l){var p=m[l].trim();if(p.match(/<t[dh]/i)){for(var b=p,v=0;b.charAt(0)=="<"&&(v=b.indexOf(">"))>-1;)b=b.slice(v+1);for(var C=0;C<x.length;++C){var k=x[C];k.s.c==u&&k.s.r<A&&A<=k.e.r&&(u=k.e.c+1,C=-1)}var S=Yt(p.slice(0,p.indexOf(">")));h=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||h>1)&&x.push({s:{r:A,c:u},e:{r:A+(f||1)-1,c:u+h-1}});var I=S.t||S["data-t"]||"";if(!b.length){u+=h;continue}if(b=_F(b),d.s.r>A&&(d.s.r=A),d.e.r<A&&(d.e.r=A),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!b.length){u+=h;continue}var N={t:"s",v:b};r.raw||!b.trim().length||I=="s"||(b==="TRUE"?N={t:"b",v:!0}:b==="FALSE"?N={t:"b",v:!1}:isNaN(to(b))?isNaN(yd(b).getDate())||(N={t:"d",v:en(b)},r.cellDates||(N={t:"n",v:is(N.v)}),N.z=r.dateNF||zt[14]):N={t:"n",v:to(b)}),r.dense?(n[A]||(n[A]=[]),n[A][u]=N):n[Xt({r:A,c:u})]=N,u+=h}}}}return n["!ref"]=ir(d),x.length&&(n["!merges"]=x),n}function PW(e,t,r,n){for(var s=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,A=0;A<s.length;++A)if(!(s[A].s.r>r||s[A].s.c>o)&&!(s[A].e.r<r||s[A].e.c<o)){if(s[A].s.r<r||s[A].s.c<o){l=-1;break}l=s[A].e.r-s[A].s.r+1,c=s[A].e.c-s[A].s.c+1;break}if(!(l<0)){var u=Xt({r,c:o}),f=n.dense?(e[r]||[])[o]:e[u],h=f&&f.v!=null&&(f.h||vb(f.w||(wl(f),f.w)||""))||"",d={};l>1&&(d.rowspan=l),c>1&&(d.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,a.push(vt("td",h,d))}}var x="<tr>";return x+a.join("")+"</tr>"}var OW='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',RW="</body></html>";function QW(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Pc(O4(r[0],t),t);var n=$b();return r.forEach(function(s,a){zb(n,O4(s,t),"Sheet"+(a+1))}),n}function MW(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function e6(e,t){var r=t||{},n=r.header!=null?r.header:OW,s=r.footer!=null?r.footer:RW,a=[n],o=Ta(e["!ref"]);r.dense=Array.isArray(e),a.push(MW(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)a.push(PW(e,o,l,r));return a.push("</table>"+s),a.join("")}function t6(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?dn(n.origin):n.origin;s=o.r,a=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),A={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var u=Ta(e["!ref"]);A.s.r=Math.min(A.s.r,u.s.r),A.s.c=Math.min(A.s.c,u.s.c),A.e.r=Math.max(A.e.r,u.e.r),A.e.c=Math.max(A.e.c,u.e.c),s==-1&&(A.e.r=s=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),x=0,g=0,y=0,m=0,p=0,b=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&g<c;++x){var v=l[x];if(R4(v)){if(n.display)continue;d[g]={hidden:!0}}var C=v.children;for(y=m=0;y<C.length;++y){var k=C[y];if(!(n.display&&R4(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):_F(k.innerHTML),I=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var N=f[h];N.s.c==m+a&&N.s.r<g+s&&g+s<=N.e.r&&(m=N.e.c+1-a,h=-1)}b=+k.getAttribute("colspan")||1,((p=+k.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:g+s,c:m+a},e:{r:g+s+(p||1)-1,c:m+a+(b||1)-1}});var Q={t:"s",v:S},L=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?Q.t=L||"z":n.raw||S.trim().length==0||L=="s"||(S==="TRUE"?Q={t:"b",v:!0}:S==="FALSE"?Q={t:"b",v:!1}:isNaN(to(S))?isNaN(yd(S).getDate())||(Q={t:"d",v:en(S)},n.cellDates||(Q={t:"n",v:is(Q.v)}),Q.z=n.dateNF||zt[14]):Q={t:"n",v:to(S)})),Q.z===void 0&&I!=null&&(Q.z=I);var T="",P=k.getElementsByTagName("A");if(P&&P.length)for(var R=0;R<P.length&&!(P[R].hasAttribute("href")&&(T=P[R].getAttribute("href"),T.charAt(0)!="#"));++R);T&&T.charAt(0)!="#"&&(Q.l={Target:T}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][m+a]=Q):e[Xt({c:m+a,r:g+s})]=Q,A.e.c<m+a&&(A.e.c=m+a),m+=b}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),A.e.r=Math.max(A.e.r,g-1+s),e["!ref"]=ir(A),g>=c&&(e["!fullref"]=ir((A.e.r=l.length-x+g-1+s,A))),e}function r6(e,t){var r=t||{},n=r.dense?[]:{};return t6(n,e,t)}function HW(e,t){return Pc(r6(e,t),t)}function R4(e){var t="",r=KW(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function KW(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function qW(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=br(t.replace(/<[^>]*>/g,""));return[r]}var Q4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function n6(e,t){var r=t||{},n=yb(e),s=[],a,o,l={name:""},c="",A=0,u,f,h={},d=[],x=r.dense?[]:{},g,y,m={value:""},p="",b=0,v=[],C=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,N={},Q=[],L={},T=0,P=0,R=[],z=1,q=1,M=[],V={Names:[]},H={},se=["",""],ce=[],B={},U="",F=0,D=!1,X=!1,K=0;for(Mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Mf.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?x["!ref"]=ir(S):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(x["!fullref"]=x["!ref"],S.e.r=r.sheetRows-1,x["!ref"]=ir(S)),Q.length&&(x["!merges"]=Q),R.length&&(x["!rows"]=R),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),h[u.name]=x,X=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Yt(g[0],!1),C=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,x=r.dense?[]:{},Q=[],R=[],X=!0);break;case"table-row-group":g[1]==="/"?--I:++I;break;case"table-row":case"":if(g[1]==="/"){C+=z,z=1;break}if(f=Yt(g[0],!1),f.?C=f.-1:C==-1&&(C=0),z=+f["number-rows-repeated"]||1,z<10)for(K=0;K<z;++K)I>0&&(R[C+K]={level:I});k=-1;break;case"covered-table-cell":g[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(x[C]||(x[C]=[]),x[C][k]={t:"z"}):x[Xt({r:C,c:k})]={t:"z"}),p="",v=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++k,m=Yt(g[0],!1),q=parseInt(m["number-columns-repeated"]||"1",10),y={t:"z",v:null},m.formula&&r.cellFormula!=!1&&(y.f=L4(br(m.formula))),(m.||m["value-type"])=="string"&&(y.t="s",y.v=br(m["string-value"]||""),r.dense?(x[C]||(x[C]=[]),x[C][k]=y):x[Xt({r:C,c:k})]=y),k+=q-1;else if(g[1]!=="/"){++k,p="",b=0,v=[],q=1;var ae=z?C+z-1:C;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),C<S.s.r&&(S.s.r=C),ae>S.e.r&&(S.e.r=ae),m=Yt(g[0],!1),ce=[],B={},y={t:m.||m["value-type"],v:null},r.cellFormula)if(m.formula&&(m.formula=br(m.formula)),m["number-matrix-columns-spanned"]&&m["number-matrix-rows-spanned"]&&(T=parseInt(m["number-matrix-rows-spanned"],10)||0,P=parseInt(m["number-matrix-columns-spanned"],10)||0,L={s:{r:C,c:k},e:{r:C+T-1,c:k+P-1}},y.F=ir(L),M.push([L,y.F])),m.formula)y.f=L4(m.formula);else for(K=0;K<M.length;++K)C>=M[K][0].s.r&&C<=M[K][0].e.r&&k>=M[K][0].s.c&&k<=M[K][0].e.c&&(y.F=M[K][1]);switch((m["number-columns-spanned"]||m["number-rows-spanned"])&&(T=parseInt(m["number-rows-spanned"],10)||0,P=parseInt(m["number-columns-spanned"],10)||0,L={s:{r:C,c:k},e:{r:C+T-1,c:k+P-1}},Q.push(L)),m["number-columns-repeated"]&&(q=parseInt(m["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Yr(m["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(m.value);break;case"percentage":y.t="n",y.v=parseFloat(m.value);break;case"currency":y.t="n",y.v=parseFloat(m.value);break;case"date":y.t="d",y.v=en(m["date-value"]),r.cellDates||(y.t="n",y.v=is(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=g7(m["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Ax(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(m.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",m["string-value"]!=null&&(p=br(m["string-value"]),v=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(D=!1,y.t==="s"&&(y.v=p||"",v.length&&(y.R=v),D=b==0),H.Target&&(y.l=H),ce.length>0&&(y.c=ce,ce=[]),p&&r.cellText!==!1&&(y.w=p),D&&(y.t="z",delete y.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var he=0;he<z;++he){if(q=parseInt(m["number-columns-repeated"]||"1",10),r.dense)for(x[C+he]||(x[C+he]=[]),x[C+he][k]=he==0?y:tn(y);--q>0;)x[C+he][k+q]=tn(y);else for(x[Xt({r:C+he,c:k})]=y;--q>0;)x[Xt({r:C+he,c:k+q})]=tn(y);S.e.c<=k&&(S.e.c=k)}q=parseInt(m["number-columns-repeated"]||"1",10),k+=q-1,q=0,y={},p="",v=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;B.t=p,v.length&&(B.R=v),B.a=U,ce.push(B)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);U="",F=0,p="",b=0,v=[];break;case"creator":g[1]==="/"?U=n.slice(F,g.index):F=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);p="",b=0,v=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(N[l.name]=c,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Yt(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Yt(g[0],!1),c+=Q4[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Yt(g[0],!1),c+=Q4[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(A,g.index);break}else A=g.index+g[0].length;break;case"named-range":o=Yt(g[0],!1),se=X1(o["cell-range-address"]);var Y={Name:o.name,Ref:se[0]+"!"+se[1]};X&&(Y.Sheet=d.length),V.Names.push(Y);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!m||!m["string-value"])){var Be=qW(n.slice(b,g.index));p=(p.length>0?p+`
`:"")+Be[0]}else Yt(g[0],!1),b=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{se=X1(Yt(g[0])["target-range-address"]),h[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(H=Yt(g[0],!1),!H.href)break;H.Target=br(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(se=X1(H.Target.slice(1)),H.Target="#"+se[0]+"!"+se[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var ee={Sheets:h,SheetNames:d,Workbook:V};return r.bookSheets&&delete ee.Sheets,ee}function M4(e,t){t=t||{},mi(e,"META-INF/manifest.xml")&&gR(Mn(e,"META-INF/manifest.xml"),t);var r=Ja(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=n6(Rr(r),t);return mi(e,"meta.xml")&&(n.Props=WF(Mn(e,"meta.xml"))),n}function H4(e,t){return n6(e,t)}var VW=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Qf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Un+t}}(),K4=function(){var e=function(a){return Dr(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,l){var c=[];c.push('      <table:table table:name="'+Dr(o.SheetNames[l])+`" table:style-name="ta1">
`);var A=0,u=0,f=Ta(a["!ref"]||"A1"),h=a["!merges"]||[],d=0,x=Array.isArray(a);if(a["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",y=a["!rows"]||[];for(A=0;A<f.s.r;++A)g=y[A]?' table:style-name="ro'+y[A].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;A<=f.e.r;++A){for(g=y[A]?' table:style-name="ro'+y[A].ods+'"':"",c.push("        <table:table-row"+g+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var m=!1,p={},b="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>u)&&!(h[d].s.r>A)&&!(h[d].e.c<u)&&!(h[d].e.r<A)){(h[d].s.c!=u||h[d].s.r!=A)&&(m=!0),p["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,p["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(m){c.push(r);continue}var v=Xt({r:A,c:u}),C=x?(a[A]||[])[u]:a[v];if(C&&C.f&&(p["table:formula"]=Dr(uq(C.f)),C.F&&C.F.slice(0,v.length)==v)){var k=Ta(C.F);p["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,p["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!C){c.push(t);continue}switch(C.t){case"b":b=C.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=C.v?"true":"false";break;case"n":b=C.w||String(C.v||0),p["office:value-type"]="float",p["office:value"]=C.v||0;break;case"s":case"str":b=C.v==null?"":C.v,p["office:value-type"]="string";break;case"d":b=C.w||en(C.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=en(C.v).toISOString(),p["table:style-name"]="ce1";break;default:c.push(t);continue}var S=e(b);if(C.l&&C.l.Target){var I=C.l.Target;I=I.charAt(0)=="#"?"#"+dq(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),S=vt("text:a",S,{"xlink:href":I.replace(/&/g,"&amp;")})}c.push("          "+vt("table:table-cell",vt("text:p",S,{}),p)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!cols"]){for(var u=0;u<A["!cols"].length;++u)if(A["!cols"][u]){var f=A["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Nc(f),f.ods=l;var h=A["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(A){return o.Sheets[A]}).forEach(function(A){if(A&&A["!rows"]){for(var u=0;u<A["!rows"].length;++u)if(A["!rows"][u]){A["!rows"][u].ods=c;var f=A["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Un],A=Qf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Qf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+A+u+`>
`),c.push(GF().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+A+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function s6(e,t){if(t.bookType=="fods")return K4(e,t);var r=mb(),n="",s=[],a=[];return n="mimetype",cr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",cr(r,n,K4(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",cr(r,n,VW(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",cr(r,n,Un+GF()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",cr(r,n,yR(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",cr(r,n,xR(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function RA(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function xw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Rr(Dc(e))}function GW(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ya(No(e))}function WW(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function kc(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function q4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function $W(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function zW(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function $f(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ir(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function yn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Cr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=$f(e,r),a=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=$f(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var A={data:l,type:a};t[s]==null?t[s]=[A]:t[s].push(A)}return t}function ys(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Ir(n*8+s.type)),s.type==2&&t.push(Ir(s.data.length)),t.push(s.data))})}),kc(t)}function Kb(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function hi(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=$f(e,n),a=Cr(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:yn(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=Cr(l.data),A=yn(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+A)}),n[0]+=A}),(t=a[3])!=null&&t[0]&&(o.merge=yn(a[3][0].data)>>>0>0),r.push(o)}return r}function pu(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ir(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ir(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Ir(o.data.length)}],n[2].push({data:ys(o.meta),type:2})});var a=ys(n);t.push(Ir(a.length)),t.push(a),s.forEach(function(o){return t.push(o)})}),kc(t)}function XW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=$f(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,A=0;if(a==1?(A=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(A=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[kc(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(A>=c)for(s.push(s[0].slice(-c)),A-=c;A>=s[s.length-1].length;)s.push(s[s.length-1]),A-=s[s.length-1].length;s.push(s[0].slice(-c,-c+A))}}var u=kc(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function pi(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(XW(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return kc(t)}function mu(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Ir(n),o=a.length;t.push(a),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return kc(t)}function YW(e,t,r,n){var s=RA(e),a=s.getUint32(4,!0),o=(n>1?12:8)+q4(a&(n>1?3470:398))*4,l=-1,c=-1,A=NaN,u=new Date(2001,0,1);a&512&&(l=s.getUint32(o,!0),o+=4),o+=q4(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(o,!0),o+=4),a&32&&(A=s.getFloat64(o,!0),o+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:A};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:A>0};break;case 7:f={t:"n",v:A/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(A))f={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function JW(e,t,r){var n=RA(e),s=n.getUint32(8,!0),a=12,o=-1,l=-1,c=NaN,A=NaN,u=new Date(2001,0,1);s&1&&(c=$W(e,a),a+=16),s&2&&(A=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(o=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:A>0};break;case 7:f={t:"n",v:A/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function J1(e,t){var r=new Uint8Array(32),n=RA(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,zW(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Z1(e,t){var r=new Uint8Array(32),n=RA(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function ZW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return YW(e,t,r,e[0]);case 5:return JW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ms(e){var t=Cr(e);return $f(t[1][0].data)}function V4(e,t){var r=Cr(t.data),n=yn(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(o){var l=Cr(o.data),c=yn(l[1][0].data)>>>0;switch(n){case 1:a[c]=xw(l[3][0].data);break;case 8:{var A=e[Ms(l[9][0].data)][0],u=Cr(A.data),f=e[Ms(u[1][0].data)][0],h=yn(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=Cr(f.data);a[c]=d[3].map(function(x){return xw(x.data)}).join("")}break}}),a}function e$(e,t){var r,n,s,a,o,l,c,A,u,f,h,d,x,g,y=Cr(e),m=yn(y[1][0].data)>>>0,p=yn(y[2][0].data)>>>0,b=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&yn(y[8][0].data)>0||!1,v,C;if((a=(s=y[7])==null?void 0:s[0])!=null&&a.data&&t!=0)v=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,C=(A=(c=y[6])==null?void 0:c[0])==null?void 0:A.data;else if((f=(u=y[4])==null?void 0:u[0])!=null&&f.data&&t!=1)v=(d=(h=y[4])==null?void 0:h[0])==null?void 0:d.data,C=(g=(x=y[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=b?4:1,S=RA(v),I=[],N=0;N<v.length/2;++N){var Q=S.getUint16(N*2,!0);Q<65535&&I.push([N,Q])}if(I.length!=p)throw"Expected ".concat(p," cells, found ").concat(I.length);var L=[];for(N=0;N<I.length-1;++N)L[I[N][0]]=C.subarray(I[N][1]*k,I[N+1][1]*k);return I.length>=1&&(L[I[I.length-1][0]]=C.subarray(I[I.length-1][1]*k)),{R:m,cells:L}}function t$(e,t){var r,n=Cr(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?yn(n[7][0].data)>>>0>0?1:0:-1,a=Kb(n[5],function(o){return e$(o,s)});return{nrows:yn(n[4][0].data)>>>0,data:a.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,A){if(o[l.R][A])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(A));o[l.R][A]=c}),o},[])}}function r$(e,t,r){var n,s=Cr(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(yn(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(yn(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=ir(a);var o=Cr(s[4][0].data),l=V4(e,e[Ms(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?V4(e,e[Ms(o[17][0].data)][0]):[],A=Cr(o[3][0].data),u=0;A[1].forEach(function(f){var h=Cr(f.data),d=e[Ms(h[2][0].data)][0],x=yn(d.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=t$(e,d);g.data.forEach(function(y,m){y.forEach(function(p,b){var v=Xt({r:u+m,c:b}),C=ZW(p,l,c);C&&(r[v]=C)})}),u+=g.nrows})}function n$(e,t){var r=Cr(t.data),n={"!ref":"A1"},s=e[Ms(r[2][0].data)],a=yn(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return r$(e,s[0],n),n}function s$(e,t){var r,n=Cr(t.data),s={name:(r=n[1])!=null&&r[0]?xw(n[1][0].data):"",sheets:[]},a=Kb(n[2],Ms);return a.forEach(function(o){e[o].forEach(function(l){var c=yn(l.meta[1][0].data);c==6e3&&s.sheets.push(n$(e,l))})}),s}function a$(e,t){var r=$b(),n=Cr(t.data),s=Kb(n[1],Ms);if(s.forEach(function(a){e[a].forEach(function(o){var l=yn(o.meta[1][0].data);if(l==2){var c=s$(e,o);c.sheets.forEach(function(A,u){zb(r,A,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ev(e){var t,r,n,s,a={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var A;try{A=pi(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=hi(A)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){a[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&yn(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||o.forEach(function(c){a[c].forEach(function(A){var u=yn(A.meta[1][0].data)>>>0;if(u==1)if(!l)l=A;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return a$(a,l)}function i$(e,t,r){var n,s,a,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&yn(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,A=RA(e[7][0].data),u=0,f=[],h=RA(e[4][0].data),d=0,x=[],g=0;g<t.length;++g){if(t[g]==null){A.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}A.setUint16(g*2,u,!0),h.setUint16(g*2,d,!0);var y,m;switch(typeof t[g]){case"string":y=J1({t:"s",v:t[g]},r),m=Z1({t:"s",v:t[g]},r);break;case"number":y=J1({t:"n",v:t[g]},r),m=Z1({t:"n",v:t[g]},r);break;case"boolean":y=J1({t:"b",v:t[g]},r),m=Z1({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(y),u+=y.length,x.push(m),d+=m.length,++c}for(e[2][0].data=Ir(c);g<e[7][0].data.length/2;++g)A.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=kc(f),e[3][0].data=kc(x),c}function o$(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ta(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ir(n)));var a=Sg(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(U){return U.forEach(function(F){typeof F=="string"&&o.push(F)})});var l={},c=[],A=Gt.read(t.numbers,{type:"base64"});A.FileIndex.map(function(U,F){return[U,A.FullPaths[F]]}).forEach(function(U){var F=U[0],D=U[1];if(F.type==2&&F.name.match(/\.iwa/)){var X=F.content,K=pi(X),ae=hi(K);ae.forEach(function(he){c.push(he.id),l[he.id]={deps:[],location:D,type:yn(he.messages[0].meta[1][0].data)}})}}),c.sort(function(U,F){return U-F});var u=c.filter(function(U){return U>1}).map(function(U){return[U,Ir(U)]});A.FileIndex.map(function(U,F){return[U,A.FullPaths[F]]}).forEach(function(U){var F=U[0];if(U[1],!!F.name.match(/\.iwa/)){var D=hi(pi(F.content));D.forEach(function(X){X.messages.forEach(function(K){u.forEach(function(ae){X.messages.some(function(he){return yn(he.meta[1][0].data)!=11006&&WW(he.data,ae[1])})&&l[ae[0]].deps.push(X.id)})})})}});for(var f=Gt.find(A,l[1].location),h=hi(pi(f.content)),d,x=0;x<h.length;++x){var g=h[x];g.id==1&&(d=g)}var y=Ms(Cr(d.messages[0].data)[1][0].data);for(f=Gt.find(A,l[y].location),h=hi(pi(f.content)),x=0;x<h.length;++x)g=h[x],g.id==y&&(d=g);for(y=Ms(Cr(d.messages[0].data)[2][0].data),f=Gt.find(A,l[y].location),h=hi(pi(f.content)),x=0;x<h.length;++x)g=h[x],g.id==y&&(d=g);for(y=Ms(Cr(d.messages[0].data)[2][0].data),f=Gt.find(A,l[y].location),h=hi(pi(f.content)),x=0;x<h.length;++x)g=h[x],g.id==y&&(d=g);var m=Cr(d.messages[0].data);{m[6][0].data=Ir(n.e.r+1),m[7][0].data=Ir(n.e.c+1);var p=Ms(m[46][0].data),b=Gt.find(A,l[p].location),v=hi(pi(b.content));{for(var C=0;C<v.length&&v[C].id!=p;++C);if(v[C].id!=p)throw"Bad ColumnRowUIDMapArchive";var k=Cr(v[C].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var S=0;S<=n.e.c;++S){var I=[];I[1]=I[2]=[{type:0,data:Ir(S+420690)}],k[1].push({type:2,data:ys(I)}),k[2].push({type:0,data:Ir(S)}),k[3].push({type:0,data:Ir(S)})}k[4]=[],k[5]=[],k[6]=[];for(var N=0;N<=n.e.r;++N)I=[],I[1]=I[2]=[{type:0,data:Ir(N+726270)}],k[4].push({type:2,data:ys(I)}),k[5].push({type:0,data:Ir(N)}),k[6].push({type:0,data:Ir(N)});v[C].messages[0].data=ys(k)}b.content=mu(pu(v)),b.size=b.content.length,delete m[46];var Q=Cr(m[4][0].data);{Q[7][0].data=Ir(n.e.r+1);var L=Cr(Q[1][0].data),T=Ms(L[2][0].data);b=Gt.find(A,l[T].location),v=hi(pi(b.content));{if(v[0].id!=T)throw"Bad HeaderStorageBucket";var P=Cr(v[0].messages[0].data);for(N=0;N<a.length;++N){var R=Cr(P[2][0].data);R[1][0].data=Ir(N),R[4][0].data=Ir(a[N].length),P[2][N]={type:P[2][0].type,data:ys(R)}}v[0].messages[0].data=ys(P)}b.content=mu(pu(v)),b.size=b.content.length;var z=Ms(Q[2][0].data);b=Gt.find(A,l[z].location),v=hi(pi(b.content));{if(v[0].id!=z)throw"Bad HeaderStorageBucket";for(P=Cr(v[0].messages[0].data),S=0;S<=n.e.c;++S)R=Cr(P[2][0].data),R[1][0].data=Ir(S),R[4][0].data=Ir(n.e.r+1),P[2][S]={type:P[2][0].type,data:ys(R)};v[0].messages[0].data=ys(P)}b.content=mu(pu(v)),b.size=b.content.length;var q=Ms(Q[4][0].data);(function(){for(var U=Gt.find(A,l[q].location),F=hi(pi(U.content)),D,X=0;X<F.length;++X){var K=F[X];K.id==q&&(D=K)}var ae=Cr(D.messages[0].data);{ae[3]=[];var he=[];o.forEach(function(ee,Te){he[1]=[{type:0,data:Ir(Te)}],he[2]=[{type:0,data:Ir(1)}],he[3]=[{type:2,data:GW(ee)}],ae[3].push({type:2,data:ys(he)})})}D.messages[0].data=ys(ae);var Y=pu(F),Be=mu(Y);U.content=Be,U.size=U.content.length})();var M=Cr(Q[3][0].data);{var V=M[1][0];delete M[2];var H=Cr(V.data);{var se=Ms(H[2][0].data);(function(){for(var U=Gt.find(A,l[se].location),F=hi(pi(U.content)),D,X=0;X<F.length;++X){var K=F[X];K.id==se&&(D=K)}var ae=Cr(D.messages[0].data);{delete ae[6],delete M[7];var he=new Uint8Array(ae[5][0].data);ae[5]=[];for(var Y=0,Be=0;Be<=n.e.r;++Be){var ee=Cr(he);Y+=i$(ee,a[Be],o),ee[1][0].data=Ir(Be),ae[5].push({data:ys(ee),type:2})}ae[1]=[{type:0,data:Ir(n.e.c+1)}],ae[2]=[{type:0,data:Ir(n.e.r+1)}],ae[3]=[{type:0,data:Ir(Y)}],ae[4]=[{type:0,data:Ir(n.e.r+1)}]}D.messages[0].data=ys(ae);var Te=pu(F),Je=mu(Te);U.content=Je,U.size=U.content.length})()}V.data=ys(H)}Q[3][0].data=ys(M)}m[4][0].data=ys(Q)}d.messages[0].data=ys(m);var ce=pu(h),B=mu(ce);return f.content=B,f.size=f.content.length,A}function a6(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function qb(e){a6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Vb(e){a6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function l$(e){return dr.WS.indexOf(e)>-1?"sheet":e==dr.CS?"chart":e==dr.DS?"dialog":e==dr.MS?"macro":e&&e.length?e:"sheet"}function c$(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,l$(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function A$(e,t,r,n,s,a,o,l,c,A,u,f){try{a[n]=rf(Ja(e,r,!0),t);var h=Mn(e,t),d;switch(l){case"sheet":d=TG(h,t,s,c,a[n],A,u,f);break;case"chart":if(d=IG(h,t,s,c,a[n],A,u,f),!d||!d["!drawel"])break;var x=U0(d["!drawel"].Target,t),g=Hf(x),y=vH(Ja(e,x,!0),rf(Ja(e,g,!0),x)),m=U0(y,x),p=Hf(m);d=iG(Ja(e,m,!0),m,c,rf(Ja(e,p,!0),m),A,d);break;case"macro":d=UG(h,t,s,c,a[n],A,u,f);break;case"dialog":d=LG(h,t,s,c,a[n],A,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=d;var b=[];a&&a[n]&&wn(a[n]).forEach(function(v){var C="";if(a[n][v].Type==dr.CMNT){C=U0(a[n][v].Target,t);var k=RG(Mn(e,C,!0),C,c);if(!k||!k.length)return;F4(d,k,!1)}a[n][v].Type==dr.TCMNT&&(C=U0(a[n][v].Target,t),b=b.concat(wH(Mn(e,C,!0),c)))}),b&&b.length&&F4(d,b,!0,c.people||[])}catch(v){if(c.WTF)throw v}}function di(e){return e.charAt(0)=="/"?e.slice(1):e}function u$(e,t){if(jd(),t=t||{},qb(t),mi(e,"META-INF/manifest.xml")||mi(e,"objectdata.xml"))return M4(e,t);if(mi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ev<"u"){if(e.FileIndex)return ev(e);var r=Gt.utils.cfb_new();return YB(e).forEach(function(R){cr(r,R,b7(e,R))}),ev(r)}throw new Error("Unsupported NUMBERS file")}if(!mi(e,"[Content_Types].xml"))throw mi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):mi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=YB(e),s=pR(Ja(e,"[Content_Types].xml")),a=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Mn(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Mn(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},A={};if(!t.bookSheets&&!t.bookProps){if(nf=[],s.sst)try{nf=OG(Mn(e,di(s.sst)),s.sst,t)}catch(R){if(t.WTF)throw R}t.cellStyles&&s.themes.length&&(c=PG(Ja(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(A=DG(Mn(e,di(s.style)),s.style,c,t))}s.links.map(function(R){try{var z=rf(Ja(e,Hf(di(R))),R);return MG(Mn(e,di(R)),z,R,t)}catch{}});var u=jG(Mn(e,di(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=Mn(e,di(s.coreprops[0]),!0),h&&(f=WF(h)),s.extprops.length!==0&&(h=Mn(e,di(s.extprops[0]),!0),h&&bR(h,f,t)));var d={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=Ja(e,di(s.custprops[0]),!0),h&&(d=BR(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(z){return z.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=d),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var g={};t.bookDeps&&s.calcchain&&(g=QG(Mn(e,di(s.calcchain)),s.calcchain));var y=0,m={},p,b;{var v=u.Sheets;f.Worksheets=v.length,f.SheetNames=[];for(var C=0;C!=v.length;++C)f.SheetNames[C]=v[C].name}var k=a?"bin":"xml",S=s.workbooks[0].lastIndexOf("/"),I=(s.workbooks[0].slice(0,S+1)+"_rels/"+s.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");mi(e,I)||(I="xl/_rels/workbook."+k+".rels");var N=rf(Ja(e,I,!0),I.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=HG(Mn(e,di(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=_H(Mn(e,di(s.people[0])),t)),N&&(N=c$(N,u.Sheets));var Q=Mn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var L="sheet";if(N&&N[y]?(p="xl/"+N[y][1].replace(/[\/]?xl\//,""),mi(e,p)||(p=N[y][1]),mi(e,p)||(p=I.replace(/_rels\/.*$/,"")+N[y][1]),L=N[y][2]):(p="xl/worksheets/sheet"+(y+1-Q)+"."+k,p=p.replace(/sheet0\./,"sheet.")),b=p.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,P=0;P!=t.sheets.length;++P)typeof t.sheets[P]=="number"&&t.sheets[P]==y&&(T=1),typeof t.sheets[P]=="string"&&t.sheets[P].toLowerCase()==f.SheetNames[y].toLowerCase()&&(T=1);if(!T)continue e}}A$(e,p,b,f.SheetNames[y],y,m,o,L,t,u,c,A)}return x={Directory:s,Workbook:u,Props:f,Custprops:d,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:nf,Styles:A,Themes:c,SSF:tn(zt)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(R,z){R=R.replace(/^Root Entry[\/]/,""),x.keys.push(R),x.files[R]=e.FileIndex[z]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=Mn(e,di(s.vba[0]),!0):s.defaults&&s.defaults.bin===jH&&(x.vbaraw=Mn(e,"xl/vbaProject.bin",!0))),x}function d$(e,t){var r=t||{},n="Workbook",s=Gt.find(e,n);try{if(n="/!DataSpaces/Version",s=Gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(HM(s.content),n="/!DataSpaces/DataSpaceMap",s=Gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=qM(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=VM(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);WM(s.content)}catch{}if(n="/EncryptionInfo",s=Gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=$M(s.content);if(n="/EncryptedPackage",s=Gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function f$(e,t){return t.bookType=="ods"?s6(e,t):t.bookType=="numbers"?o$(e,t):t.bookType=="xlsb"?h$(e,t):p$(e,t)}function h$(e,t){Vu=1024,e&&!e.SSF&&(e.SSF=tn(zt)),e&&e.SSF&&(jd(),ox(e.SSF),t.revssf=cx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Tj.indexOf(t.bookType)>-1,s=Fb();Vb(t=t||{});var a=mb(),o="",l=0;if(t.cellXfs=[],Oc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",cr(a,o,$F(e.Props,t)),s.coreprops.push(o),Ur(t.rels,2,o,dr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(e.SheetNames[A]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,cr(a,o,YF(e.Props)),s.extprops.push(o),Ur(t.rels,3,o,dr.EXT_PROPS),e.Custprops!==e.Props&&wn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",cr(a,o,JF(e.Custprops)),s.custprops.push(o),Ur(t.rels,4,o,dr.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,cr(a,o,qG(l-1,o,t,e,u)),s.sheets.push(o),Ur(t.wbrels,-1,"worksheets/sheet"+l+"."+r,dr.WS[0])}if(f){var d=f["!comments"],x=!1,g="";d&&d.length>0&&(g="xl/comments"+l+"."+r,cr(a,g,WG(d,g)),s.comments.push(g),Ur(u,-1,"../comments"+l+"."+r,dr.CMNT),x=!0),f["!legacy"]&&x&&cr(a,"xl/drawings/vmlDrawing"+l+".vml",Fj(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&cr(a,Hf(o),sd(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,cr(a,o,GG(t.Strings,o,t)),s.strs.push(o),Ur(t.wbrels,-1,"sharedStrings."+r,dr.SST)),o="xl/workbook."+r,cr(a,o,KG(e,o)),s.workbooks.push(o),Ur(t.rels,1,o,dr.WB),o="xl/theme/theme1.xml",cr(a,o,Db(e.Themes,t)),s.themes.push(o),Ur(t.wbrels,-1,"theme/theme1.xml",dr.THEME),o="xl/styles."+r,cr(a,o,VG(e,o,t)),s.styles.push(o),Ur(t.wbrels,-1,"styles."+r,dr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",cr(a,o,e.vbaraw),s.vba.push(o),Ur(t.wbrels,-1,"vbaProject.bin",dr.VBA)),o="xl/metadata."+r,cr(a,o,$G(o)),s.metadata.push(o),Ur(t.wbrels,-1,"metadata."+r,dr.XLMETA),cr(a,"[Content_Types].xml",VF(s,t)),cr(a,"_rels/.rels",sd(t.rels)),cr(a,"xl/_rels/workbook."+r+".rels",sd(t.wbrels)),delete t.revssf,delete t.ssf,a}function p$(e,t){Vu=1024,e&&!e.SSF&&(e.SSF=tn(zt)),e&&e.SSF&&(jd(),ox(e.SSF),t.revssf=cx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Tj.indexOf(t.bookType)>-1,s=Fb();Vb(t=t||{});var a=mb(),o="",l=0;if(t.cellXfs=[],Oc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",cr(a,o,$F(e.Props,t)),s.coreprops.push(o),Ur(t.rels,2,o,dr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&c.push(e.SheetNames[A]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,cr(a,o,YF(e.Props)),s.extprops.push(o),Ur(t.rels,3,o,dr.EXT_PROPS),e.Custprops!==e.Props&&wn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",cr(a,o,JF(e.Custprops)),s.custprops.push(o),Ur(t.rels,4,o,dr.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,cr(a,o,Kj(l-1,t,e,f)),s.sheets.push(o),Ur(t.wbrels,-1,"worksheets/sheet"+l+"."+r,dr.WS[0])}if(h){var x=h["!comments"],g=!1,y="";if(x&&x.length>0){var m=!1;x.forEach(function(p){p[1].forEach(function(b){b.T==!0&&(m=!0)})}),m&&(y="xl/threadedComments/threadedComment"+l+"."+r,cr(a,y,bH(x,u,t)),s.threadedcomments.push(y),Ur(f,-1,"../threadedComments/threadedComment"+l+"."+r,dr.TCMNT)),y="xl/comments"+l+"."+r,cr(a,y,jj(x)),s.comments.push(y),Ur(f,-1,"../comments"+l+"."+r,dr.CMNT),g=!0}h["!legacy"]&&g&&cr(a,"xl/drawings/vmlDrawing"+l+".vml",Fj(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&cr(a,Hf(o),sd(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,cr(a,o,xj(t.Strings,t)),s.strs.push(o),Ur(t.wbrels,-1,"sharedStrings."+r,dr.SST)),o="xl/workbook."+r,cr(a,o,$j(e)),s.workbooks.push(o),Ur(t.rels,1,o,dr.WB),o="xl/theme/theme1.xml",cr(a,o,Db(e.Themes,t)),s.themes.push(o),Ur(t.wbrels,-1,"theme/theme1.xml",dr.THEME),o="xl/styles."+r,cr(a,o,Nj(e,t)),s.styles.push(o),Ur(t.wbrels,-1,"styles."+r,dr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",cr(a,o,e.vbaraw),s.vba.push(o),Ur(t.wbrels,-1,"vbaProject.bin",dr.VBA)),o="xl/metadata."+r,cr(a,o,Ej()),s.metadata.push(o),Ur(t.wbrels,-1,"metadata."+r,dr.XLMETA),u.length>1&&(o="xl/persons/person.xml",cr(a,o,BH(u)),s.people.push(o),Ur(t.wbrels,-1,"persons/person.xml",dr.PEOPLE)),cr(a,"[Content_Types].xml",VF(s,t)),cr(a,"_rels/.rels",sd(t.rels)),cr(a,"xl/_rels/workbook."+r+".rels",sd(t.wbrels)),delete t.revssf,delete t.ssf,a}function Gb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=si(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function m$(e,t){return Gt.find(e,"EncryptedPackage")?d$(e,t):Jj(e,t)}function g$(e,t){var r,n=e,s=t||{};return s.type||(s.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r=yF(n,s),u$(r,s)}function i6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return mw(e.slice(r),t);default:break e}return wd.to_workbook(e,t)}function x$(e,t){var r="",n=Gb(e,t);switch(t.type){case"base64":r=si(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=LA(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Rr(r)),t.type="binary",i6(r,t)}function v$(e,t){var r=e;return t.type=="base64"&&(r=si(r)),r=Df.utils.decode(1200,r.slice(2),"str"),t.type="binary",i6(r,t)}function y$(e){return e.match(/[^\x00-\x7F]/)?No(e):e}function tv(e,t,r,n){return n?(r.type="string",wd.to_workbook(e,r)):wd.to_workbook(t,r)}function vw(e,t){ub();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return vw(new Uint8Array(e),(r=tn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),id={},r.dateNF&&(id.dateNF=r.dateNF),r.type||(r.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ur?"buffer":"binary",n=h7(e),typeof Uint8Array<"u"&&!ur&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=y$(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=tn(r),r.type="array",vw(db(n),r)}switch((s=Gb(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return m$(Gt.read(n,r),r);break;case 9:if(s[1]<=8)return Jj(n,r);break;case 60:return mw(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return CM(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return mj.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?g$(n,r):tv(e,n,r,a);case 239:return s[3]===60?mw(n,r):tv(e,n,r,a);case 255:if(s[1]===254)return v$(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return bA.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return bA.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return pw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return _j.to_workbook(n,r);break;case 10:case 13:case 32:return x$(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return BM.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?pw.to_workbook(n,r):tv(e,n,r,a)}function o6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ch(t.file,Gt.write(e,{type:ur?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Gt.write(e,t)}function w$(e,t){var r=tn(t||{}),n=f$(e,r);return b$(n,r)}function b$(e,t){var r={},n=ur?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Gt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(ix(s))}return t.password&&typeof encrypt_agile<"u"?o6(encrypt_agile(s,t.password),t):t.type==="file"?ch(t.file,s):t.type=="string"?Rr(s):s}function _$(e,t){var r=t||{},n=yW(e,r);return o6(n,r)}function wo(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Pf(No(n));case"binary":return No(n);case"string":return e;case"file":return ch(t.file,n,"utf8");case"buffer":return ur?Cl(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):wo(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function B$(e,t){switch(t.type){case"base64":return Pf(e);case"binary":return e;case"string":return e;case"file":return ch(t.file,e,"binary");case"buffer":return ur?Cl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Tp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Pf(r):t.type=="string"?Rr(r):r;case"file":return ch(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function l6(e,t){ub(),mG(e);var r=tn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=l6(e,r);return r.type="array",ix(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return wo(fW(e,r),r);case"slk":case"sylk":return wo(pj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return wo(e6(e.Sheets[e.SheetNames[s]],r),r);case"txt":return B$(c6(e.Sheets[e.SheetNames[s]],r),r);case"csv":return wo(Wb(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return wo(mj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Tp(pw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return wo(wd.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return wo(_j.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return wo(gj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return wo(s6(e,r),r);case"wk1":return Tp(bA.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Tp(bA.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Tp(Zj(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),_$(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return w$(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function C$(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function yw(e,t,r){var n={};return n.type="file",n.file=t,C$(n),l6(e,n)}function N$(e,t,r,n,s,a,o,l){var c=In(r),A=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var d=t.s.c;d<=t.e.c;++d){var x=o?e[r][d]:e[n[d]+c];if(x===void 0||x.t===void 0){if(A===void 0)continue;a[d]!=null&&(h[a[d]]=A);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[d]!=null){if(g==null)if(x.t=="e"&&g===null)h[a[d]]=null;else if(A!==void 0)h[a[d]]=A;else if(u&&g===null)h[a[d]]=null;else continue;else h[a[d]]=u&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?g:wl(x,g,l);g!=null&&(f=!1)}}return{row:h,isempty:f}}function Sg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},A=t||{},u=A.range!=null?A.range:e["!ref"];switch(A.header===1?n=1:A.header==="A"?n=2:Array.isArray(A.header)?n=3:A.header==null&&(n=0),typeof u){case"string":c=_r(u);break;case"number":c=_r(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(s=0);var f=In(c.s.r),h=[],d=[],x=0,g=0,y=Array.isArray(e),m=c.s.r,p=0,b={};y&&!e[m]&&(e[m]=[]);var v=A.skipHidden&&e["!cols"]||[],C=A.skipHidden&&e["!rows"]||[];for(p=c.s.c;p<=c.e.c;++p)if(!(v[p]||{}).hidden)switch(h[p]=un(p),r=y?e[m][p]:e[h[p]+f],n){case 1:a[p]=p-c.s.c;break;case 2:a[p]=h[p];break;case 3:a[p]=A.header[p-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=wl(r,null,A),g=b[o]||0,!g)b[o]=1;else{do l=o+"_"+g++;while(b[l]);b[o]=g,b[l]=1}a[p]=l}for(m=c.s.r+s;m<=c.e.r;++m)if(!(C[m]||{}).hidden){var k=N$(e,c,m,h,n,a,y,A);(k.isempty===!1||(n===1?A.blankrows!==!1:A.blankrows))&&(d[x++]=k.row)}return d.length=x,d}var G4=/"/g;function S$(e,t,r,n,s,a,o,l){for(var c=!0,A=[],u="",f=In(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=l.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){c=!1,u=""+(l.rawNumbers&&d.t=="n"?d.v:wl(d,null,l));for(var x=0,g=0;x!==u.length;++x)if((g=u.charCodeAt(x))===s||g===a||g===34||l.forceQuotes){u='"'+u.replace(G4,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(c=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(G4,'""')+'"')):u="";A.push(u)}return l.blankrows===!1&&c?null:A.join(o)}function Wb(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=_r(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),A=new RegExp((a=="|"?"\\|":a)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(f[x]=un(x));for(var g=0,y=s.s.r;y<=s.e.r;++y)(d[y]||{}).hidden||(u=S$(e,s,y,f,o,c,a,n),u!=null&&(n.strip&&(u=u.replace(A,"")),(u||n.blankrows!==!1)&&r.push((g++?l:"")+u)));return delete n.dense,r.join("")}function c6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Wb(e,t);return r}function k$(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=_r(e["!ref"]),a="",o=[],l,c=[],A=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=un(l);for(var u=s.s.r;u<=s.e.r;++u)for(a=In(u),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+a,r=A?(e[u]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function A6(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?dn(n.origin):n.origin;o=c.r,l=c.c}var A,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(a["!ref"]){var f=_r(a["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var h=n.header||[],d=0;t.forEach(function(g,y){wn(g).forEach(function(m){(d=h.indexOf(m))==-1&&(h[d=h.length]=m);var p=g[m],b="z",v="",C=Xt({c:l+d,r:o+y+s});A=zf(a,C),p&&typeof p=="object"&&!(p instanceof Date)?a[C]=p:(typeof p=="number"?b="n":typeof p=="boolean"?b="b":typeof p=="string"?b="s":p instanceof Date?(b="d",n.cellDates||(b="n",p=is(p)),v=n.dateNF||zt[14]):p===null&&n.nullError&&(b="e",p=0),A?(A.t=b,A.v=p,delete A.w,delete A.R,v&&(A.z=v)):a[C]=A={t:b,v:p},v&&(A.z=v))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var x=In(o);if(s)for(d=0;d<h.length;++d)a[un(d+l)+x]={t:"s",v:h[d]};return a["!ref"]=ir(u),a}function E$(e,t){return A6(null,e,t)}function zf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=dn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?zf(e,Xt(t)):zf(e,Xt({r:t,c:r||0}))}function F$(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $b(){return{SheetNames:[],Sheets:{}}}function zb(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(Wj(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function j$(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=F$(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function T$(e,t){return e.z=t,e}function u6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function I$(e,t,r){return u6(e,"#"+t,r)}function U$(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function L$(e,t,r,n){for(var s=typeof t!="string"?t:_r(t),a=typeof t=="string"?t:ir(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=zf(e,o,l);c.t="n",c.F=a,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var gi={encode_col:un,encode_row:In,encode_cell:Xt,encode_range:ir,decode_col:Bb,decode_row:_b,split_cell:G7,decode_cell:dn,decode_range:Ta,format_cell:wl,sheet_add_aoa:OF,sheet_add_json:A6,sheet_add_dom:t6,aoa_to_sheet:Td,json_to_sheet:E$,table_to_sheet:r6,table_to_book:HW,sheet_to_csv:Wb,sheet_to_txt:c6,sheet_to_json:Sg,sheet_to_html:e6,sheet_to_formulae:k$,sheet_to_row_object_array:Sg,sheet_get_cell:zf,book_new:$b,book_append_sheet:zb,book_set_sheet_visibility:j$,cell_set_number_format:T$,cell_set_hyperlink:u6,cell_set_internal_link:I$,cell_add_comment:U$,sheet_set_array_formula:L$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function D$({isOpen:e,onClose:t,inquiry:r,replyTo:n}){const[s,a]=G.useState(r.contact_email||""),[o,l]=G.useState(""),[c,A]=G.useState(""),[u,f]=G.useState(!1),[h,d]=G.useState(!1),[x,g]=G.useState(n!=null&&n.subject?n.subject.startsWith("Re:")?n.subject:`Re: ${n.subject}`:`Re: ${r.product_name} - Inquiry ${r.inquiry_number}`),[y,m]=G.useState(""),[p,b]=G.useState([]),[v,C]=G.useState(!1),[k,S]=G.useState([]),[I,N]=G.useState(!1),[Q,L]=G.useState(""),T=G.useRef(null);G.useEffect(()=>{if(P(),R(),n){const se=`
        <br><br>
        <div style="border-left: 3px solid #ccc; padding-left: 15px; margin-left: 10px; color: #666;">
          <p><strong>On ${new Date().toLocaleDateString()}, ${n.from_email} wrote:</strong></p>
          ${n.body}
        </div>
      `;m(se)}},[n]);const P=async()=>{try{const{data:se,error:ce}=await oe.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(ce)throw ce;S(se||[])}catch(se){console.error("Error loading templates:",se)}},R=async()=>{try{const{data:{user:se}}=await oe.auth.getUser();if(se){const{data:ce}=await oe.from("user_profiles").select("full_name").eq("id",se.id).single();L((ce==null?void 0:ce.full_name)||"")}}catch(se){console.error("Error loading user name:",se)}},z=se=>{const ce={"{{contact_person}}":r.contact_person||"","{{company_name}}":r.company_name,"{{product_name}}":r.product_name,"{{specification}}":r.specification||"-","{{quantity}}":r.quantity,"{{supplier_name}}":r.supplier_name||"-","{{supplier_country}}":r.supplier_country||"-","{{inquiry_number}}":r.inquiry_number,"{{user_name}}":Q};let B=se.subject,U=se.body;Object.entries(ce).forEach(([F,D])=>{const X=new RegExp(F.replace(/[{}]/g,"\\$&"),"g");B=B.replace(X,D),U=U.replace(X,D)}),g(B),m(U),N(!1),oe.from("crm_email_templates").update({use_count:se.use_count+1,last_used:new Date().toISOString()}).eq("id",se.id).then(()=>{})},q=se=>{const ce=se.target.files;if(!ce)return;const B=[];for(let U=0;U<ce.length;U++){const F=ce[U];if(F.size>25*1024*1024){alert(`File ${F.name} is too large. Maximum size is 25MB.`);continue}B.push({file:F,name:F.name,size:F.size})}b(U=>[...U,...B])},M=se=>{b(ce=>ce.filter((B,U)=>U!==se))},V=se=>se<1024?se+" B":se<1024*1024?(se/1024).toFixed(1)+" KB":(se/(1024*1024)).toFixed(1)+" MB",H=async()=>{if(!s||!x||!y){alert("Please fill in all required fields");return}C(!0);try{const{data:{user:se}}=await oe.auth.getUser();if(!se)throw new Error("Not authenticated");const ce=[];for(const D of p){const X=`${Date.now()}_${D.name}`,K=`email-attachments/${se.id}/${X}`,{error:ae}=await oe.storage.from("crm-documents").upload(K,D.file);ae||ce.push(K)}const B={inquiry_id:r.id,email_type:"sent",from_email:se.email,to_email:[s,...o?o.split(",").map(D=>D.trim()):[]],cc_email:o?o.split(",").map(D=>D.trim()):null,bcc_email:c?c.split(",").map(D=>D.trim()):null,subject:x,body:y,attachments:ce.length>0?ce:null,sent_date:new Date().toISOString(),created_by:se.id,reply_to_id:(n==null?void 0:n.email_id)||null},{error:U}=await oe.from("crm_email_activities").insert([B]);if(U)throw U;const F={};x.toLowerCase().includes("price")||x.toLowerCase().includes("quote")?(F.price_quoted=!0,F.price_quoted_date=new Date().toISOString().split("T")[0],F.status="price_quoted"):(x.toLowerCase().includes("coa")||x.toLowerCase().includes("msds"))&&(F.coa_sent=!0,F.coa_sent_date=new Date().toISOString().split("T")[0]),Object.keys(F).length>0&&await oe.from("crm_inquiries").update(F).eq("id",r.id),alert("Email sent successfully!"),t()}catch(se){console.error("Error sending email:",se),alert("Failed to send email. Please try again.")}finally{C(!1)}};return e?i.jsx(fr,{isOpen:e,onClose:t,title:"",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between border-b pb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx($s,{className:"w-5 h-5"}),n?"Reply to Email":"New Message"]}),i.jsxs("button",{onClick:()=>N(!I),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded transition",children:[i.jsx(rd,{className:"w-4 h-4"}),"Templates",i.jsx(ac,{className:"w-3 h-3"})]})]}),I&&i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Choose a template:"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:k.map(se=>i.jsxs("button",{onClick:()=>z(se),className:"px-3 py-2 text-left text-sm bg-white hover:bg-blue-50 border border-gray-200 rounded transition",children:[i.jsx("div",{className:"font-medium text-gray-900",children:se.template_name}),i.jsx("div",{className:"text-xs text-gray-500",children:se.category})]},se.id))})]}),i.jsx("div",{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"To:"}),i.jsx("input",{type:"email",value:s,onChange:se=>a(se.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"recipient@example.com",required:!0}),i.jsx("button",{onClick:()=>f(!u),className:"text-sm text-blue-600 hover:text-blue-700",children:"Cc"}),i.jsx("button",{onClick:()=>d(!h),className:"text-sm text-blue-600 hover:text-blue-700",children:"Bcc"})]})}),u&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Cc:"}),i.jsx("input",{type:"text",value:o,onChange:se=>l(se.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"cc@example.com (comma separated)"})]}),h&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Bcc:"}),i.jsx("input",{type:"text",value:c,onChange:se=>A(se.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"bcc@example.com (comma separated)"})]}),i.jsx("div",{children:i.jsx("input",{type:"text",value:x,onChange:se=>g(se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Subject",required:!0})}),i.jsx("div",{children:i.jsx("textarea",{value:y.replace(/<[^>]*>/g,""),onChange:se=>m(se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Compose your email..."})}),p.length>0&&i.jsx("div",{className:"space-y-2",children:p.map((se,ce)=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(jo,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-sm text-gray-700",children:se.name}),i.jsxs("span",{className:"text-xs text-gray-500",children:["(",V(se.size),")"]})]}),i.jsx("button",{onClick:()=>M(ce),className:"text-red-600 hover:text-red-700",children:i.jsx(Xs,{className:"w-4 h-4"})})]},ce))}),i.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[i.jsxs("div",{children:[i.jsx("input",{ref:T,type:"file",multiple:!0,onChange:q,className:"hidden"}),i.jsxs("button",{onClick:()=>{var se;return(se=T.current)==null?void 0:se.click()},className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",children:[i.jsx(jo,{className:"w-4 h-4"}),"Attach Files"]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:H,disabled:v||!s||!x||!y,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:v?i.jsxs(i.Fragment,{children:[i.jsx(Bc,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Io,{className:"w-4 h-4"}),"Send"]})})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t",children:[i.jsx("strong",{children:"Inquiry:"})," ",r.inquiry_number," | ",r.company_name," | ",r.product_name]})]})}):null}function d6({isOpen:e,onClose:t,onSuccess:r,initialData:n}){const{user:s}=Qr(),[a,o]=G.useState(!1),[l,c]=G.useState([]),[A,u]=G.useState([]),[f,h]=G.useState([]),[d,x]=G.useState([]),g=G.useRef(null),[y,m]=G.useState(""),[p,b]=G.useState(""),[v,C]=G.useState(""),[k,S]=G.useState(""),[I,N]=G.useState("medium"),[Q,L]=G.useState([]),[T,P]=G.useState(""),[R,z]=G.useState(""),[q,M]=G.useState(""),[V,H]=G.useState([]),[se,ce]=G.useState(""),[B,U]=G.useState([]),[F,D]=G.useState(""),[X,K]=G.useState(!1);G.useEffect(()=>{if(e){ae(),he(),Y(),Be(),n&&(P(n.inquiry_id||""),z(n.customer_id||""),M(n.product_id||""));const Fe=new Date;Fe.setDate(Fe.getDate()+1),C(Fe.toISOString().split("T")[0]),S("17:00")}},[e,n]);const ae=async()=>{try{const{data:Fe,error:Re}=await oe.from("user_profiles").select("id, full_name, email, role").eq("is_active",!0).order("full_name");if(Re)throw Re;c(Fe||[])}catch(Fe){console.error("Error loading users:",Fe)}},he=async()=>{try{const{data:Fe,error:Re}=await oe.from("crm_inquiries").select("id, inquiry_number, company_name, product_name").order("created_at",{ascending:!1}).limit(100);if(Re)throw Re;u((Fe||[]).map(at=>({id:at.id,label:`${at.inquiry_number} - ${at.company_name} (${at.product_name})`})))}catch(Fe){console.error("Error loading inquiries:",Fe)}},Y=async()=>{try{const{data:Fe,error:Re}=await oe.from("customers").select("id, company_name, contact_person").eq("is_active",!0).order("company_name");if(Re)throw Re;h((Fe||[]).map(at=>({id:at.id,label:`${at.company_name}${at.contact_person?` (${at.contact_person})`:""}`})))}catch(Fe){console.error("Error loading customers:",Fe)}},Be=async()=>{try{const{data:Fe,error:Re}=await oe.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(Re)throw Re;x((Fe||[]).map(at=>({id:at.id,label:`${at.product_name}${at.product_code?` (${at.product_code})`:""}`})))}catch(Fe){console.error("Error loading products:",Fe)}},ee=Fe=>{Q.includes(Fe)?L(Q.filter(Re=>Re!==Fe)):L([...Q,Fe])},Te=()=>{se.trim()&&!V.includes(se.trim())&&(H([...V,se.trim()]),ce(""))},Je=Fe=>{H(V.filter(Re=>Re!==Fe))},ie=async Fe=>{const Re=[];for(const at of B){const we=`${Date.now()}_${at.name}`,ve=`tasks/${Fe}/${we}`,{error:Le}=await oe.storage.from("task-attachments").upload(ve,at);Le?console.error("Error uploading file:",Le):Re.push(ve)}return Re},$e=async Fe=>{if(Fe.preventDefault(),!y.trim()){alert("Please enter a task title");return}if(!v||!k){alert("Please set a deadline");return}if(Q.length===0){alert("Please assign at least one user");return}try{o(!0);const Re=`${v}T${k}:00`,at={title:y.trim(),description:p.trim()||null,deadline:Re,priority:I,created_by:s==null?void 0:s.id,assigned_users:Q,inquiry_id:T||null,customer_id:R||null,product_id:q||null,tags:V},{data:we,error:ve}=await oe.from("tasks").insert([at]).select().single();if(ve)throw ve;if(B.length>0&&we){const lt=await ie(we.id),{error:it}=await oe.from("tasks").update({attachment_urls:lt}).eq("id",we.id);if(it)throw it}const Le=Q.map(lt=>({task_id:we.id,assigned_user_id:lt,assigned_by:s==null?void 0:s.id})),{error:tt}=await oe.from("task_assignments").insert(Le);if(tt)throw tt;r()}catch(Re){console.error("Error creating task:",Re),alert("Failed to create task. Please try again.")}finally{o(!1)}},ze=l.filter(Fe=>Fe.full_name.toLowerCase().includes(F.toLowerCase())||Fe.email.toLowerCase().includes(F.toLowerCase()));return i.jsx(fr,{isOpen:e,onClose:t,title:"Create New Task",size:"lg",children:i.jsxs("form",{onSubmit:$e,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Task Title ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:y,onChange:Fe=>m(Fe.target.value),placeholder:"e.g., Send quotation to customer",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:p,onChange:Fe=>b(Fe.target.value),placeholder:"Add detailed instructions or notes...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Date ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"date",value:v,onChange:Fe=>C(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Time ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"time",value:k,onChange:Fe=>S(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Priority ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:I,onChange:Fe=>N(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Assign To ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:F,onChange:Fe=>D(Fe.target.value),onFocus:()=>K(!0),placeholder:"Search users...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx(Lc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),X&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:ze.map(Fe=>i.jsxs("button",{type:"button",onClick:()=>ee(Fe.id),className:`w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center justify-between ${Q.includes(Fe.id)?"bg-blue-50":""}`,children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:Fe.full_name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[Fe.email,"  ",Fe.role]})]}),Q.includes(Fe.id)&&i.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center",children:i.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},Fe.id))})]}),Q.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Q.map(Fe=>{const Re=l.find(at=>at.id===Fe);return i.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:[Re==null?void 0:Re.full_name,i.jsx("button",{type:"button",onClick:()=>ee(Fe),className:"text-blue-600 hover:text-blue-800",children:i.jsx(Xs,{className:"w-4 h-4"})})]},Fe)})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Inquiry"}),i.jsxs("select",{value:T,onChange:Fe=>P(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"None"}),A.map(Fe=>i.jsx("option",{value:Fe.id,children:Fe.label},Fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Customer"}),i.jsxs("select",{value:R,onChange:Fe=>z(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"None"}),f.map(Fe=>i.jsx("option",{value:Fe.id,children:Fe.label},Fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Product"}),i.jsxs("select",{value:q,onChange:Fe=>M(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"None"}),d.map(Fe=>i.jsx("option",{value:Fe.id,children:Fe.label},Fe.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:se,onChange:Fe=>ce(Fe.target.value),onKeyPress:Fe=>Fe.key==="Enter"&&(Fe.preventDefault(),Te()),placeholder:"Add tag and press Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx("button",{type:"button",onClick:Te,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:"Add"})]}),V.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:V.map(Fe=>i.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:[i.jsx(hg,{className:"w-3 h-3"}),Fe,i.jsx("button",{type:"button",onClick:()=>Je(Fe),className:"text-gray-500 hover:text-red-600",children:i.jsx(Xs,{className:"w-3 h-3"})})]},Fe))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attachments"}),i.jsx("input",{ref:g,type:"file",multiple:!0,onChange:Fe=>{Fe.target.files&&U(Array.from(Fe.target.files))},className:"hidden"}),i.jsxs("button",{type:"button",onClick:()=>{var Fe;return(Fe=g.current)==null?void 0:Fe.click()},className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[i.jsx(jo,{className:"w-4 h-4"}),"Choose Files"]}),B.length>0&&i.jsx("div",{className:"mt-2 space-y-2",children:B.map((Fe,Re)=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Nr,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-sm text-gray-700",children:Fe.name}),i.jsxs("span",{className:"text-xs text-gray-500",children:["(",(Fe.size/1024).toFixed(1)," KB)"]})]}),i.jsx("button",{type:"button",onClick:()=>U(at=>at.filter((we,ve)=>ve!==Re)),className:"text-red-600 hover:text-red-700",children:i.jsx(Xs,{className:"w-4 h-4"})})]},Re))})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:a||!y.trim()||Q.length===0,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a?i.jsxs(i.Fragment,{children:[i.jsx(Bc,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):"Create Task"})]})]})})}function P$({inquiry:e,compact:t=!1,onMarkSent:r}){const n=[{type:"price",letter:"P",required:e.price_required??!0,sent:e.price_sent_at,label:"Price"},{type:"coa",letter:"C",required:e.coa_required??!0,sent:e.coa_sent_at,label:"COA"},{type:"sample",letter:"S",required:e.sample_required,sent:e.sample_sent_at,label:"Sample"},{type:"agency_letter",letter:"A",required:e.agency_letter_required,sent:e.agency_letter_sent_at,label:"Agency Letter"},{type:"others",letter:"O",required:e.others_required,sent:e.others_sent_at,label:"Others"}];return n.some(a=>a.required)?i.jsx("div",{className:"flex flex-wrap gap-1.5",children:n.filter(a=>a.required).map(a=>i.jsx("button",{onClick:()=>r==null?void 0:r(a.type),disabled:!r,className:`
            inline-flex items-center justify-center
            w-6 h-6 rounded text-xs font-bold
            transition-colors duration-150
            ${a.sent?"bg-green-100 text-green-700 hover:bg-green-200 cursor-pointer":"bg-red-100 text-red-700 hover:bg-red-200 cursor-pointer"}
            ${r?"":"cursor-default"}
          `,title:`${a.label}${a.sent?" - Sent (Click to unmark)":" - Pending (Click to mark as sent)"}`,children:a.letter},a.type))}):i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-500",children:[i.jsx(O$,{className:"w-3 h-3"}),!t&&"Nothing required"]})}function O$({className:e}){return i.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}const W4={new:{label:"New",color:"bg-gray-100 text-gray-700 border-gray-300",icon:HE},in_progress:{label:"In Progress",color:"bg-blue-100 text-blue-700 border-blue-300",icon:ao},follow_up:{label:"Follow Up",color:"bg-purple-100 text-purple-700 border-purple-300",icon:Ws},won:{label:"Won",color:"bg-green-100 text-green-700 border-green-300",icon:pa},lost:{label:"Lost",color:"bg-red-100 text-red-700 border-red-300",icon:zs},on_hold:{label:"On Hold",color:"bg-yellow-100 text-yellow-700 border-yellow-300",icon:xO}};function R$({status:e,compact:t=!1}){const r=W4[e]||W4.new,n=r.icon;return i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium border ${r.color}`,children:[i.jsx(n,{className:"w-3 h-3"}),!t&&r.label]})}const Ip=[{value:"new",label:"New"},{value:"in_progress",label:"In Progress"},{value:"follow_up",label:"Follow Up"},{value:"won",label:"Won"},{value:"lost",label:"Lost"},{value:"on_hold",label:"On Hold"}];function Q$({isOpen:e,onClose:t,inquiryId:r,inquiryNumber:n,onSuccess:s}){const[a,o]=G.useState(""),[l,c]=G.useState(""),[A,u]=G.useState(""),[f,h]=G.useState(!1),d=async y=>{if(y.preventDefault(),a.trim().length<10){alert("Please provide a detailed reason (at least 10 characters)");return}h(!0);try{const m={pipeline_status:"lost",lost_reason:a.trim(),lost_at:new Date().toISOString()};l.trim()&&(m.competitor_name=l.trim()),A.trim()&&(m.competitor_price=parseFloat(A));const{error:p}=await oe.from("crm_inquiries").update(m).eq("id",r);if(p)throw p;s(),t(),x()}catch(m){console.error("Error marking inquiry as lost:",m),alert("Failed to mark inquiry as lost. Please try again.")}finally{h(!1)}},x=()=>{o(""),c(""),u("")},g=()=>{f||(t(),x())};return i.jsx(fr,{isOpen:e,onClose:g,title:`Mark Inquiry #${n} as Lost`,children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[i.jsx(zs,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-red-800",children:[i.jsx("p",{className:"font-medium",children:"You are about to mark this inquiry as lost."}),i.jsx("p",{className:"mt-1 text-red-700",children:"This will move it to the Archive. Please provide details below."})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Lost Reason ",i.jsx("span",{className:"text-red-600",children:"*"})]}),i.jsx("textarea",{value:a,onChange:y=>o(y.target.value),placeholder:"e.g., Competitor offered lower price, Customer chose local supplier, Budget constraints...",rows:4,required:!0,minLength:10,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 characters. Be specific to help improve future quotes."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Name ",i.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),i.jsx("input",{type:"text",value:l,onChange:y=>c(y.target.value),placeholder:"e.g., ABC Trading Co.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Price (USD) ",i.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),i.jsx("input",{type:"number",step:"0.01",value:A,onChange:y=>u(y.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:g,disabled:f,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:f||a.trim().length<10,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:f?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(zs,{className:"w-4 h-4"}),"Mark as Lost"]})})]})]})})}function M$({inquiries:e,onRefresh:t,canManage:r,onAddInquiry:n}){const{profile:s}=Qr(),[a,o]=G.useState(new Set),[l,c]=G.useState([]),[A,u]=G.useState(null),[f,h]=G.useState(e),[d,x]=G.useState({column:"inquiry_date",direction:"desc"}),[g,y]=G.useState(null),[m,p]=G.useState(""),[b,v]=G.useState(!1),[C,k]=G.useState(null),[S,I]=G.useState(!1),[N,Q]=G.useState(""),[L,T]=G.useState(!1),[P,R]=G.useState(""),[z,q]=G.useState(""),[M,V]=G.useState(!1),[H,se]=G.useState(!1),[ce,B]=G.useState(!1),[U,F]=G.useState(null),[D,X]=G.useState(!1),[K,ae]=G.useState(null),[he,Y]=G.useState(""),[Be,ee]=G.useState(!1),[Te,Je]=G.useState({price_required:!1,coa_required:!1,sample_required:!1,agency_letter_required:!1,others_required:!1}),ie=G.useRef(null),[$e,ze]=G.useState({checkbox:50,inquiry_number:120,inquiry_date:120,product_name:200,specification:200,quantity:100,supplier_name:150,company_name:180,mail_subject:200,aceerp_no:120,status:130,pipeline_status:130,our_side:130,purchase_price:100,offered_price:100,delivery_date:120,priority:100,remarks:200}),[Fe,Re]=G.useState(null),at=[{value:"urgent",label:"Urgent",icon:i.jsx(VE,{className:"w-3 h-3 text-red-600"})},{value:"high",label:"High",icon:i.jsx(sw,{className:"w-3 h-3 text-orange-600"})},{value:"medium",label:"Medium",icon:i.jsx(aw,{className:"w-3 h-3 text-gray-400"})},{value:"low",label:"Low",icon:i.jsx(aw,{className:"w-3 h-3 text-gray-300"})}];G.useEffect(()=>{Le()},[e,l,d]),G.useEffect(()=>{function _e(Ee){ie.current&&!ie.current.contains(Ee.target)&&u(null)}return document.addEventListener("mousedown",_e),()=>document.removeEventListener("mousedown",_e)},[]),G.useEffect(()=>{const _e=dt=>{if(!Fe)return;const Mt=dt.clientX-Fe.startX,W=Math.max(50,Fe.startWidth+Mt);ze(ue=>({...ue,[Fe.column]:W}))},Ee=()=>{Re(null)};if(Fe)return document.addEventListener("mousemove",_e),document.addEventListener("mouseup",Ee),()=>{document.removeEventListener("mousemove",_e),document.removeEventListener("mouseup",Ee)}},[Fe]);const we=(_e,Ee)=>{Ee.preventDefault(),Ee.stopPropagation(),Re({column:_e,startX:Ee.clientX,startWidth:$e[_e]||150})},ve=({column:_e,label:Ee,sortable:dt=!0,className:Mt=""})=>i.jsxs("th",{style:{width:$e[_e],minWidth:$e[_e]},className:`relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 ${dt?"cursor-pointer hover:bg-gray-100 select-none":""} ${Mt}`,onClick:dt?()=>tt(_e):void 0,children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"truncate",children:Ee}),dt&&lt(_e)]}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400 group",onMouseDown:W=>we(_e,W),onClick:W=>W.stopPropagation(),children:i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-transparent group-hover:bg-blue-400"})})]}),Le=()=>{let _e=[...e];l.forEach(Ee=>{Ee.values.length>0&&(_e=_e.filter(dt=>{const Mt=dt[Ee.column];return Ee.values.includes(String(Mt||""))}))}),d.column&&d.direction&&_e.sort((Ee,dt)=>{const Mt=Ee[d.column],W=dt[d.column];if(Mt==null&&W==null)return 0;if(Mt==null)return d.direction==="asc"?1:-1;if(W==null)return d.direction==="asc"?-1:1;const ue=String(Mt).toLowerCase(),re=String(W).toLowerCase();return d.direction==="asc"?ue>re?1:ue<re?-1:0:ue<re?1:ue>re?-1:0}),h(_e)},tt=_e=>{let Ee="asc";d.column===_e&&(d.direction==="asc"?Ee="desc":d.direction==="desc"&&(Ee=null)),x({column:_e,direction:Ee})},lt=_e=>d.column!==_e?i.jsx(EB,{className:"w-3 h-3 text-gray-400"}):d.direction==="asc"?i.jsx(sw,{className:"w-3 h-3 text-blue-600"}):d.direction==="desc"?i.jsx(tO,{className:"w-3 h-3 text-blue-600"}):i.jsx(EB,{className:"w-3 h-3 text-gray-400"}),it=()=>{se(!0);try{const _e=f.map(W=>{var ue,re;return{"No.":W.inquiry_number,Date:new Date(W.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:W.product_name,Specification:W.specification||"-",Qty:W.quantity,Supplier:W.supplier_name||"-",Country:W.supplier_country||"-",Company:W.company_name,"Mail Subject":W.mail_subject||"-","ACE ERP#":W.aceerp_no||"-",Pipeline:((ue=Ip.find(Ae=>Ae.value===W.pipeline_status))==null?void 0:ue.label)||"-","Price Needed":W.price_required?"Yes":"No","COA Needed":W.coa_required?"Yes":"No","Sample Needed":W.sample_required?"Yes":"No","Agency Letter Needed":W.agency_letter_required?"Yes":"No","Others Needed":W.others_required?"Yes":"No","Price Sent":W.price_sent_at?"Yes":"No","COA Sent":W.coa_sent_at?"Yes":"No","Sample Sent":W.sample_sent_at?"Yes":"No","Agency Letter Sent":W.agency_letter_sent_at?"Yes":"No","Purchase Price":W.purchase_price?`${W.purchase_price} ${W.purchase_price_currency||"USD"}`:"-","Offered Price":W.offered_price?`${W.offered_price} ${W.offered_price_currency||"USD"}`:"-","Delivery Date":W.delivery_date?new Date(W.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":W.delivery_terms||"-",Priority:((re=at.find(Ae=>Ae.value===W.priority))==null?void 0:re.label)||W.priority,Remarks:W.remarks||"-"}}),Ee=gi.json_to_sheet(_e);Ee["!cols"]=[{wch:15},{wch:12},{wch:30},{wch:20},{wch:10},{wch:20},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:13},{wch:12},{wch:15},{wch:20},{wch:12},{wch:11},{wch:13},{wch:19},{wch:18},{wch:18},{wch:15},{wch:18},{wch:10},{wch:30}];const dt=gi.book_new();gi.book_append_sheet(dt,Ee,"CRM Inquiries");const Mt=`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.xlsx`;yw(dt,Mt),alert(`Exported ${_e.length} inquiries to ${Mt}`)}catch(_e){console.error("Export error:",_e),alert("Failed to export data. Please try again.")}finally{se(!1)}},Ne=()=>{se(!0);try{const _e=f.map(re=>{var Ae,pe;return{"No.":re.inquiry_number,Date:new Date(re.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:re.product_name,Specification:re.specification||"-",Qty:re.quantity,Supplier:re.supplier_name||"-",Country:re.supplier_country||"-",Company:re.company_name,"Mail Subject":re.mail_subject||"-","ACE ERP#":re.aceerp_no||"-",Pipeline:((Ae=Ip.find(me=>me.value===re.pipeline_status))==null?void 0:Ae.label)||"-","Price Needed":re.price_required?"Yes":"No","COA Needed":re.coa_required?"Yes":"No","Sample Needed":re.sample_required?"Yes":"No","Agency Letter Needed":re.agency_letter_required?"Yes":"No","Others Needed":re.others_required?"Yes":"No","Price Sent":re.price_sent_at?"Yes":"No","COA Sent":re.coa_sent_at?"Yes":"No","Sample Sent":re.sample_sent_at?"Yes":"No","Agency Letter Sent":re.agency_letter_sent_at?"Yes":"No","Purchase Price":re.purchase_price?`${re.purchase_price} ${re.purchase_price_currency||"USD"}`:"-","Offered Price":re.offered_price?`${re.offered_price} ${re.offered_price_currency||"USD"}`:"-","Delivery Date":re.delivery_date?new Date(re.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":re.delivery_terms||"-",Priority:((pe=at.find(me=>me.value===re.priority))==null?void 0:pe.label)||re.priority,Remarks:re.remarks||"-"}}),Ee=gi.json_to_sheet(_e),dt=gi.sheet_to_csv(Ee),Mt=new Blob([dt],{type:"text/csv;charset=utf-8;"}),W=document.createElement("a"),ue=URL.createObjectURL(Mt);W.setAttribute("href",ue),W.setAttribute("download",`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.csv`),W.style.visibility="hidden",document.body.appendChild(W),W.click(),document.body.removeChild(W),alert(`Exported ${_e.length} inquiries to CSV. You can import this file to Google Sheets.`)}catch(_e){console.error("Export error:",_e),alert("Failed to export data. Please try again.")}finally{se(!1)}},ke=()=>{const _e=[{Date:"02-12-2024",Product:"Example Product Name",Specification:"BP / USP / EP",Qty:"500 KG",Supplier:"Manufacturer Name",Country:"Japan",Company:"Customer Company Name","Mail Subject":"Inquiry for Product","ACE ERP#":"ACE-123","Price Needed":"Yes","COA Needed":"Yes","Sample Needed":"No","Agency Letter Needed":"No","Others Needed":"No","Purchase Price":"100","Purchase Price Currency":"USD","Offered Price":"150","Offered Price Currency":"USD","Delivery Date":"2025-12-31","Delivery Terms":"FOB Shanghai",Priority:"Medium",Remarks:"Additional notes"}],Ee=gi.json_to_sheet(_e),dt=gi.book_new();gi.book_append_sheet(dt,Ee,"Import Template"),yw(dt,"CRM-Import-Template.xlsx"),alert("Template downloaded! Fill in your data and use the Import button to upload.")},qe=_e=>{var Mt;const Ee=(Mt=_e.target.files)==null?void 0:Mt[0];if(!Ee)return;const dt=new FileReader;dt.onload=async W=>{var ue;try{const re=new Uint8Array((ue=W.target)==null?void 0:ue.result),Ae=vw(re,{type:"array"}),pe=Ae.Sheets[Ae.SheetNames[0]],me=gi.sheet_to_json(pe);if(me.length===0){alert("No data found in the file");return}const{data:{user:De}}=await oe.auth.getUser();if(!De)throw new Error("Not authenticated");const Ge=be=>{if(!be)return new Date().toISOString().split("T")[0];if(typeof be=="number"){const bt=new Date(1899,11,30),Vt=new Date(bt.getTime()+be*864e5),Ht=Vt.getFullYear(),Br=(Vt.getMonth()+1).toString().padStart(2,"0"),js=Vt.getDate().toString().padStart(2,"0");return`${Ht}-${Br}-${js}`}const fe=be.toString().trim(),Ie=fe.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(Ie){let[,bt,Vt,Ht]=Ie;return`${parseInt(Ht)<30?`20${Ht}`:`19${Ht}`}-${Vt.padStart(2,"0")}-${bt.padStart(2,"0")}`}const We=fe.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(We){const[,bt,Vt,Ht]=We;return`${Ht}-${Vt.padStart(2,"0")}-${bt.padStart(2,"0")}`}const nt=fe.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(nt){const[,bt,Vt,Ht]=nt;return`${Ht}-${Vt.padStart(2,"0")}-${bt.padStart(2,"0")}`}const ft=fe.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(ft){const[,bt,Vt,Ht]=ft;return`${bt}-${Vt.padStart(2,"0")}-${Ht.padStart(2,"0")}`}return new Date().toISOString().split("T")[0]},Oe=me.map(be=>({product_name:be.Product||"",specification:be.Specification||null,quantity:be.Qty||"",supplier_name:be.Supplier||null,supplier_country:be.Country||null,company_name:be.Company||"",mail_subject:be["Mail Subject"]||null,aceerp_no:be["ACE ERP#"]||null,price_required:(be["Price Needed"]||"").toLowerCase()==="yes",coa_required:(be["COA Needed"]||"").toLowerCase()==="yes",sample_required:(be["Sample Needed"]||"").toLowerCase()==="yes",agency_letter_required:(be["Agency Letter Needed"]||"").toLowerCase()==="yes",others_required:(be["Others Needed"]||"").toLowerCase()==="yes",purchase_price:be["Purchase Price"]?parseFloat(be["Purchase Price"]):null,purchase_price_currency:be["Purchase Price Currency"]||"USD",offered_price:be["Offered Price"]?parseFloat(be["Offered Price"]):null,offered_price_currency:be["Offered Price Currency"]||"USD",delivery_date:be["Delivery Date"]||null,delivery_terms:be["Delivery Terms"]||null,priority:(be.Priority||"medium").toLowerCase(),remarks:be.Remarks||null,inquiry_date:Ge(be.Date),pipeline_status:"new",status:"new",inquiry_source:"other",assigned_to:De.id,created_by:De.id})),{error:Qe}=await oe.from("crm_inquiries").insert(Oe);if(Qe)throw Qe;alert(`Successfully imported ${Oe.length} inquiries!`),t(),_e.target.value=""}catch(re){console.error("Import error:",re),alert("Failed to import data. Please check the file format and try again."),_e.target.value=""}},dt.readAsArrayBuffer(Ee)},Me=(_e,Ee)=>{c(dt=>{const Mt=dt.find(W=>W.column===_e);if(Mt){const W=Mt.values.includes(Ee)?Mt.values.filter(ue=>ue!==Ee):[...Mt.values,Ee];return W.length===0?dt.filter(ue=>ue.column!==_e):dt.map(ue=>ue.column===_e?{...ue,values:W}:ue)}return[...dt,{column:_e,values:[Ee]}]})},Ve=_e=>{c(Ee=>Ee.filter(dt=>dt.column!==_e))},Et=_e=>{const Ee=e.map(dt=>dt[_e]);return[...new Set(Ee)].filter(Boolean).sort()},xt=_e=>l.some(Ee=>Ee.column===_e&&Ee.values.length>0),st=_e=>{o(Ee=>{const dt=new Set(Ee);return dt.has(_e)?dt.delete(_e):dt.add(_e),dt})},pt=()=>{a.size===f.length?o(new Set):o(new Set(f.map(_e=>_e.id)))},It=(_e,Ee)=>{r&&(y({id:_e.id,field:Ee}),p(String(_e[Ee]||"")))},ut=async()=>{if(g)try{const{error:_e}=await oe.from("crm_inquiries").update({[g.field]:m||null}).eq("id",g.id);if(_e)throw _e;y(null),t()}catch(_e){console.error("Error updating field:",_e),alert("Failed to update. Please try again.")}},kt=async(_e,Ee)=>{try{const{error:dt}=await oe.from("crm_inquiries").update({priority:Ee}).eq("id",_e.id);if(dt)throw dt;t()}catch(dt){console.error("Error updating priority:",dt)}},yt=async(_e,Ee)=>{if(Ee==="lost"){F(_e),B(!0);return}try{const{error:dt}=await oe.from("crm_inquiries").update({pipeline_status:Ee}).eq("id",_e.id);if(dt)throw dt;t()}catch(dt){console.error("Error updating pipeline status:",dt)}},Ct=async(_e,Ee)=>{var W;const dt=`${Ee}_sent_at`;if(_e[dt]){if(!confirm(`Are you sure you want to unmark ${Ee.toUpperCase()} as sent?`))return;try{const ue={[dt]:null},{error:re}=await oe.from("crm_inquiries").update(ue).eq("id",_e.id);if(re)throw re;t(),alert(`${Ee.toUpperCase()} unmarked!`)}catch(ue){console.error("Error unmarking requirement:",ue),alert("Failed to unmark. Please try again.")}return}if(Ee==="price"){ae(_e),Y(((W=_e.offered_price)==null?void 0:W.toString())||""),X(!0);return}try{const{error:ue}=await oe.rpc("mark_requirement_sent",{inquiry_id:_e.id,requirement_type:Ee});if(ue)throw ue;t(),alert(`${Ee.toUpperCase()} marked as sent!`)}catch(ue){console.error("Error marking requirement as sent:",ue),alert("Failed to mark as sent. Please try again.")}},er=async()=>{if(!K)return;const _e=he.trim()?parseFloat(he):null;try{const{error:Ee}=await oe.from("crm_inquiries").update({offered_price:_e}).eq("id",K.id);if(Ee)throw Ee;const{error:dt}=await oe.rpc("mark_requirement_sent",{inquiry_id:K.id,requirement_type:"price"});if(dt)throw dt;X(!1),ae(null),Y(""),t(),alert("Price marked as sent with offered price updated!")}catch(Ee){console.error("Error saving offered price and marking sent:",Ee),alert("Failed to save. Please try again.")}},Wt=()=>{const _e=f.find(Ee=>a.has(Ee.id));_e&&(k(_e),v(!0))},St=async()=>{const _e=f.find(Ee=>a.has(Ee.id));_e&&(k(_e),v(!0))},Ar=()=>{I(!0)},Fs=async()=>{const _e=f.find(Ee=>a.has(Ee.id));if(_e)try{const{data:{user:Ee}}=await oe.auth.getUser();if(!Ee)throw new Error("Not authenticated");await oe.from("crm_activities").insert({inquiry_id:_e.id,activity_type:"call",description:N,activity_date:new Date().toISOString().split("T")[0],is_completed:!0,created_by:Ee.id}),I(!1),Q(""),alert("Call logged successfully!"),t()}catch(Ee){console.error("Error logging call:",Ee),alert("Failed to log call. Please try again.")}},sr=async()=>{if(a.size===0)return;const _e=a.size;if(confirm(`Are you sure you want to delete ${_e} selected ${_e===1?"inquiry":"inquiries"}? This action cannot be undone.`))try{const Ee=Array.from(a),{error:dt}=await oe.from("crm_inquiries").delete().in("id",Ee);if(dt)throw dt;o(new Set),alert(`Successfully deleted ${_e} ${_e===1?"inquiry":"inquiries"}`),t()}catch(Ee){console.error("Error deleting inquiries:",Ee),alert("Failed to delete inquiries. Please try again.")}},an=()=>{T(!0)},Wn=async()=>{const _e=f.find(Ee=>a.has(Ee.id));if(_e)try{const{data:{user:Ee}}=await oe.auth.getUser();if(!Ee)throw new Error("Not authenticated");await oe.from("crm_activities").insert({inquiry_id:_e.id,activity_type:"follow_up",description:z,activity_date:new Date().toISOString().split("T")[0],follow_up_date:P,is_completed:!1,created_by:Ee.id}),T(!1),R(""),q(""),alert("Follow-up scheduled successfully!"),t()}catch(Ee){console.error("Error scheduling follow-up:",Ee),alert("Failed to schedule follow-up. Please try again.")}},Pt=()=>{const _e=f.find(Ee=>a.has(Ee.id));_e&&(Je({price_required:_e.price_required??!1,coa_required:_e.coa_required??!1,sample_required:_e.sample_required??!1,agency_letter_required:_e.agency_letter_required??!1,others_required:_e.others_required??!1}),ee(!0))},Ln=async()=>{const _e=f.find(Ee=>a.has(Ee.id));if(_e)try{const{error:Ee}=await oe.from("crm_inquiries").update(Te).eq("id",_e.id);if(Ee)throw Ee;ee(!1),alert("Customer requirements updated successfully!"),t()}catch(Ee){console.error("Error updating requirements:",Ee),alert("Failed to update requirements. Please try again.")}},on=f.find(_e=>a.has(_e.id));return i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:it,disabled:H||f.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to Excel (.xlsx)",children:[i.jsx(TB,{className:"w-3.5 h-3.5"}),H?"Exporting...":"Export Excel"]}),i.jsxs("button",{onClick:Ne,disabled:H||f.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to CSV for Google Sheets",children:[i.jsx(TA,{className:"w-3.5 h-3.5"}),H?"Exporting...":"Export CSV"]}),r&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),i.jsxs("button",{onClick:ke,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",title:"Download Excel template for bulk import",children:[i.jsx(TA,{className:"w-3.5 h-3.5"}),"Download Template"]}),i.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[i.jsx(TB,{className:"w-3.5 h-3.5"}),"Import Excel",i.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:qe,className:"hidden"})]}),n&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),i.jsxs("button",{onClick:n,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[i.jsx(Gn,{className:"w-3.5 h-3.5"}),"Add Inquiry"]})]})]}),i.jsxs("div",{className:"text-sm text-gray-600 ml-2",children:[f.length," ",f.length===1?"inquiry":"inquiries",l.length>0&&" (filtered)",d.direction&&" (sorted)"]})]})}),a.size>0&&r&&on&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("div",{className:"text-sm font-medium text-blue-900",children:["Selected: ",i.jsx("span",{className:"font-bold",children:on.inquiry_number})," - ",on.product_name]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:Wt,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[i.jsx(Io,{className:"w-3.5 h-3.5"}),"Send Price"]}),i.jsxs("button",{onClick:St,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-green-700 bg-green-50 border border-green-200 rounded-md hover:bg-green-100 transition",children:[i.jsx(Nr,{className:"w-3.5 h-3.5"}),"Send COA/MSDS"]}),i.jsxs("button",{onClick:Ar,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(IA,{className:"w-3.5 h-3.5"}),"Log Call"]}),i.jsxs("button",{onClick:an,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(ha,{className:"w-3.5 h-3.5"}),"Schedule Follow-up"]}),i.jsxs("button",{onClick:()=>V(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(Lf,{className:"w-3.5 h-3.5"}),"Create Task"]}),i.jsxs("button",{onClick:Pt,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-700 bg-purple-50 border border-purple-200 rounded-md hover:bg-purple-100 transition",title:"Edit Customer Requirements",children:[i.jsx(Lf,{className:"w-3.5 h-3.5"}),"Edit Requirements"]}),i.jsxs("button",{onClick:sr,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",title:"Delete Selected",children:[i.jsx(Xs,{className:"w-3.5 h-3.5"}),"Delete"]}),i.jsx("button",{onClick:()=>o(new Set),className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition",title:"Deselect",children:i.jsx(Xs,{className:"w-3.5 h-3.5"})})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden border border-gray-200",children:i.jsx("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 280px)"},children:i.jsxs("table",{className:"w-full text-sm border-collapse",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{className:"border-b border-gray-300",children:[i.jsx("th",{className:"px-3 py-2 border-r border-gray-300",children:i.jsx("input",{type:"checkbox",checked:a.size===f.length&&f.length>0,onChange:pt,className:"rounded border-gray-300"})}),i.jsx(ve,{column:"inquiry_number",label:"No.",className:"whitespace-nowrap"}),i.jsx(ve,{column:"inquiry_date",label:"Date",className:"whitespace-nowrap"}),i.jsx(ve,{column:"product_name",label:"Product"}),i.jsx(ve,{column:"specification",label:"Specification"}),i.jsx(ve,{column:"quantity",label:"Qty"}),i.jsx(ve,{column:"supplier_name",label:"Supplier"}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[150px] relative",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Company"}),i.jsx("button",{onClick:()=>u(A==="company_name"?null:"company_name"),className:`p-0.5 rounded hover:bg-gray-200 ${xt("company_name")?"text-blue-600":""}`,children:i.jsx(ac,{className:"w-4 h-4"})})]}),A==="company_name"&&i.jsxs("div",{ref:ie,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-64",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Company"}),xt("company_name")&&i.jsx("button",{onClick:()=>Ve("company_name"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Et("company_name").map(_e=>{var dt;const Ee=(dt=l.find(Mt=>Mt.column==="company_name"))==null?void 0:dt.values.includes(String(_e));return i.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Ee,onChange:()=>Me("company_name",String(_e)),className:"rounded border-gray-300"}),i.jsx("span",{className:"text-sm",children:String(_e)})]},String(_e))})})]})]}),i.jsx(ve,{column:"mail_subject",label:"Mail Subject"}),i.jsx(ve,{column:"aceerp_no",label:"ACE ERP#"}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative min-w-[130px]",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Pipeline"}),i.jsx("button",{onClick:()=>u(A==="pipeline_status"?null:"pipeline_status"),className:`p-0.5 rounded hover:bg-gray-200 ${xt("pipeline_status")?"text-blue-600":""}`,children:i.jsx(ac,{className:"w-4 h-4"})})]}),A==="pipeline_status"&&i.jsxs("div",{ref:ie,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Pipeline"}),xt("pipeline_status")&&i.jsx("button",{onClick:()=>Ve("pipeline_status"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Ip.map(_e=>{var dt;const Ee=(dt=l.find(Mt=>Mt.column==="pipeline_status"))==null?void 0:dt.values.includes(_e.value);return i.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Ee,onChange:()=>Me("pipeline_status",_e.value),className:"rounded border-gray-300"}),i.jsx("span",{className:"text-sm",children:_e.label})]},_e.value)})})]})]}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[120px] relative",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Our Side"}),i.jsx("button",{onClick:()=>u(A==="our_side"?null:"our_side"),className:`p-0.5 rounded hover:bg-gray-200 ${xt("our_side")?"text-blue-600":""}`,children:i.jsx(ac,{className:"w-4 h-4"})})]}),A==="our_side"&&i.jsxs("div",{ref:ie,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Our Side"}),xt("our_side")&&i.jsx("button",{onClick:()=>Ve("our_side"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsxs("div",{className:"p-2 space-y-1",children:[i.jsxs("button",{onClick:()=>{const _e=e.filter(Ee=>(Ee.price_required??!0)&&!Ee.price_sent_at);h(_e),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"P"}),i.jsx("span",{children:"Price Pending"})]}),i.jsxs("button",{onClick:()=>{const _e=e.filter(Ee=>(Ee.coa_required??!0)&&!Ee.coa_sent_at);h(_e),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"C"}),i.jsx("span",{children:"COA Pending"})]}),i.jsxs("button",{onClick:()=>{const _e=e.filter(Ee=>(Ee.price_required??!0)&&Ee.price_sent_at);h(_e),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"P"}),i.jsx("span",{children:"Price Sent"})]}),i.jsxs("button",{onClick:()=>{const _e=e.filter(Ee=>(Ee.coa_required??!0)&&Ee.coa_sent_at);h(_e),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"C"}),i.jsx("span",{children:"COA Sent"})]})]})]})]}),(s==null?void 0:s.role)==="admin"&&i.jsxs("th",{style:{width:$e.purchase_price,minWidth:$e.purchase_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[i.jsx("span",{children:"P.Price"}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:_e=>we("purchase_price",_e)})]}),i.jsxs("th",{style:{width:$e.offered_price,minWidth:$e.offered_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[i.jsx("span",{children:"O.Price"}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:_e=>we("offered_price",_e)})]}),i.jsxs("th",{style:{width:$e.delivery_date,minWidth:$e.delivery_date},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[i.jsx("span",{children:"Delivery"}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:_e=>we("delivery_date",_e)})]}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Priority"}),i.jsx("button",{onClick:()=>u(A==="priority"?null:"priority"),className:`p-0.5 rounded hover:bg-gray-200 ${xt("priority")?"text-blue-600":""}`,children:i.jsx(ac,{className:"w-4 h-4"})})]}),A==="priority"&&i.jsxs("div",{ref:ie,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-48",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Priority"}),xt("priority")&&i.jsx("button",{onClick:()=>Ve("priority"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsx("div",{className:"p-2",children:at.map(_e=>{var dt;const Ee=(dt=l.find(Mt=>Mt.column==="priority"))==null?void 0:dt.values.includes(_e.value);return i.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Ee,onChange:()=>Me("priority",_e.value),className:"rounded border-gray-300"}),_e.icon,i.jsx("span",{className:"text-sm",children:_e.label})]},_e.value)})})]})]}),i.jsx(ve,{column:"remarks",label:"Remarks"})]})}),i.jsx("tbody",{children:f.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:18,className:"px-3 py-8 text-center text-gray-500",children:"No inquiries found"})}):f.map(_e=>i.jsxs("tr",{className:`border-b border-gray-200 hover:bg-blue-50 transition ${a.has(_e.id)?"bg-blue-100":""}`,children:[i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("input",{type:"checkbox",checked:a.has(_e.id),onChange:()=>st(_e.id),className:"rounded border-gray-300"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 font-medium text-blue-600",children:_e.inquiry_number}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 whitespace-nowrap",children:new Date(_e.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="product_name"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>It(_e,"product_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:_e.product_name})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 text-xs",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="specification"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>It(_e,"specification"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:_e.specification||"-"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="quantity"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>It(_e,"quantity"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:_e.quantity})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="supplier_name"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsxs("div",{onDoubleClick:()=>It(_e,"supplier_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:[i.jsx("div",{children:_e.supplier_name||"-"}),_e.supplier_country&&i.jsx("div",{className:"text-xs text-gray-500",children:_e.supplier_country})]})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("div",{className:"font-medium",children:_e.company_name})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="mail_subject"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>It(_e,"mail_subject"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",title:_e.mail_subject||"",children:_e.mail_subject?i.jsx("div",{className:"line-clamp-2",children:_e.mail_subject}):i.jsx("span",{className:"text-gray-400",children:"-"})})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="aceerp_no"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>r&&It(_e,"aceerp_no"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded":"px-2 py-1",children:_e.aceerp_no||(r?i.jsx("span",{className:"text-gray-400 text-xs",children:"Click to add"}):"-")})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("select",{value:_e.pipeline_status||"new",onChange:Ee=>yt(_e,Ee.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer bg-white",children:Ip.map(Ee=>i.jsx("option",{value:Ee.value,children:Ee.label},Ee.value))})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("div",{className:"flex items-center justify-center",children:i.jsx(P$,{inquiry:_e,onMarkSent:r?Ee=>Ct(_e,Ee):void 0})})}),(s==null?void 0:s.role)==="admin"&&i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="purchase_price"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):i.jsx("div",{onDoubleClick:()=>It(_e,"purchase_price"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",children:_e.purchase_price?`$${_e.purchase_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:i.jsx("span",{className:"text-gray-400",children:"Click to add"})})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="offered_price"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):i.jsx("div",{onDoubleClick:()=>r&&It(_e,"offered_price"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs":"px-2 py-1 text-xs",children:_e.offered_price?`$${_e.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:r?i.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="delivery_date"?i.jsx("input",{type:"date",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>r&&It(_e,"delivery_date"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs whitespace-nowrap":"px-2 py-1 text-xs whitespace-nowrap",children:_e.delivery_date?new Date(_e.delivery_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):r?i.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("select",{value:_e.priority,onChange:Ee=>kt(_e,Ee.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer",children:at.map(Ee=>i.jsx("option",{value:Ee.value,children:Ee.label},Ee.value))})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===_e.id&&(g==null?void 0:g.field)==="remarks"?i.jsx("input",{type:"text",value:m,onChange:Ee=>p(Ee.target.value),onBlur:ut,onKeyDown:Ee=>{Ee.key==="Enter"&&ut(),Ee.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>It(_e,"remarks"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-gray-600",children:_e.remarks||"-"})})]},_e.id))})]})})}),b&&C&&i.jsx(D$,{isOpen:b,onClose:()=>{v(!1),k(null),t()},inquiry:C}),i.jsx(fr,{isOpen:S,onClose:()=>{I(!1),Q("")},title:"Log Phone Call",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Call Notes *"}),i.jsx("textarea",{value:N,onChange:_e=>Q(_e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What was discussed during the call?",required:!0})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>{I(!1),Q("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:Fs,disabled:!N.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:"Save Call Log"})]})]})}),i.jsx(fr,{isOpen:L,onClose:()=>{T(!1),R(""),q("")},title:"Schedule Follow-up",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date *"}),i.jsx("input",{type:"date",value:P,onChange:_e=>R(_e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:z,onChange:_e=>q(_e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What needs to be followed up?"})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>{T(!1),R(""),q("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:Wn,disabled:!P,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50",children:"Schedule Follow-up"})]})]})}),M&&on&&i.jsx(d6,{isOpen:M,onClose:()=>V(!1),onSuccess:()=>{V(!1),t()},initialData:{inquiry_id:on.id}}),U&&i.jsx(Q$,{isOpen:ce,onClose:()=>{B(!1),F(null)},inquiryId:U.id,inquiryNumber:U.inquiry_number,onSuccess:()=>{t(),F(null)}}),i.jsx(fr,{isOpen:D,onClose:()=>{X(!1),ae(null),Y("")},title:"Enter Offered Price",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Inquiry: ",(K==null?void 0:K.inquiry_number)||"-"]}),i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Product: ",(K==null?void 0:K.product_name)||"-"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Offered Price (O.Price) *"}),i.jsx("input",{type:"number",value:he,onChange:_e=>Y(_e.target.value),placeholder:"Enter offered price",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the price you offered to the customer"})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>{X(!1),ae(null),Y("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),i.jsx("button",{onClick:er,className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Save & Mark Price as Sent"})]})]})}),i.jsx(fr,{isOpen:Be,onClose:()=>ee(!1),title:"Edit Customer Requirements",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Check what the customer has requested:"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Te.price_required,onChange:_e=>Je({...Te,price_required:_e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Price"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Te.coa_required,onChange:_e=>Je({...Te,coa_required:_e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"COA"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Te.sample_required,onChange:_e=>Je({...Te,sample_required:_e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sample"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Te.agency_letter_required,onChange:_e=>Je({...Te,agency_letter_required:_e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Agency Letter"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:Te.others_required,onChange:_e=>Je({...Te,others_required:_e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Others"})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:[i.jsx("button",{onClick:()=>ee(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:Ln,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition",children:"Save Requirements"})]})]})})]})}function H$({onReminderCreated:e}){const[t,r]=G.useState([]),[n,s]=G.useState(new Date),[a,o]=G.useState(null),[l,c]=G.useState("month"),[A,u]=G.useState(!0),[f,h]=G.useState(!1),[d,x]=G.useState(null);G.useEffect(()=>{g()},[n,l]);const g=async()=>{try{let P=oe.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `);if(l==="month"){const q=new Date(n.getFullYear(),n.getMonth(),1),M=new Date(n.getFullYear(),n.getMonth()+1,0);P=P.gte("due_date",q.toISOString()).lte("due_date",M.toISOString())}const{data:R,error:z}=await P.order("due_date",{ascending:!0});if(z)throw z;r(R||[])}catch(P){console.error("Error loading reminders:",P)}finally{u(!1)}},y=async P=>{try{const{error:R}=await oe.from("crm_reminders").update({is_completed:!P.is_completed,completed_at:P.is_completed?null:new Date().toISOString()}).eq("id",P.id);if(R)throw R;g()}catch(R){console.error("Error updating reminder:",R)}},m=async(P,R)=>{try{const z=new Date(P.due_date);z.setDate(z.getDate()+R);const{error:q}=await oe.from("crm_reminders").update({due_date:z.toISOString()}).eq("id",P.id);if(q)throw q;g(),h(!1)}catch(z){console.error("Error snoozing reminder:",z)}},p=P=>new Date(P.getFullYear(),P.getMonth()+1,0).getDate(),b=P=>new Date(P.getFullYear(),P.getMonth(),1).getDay(),v=P=>t.filter(R=>{const z=new Date(R.due_date);return z.getDate()===P.getDate()&&z.getMonth()===P.getMonth()&&z.getFullYear()===P.getFullYear()}),C=()=>{const P=new Date;return P.setHours(0,0,0,0),t.filter(R=>{const z=new Date(R.due_date);return z.setHours(0,0,0,0),z.getTime()===P.getTime()&&!R.is_completed})},k=()=>{const P=new Date;return P.setHours(0,0,0,0),t.filter(R=>{const z=new Date(R.due_date);return z.setHours(0,0,0,0),z<P&&!R.is_completed})},S=()=>{const P=new Date;P.setHours(0,0,0,0);const R=new Date(P);return R.setDate(R.getDate()+7),t.filter(z=>{const q=new Date(z.due_date);return q.setHours(0,0,0,0),q>P&&q<=R&&!z.is_completed})},I=()=>{s(new Date(n.getFullYear(),n.getMonth()-1))},N=()=>{s(new Date(n.getFullYear(),n.getMonth()+1))},Q={follow_up:"bg-blue-100 text-blue-800 border-blue-200",send_coa:"bg-orange-100 text-orange-800 border-orange-200",send_sample:"bg-green-100 text-green-800 border-green-200",send_price:"bg-purple-100 text-purple-800 border-purple-200",custom:"bg-gray-100 text-gray-800 border-gray-200"},L=()=>{const P=p(n),R=b(n),z=[];for(let q=0;q<R;q++)z.push(i.jsx("div",{className:"min-h-24 p-2 bg-gray-50"},`empty-${q}`));for(let q=1;q<=P;q++){const M=new Date(n.getFullYear(),n.getMonth(),q),V=v(M),H=M.toDateString()===new Date().toDateString();z.push(i.jsxs("div",{className:`min-h-24 p-2 border border-gray-200 ${H?"bg-blue-50":"bg-white"} hover:bg-gray-50 transition cursor-pointer`,onClick:()=>{o(M),V.length>0&&(x(V[0]),h(!0))},children:[i.jsx("div",{className:`text-sm font-medium mb-1 ${H?"text-blue-600":"text-gray-900"}`,children:q}),i.jsxs("div",{className:"space-y-1",children:[V.slice(0,3).map(se=>i.jsx("div",{className:`text-xs p-1 rounded border ${Q[se.reminder_type]} truncate ${se.is_completed?"opacity-50 line-through":""}`,title:se.title,children:se.title},se.id)),V.length>3&&i.jsxs("div",{className:"text-xs text-gray-500 font-medium",children:["+",V.length-3," more"]})]})]},q))}return z},T=()=>{const P=k(),R=C(),z=S();return i.jsxs("div",{className:"space-y-6",children:[P.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-red-600 mb-2 flex items-center gap-2",children:[i.jsx(Fa,{className:"w-4 h-4"}),"Overdue (",P.length,")"]}),i.jsx("div",{className:"space-y-2",children:P.map(q=>i.jsx(rv,{reminder:q,onToggleComplete:y,onViewDetails:()=>{x(q),h(!0)}},q.id))})]}),R.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-blue-600 mb-2 flex items-center gap-2",children:[i.jsx(Ws,{className:"w-4 h-4"}),"Today (",R.length,")"]}),i.jsx("div",{className:"space-y-2",children:R.map(q=>i.jsx(rv,{reminder:q,onToggleComplete:y,onViewDetails:()=>{x(q),h(!0)}},q.id))})]}),z.length>0&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Upcoming (Next 7 days)"}),i.jsx("div",{className:"space-y-2",children:z.map(q=>i.jsx(rv,{reminder:q,onToggleComplete:y,onViewDetails:()=>{x(q),h(!0)}},q.id))})]}),P.length===0&&R.length===0&&z.length===0&&i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(Ws,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.length===0?i.jsx("p",{children:"No reminders found. Create one using the quick actions!"}):i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"No upcoming reminders in the next 7 days"}),i.jsxs("p",{className:"text-sm mt-1",children:["You have ",t.length," reminder",t.length===1?"":"s"," total (all past or completed)"]})]})]})]})};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(ha,{className:"w-5 h-5 text-blue-600"}),"Reminders & Tasks"]}),i.jsxs("div",{className:"flex gap-1 bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>c("month"),className:`px-3 py-1 rounded text-sm ${l==="month"?"bg-white shadow":"text-gray-600"}`,children:"Month"}),i.jsx("button",{onClick:()=>c("list"),className:`px-3 py-1 rounded text-sm ${l==="list"?"bg-white shadow":"text-gray-600"}`,children:"List"})]})]}),l==="month"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:I,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:i.jsx(iO,{className:"w-5 h-5"})}),i.jsx("span",{className:"font-semibold min-w-40 text-center",children:n.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:i.jsx(Nm,{className:"w-5 h-5"})})]})]}),A?i.jsx("div",{className:"flex justify-center items-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l==="month"?i.jsxs("div",{className:"space-y-2",children:[t.length===0&&i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800",children:[i.jsxs("p",{className:"font-medium",children:["No reminders for ",n.toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),i.jsx("p",{className:"text-xs mt-1",children:'Use the arrows above to navigate to other months, or switch to "List" view to see all reminders.'})]}),t.length>0&&i.jsxs("div",{className:"text-sm text-gray-600 px-2",children:[t.length," reminder",t.length===1?"":"s"," in ",n.toLocaleDateString("en-US",{month:"long"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(P=>i.jsx("div",{className:"p-2 text-center text-sm font-semibold text-gray-700 bg-gray-50",children:P},P))}),i.jsx("div",{className:"grid grid-cols-7",children:L()})]})]}):i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:T()}),i.jsx(fr,{isOpen:f,onClose:()=>{h(!1),x(null)},title:"Reminder Details",children:d&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:`p-3 rounded-lg border ${Q[d.reminder_type]}`,children:[i.jsx("p",{className:"font-semibold",children:d.title}),i.jsxs("p",{className:"text-sm mt-1",children:["Due: ",new Date(d.due_date).toLocaleDateString()]})]}),d.description&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d.description})]}),d.crm_inquiries&&i.jsxs("div",{className:"border-t pt-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Related Inquiry"}),i.jsxs("div",{className:"mt-2 bg-gray-50 p-3 rounded-lg",children:[i.jsxs("p",{className:"text-sm font-medium",children:["#",d.crm_inquiries.inquiry_number]}),i.jsx("p",{className:"text-sm text-gray-600",children:d.crm_inquiries.company_name}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d.crm_inquiries.product_name})]})]}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>m(d,1),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 1 day"}),i.jsx("button",{onClick:()=>m(d,3),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 3 days"})]}),i.jsxs("button",{onClick:()=>{y(d),h(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[i.jsx(pa,{className:"w-4 h-4"}),d.is_completed?"Mark Incomplete":"Mark Complete"]})]})]})})]})}function rv({reminder:e,onToggleComplete:t,onViewDetails:r}){const n={follow_up:"border-blue-200",send_coa:"border-orange-200",send_sample:"border-green-200",send_price:"border-purple-200",custom:"border-gray-200"},s=new Date(e.due_date)<new Date&&!e.is_completed;return i.jsx("div",{className:`p-3 border-l-4 ${n[e.reminder_type]} bg-white rounded-lg shadow-sm hover:shadow-md transition ${e.is_completed?"opacity-60":""}`,children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1 cursor-pointer",onClick:r,children:[i.jsx("p",{className:`font-medium ${e.is_completed?"line-through":""}`,children:e.title}),e.crm_inquiries&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["#",e.crm_inquiries.inquiry_number," - ",e.crm_inquiries.company_name]}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("span",{className:`text-xs ${s?"text-red-600 font-medium":"text-gray-500"}`,children:new Date(e.due_date).toLocaleDateString()}),s&&i.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-0.5 rounded-full",children:"Overdue"})]})]}),i.jsx("button",{onClick:()=>t(e),className:`p-1 rounded ${e.is_completed?"text-green-600":"text-gray-400 hover:text-green-600"}`,children:i.jsx(pa,{className:"w-5 h-5"})})]})})}function K$({canManage:e,onInquiryClick:t}){const[r,n]=G.useState([]),[s,a]=G.useState([]),[o,l]=G.useState(!0),[c,A]=G.useState(null),[u,f]=G.useState(null);G.useEffect(()=>{h(),d()},[]);const h=async()=>{try{A(null);const{data:C,error:k}=await oe.from("crm_pipeline_stages").select("*").eq("is_active",!0).order("stage_order",{ascending:!0});if(k)throw console.error("Database error loading stages:",k),new Error(k.message||"Failed to load pipeline stages");a(C||[])}catch(C){const k=C instanceof Error?C.message:"Failed to load pipeline stages";console.error("Error loading stages:",C),A(k),a([])}},d=async()=>{try{A(null);const{data:C,error:k}=await oe.from("crm_inquiries").select("*").order("created_at",{ascending:!1});if(k)throw console.error("Database error loading inquiries:",k),new Error(k.message||"Failed to load inquiries");n(C||[])}catch(C){const k=C instanceof Error?C.message:"Failed to load inquiries";console.error("Error loading inquiries:",C),A(k),n([])}finally{l(!1)}},x={"New Inquiry":"new","Price Quoted":"price_quoted","COA Pending":"coa_pending","Sample Sent":"sample_sent",Negotiation:"negotiation","PO Received":"po_received",Won:"won",Lost:"lost"},g=C=>{const k=x[C];return r.filter(S=>S.status===k)},y=C=>{e&&f(C)},m=C=>{C.preventDefault()},p=async C=>{if(!u||!e)return;const k=x[C];if(u.status===k){f(null);return}try{const{error:S}=await oe.from("crm_inquiries").update({status:k}).eq("id",u.id);if(S)throw S;d()}catch(S){console.error("Error updating inquiry status:",S),alert("Failed to update inquiry status")}finally{f(null)}},b=C=>{const k=new Date(C.created_at),I=Math.abs(new Date().getTime()-k.getTime());return Math.ceil(I/(1e3*60*60*24))},v={urgent:"border-l-4 border-red-500",high:"border-l-4 border-orange-500",medium:"border-l-4 border-yellow-500",low:"border-l-4 border-gray-400"};return o?i.jsx("div",{className:"flex justify-center items-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c?i.jsx("div",{className:"space-y-4",children:i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"text-red-600 mt-0.5",children:i.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-red-900",children:"Error Loading Pipeline"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:c}),i.jsx("button",{onClick:()=>{h(),d()},className:"mt-3 text-sm font-medium text-red-700 hover:text-red-800 underline",children:"Try Again"})]})]})})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Pipeline View"}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",r.length," inquiries"]})]}),i.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:s.map(C=>{const k=g(C.stage_name),S=k.reduce((I,N)=>I+(N.estimated_value||0),0);return i.jsxs("div",{className:"flex-shrink-0 w-80 bg-gray-50 rounded-lg",onDragOver:m,onDrop:()=>p(C.stage_name),children:[i.jsxs("div",{className:"p-4 rounded-t-lg",style:{backgroundColor:C.color+"20"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:C.stage_name}),i.jsx("span",{className:"text-sm font-medium text-gray-600",children:k.length})]}),S>0&&i.jsxs("div",{className:"text-xs text-gray-600",children:["Value: Rp ",S.toLocaleString("id-ID")]})]}),i.jsx("div",{className:"p-2 space-y-2 max-h-[600px] overflow-y-auto",children:k.length===0?i.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No inquiries"}):k.map(I=>i.jsxs("div",{draggable:e,onDragStart:()=>y(I),onClick:()=>t&&t(I),className:`bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition cursor-pointer ${v[I.priority]||""} ${e?"cursor-move":""}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("span",{className:"text-xs font-semibold text-blue-600",children:["#",I.inquiry_number]}),i.jsxs("span",{className:"text-xs text-gray-500",children:[b(I),"d"]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(sO,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:I.company_name})]}),i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(ri,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:I.product_name})]}),i.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[i.jsx("span",{children:I.quantity}),i.jsx("span",{children:new Date(I.inquiry_date).toLocaleDateString("en-GB")})]}),I.priority==="urgent"&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[i.jsx(Fa,{className:"w-3 h-3"}),i.jsx("span",{className:"font-medium",children:"URGENT"})]}),I.estimated_value&&I.estimated_value>0&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 font-medium",children:[i.jsx(To,{className:"w-3 h-3"}),i.jsxs("span",{children:["Rp ",I.estimated_value.toLocaleString("id-ID")]})]})]})]},I.id))})]},C.id)})}),!e&&i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[i.jsx(Fa,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-sm text-yellow-800",children:"You have view-only access to the pipeline. Contact admin to manage inquiries."})]})]})}function q$({inquiry:e,onClose:t,onSent:r}){const[n,s]=G.useState([]),[a,o]=G.useState(null),[l,c]=G.useState(""),[A,u]=G.useState(""),[f,h]=G.useState(""),[d,x]=G.useState(!1),[g,y]=G.useState(!1);G.useEffect(()=>{m(),e&&c(e.contact_email||"")},[e]);const m=async()=>{try{const{data:v,error:C}=await oe.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(C)throw C;s(v||[])}catch(v){console.error("Error loading templates:",v)}},p=v=>{let C=v.subject,k=v.body;e&&(C=C.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number),k=k.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"Sir/Madam").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number)),u(C),h(k),o(v),y(!1)},b=async()=>{if(!l||!A||!f){alert("Please fill in all required fields");return}x(!0);try{const{data:{user:v}}=await oe.auth.getUser();if(!v)throw new Error("Not authenticated");const C=l.split(";").map(I=>I.trim()).filter(I=>I.length>0),k={inquiry_id:(e==null?void 0:e.id)||null,contact_id:null,email_type:"sent",from_email:v.email,to_email:C,subject:A,body:f,template_id:(a==null?void 0:a.id)||null,sent_date:new Date().toISOString(),created_by:v.id},{error:S}=await oe.from("crm_email_activities").insert([k]);if(S)throw S;a&&await oe.from("crm_email_templates").update({use_count:a.use_count+1,last_used:new Date().toISOString()}).eq("id",a.id),alert("Email logged successfully! Note: Actual email sending requires SMTP configuration."),r&&r(),t&&t()}catch(v){console.error("Error sending email:",v),alert("Failed to send email. Please try again.")}finally{x(!1)}};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx($s,{className:"w-5 h-5 text-blue-600"}),"Compose Email"]}),i.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:[i.jsx(Nr,{className:"w-4 h-4"}),"Use Template"]})]}),e&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[i.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Inquiry #",e.inquiry_number," - ",e.company_name]}),i.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[e.product_name," - ",e.quantity]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To *"}),i.jsx("input",{type:"text",value:l,onChange:v=>c(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"recipient@example.com; recipient2@example.com",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l.includes(";")?`Sending to ${l.split(";").filter(v=>v.trim()).length} email addresses`:"Separate multiple emails with semicolon (;)"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:A,onChange:v=>u(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),i.jsx("textarea",{value:f,onChange:v=>h(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:12,placeholder:"Type your message here...",required:!0})]}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[i.jsx("div",{className:"flex gap-2",children:i.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:!0,children:[i.jsx(jo,{className:"w-4 h-4"}),"Attach Files (Coming Soon)"]})}),i.jsxs("div",{className:"flex gap-2",children:[t&&i.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:b,disabled:d||!l||!A||!f,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:d?i.jsxs(i.Fragment,{children:[i.jsx(Bc,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Io,{className:"w-4 h-4"}),"Send Email"]})})]})]}),i.jsx(fr,{isOpen:g,onClose:()=>y(!1),title:"Email Templates",children:i.jsx("div",{className:"space-y-2",children:n.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Nr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),i.jsx("p",{children:"No templates available"}),i.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):n.map(v=>i.jsxs("div",{onClick:()=>p(v),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:[i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-900",children:v.template_name}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v.subject}),v.category&&i.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:v.category})]})}),v.variables&&v.variables.length>0&&i.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:i.jsxs("p",{className:"text-xs text-gray-500",children:["Variables: ",v.variables.join(", ")]})})]},v.id))})})]})}function V$({selectedCustomers:e,onClose:t,onComplete:r}){var P;const[n,s]=G.useState([]),[a,o]=G.useState(null),[l,c]=G.useState(""),[A,u]=G.useState(""),[f,h]=G.useState(30),[d,x]=G.useState(!1),[g,y]=G.useState(!1),[m,p]=G.useState([]),[b,v]=G.useState(0);G.useEffect(()=>{k(),C()},[]);const C=()=>{const R=e.map(z=>({customerId:z.id,companyName:z.company_name,email:z.email,status:"pending"}));p(R)},k=async()=>{try{const{data:R,error:z}=await oe.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(z)throw z;s(R||[])}catch(R){console.error("Error loading templates:",R)}},S=R=>{c(R.subject),u(R.body),o(R),y(!1)},I=(R,z)=>R.replace(/\{\{company_name\}\}/g,z.company_name).replace(/\{\{contact_person\}\}/g,z.contact_person||"Sir/Madam"),N=async()=>{if(!l||!A){alert("Please fill in subject and message");return}if(f<10){alert("Please set interval to at least 10 seconds to avoid blocking");return}x(!0),v(0);try{const{data:{user:R}}=await oe.auth.getUser();if(!R)throw new Error("Not authenticated");const{data:z}=await oe.from("gmail_connections").select("*").eq("user_id",R.id).eq("is_connected",!0).maybeSingle();if(!z){alert("Gmail not connected. Please connect Gmail in Settings first."),x(!1);return}for(let M=0;M<e.length;M++){const V=e[M];v(M),p(H=>H.map((se,ce)=>ce===M?{...se,status:"sending"}:se));try{const H=V.email.split(";").map(X=>X.trim()).filter(X=>X.length>0),se=I(l,V),ce=I(A,V),F=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/send-bulk-email",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY"},body:JSON.stringify({userId:R.id,toEmails:H,subject:se,body:ce,contactId:V.id})});if(!F.ok)throw new Error("Failed to send email");const D=await F.json();if(D.success){const X={contact_id:V.id,email_type:"sent",from_email:R.email,to_email:H,subject:se,body:ce,template_id:(a==null?void 0:a.id)||null,sent_date:new Date().toISOString(),created_by:R.id};await oe.from("crm_email_activities").insert([X]),p(K=>K.map((ae,he)=>he===M?{...ae,status:"success"}:ae))}else throw new Error(D.error||"Unknown error");M<e.length-1&&await new Promise(X=>setTimeout(X,f*1e3))}catch(H){console.error(`Error sending to ${V.company_name}:`,H),p(se=>se.map((ce,B)=>B===M?{...ce,status:"error",error:H.message}:ce))}}a&&await oe.from("crm_email_templates").update({use_count:a.use_count+e.length,last_used:new Date().toISOString()}).eq("id",a.id);const q=m.filter(M=>M.status==="success").length;alert(`Bulk email completed!
${q} of ${e.length} emails sent successfully.`),r()}catch(R){console.error("Error in bulk email:",R),alert("Failed to complete bulk email. Please check the results.")}finally{x(!1)}},Q=m.filter(R=>R.status==="success").length,L=m.filter(R=>R.status==="error").length,T=m.filter(R=>R.status==="pending").length;return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx($s,{className:"w-5 h-5 text-blue-600"}),"Bulk Email to Customers"]}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Sending to ",e.length," customers"]})]}),i.jsxs("button",{onClick:()=>y(!0),disabled:d,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50",children:[i.jsx(Nr,{className:"w-4 h-4"}),"Use Template"]})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[i.jsx(Fa,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-yellow-800",children:[i.jsx("p",{className:"font-medium",children:"Important: Email Throttling"}),i.jsxs("p",{className:"mt-1",children:["Emails will be sent with ",f,"s intervals to prevent your email account from being blocked. Total time: ~",Math.ceil(e.length*f/60)," minutes"]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interval Between Emails (seconds)"}),i.jsx("input",{type:"number",min:"10",max:"300",value:f,onChange:R=>h(Math.max(10,parseInt(R.target.value)||10)),disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 seconds recommended. Higher values are safer for large batches."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:l,onChange:R=>c(R.target.value),disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",placeholder:"Email subject (use {{company_name}} and {{contact_person}} for personalization)"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),i.jsx("textarea",{value:A,onChange:R=>u(R.target.value),disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",rows:10,placeholder:"Type your message here... (use {{company_name}} and {{contact_person}} for personalization)"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables: ","{{company_name}}",", ","{{contact_person}}"]})]}),d&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),i.jsxs("div",{children:[i.jsxs("p",{className:"font-medium text-blue-900",children:["Sending email ",b+1," of ",e.length]}),i.jsxs("p",{className:"text-sm text-blue-700",children:["Current: ",(P=e[b])==null?void 0:P.company_name]})]})]}),i.jsxs("div",{className:"flex gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-1 text-green-700",children:[i.jsx(pa,{className:"w-4 h-4"}),"Success: ",Q]}),i.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[i.jsx(zs,{className:"w-4 h-4"}),"Failed: ",L]}),i.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[i.jsx(Ws,{className:"w-4 h-4"}),"Pending: ",T]})]})]}),m.some(R=>R.status!=="pending")&&i.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b",children:i.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Send Results"})}),i.jsx("div",{className:"max-h-64 overflow-y-auto",children:m.map((R,z)=>i.jsxs("div",{className:`px-4 py-2 border-b last:border-b-0 flex items-center justify-between ${R.status==="success"?"bg-green-50":R.status==="error"?"bg-red-50":R.status==="sending"?"bg-blue-50":""}`,children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:R.companyName}),i.jsx("p",{className:"text-xs text-gray-600",children:R.email}),R.error&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:R.error})]}),i.jsxs("div",{children:[R.status==="success"&&i.jsx(pa,{className:"w-5 h-5 text-green-600"}),R.status==="error"&&i.jsx(zs,{className:"w-5 h-5 text-red-600"}),R.status==="sending"&&i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),R.status==="pending"&&i.jsx(Ws,{className:"w-5 h-5 text-gray-400"})]})]},z))})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{onClick:t,disabled:d,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:d?"Sending...":"Cancel"}),i.jsxs("button",{onClick:N,disabled:d||!l||!A,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Io,{className:"w-4 h-4"}),d?"Sending...":"Start Bulk Send"]})]}),i.jsx(fr,{isOpen:g,onClose:()=>y(!1),title:"Email Templates",children:i.jsx("div",{className:"space-y-2",children:n.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Nr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),i.jsx("p",{children:"No templates available"}),i.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):n.map(R=>i.jsx("div",{onClick:()=>S(R),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-900",children:R.template_name}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:R.subject}),R.category&&i.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:R.category})]})})},R.id))})})]})}function G$(){const[e,t]=G.useState([]),[r,n]=G.useState([]),[s,a]=G.useState(!0),[o,l]=G.useState(null),[c,A]=G.useState(""),[u,f]=G.useState(new Set),[h,d]=G.useState(!1),[x,g]=G.useState(""),[y,m]=G.useState(""),[p,b]=G.useState(""),[v,C]=G.useState({created_at:110,company_name:200,contact_person:150,designation:120,email:180,mobile:130,landline:130,phone:130,country:120,city:120,address:200,website:150,customer_type:120,notes:200}),[k,S]=G.useState(null),I=G.useRef(null);G.useEffect(()=>{N()},[]),G.useEffect(()=>{if(k){const K=he=>{const Y=he.clientX-k.startX,Be=Math.max(80,k.startWidth+Y);C(ee=>({...ee,[k.column]:Be}))},ae=()=>{S(null)};return document.addEventListener("mousemove",K),document.addEventListener("mouseup",ae),()=>{document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",ae)}}},[k]);const N=async()=>{try{const{data:K,error:ae}=await oe.from("crm_contacts").select("*").order("company_name");if(ae)throw ae;t(K||[]),n(K||[])}catch(K){console.error("Error loading customers:",K)}finally{a(!1)}};G.useEffect(()=>{let K=[...e];if(x){const ae=x.toLowerCase();K=K.filter(he=>{var Y,Be,ee,Te;return((Y=he.company_name)==null?void 0:Y.toLowerCase().includes(ae))||((Be=he.contact_person)==null?void 0:Be.toLowerCase().includes(ae))||((ee=he.email)==null?void 0:ee.toLowerCase().includes(ae))||((Te=he.city)==null?void 0:Te.toLowerCase().includes(ae))})}y&&(K=K.filter(ae=>ae.city===y)),p&&(K=K.filter(ae=>ae.customer_type===p)),n(K)},[x,y,p,e]);const Q=Array.from(new Set(e.map(K=>K.city).filter(Boolean))).sort(),L=Array.from(new Set(e.map(K=>K.customer_type).filter(Boolean))).sort(),T=(K,ae)=>{l({rowId:K.id,field:ae}),A(K[ae]||"")},P=async()=>{if(o)try{const{error:K}=await oe.from("crm_contacts").update({[o.field]:c||null}).eq("id",o.rowId);if(K)throw K;t(ae=>ae.map(he=>he.id===o.rowId?{...he,[o.field]:c||null}:he))}catch(K){console.error("Error updating customer:",K),alert("Failed to update customer")}finally{l(null),A("")}},R=K=>{K.key==="Enter"?(K.preventDefault(),P()):K.key==="Escape"&&(l(null),A(""))},z=async()=>{try{const{data:{user:K}}=await oe.auth.getUser();if(!K)throw new Error("Not authenticated");const{data:ae,error:he}=await oe.from("crm_contacts").insert({company_name:"New Customer",is_active:!0,created_by:K.id}).select().single();if(he)throw he;t(Y=>[ae,...Y])}catch(K){console.error("Error adding customer:",K),alert("Failed to add customer")}},q=async()=>{if(u.size!==0&&confirm(`Delete ${u.size} customer(s)?`))try{const{error:K}=await oe.from("crm_contacts").delete().in("id",Array.from(u));if(K)throw K;t(ae=>ae.filter(he=>!u.has(he.id))),f(new Set)}catch(K){console.error("Error deleting customers:",K),alert("Failed to delete customers")}},M=K=>{f(ae=>{const he=new Set(ae);return he.has(K)?he.delete(K):he.add(K),he})},V=()=>{u.size===r.length?f(new Set):f(new Set(r.map(K=>K.id)))},H=K=>{const ae=new Date(K),he=ae.getDate().toString().padStart(2,"0"),Y=(ae.getMonth()+1).toString().padStart(2,"0"),Be=ae.getFullYear();return`${he}-${Y}-${Be}`},se=()=>{const K=["Date","Company Name","Contact Person","Designation","Email","Mobile","Landline","Phone","Country","City","Address","Website","Customer Type","Notes"],ae=e.map(Te=>[H(Te.created_at),Te.company_name,Te.contact_person||"",Te.designation||"",Te.email||"",Te.mobile||"",Te.landline||"",Te.phone||"",Te.country||"",Te.city||"",Te.address||"",Te.website||"",Te.customer_type||"",Te.notes||""]),he=[K,...ae].map(Te=>Te.map(Je=>`"${Je}"`).join(",")).join(`
`),Y=new Blob([he],{type:"text/csv"}),Be=URL.createObjectURL(Y),ee=document.createElement("a");ee.href=Be,ee.download=`customers_${new Date().toISOString().split("T")[0]}.csv`,ee.click()},ce=async K=>{var he;const ae=(he=K.target.files)==null?void 0:he[0];if(ae){try{const{data:{user:Y}}=await oe.auth.getUser();if(!Y)throw new Error("Not authenticated");const ee=(await ae.text()).split(`
`).filter(st=>st.trim());if(ee.length<2){alert("CSV file is empty or invalid");return}const Te=ee[0].split(",").map(st=>st.replace(/"/g,"").trim()),Je=ee.slice(1),ie=Te.findIndex(st=>st.toLowerCase()==="date"),$e=Te.findIndex(st=>st.toLowerCase()==="company name"),ze=Te.findIndex(st=>st.toLowerCase()==="contact person"),Fe=Te.findIndex(st=>st.toLowerCase()==="designation"),Re=Te.findIndex(st=>st.toLowerCase()==="email"),at=Te.findIndex(st=>st.toLowerCase()==="mobile"),we=Te.findIndex(st=>st.toLowerCase()==="landline"),ve=Te.findIndex(st=>st.toLowerCase()==="phone"),Le=Te.findIndex(st=>st.toLowerCase()==="country"),tt=Te.findIndex(st=>st.toLowerCase()==="city"),lt=Te.findIndex(st=>st.toLowerCase()==="address"),it=Te.findIndex(st=>st.toLowerCase()==="website"),Ne=Te.findIndex(st=>st.toLowerCase()==="customer type"),ke=Te.findIndex(st=>st.toLowerCase()==="notes");if($e===-1){alert('CSV must have a "Company Name" column');return}const qe=st=>{const pt=[];let It="",ut=!1;for(let kt=0;kt<st.length;kt++){const yt=st[kt];yt==='"'?ut=!ut:yt===","&&!ut?(pt.push(It.trim()),It=""):It+=yt}return pt.push(It.trim()),pt},Me=st=>{if(!st)return new Date().toISOString();const pt=[/^(\d{1,2})-(\d{1,2})-(\d{4})$/,/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,/^(\d{4})-(\d{1,2})-(\d{1,2})$/];for(const It of pt){const ut=st.match(It);if(ut){let kt,yt,Ct;return It.toString().includes("\\d{4}$")?[,kt,yt,Ct]=ut:[,Ct,yt,kt]=ut,new Date(`${Ct}-${yt.padStart(2,"0")}-${kt.padStart(2,"0")}`).toISOString()}}return new Date().toISOString()},Ve=Je.map(st=>{var kt,yt,Ct,er,Wt,St,Ar,Fs,sr,an,Wn,Pt,Ln,on;const pt=qe(st),It=(kt=pt[$e])==null?void 0:kt.replace(/"/g,"").trim();if(!It)return null;const ut=ie!==-1?Me((yt=pt[ie])==null?void 0:yt.replace(/"/g,"").trim()):new Date().toISOString();return{company_name:It,contact_person:ze!==-1&&((Ct=pt[ze])==null?void 0:Ct.replace(/"/g,"").trim())||null,designation:Fe!==-1&&((er=pt[Fe])==null?void 0:er.replace(/"/g,"").trim())||null,email:Re!==-1&&((Wt=pt[Re])==null?void 0:Wt.replace(/"/g,"").trim())||null,mobile:at!==-1&&((St=pt[at])==null?void 0:St.replace(/"/g,"").trim())||null,landline:we!==-1&&((Ar=pt[we])==null?void 0:Ar.replace(/"/g,"").trim())||null,phone:ve!==-1&&((Fs=pt[ve])==null?void 0:Fs.replace(/"/g,"").trim())||null,country:Le!==-1&&((sr=pt[Le])==null?void 0:sr.replace(/"/g,"").trim())||null,city:tt!==-1&&((an=pt[tt])==null?void 0:an.replace(/"/g,"").trim())||null,address:lt!==-1&&((Wn=pt[lt])==null?void 0:Wn.replace(/"/g,"").trim())||null,website:it!==-1&&((Pt=pt[it])==null?void 0:Pt.replace(/"/g,"").trim())||null,customer_type:Ne!==-1&&((Ln=pt[Ne])==null?void 0:Ln.replace(/"/g,"").trim())||null,notes:ke!==-1&&((on=pt[ke])==null?void 0:on.replace(/"/g,"").trim())||null,is_active:!0,created_by:Y.id,created_at:ut}}).filter(Boolean);if(Ve.length===0){alert("No valid customer data found in CSV");return}const{data:Et,error:xt}=await oe.from("crm_contacts").insert(Ve).select();if(xt)throw xt;alert(`Successfully imported ${Ve.length} customer(s)`),N()}catch(Y){console.error("Error importing CSV:",Y),alert("Failed to import CSV. Please check the file format.")}K.target.value=""}},B=K=>{const ae=new Date(K),he=ae.getDate().toString().padStart(2,"0"),Y=(ae.getMonth()+1).toString().padStart(2,"0"),Be=ae.getFullYear();return`${he}-${Y}-${Be}`},U=(K,ae)=>{const he=(o==null?void 0:o.rowId)===K.id&&(o==null?void 0:o.field)===ae,Y=K[ae];return ae==="created_at"?i.jsx("div",{className:"px-2 py-1 h-full flex items-center",children:i.jsx("span",{className:"truncate text-xs",children:B(K.created_at)})}):he?i.jsx("input",{type:"text",value:c,onChange:Be=>A(Be.target.value),onBlur:P,onKeyDown:R,autoFocus:!0,className:"w-full h-full px-2 py-1 border-2 border-blue-500 focus:outline-none bg-white"}):i.jsx("div",{onDoubleClick:()=>T(K,ae),className:"px-2 py-1 cursor-cell hover:bg-gray-50 h-full flex items-center",title:"Double-click to edit",children:ae==="is_active"?i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Y?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:Y?"Active":"Inactive"}):i.jsx("span",{className:"truncate",children:(Y==null?void 0:Y.toString())||"-"})})},F=(K,ae)=>{K.preventDefault(),S({column:ae,startX:K.clientX,startWidth:v[ae]})},D=()=>{if(Array.from(u).map(ae=>e.find(he=>he.id===ae)).filter(ae=>!!ae&&!!ae.email).length===0){alert("Please select customers with email addresses");return}d(!0)},X=()=>Array.from(u).map(K=>e.find(ae=>ae.id===K)).filter(K=>!!K&&!!K.email).map(K=>({id:K.id,company_name:K.company_name,email:K.email,contact_person:K.contact_person}));return s?i.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading customers..."}):i.jsxs("div",{className:"flex flex-col h-full bg-white rounded-lg shadow",children:[i.jsxs("div",{className:"flex flex-col gap-3 px-4 py-3 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:z,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[i.jsx(Gn,{className:"w-3.5 h-3.5"}),"Add Customer"]}),u.size>0&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:D,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-green-600 border border-green-700 rounded-md hover:bg-green-700 transition",children:[i.jsx(Io,{className:"w-3.5 h-3.5"}),"Send Email (",u.size,")"]}),i.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",children:[i.jsx(ks,{className:"w-3.5 h-3.5"}),"Delete (",u.size,")"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[i.jsx(ZE,{className:"w-3.5 h-3.5"}),"Import CSV",i.jsx("input",{type:"file",accept:".csv",onChange:ce,className:"hidden"})]}),i.jsxs("button",{onClick:se,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(TA,{className:"w-3.5 h-3.5"}),"Export CSV"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(Lc,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",value:x,onChange:K=>g(K.target.value),placeholder:"Search by company, contact person, email, or city...",className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("select",{value:y,onChange:K=>m(K.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"All Cities"}),Q.map(K=>i.jsx("option",{value:K,children:K},K))]}),i.jsxs("select",{value:p,onChange:K=>b(K.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"All Types"}),L.map(K=>i.jsx("option",{value:K,children:K},K))]}),(x||y||p)&&i.jsx("button",{onClick:()=>{g(""),m(""),b("")},className:"px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Clear Filters"})]})]}),i.jsx("div",{ref:I,className:"flex-1 overflow-auto",style:{maxHeight:"calc(100vh - 250px)"},children:i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{className:"sticky top-0 bg-gray-50 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 w-10",children:i.jsx("input",{type:"checkbox",checked:u.size===r.length&&r.length>0,onChange:V,className:"rounded"})}),[{key:"created_at",label:"Date"},{key:"company_name",label:"Company Name"},{key:"contact_person",label:"Contact Person"},{key:"designation",label:"Designation"},{key:"email",label:"Email"},{key:"mobile",label:"Mobile"},{key:"landline",label:"Landline"},{key:"phone",label:"Phone"},{key:"country",label:"Country"},{key:"city",label:"City"},{key:"address",label:"Address"},{key:"website",label:"Website"},{key:"customer_type",label:"Type"},{key:"notes",label:"Notes"}].map(({key:K,label:ae})=>i.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 text-left text-xs font-semibold text-gray-700 relative",style:{width:v[K],minWidth:v[K]},children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:ae}),i.jsx("div",{onMouseDown:he=>F(he,K),className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 hover:w-1.5 transition-all",style:{touchAction:"none"}})]})},K))]})}),i.jsx("tbody",{children:r.map(K=>i.jsxs("tr",{className:`${u.has(K.id)?"bg-blue-50":"hover:bg-gray-50"} transition`,children:[i.jsx("td",{className:"border border-gray-300 px-2 py-1 text-center",children:i.jsx("input",{type:"checkbox",checked:u.has(K.id),onChange:()=>M(K.id),className:"rounded"})}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.created_at},children:U(K,"created_at")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.company_name},children:U(K,"company_name")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.contact_person},children:U(K,"contact_person")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.designation},children:U(K,"designation")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.email},children:U(K,"email")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.mobile},children:U(K,"mobile")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.landline},children:U(K,"landline")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.phone},children:U(K,"phone")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.country},children:U(K,"country")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.city},children:U(K,"city")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.address},children:U(K,"address")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.website},children:U(K,"website")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.customer_type},children:U(K,"customer_type")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.notes},children:U(K,"notes")})]},K.id))})]})}),i.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 text-sm text-gray-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{children:[r.length," customer(s)",r.length!==e.length&&` (filtered from ${e.length} total)`,u.size>0&&`  ${u.size} selected`]}),i.jsx("span",{className:"text-xs text-gray-500",children:"Double-click any cell to edit  Drag column borders to resize"})]})}),i.jsx(fr,{isOpen:h,onClose:()=>{d(!1),f(new Set)},title:"Bulk Email",children:i.jsx(V$,{selectedCustomers:X(),onClose:()=>{d(!1),f(new Set)},onComplete:()=>{d(!1),f(new Set),N()}})})]})}function W$({inquiryId:e,customerId:t,leadId:r,onActivityLogged:n}){const{profile:s}=Qr(),{t:a}=Es(),[o,l]=G.useState([]),[c,A]=G.useState(!0),[u,f]=G.useState(!1),[h,d]=G.useState({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1});G.useEffect(()=>{x()},[e,t,r]);const x=async()=>{try{let C=oe.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name)").order("created_at",{ascending:!1});r&&(C=C.eq("lead_id",r)),t&&(C=C.eq("customer_id",t));const{data:k,error:S}=await C;if(S)throw S;l(k||[])}catch(C){console.error("Error loading activities:",C)}finally{A(!1)}},g=async C=>{C.preventDefault();try{const{data:{user:k}}=await oe.auth.getUser();if(!k)throw new Error("Not authenticated");const S={...h,created_by:k.id,follow_up_date:h.follow_up_date||null,completed_at:h.is_completed?new Date().toISOString():null};r&&(S.lead_id=r),t&&(S.customer_id=t);const{error:I}=await oe.from("crm_activities").insert([S]);if(I)throw I;f(!1),d({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1}),x(),n==null||n()}catch(k){console.error("Error logging activity:",k),alert("Failed to log activity. Please try again.")}},y=async C=>{try{const{error:k}=await oe.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",C);if(k)throw k;x()}catch(k){console.error("Error completing activity:",k),alert("Failed to complete activity. Please try again.")}},m=async C=>{if(confirm("Are you sure you want to delete this activity? This action cannot be undone."))try{const{error:k}=await oe.from("crm_activities").delete().eq("id",C);if(k)throw k;x(),n==null||n()}catch(k){console.error("Error deleting activity:",k),alert("Failed to delete activity. Please try again.")}},p=C=>{switch(C){case"phone_call":return i.jsx(IA,{className:"w-5 h-5"});case"meeting":return i.jsx(ha,{className:"w-5 h-5"});case"email":return i.jsx(lh,{className:"w-5 h-5"});case"note":return i.jsx(Nr,{className:"w-5 h-5"});case"video_call":return i.jsx(eF,{className:"w-5 h-5"});case"whatsapp":return i.jsx(mO,{className:"w-5 h-5"});default:return i.jsx(Nr,{className:"w-5 h-5"})}},b=C=>{switch(C){case"phone_call":return"bg-blue-50 text-blue-600 border-blue-200";case"meeting":return"bg-purple-50 text-purple-600 border-purple-200";case"email":return"bg-green-50 text-green-600 border-green-200";case"note":return"bg-gray-50 text-gray-600 border-gray-200";case"video_call":return"bg-indigo-50 text-indigo-600 border-indigo-200";case"whatsapp":return"bg-emerald-50 text-emerald-600 border-emerald-200";default:return"bg-gray-50 text-gray-600 border-gray-200"}},v=C=>({phone_call:"Phone Call",meeting:"Meeting",email:"Email",note:"Note",video_call:"Video Call",whatsapp:"WhatsApp"})[C]||C;return c?i.jsx("div",{className:"flex justify-center py-8",children:"Loading activities..."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Log"}),i.jsxs("button",{onClick:()=>f(!u),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-4 h-4"}),"Log Activity"]})]}),u&&i.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:i.jsxs("form",{onSubmit:g,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activity Type *"}),i.jsxs("select",{value:h.activity_type,onChange:C=>d({...h,activity_type:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"phone_call",children:"Phone Call"}),i.jsx("option",{value:"meeting",children:"Meeting"}),i.jsx("option",{value:"email",children:"Email"}),i.jsx("option",{value:"note",children:"Note"}),i.jsx("option",{value:"video_call",children:"Video Call"}),i.jsx("option",{value:"whatsapp",children:"WhatsApp (Coming Soon)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:h.subject,onChange:C=>d({...h,subject:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Brief description",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:h.description,onChange:C=>d({...h,description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Detailed notes about the conversation or activity"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date"}),i.jsx("input",{type:"datetime-local",value:h.follow_up_date,onChange:C=>d({...h,follow_up_date:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex items-center",children:i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:h.is_completed,onChange:C=>d({...h,is_completed:C.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm text-gray-700",children:"Mark as completed"})]})})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Log Activity"})]})]})}),i.jsx("div",{className:"space-y-3",children:o.length===0?i.jsx("div",{className:"text-center py-8 text-gray-500",children:"No activities logged yet. Start by logging your first activity!"}):o.map(C=>i.jsx("div",{className:`border rounded-lg p-4 ${C.is_completed?"bg-gray-50 border-gray-200":"bg-white border-gray-300"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg border ${b(C.activity_type)}`,children:p(C.activity_type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:C.subject}),C.is_completed&&i.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded",children:[i.jsx(pa,{className:"w-3 h-3"}),"Completed"]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[v(C.activity_type),"  ",new Date(C.created_at).toLocaleString()]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[!C.is_completed&&C.follow_up_date&&i.jsx("button",{onClick:()=>y(C.id),className:"text-sm px-3 py-1 text-green-600 hover:bg-green-50 rounded-lg transition",children:"Mark Complete"}),i.jsx("button",{onClick:()=>m(C.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",title:"Delete activity",children:i.jsx(ks,{className:"w-4 h-4"})})]})]}),C.description&&i.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:C.description}),C.follow_up_date&&!C.is_completed&&i.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-orange-600",children:[i.jsx(Ws,{className:"w-4 h-4"}),"Follow-up: ",new Date(C.follow_up_date).toLocaleString()]}),C.user_profiles&&i.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["by ",C.user_profiles.full_name]})]})]})},C.id))})]})}function $$({customerId:e,leadId:t,onAppointmentCreated:r}){const{profile:n}=Qr(),[s,a]=G.useState([]),[o,l]=G.useState([]),[c,A]=G.useState(!0),[u,f]=G.useState(!1),[h,d]=G.useState(null),[x,g]=G.useState({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||""});G.useEffect(()=>{m(),!e&&!t&&y()},[e,t]);const y=async()=>{try{const{data:N,error:Q}=await oe.from("crm_contacts").select("id, company_name").order("company_name",{ascending:!0});if(Q)throw Q;l(N||[])}catch(N){console.error("Error loading contacts:",N)}},m=async()=>{try{let N=oe.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name), crm_contacts(company_name)").in("activity_type",["meeting","video_call","phone_call"]).not("follow_up_date","is",null).order("follow_up_date",{ascending:!0});e?N=N.eq("customer_id",e):t&&(N=N.eq("lead_id",t));const{data:Q,error:L}=await N;if(L)throw L;a(Q||[])}catch(N){console.error("Error loading appointments:",N)}finally{A(!1)}},p=async N=>{N.preventDefault();try{const{data:{user:Q}}=await oe.auth.getUser();if(!Q)throw new Error("Not authenticated");const L={activity_type:x.activity_type,subject:x.subject,description:x.description||null,follow_up_date:x.follow_up_date,is_completed:!1,created_by:Q.id};if(e?L.customer_id=e:t?L.lead_id=t:x.customer_id&&(L.customer_id=x.customer_id),h){const{error:T}=await oe.from("crm_activities").update(L).eq("id",h.id);if(T)throw T}else{const{error:T}=await oe.from("crm_activities").insert([L]);if(T)throw T}f(!1),d(null),g({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:""}),m(),r==null||r()}catch(Q){console.error("Error saving appointment:",Q),alert("Failed to save appointment. Please try again.")}},b=N=>{d(N),g({activity_type:N.activity_type,subject:N.subject,description:N.description||"",follow_up_date:N.follow_up_date,location:"",customer_id:N.customer_id||e||""}),f(!0)},v=async N=>{if(confirm("Are you sure you want to delete this appointment?"))try{const{error:Q}=await oe.from("crm_activities").delete().eq("id",N);if(Q)throw Q;m()}catch(Q){console.error("Error deleting appointment:",Q),alert("Failed to delete appointment. Please try again.")}},C=async N=>{try{const{error:Q}=await oe.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",N);if(Q)throw Q;m()}catch(Q){console.error("Error completing appointment:",Q),alert("Failed to complete appointment. Please try again.")}},k=N=>{switch(N){case"meeting":return i.jsx(ha,{className:"w-5 h-5"});case"video_call":return i.jsx(eF,{className:"w-5 h-5"});case"phone_call":return i.jsx(IA,{className:"w-5 h-5"});default:return i.jsx(ha,{className:"w-5 h-5"})}},S=N=>{if(N.is_completed)return"bg-gray-50 border-gray-200 text-gray-600";const Q=new Date,L=new Date(N.follow_up_date);return L<Q?"bg-red-50 border-red-200 text-red-700":L<new Date(Q.getTime()+24*60*60*1e3)?"bg-orange-50 border-orange-200 text-orange-700":"bg-blue-50 border-blue-200 text-blue-700"},I=N=>({meeting:"In-Person Meeting",video_call:"Video Call",phone_call:"Phone Call"})[N]||N;return c?i.jsx("div",{className:"flex justify-center py-8",children:"Loading appointments..."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Appointments & Meetings"}),i.jsxs("button",{onClick:()=>{d(null),g({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||""}),f(!u)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-4 h-4"}),"Schedule Appointment"]})]}),u&&i.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:i.jsxs("form",{onSubmit:p,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[!e&&!t&&i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),i.jsxs("select",{value:x.customer_id,onChange:N=>g({...x,customer_id:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select a customer..."}),o.map(N=>i.jsx("option",{value:N.id,children:N.company_name},N.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Type *"}),i.jsxs("select",{value:x.activity_type,onChange:N=>g({...x,activity_type:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"meeting",children:"In-Person Meeting"}),i.jsx("option",{value:"video_call",children:"Video Call"}),i.jsx("option",{value:"phone_call",children:"Phone Call"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date & Time *"}),i.jsx("input",{type:"datetime-local",value:x.follow_up_date,onChange:N=>g({...x,follow_up_date:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:x.subject,onChange:N=>g({...x,subject:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Product demonstration, Price negotiation",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description / Agenda"}),i.jsx("textarea",{value:x.description,onChange:N=>g({...x,description:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Meeting agenda, discussion points, etc."})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{f(!1),d(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:h?"Update Appointment":"Schedule Appointment"})]})]})}),i.jsx("div",{className:"space-y-3",children:s.length===0?i.jsx("div",{className:"text-center py-8 text-gray-500",children:"No appointments scheduled. Create your first appointment!"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Upcoming Appointments"}),s.filter(N=>!N.is_completed&&new Date(N.follow_up_date)>=new Date).map(N=>i.jsx("div",{className:`border rounded-lg p-4 ${S(N)}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:k(N.activity_type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:N.subject}),N.crm_contacts&&i.jsx("p",{className:"text-sm font-medium text-blue-600 mt-1",children:N.crm_contacts.company_name}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:I(N.activity_type)}),i.jsxs("p",{className:"text-sm font-medium mt-1 flex items-center gap-1",children:[i.jsx(Ws,{className:"w-4 h-4"}),new Date(N.follow_up_date).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>b(N),className:"p-1 hover:bg-white rounded transition",title:"Edit",children:i.jsx(fg,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>v(N.id),className:"p-1 hover:bg-white rounded transition",title:"Delete",children:i.jsx(ks,{className:"w-4 h-4"})})]})]}),N.description&&i.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:N.description}),i.jsx("div",{className:"mt-3 flex gap-2",children:i.jsx("button",{onClick:()=>C(N.id),className:"text-xs px-3 py-1 bg-white border border-current rounded hover:bg-gray-50 transition",children:"Mark as Completed"})})]})]})},N.id))]}),s.filter(N=>N.is_completed||new Date(N.follow_up_date)<new Date).length>0&&i.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Past Appointments"}),s.filter(N=>N.is_completed||new Date(N.follow_up_date)<new Date).map(N=>i.jsx("div",{className:"border rounded-lg p-4 bg-gray-50 border-gray-200",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 text-gray-400",children:k(N.activity_type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-medium text-gray-700",children:N.subject}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[I(N.activity_type),"  ",new Date(N.follow_up_date).toLocaleDateString()]})]})]})},N.id))]})]})})]})}function z$({canManage:e,onRefresh:t}){const{profile:r}=Qr(),[n,s]=G.useState([]),[a,o]=G.useState([]),[l,c]=G.useState(!0),[A,u]=G.useState(""),[f,h]=G.useState(null),[d,x]=G.useState(!1);G.useEffect(()=>{g()},[]),G.useEffect(()=>{if(A){const p=n.filter(b=>b.inquiry_number.toLowerCase().includes(A.toLowerCase())||b.company_name.toLowerCase().includes(A.toLowerCase())||b.product_name.toLowerCase().includes(A.toLowerCase())||b.lost_reason&&b.lost_reason.toLowerCase().includes(A.toLowerCase()));o(p)}else o(n)},[A,n]);const g=async()=>{try{const{data:p,error:b}=await oe.from("crm_inquiries").select("*").eq("pipeline_status","lost").order("lost_at",{ascending:!1});if(b)throw b;s(p||[]),o(p||[])}catch(p){console.error("Error loading archived inquiries:",p)}finally{c(!1)}},y=async p=>{if(confirm(`Reopen inquiry #${p.inquiry_number} and move it back to active deals?`))try{const{error:b}=await oe.from("crm_inquiries").update({pipeline_status:"in_progress",lost_reason:null,lost_at:null,competitor_name:null,competitor_price:null}).eq("id",p.id);if(b)throw b;alert("Inquiry reopened and moved to active deals!"),g(),t()}catch(b){console.error("Error reopening inquiry:",b),alert("Failed to reopen inquiry. Please try again.")}},m=()=>{try{const p=a.map(k=>({"Inquiry No.":k.inquiry_number,Date:new Date(k.inquiry_date).toLocaleDateString("en-GB"),Company:k.company_name,Product:k.product_name,Qty:k.quantity,"Offered Price":k.offered_price?`${k.offered_price} ${k.offered_price_currency}`:"-",Supplier:k.supplier_name||"-","Lost Reason":k.lost_reason||"-",Competitor:k.competitor_name||"-","Competitor Price":k.competitor_price?`$${k.competitor_price}`:"-","Lost Date":k.lost_at?new Date(k.lost_at).toLocaleDateString("en-GB"):"-",Remarks:k.remarks||"-"})),b=gi.json_to_sheet(p);b["!cols"]=[{wch:12},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:20},{wch:40},{wch:20},{wch:15},{wch:12},{wch:30}];const v=gi.book_new();gi.book_append_sheet(v,b,"Lost Deals Archive");const C=`Archive-Lost-Deals-${new Date().toISOString().split("T")[0]}.xlsx`;yw(v,C),alert(`Exported ${p.length} archived inquiries to ${C}`)}catch(p){console.error("Export error:",p),alert("Failed to export data. Please try again.")}};return l?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(zs,{className:"w-6 h-6 text-red-600"}),"Lost Deals Archive"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View history of lost inquiries and analyze reasons for improvement"})]}),i.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[i.jsx(TA,{className:"w-4 h-4"}),"Export to Excel"]})]}),i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(Lc,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),i.jsx("input",{type:"text",value:A,onChange:p=>u(p.target.value),placeholder:"Search by inquiry no, company, product, or lost reason...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:a.length})," archived inquiries"]})]})}),a.length===0?i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[i.jsx(zs,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-500",children:A?"No archived inquiries match your search.":"No archived inquiries yet."})]}):i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"No."}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),(r==null?void 0:r.role)==="admin"&&i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Offered"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map(p=>i.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[i.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:p.inquiry_number}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(p.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.company_name}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.product_name}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:p.quantity}),(r==null?void 0:r.role)==="admin"&&i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.offered_price?`$${p.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:p.supplier_name||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsxs("div",{className:"max-w-xs",children:[i.jsx("p",{className:"text-gray-900 line-clamp-2",children:p.lost_reason||"-"}),p.competitor_name&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Competitor: ",p.competitor_name,p.competitor_price&&` ($${p.competitor_price})`]})]})}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:p.lost_at?new Date(p.lost_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{h(p),x(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",title:"View Details",children:i.jsx(oh,{className:"w-4 h-4"})}),e&&i.jsx("button",{onClick:()=>y(p),className:"p-1 text-green-600 hover:bg-green-50 rounded transition",title:"Reopen Deal",children:i.jsx(UB,{className:"w-4 h-4"})})]})})]},p.id))})]})})}),f&&i.jsx(fr,{isOpen:d,onClose:()=>{x(!1),h(null)},title:`Inquiry #${f.inquiry_number} - Details`,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2 pb-4 border-b",children:[i.jsx(R$,{status:"lost"}),i.jsxs("span",{className:"text-sm text-gray-500",children:["Lost on ",f.lost_at?new Date(f.lost_at).toLocaleDateString("en-GB"):"N/A"]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Company"}),i.jsx("p",{className:"text-sm text-gray-900",children:f.company_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Product"}),i.jsx("p",{className:"text-sm text-gray-900",children:f.product_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Quantity"}),i.jsx("p",{className:"text-sm text-gray-900",children:f.quantity})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Supplier"}),i.jsx("p",{className:"text-sm text-gray-900",children:f.supplier_name||"-"})]}),(r==null?void 0:r.role)==="admin"&&f.offered_price&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Offered Price"}),i.jsxs("p",{className:"text-sm text-gray-900",children:["$",f.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})," ",f.offered_price_currency]})]})]}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Fa,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-medium text-red-900 mb-1",children:"Lost Reason"}),i.jsx("p",{className:"text-sm text-red-800",children:f.lost_reason||"No reason provided"}),f.competitor_name&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-red-200",children:[i.jsx("p",{className:"text-xs font-medium text-red-900 mb-1",children:"Competitor Information"}),i.jsxs("p",{className:"text-sm text-red-800",children:[f.competitor_name,f.competitor_price&&` - $${f.competitor_price.toLocaleString("en-US",{minimumFractionDigits:2})}`]})]})]})]})}),f.remarks&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Remarks"}),i.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 rounded p-3",children:f.remarks})]}),e&&i.jsx("div",{className:"flex justify-end pt-4 border-t",children:i.jsxs("button",{onClick:()=>{y(f),x(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[i.jsx(UB,{className:"w-4 h-4"}),"Reopen This Deal"]})})]})})]})}function f6({onSubmit:e,onCancel:t,initialData:r,isEditing:n=!1}){const[s,a]=G.useState([]),[o,l]=G.useState([]),[c,A]=G.useState(""),[u,f]=G.useState(!1),[h,d]=G.useState(!1),[x,g]=G.useState(!1),y=G.useRef(null),[m,p]=G.useState({product_name:(r==null?void 0:r.product_name)||"",specification:(r==null?void 0:r.specification)||"",quantity:(r==null?void 0:r.quantity)||"",priority:(r==null?void 0:r.priority)||"medium",inquiry_source:(r==null?void 0:r.inquiry_source)||"email",supplier_name:(r==null?void 0:r.supplier_name)||"",supplier_country:(r==null?void 0:r.supplier_country)||"",customer_id:(r==null?void 0:r.customer_id)||"",company_name:(r==null?void 0:r.company_name)||"",contact_person:(r==null?void 0:r.contact_person)||"",contact_email:(r==null?void 0:r.contact_email)||"",contact_phone:(r==null?void 0:r.contact_phone)||"",price_required:(r==null?void 0:r.price_required)||!1,coa_required:(r==null?void 0:r.coa_required)||!1,sample_required:(r==null?void 0:r.sample_required)||!1,agency_letter_required:(r==null?void 0:r.agency_letter_required)||!1,others_required:(r==null?void 0:r.others_required)||!1,purchase_price:(r==null?void 0:r.purchase_price)||"",purchase_price_currency:(r==null?void 0:r.purchase_price_currency)||"USD",offered_price:(r==null?void 0:r.offered_price)||"",offered_price_currency:(r==null?void 0:r.offered_price_currency)||"USD",delivery_date:(r==null?void 0:r.delivery_date)||"",delivery_terms:(r==null?void 0:r.delivery_terms)||"",aceerp_no:(r==null?void 0:r.aceerp_no)||"",mail_subject:(r==null?void 0:r.mail_subject)||"",pipeline_status:(r==null?void 0:r.pipeline_status)||"new",remarks:(r==null?void 0:r.remarks)||"",internal_notes:(r==null?void 0:r.internal_notes)||""}),[b,v]=G.useState({company_name:"",contact_person:"",email:"",phone:"",mobile:"",landline:"",country:"",address:""});G.useEffect(()=>{C()},[]),G.useEffect(()=>{const N=Q=>{y.current&&!y.current.contains(Q.target)&&f(!1)};return u&&document.addEventListener("mousedown",N),()=>{document.removeEventListener("mousedown",N)}},[u]),G.useEffect(()=>{if(c){const N=s.filter(Q=>Q.company_name.toLowerCase().includes(c.toLowerCase()));l(N)}else l(s)},[c,s]);const C=async()=>{try{const{data:N,error:Q}=await oe.from("crm_contacts").select("id, company_name, contact_person, email, phone, mobile, landline, country").eq("is_active",!0).order("company_name");if(Q)throw Q;a(N||[]),l(N||[])}catch(N){console.error("Error loading customers:",N)}},k=N=>{p({...m,customer_id:N.id,company_name:N.company_name,contact_person:N.contact_person||"",contact_email:N.email||"",contact_phone:N.phone||""}),A(N.company_name),f(!1)},S=async()=>{if(!b.company_name){alert("Customer name is required");return}try{const{data:{user:N}}=await oe.auth.getUser();if(!N)throw new Error("Not authenticated");const{data:Q,error:L}=await oe.from("crm_contacts").insert({...b,is_active:!0,created_by:N.id}).select().single();if(L)throw L;await C(),k(Q),d(!1),v({company_name:"",contact_person:"",email:"",phone:"",mobile:"",landline:"",country:"",address:""})}catch(N){console.error("Error adding customer:",N),alert("Failed to add customer")}},I=async N=>{if(N.preventDefault(),!m.product_name||!m.quantity||!m.company_name){alert("Please fill in all required fields: Product Name, Quantity, and Customer");return}g(!0);try{await e(m)}finally{g(!1)}};return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:I,className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Product Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:m.product_name,onChange:N=>p({...m,product_name:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter product name",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Specification"}),i.jsx("input",{type:"text",value:m.specification,onChange:N=>p({...m,specification:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"BP / USP / EP"})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Quantity ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:m.quantity,onChange:N=>p({...m,quantity:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 500 KG",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Priority ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:m.priority,onChange:N=>p({...m,priority:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Inquiry Source"}),i.jsxs("select",{value:m.inquiry_source,onChange:N=>p({...m,inquiry_source:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"email",children:"Email"}),i.jsx("option",{value:"phone",children:"Phone"}),i.jsx("option",{value:"whatsapp",children:"WhatsApp"}),i.jsx("option",{value:"website",children:"Website"}),i.jsx("option",{value:"referral",children:"Referral"}),i.jsx("option",{value:"other",children:"Other"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Supplier Name"}),i.jsx("input",{type:"text",value:m.supplier_name,onChange:N=>p({...m,supplier_name:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Manufacturer/Supplier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country of Origin"}),i.jsx("input",{type:"text",value:m.supplier_country,onChange:N=>p({...m,supplier_country:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Supplier country"})]}),i.jsxs("div",{ref:y,className:"relative",children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Customer ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:c||m.company_name,onChange:N=>{A(N.target.value),f(!0)},onFocus:()=>f(!0),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 pr-8",placeholder:"Search customer...",required:!0}),i.jsx(Lc,{className:"absolute right-2 top-2 w-4 h-4 text-gray-400"})]}),u&&i.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[o.map(N=>i.jsxs("div",{onClick:()=>k(N),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:N.company_name}),N.contact_person&&i.jsx("div",{className:"text-xs text-gray-500",children:N.contact_person})]},N.id)),o.length===0&&i.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No customers found"})]}),i.jsxs("button",{type:"button",onClick:()=>d(!0),className:"mt-1 text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[i.jsx(Gn,{className:"w-3 h-3"}),"Add New Customer"]})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),i.jsx("input",{type:"text",value:m.contact_person,onChange:N=>p({...m,contact_person:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:m.contact_email,onChange:N=>p({...m,contact_email:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:m.contact_phone,onChange:N=>p({...m,contact_phone:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Mail Subject"}),i.jsx("input",{type:"text",value:m.mail_subject,onChange:N=>p({...m,mail_subject:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject line"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Customer Requested"}),i.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:m.price_required,onChange:N=>p({...m,price_required:N.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Price"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:m.coa_required,onChange:N=>p({...m,coa_required:N.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"COA"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:m.sample_required,onChange:N=>p({...m,sample_required:N.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Sample"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:m.agency_letter_required,onChange:N=>p({...m,agency_letter_required:N.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Agency Letter"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:m.others_required,onChange:N=>p({...m,others_required:N.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Others"})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[i.jsx("h3",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Pricing"}),i.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Purchase Price"}),i.jsx("input",{type:"text",value:m.purchase_price,onChange:N=>p({...m,purchase_price:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"100.00"})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),i.jsxs("select",{value:m.purchase_price_currency,onChange:N=>p({...m,purchase_price_currency:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"USD",children:"USD"}),i.jsx("option",{value:"IDR",children:"IDR"})]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offered Price"}),i.jsx("input",{type:"text",value:m.offered_price,onChange:N=>p({...m,offered_price:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"150.00"})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),i.jsxs("select",{value:m.offered_price_currency,onChange:N=>p({...m,offered_price_currency:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"USD",children:"USD"}),i.jsx("option",{value:"IDR",children:"IDR"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Date"}),i.jsx("input",{type:"date",value:m.delivery_date,onChange:N=>p({...m,delivery_date:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Terms"}),i.jsxs("select",{value:m.delivery_terms,onChange:N=>p({...m,delivery_terms:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select..."}),i.jsx("option",{value:"FOB Jakarta",children:"FOB Jakarta"}),i.jsx("option",{value:"CIF Jakarta",children:"CIF Jakarta"}),i.jsx("option",{value:"FOB Surabaya",children:"FOB Surabaya"}),i.jsx("option",{value:"CIF Surabaya",children:"CIF Surabaya"}),i.jsx("option",{value:"FOB Semarang",children:"FOB Semarang"}),i.jsx("option",{value:"CIF Semarang",children:"CIF Semarang"}),i.jsx("option",{value:"EXW",children:"EXW"}),i.jsx("option",{value:"DDP",children:"DDP"}),i.jsx("option",{value:"DAP",children:"DAP"}),i.jsx("option",{value:"CFR",children:"CFR"}),i.jsx("option",{value:"FCA",children:"FCA"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"ACE ERP No"}),i.jsx("input",{type:"text",value:m.aceerp_no,onChange:N=>p({...m,aceerp_no:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pipeline Status"}),i.jsxs("select",{value:m.pipeline_status,onChange:N=>p({...m,pipeline_status:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"new",children:"New"}),i.jsx("option",{value:"contacted",children:"Contacted"}),i.jsx("option",{value:"qualified",children:"Qualified"}),i.jsx("option",{value:"proposal",children:"Proposal"}),i.jsx("option",{value:"negotiation",children:"Negotiation"}),i.jsx("option",{value:"won",children:"Won"}),i.jsx("option",{value:"lost",children:"Lost"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Remarks"}),i.jsx("textarea",{value:m.remarks,onChange:N=>p({...m,remarks:N.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Customer notes, special requirements..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Internal Notes"}),i.jsx("textarea",{value:m.internal_notes,onChange:N=>p({...m,internal_notes:N.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Private notes (not visible to customer)..."})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 sticky bottom-0 bg-white",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:x,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",disabled:x,children:x?"Saving...":n?"Update Inquiry":"Add Inquiry"})]})]}),h&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Add New Customer"}),i.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(Xs,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Company Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:b.company_name,onChange:N=>v({...b,company_name:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Company name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),i.jsx("input",{type:"text",value:b.contact_person,onChange:N=>v({...b,contact_person:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Contact name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:b.email,onChange:N=>v({...b,email:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com"})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Mobile"}),i.jsx("input",{type:"tel",value:b.mobile,onChange:N=>v({...b,mobile:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Landline"}),i.jsx("input",{type:"tel",value:b.landline,onChange:N=>v({...b,landline:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"021-xxx"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:b.phone,onChange:N=>v({...b,phone:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:b.country,onChange:N=>v({...b,country:N.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Indonesia"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Address"}),i.jsx("textarea",{value:b.address,onChange:N=>v({...b,address:N.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Full address"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[i.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:S,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Customer"})]})]})})]})}function X$(){const{profile:e}=Qr(),[t,r]=G.useState([]),[n,s]=G.useState(!0),[a,o]=G.useState("table"),[l,c]=G.useState(!1),[A,u]=G.useState(null),[f,h]=G.useState(!1),[d,x]=G.useState(null);G.useEffect(()=>{g()},[]);const g=async()=>{try{const{data:b,error:v}=await oe.from("crm_inquiries").select("*, user_profiles!crm_inquiries_assigned_to_fkey(full_name)").neq("pipeline_status","lost").order("created_at",{ascending:!1});if(v)throw v;r(b||[])}catch(b){console.error("Error loading inquiries:",b)}finally{s(!1)}},y=async b=>{try{const{data:{user:v}}=await oe.auth.getUser();if(!v)throw new Error("Not authenticated");if(A){const C={...b,specification:b.specification||null,purchase_price:b.purchase_price?parseFloat(b.purchase_price):null,offered_price:b.offered_price?parseFloat(b.offered_price):null},{error:k}=await oe.from("crm_inquiries").update(C).eq("id",A.id);if(k)throw k}else{const C={...b,specification:b.specification||null,inquiry_date:new Date().toISOString().split("T")[0],assigned_to:v.id,created_by:v.id,purchase_price:b.purchase_price?parseFloat(b.purchase_price):null,offered_price:b.offered_price?parseFloat(b.offered_price):null},{error:k}=await oe.from("crm_inquiries").insert([C]);if(k)throw k}c(!1),u(null),g()}catch(v){throw console.error("Error saving inquiry:",v),alert("Failed to save inquiry. Please try again."),v}},m=b=>{u(b),c(!0)},p=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="sales";return i.jsx(as,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex items-center",children:i.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"CRM - Inquiry Management"})}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("div",{className:"flex overflow-x-auto",children:[i.jsxs("button",{onClick:()=>o("email"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="email"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(WE,{className:"w-5 h-5"}),"Email Inbox"]}),i.jsxs("button",{onClick:()=>o("table"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="table"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(wO,{className:"w-5 h-5"}),"Table View"]}),i.jsxs("button",{onClick:()=>o("pipeline"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="pipeline"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(hO,{className:"w-5 h-5"}),"Pipeline"]}),i.jsxs("button",{onClick:()=>o("calendar"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="calendar"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(ha,{className:"w-5 h-5"}),"Calendar"]}),i.jsxs("button",{onClick:()=>o("customers"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="customers"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(lb,{className:"w-5 h-5"}),"Customers"]}),i.jsxs("button",{onClick:()=>o("activities"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="activities"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(eO,{className:"w-5 h-5"}),"Activities"]}),i.jsxs("button",{onClick:()=>o("appointments"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="appointments"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(Ws,{className:"w-5 h-5"}),"Appointments"]}),i.jsxs("button",{onClick:()=>o("archive"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${a==="archive"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(QE,{className:"w-5 h-5"}),"Archive"]})]})}),i.jsxs("div",{className:"p-6",children:[a==="email"&&i.jsx(LO,{}),a==="table"&&i.jsx(M$,{inquiries:t,onRefresh:g,canManage:p,onAddInquiry:()=>{u(null),c(!0)}}),a==="pipeline"&&i.jsx(K$,{canManage:p,onInquiryClick:b=>m(b)}),a==="calendar"&&i.jsx(H$,{onReminderCreated:g}),a==="customers"&&i.jsx(G$,{}),a==="activities"&&i.jsx(W$,{onActivityLogged:g}),a==="appointments"&&i.jsx($$,{onAppointmentCreated:g}),a==="archive"&&i.jsx(z$,{canManage:p,onRefresh:g})]})]}),i.jsx(fr,{isOpen:l,onClose:()=>{c(!1),u(null)},title:A?"Edit Inquiry":"Add New Inquiry",children:i.jsx(f6,{onSubmit:y,onCancel:()=>{c(!1),u(null)},initialData:A,isEditing:!!A})}),i.jsx(fr,{isOpen:f,onClose:()=>{h(!1),x(null)},title:"Send Email",children:i.jsx(q$,{inquiry:d,onClose:()=>{h(!1),x(null)},onSent:()=>{g()}})})]})})}function Y$({onEmailSelect:e,selectedEmailId:t}){const[r,n]=G.useState([]),[s,a]=G.useState(!0),[o,l]=G.useState(!1),[c,A]=G.useState(null),u=G.useCallback(async()=>{try{const{data:y,error:m}=await oe.from("crm_email_inbox").select("*").eq("is_processed",!1).order("received_date",{ascending:!1}).limit(50);if(m)throw m;n(y||[])}catch(y){console.error("Error loading emails:",y)}finally{a(!1),l(!1)}},[]),f=G.useCallback(async()=>{l(!0);try{const{data:{session:y}}=await oe.auth.getSession();if(!y){console.error("Not authenticated"),l(!1);return}const m="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",p=new AbortController,b=setTimeout(()=>p.abort(),12e4),v=await fetch(m,{method:"POST",headers:{Authorization:`Bearer ${y.access_token}`,"Content-Type":"application/json"},signal:p.signal});if(clearTimeout(b),!v.ok)throw new Error(`Sync failed: ${v.status}`);await v.json(),await u()}catch(y){console.error("Error syncing emails:",y),await u()}finally{l(!1)}},[u]);G.useEffect(()=>{u();const y=oe.channel("email_inbox_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_email_inbox"},()=>{u()}).subscribe(),m=setInterval(()=>{f()},6e5);return()=>{y.unsubscribe(),clearInterval(m)}},[u,f]);const h=async y=>{A(y.id);try{const{data:{session:m}}=await oe.auth.getSession();if(!m)throw new Error("Not authenticated");const v=await(await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-pharma-email",{method:"POST",headers:{Authorization:`Bearer ${m.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({emailSubject:y.subject,emailBody:y.body,fromEmail:y.from_email,fromName:y.from_name})})).json();v.success?e(y,v.data):v.fallbackData?e(y,v.fallbackData):(alert("Failed to parse email: "+v.error),e(y,null))}catch(m){console.error("Error parsing email:",m),alert("Failed to parse email. Please try again.")}finally{A(null)}},d=y=>{var C,k;const m=((C=y.body)==null?void 0:C.toLowerCase())||"",p=((k=y.subject)==null?void 0:k.toLowerCase())||"",b=m+" "+p,v=[];return(b.includes("price")||b.includes("harga")||b.includes("quotation")||b.includes("quote"))&&v.push({icon:To,color:"text-green-600",label:"Price"}),(b.includes("coa")||b.includes("certificate")||b.includes("analysis"))&&v.push({icon:Nr,color:"text-blue-600",label:"COA"}),(b.includes("msds")||b.includes("safety")||b.includes("data sheet"))&&v.push({icon:Nr,color:"text-orange-600",label:"MSDS"}),(b.includes("sample")||b.includes("sampel"))&&v.push({icon:YE,color:"text-purple-600",label:"Sample"}),v},x=y=>{const p=(y.body||"").split(`
`).filter(k=>k.trim().length>0);let b="",v="",C="";for(const k of p.slice(0,20)){const S=k.toLowerCase();if(!b&&(S.includes("product")||S.includes("material")||S.includes("item"))&&(b=k.replace(/^[^:]+:/,"").trim().substring(0,50)),!v&&(S.includes("qty")||S.includes("quantity")||S.includes("kg")||S.includes("mt"))){const I=k.match(/\d+\s*(kg|mt|ton|units?|pcs)/i);I&&(v=I[0])}!C&&(S.includes("supplier")||S.includes("manufacturer")||S.includes("origin"))&&(C=k.replace(/^[^:]+:/,"").trim().substring(0,30))}return{product:b,quantity:v,supplier:C}},g=y=>{const m=(y.subject+" "+y.body).toLowerCase();return m.includes("urgent")||m.includes("asap")||m.includes("segera")||m.includes("mendesak")};return s?i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading emails..."})]})}):i.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx($s,{className:"w-5 h-5 text-blue-600"}),i.jsx("h2",{className:"font-semibold text-gray-900",children:"New Emails"}),i.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:r.length})]}),i.jsx("button",{onClick:f,disabled:o,className:"p-1.5 hover:bg-gray-200 rounded-lg transition",title:"Refresh emails",children:i.jsx(td,{className:`w-4 h-4 text-gray-600 ${o?"animate-spin":""}`})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[i.jsx($s,{className:"w-16 h-16 text-gray-300 mb-4"}),i.jsx("p",{className:"text-gray-600 font-medium",children:"No unprocessed emails"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"New emails will appear here automatically"})]}):i.jsx("div",{className:"divide-y divide-gray-100",children:r.map(y=>{const m=x(y),p=d(y),b=g(y),v=t===y.id,C=c===y.id;return i.jsxs("div",{onClick:()=>!C&&h(y),className:`p-4 cursor-pointer transition ${v?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50 border-l-4 border-transparent"} ${C?"opacity-50 cursor-wait":""}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"font-semibold text-gray-900 truncate",children:y.from_name||y.from_email}),b&&i.jsx("span",{className:"flex-shrink-0 px-1.5 py-0.5 text-xs font-bold bg-red-100 text-red-700 rounded",children:"URGENT"})]}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:y.from_email})]}),C&&i.jsx(rd,{className:"w-5 h-5 text-blue-600 animate-pulse flex-shrink-0 ml-2"})]}),i.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2 line-clamp-1",children:y.subject}),(m.product||m.quantity)&&i.jsxs("div",{className:"space-y-1 mb-2",children:[m.product&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(ri,{className:"w-3.5 h-3.5 text-gray-400 mt-0.5 flex-shrink-0"}),i.jsx("span",{className:"text-xs text-gray-600 line-clamp-1",children:m.product})]}),m.quantity&&i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("span",{className:"text-xs font-medium text-blue-600",children:m.quantity})})]}),p.length>0&&i.jsx("div",{className:"flex items-center gap-2 mb-2",children:p.map((k,S)=>i.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-gray-100 rounded",title:k.label,children:[i.jsx(k.icon,{className:`w-3 h-3 ${k.color}`}),i.jsx("span",{className:"text-xs text-gray-600",children:k.label})]},S))}),i.jsxs("div",{className:"flex items-center justify-between mt-2",children:[i.jsx("span",{className:"text-xs text-gray-500",children:new Date(y.received_date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),!C&&i.jsxs("span",{className:"text-xs text-blue-600 font-medium flex items-center gap-1",children:[i.jsx(rd,{className:"w-3 h-3"}),"AI Parse"]})]})]},y.id)})})})]})}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:h6,setPrototypeOf:$4,isFrozen:J$,getPrototypeOf:Z$,getOwnPropertyDescriptor:ez}=Object;let{freeze:ma,seal:ji,create:ww}=Object,{apply:bw,construct:_w}=typeof Reflect<"u"&&Reflect;ma||(ma=function(t){return t});ji||(ji=function(t){return t});bw||(bw=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return t.apply(r,s)});_w||(_w=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return new t(...n)});const Up=ga(Array.prototype.forEach),tz=ga(Array.prototype.lastIndexOf),z4=ga(Array.prototype.pop),m0=ga(Array.prototype.push),rz=ga(Array.prototype.splice),Sm=ga(String.prototype.toLowerCase),nv=ga(String.prototype.toString),sv=ga(String.prototype.match),g0=ga(String.prototype.replace),nz=ga(String.prototype.indexOf),sz=ga(String.prototype.trim),qi=ga(Object.prototype.hasOwnProperty),ia=ga(RegExp.prototype.test),x0=az(TypeError);function ga(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return bw(e,t,n)}}function az(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _w(e,r)}}function hr(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sm;$4&&$4(e,null);let n=t.length;for(;n--;){let s=t[n];if(typeof s=="string"){const a=r(s);a!==s&&(J$(t)||(t[n]=a),s=a)}e[s]=!0}return e}function iz(e){for(let t=0;t<e.length;t++)qi(e,t)||(e[t]=null);return e}function sl(e){const t=ww(null);for(const[r,n]of h6(e))qi(e,r)&&(Array.isArray(n)?t[r]=iz(n):n&&typeof n=="object"&&n.constructor===Object?t[r]=sl(n):t[r]=n);return t}function v0(e,t){for(;e!==null;){const n=ez(e,t);if(n){if(n.get)return ga(n.get);if(typeof n.value=="function")return ga(n.value)}e=Z$(e)}function r(){return null}return r}const X4=ma(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),av=ma(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),iv=ma(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),oz=ma(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ov=ma(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),lz=ma(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Y4=ma(["#text"]),J4=ma(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),lv=ma(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Z4=ma(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Lp=ma(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),cz=ji(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Az=ji(/<%[\w\W]*|[\w\W]*%>/gm),uz=ji(/\$\{[\w\W]*/gm),dz=ji(/^data-[\-\w.\u00B7-\uFFFF]+$/),fz=ji(/^aria-[\-\w]+$/),p6=ji(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),hz=ji(/^(?:\w+script|data):/i),pz=ji(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),m6=ji(/^html$/i),mz=ji(/^[a-z][.\w]*(-[.\w]+)+$/i);var eC=Object.freeze({__proto__:null,ARIA_ATTR:fz,ATTR_WHITESPACE:pz,CUSTOM_ELEMENT:mz,DATA_ATTR:dz,DOCTYPE_NAME:m6,ERB_EXPR:Az,IS_ALLOWED_URI:p6,IS_SCRIPT_OR_DATA:hz,MUSTACHE_EXPR:cz,TMPLIT_EXPR:uz});const y0={element:1,text:3,progressingInstruction:7,comment:8,document:9},gz=function(){return typeof window>"u"?null:window},xz=function(t,r){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";r&&r.hasAttribute(s)&&(n=r.getAttribute(s));const a="dompurify"+(n?"#"+n:"");try{return t.createPolicy(a,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},tC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function g6(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gz();const t=be=>g6(be);if(t.version="3.3.0",t.removed=[],!e||!e.document||e.document.nodeType!==y0.document||!e.Element)return t.isSupported=!1,t;let{document:r}=e;const n=r,s=n.currentScript,{DocumentFragment:a,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:A,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:f,DOMParser:h,trustedTypes:d}=e,x=c.prototype,g=v0(x,"cloneNode"),y=v0(x,"remove"),m=v0(x,"nextSibling"),p=v0(x,"childNodes"),b=v0(x,"parentNode");if(typeof o=="function"){const be=r.createElement("template");be.content&&be.content.ownerDocument&&(r=be.content.ownerDocument)}let v,C="";const{implementation:k,createNodeIterator:S,createDocumentFragment:I,getElementsByTagName:N}=r,{importNode:Q}=n;let L=tC();t.isSupported=typeof h6=="function"&&typeof b=="function"&&k&&k.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:T,ERB_EXPR:P,TMPLIT_EXPR:R,DATA_ATTR:z,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:M,ATTR_WHITESPACE:V,CUSTOM_ELEMENT:H}=eC;let{IS_ALLOWED_URI:se}=eC,ce=null;const B=hr({},[...X4,...av,...iv,...ov,...Y4]);let U=null;const F=hr({},[...J4,...lv,...Z4,...Lp]);let D=Object.seal(ww(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),X=null,K=null;const ae=Object.seal(ww(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let he=!0,Y=!0,Be=!1,ee=!0,Te=!1,Je=!0,ie=!1,$e=!1,ze=!1,Fe=!1,Re=!1,at=!1,we=!0,ve=!1;const Le="user-content-";let tt=!0,lt=!1,it={},Ne=null;const ke=hr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let qe=null;const Me=hr({},["audio","video","img","source","image","track"]);let Ve=null;const Et=hr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),xt="http://www.w3.org/1998/Math/MathML",st="http://www.w3.org/2000/svg",pt="http://www.w3.org/1999/xhtml";let It=pt,ut=!1,kt=null;const yt=hr({},[xt,st,pt],nv);let Ct=hr({},["mi","mo","mn","ms","mtext"]),er=hr({},["annotation-xml"]);const Wt=hr({},["title","style","font","a","script"]);let St=null;const Ar=["application/xhtml+xml","text/html"],Fs="text/html";let sr=null,an=null;const Wn=r.createElement("form"),Pt=function(fe){return fe instanceof RegExp||fe instanceof Function},Ln=function(){let fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(an&&an===fe)){if((!fe||typeof fe!="object")&&(fe={}),fe=sl(fe),St=Ar.indexOf(fe.PARSER_MEDIA_TYPE)===-1?Fs:fe.PARSER_MEDIA_TYPE,sr=St==="application/xhtml+xml"?nv:Sm,ce=qi(fe,"ALLOWED_TAGS")?hr({},fe.ALLOWED_TAGS,sr):B,U=qi(fe,"ALLOWED_ATTR")?hr({},fe.ALLOWED_ATTR,sr):F,kt=qi(fe,"ALLOWED_NAMESPACES")?hr({},fe.ALLOWED_NAMESPACES,nv):yt,Ve=qi(fe,"ADD_URI_SAFE_ATTR")?hr(sl(Et),fe.ADD_URI_SAFE_ATTR,sr):Et,qe=qi(fe,"ADD_DATA_URI_TAGS")?hr(sl(Me),fe.ADD_DATA_URI_TAGS,sr):Me,Ne=qi(fe,"FORBID_CONTENTS")?hr({},fe.FORBID_CONTENTS,sr):ke,X=qi(fe,"FORBID_TAGS")?hr({},fe.FORBID_TAGS,sr):sl({}),K=qi(fe,"FORBID_ATTR")?hr({},fe.FORBID_ATTR,sr):sl({}),it=qi(fe,"USE_PROFILES")?fe.USE_PROFILES:!1,he=fe.ALLOW_ARIA_ATTR!==!1,Y=fe.ALLOW_DATA_ATTR!==!1,Be=fe.ALLOW_UNKNOWN_PROTOCOLS||!1,ee=fe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=fe.SAFE_FOR_TEMPLATES||!1,Je=fe.SAFE_FOR_XML!==!1,ie=fe.WHOLE_DOCUMENT||!1,Fe=fe.RETURN_DOM||!1,Re=fe.RETURN_DOM_FRAGMENT||!1,at=fe.RETURN_TRUSTED_TYPE||!1,ze=fe.FORCE_BODY||!1,we=fe.SANITIZE_DOM!==!1,ve=fe.SANITIZE_NAMED_PROPS||!1,tt=fe.KEEP_CONTENT!==!1,lt=fe.IN_PLACE||!1,se=fe.ALLOWED_URI_REGEXP||p6,It=fe.NAMESPACE||pt,Ct=fe.MATHML_TEXT_INTEGRATION_POINTS||Ct,er=fe.HTML_INTEGRATION_POINTS||er,D=fe.CUSTOM_ELEMENT_HANDLING||{},fe.CUSTOM_ELEMENT_HANDLING&&Pt(fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(D.tagNameCheck=fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&Pt(fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(D.attributeNameCheck=fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&typeof fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(D.allowCustomizedBuiltInElements=fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(Y=!1),Re&&(Fe=!0),it&&(ce=hr({},Y4),U=[],it.html===!0&&(hr(ce,X4),hr(U,J4)),it.svg===!0&&(hr(ce,av),hr(U,lv),hr(U,Lp)),it.svgFilters===!0&&(hr(ce,iv),hr(U,lv),hr(U,Lp)),it.mathMl===!0&&(hr(ce,ov),hr(U,Z4),hr(U,Lp))),fe.ADD_TAGS&&(typeof fe.ADD_TAGS=="function"?ae.tagCheck=fe.ADD_TAGS:(ce===B&&(ce=sl(ce)),hr(ce,fe.ADD_TAGS,sr))),fe.ADD_ATTR&&(typeof fe.ADD_ATTR=="function"?ae.attributeCheck=fe.ADD_ATTR:(U===F&&(U=sl(U)),hr(U,fe.ADD_ATTR,sr))),fe.ADD_URI_SAFE_ATTR&&hr(Ve,fe.ADD_URI_SAFE_ATTR,sr),fe.FORBID_CONTENTS&&(Ne===ke&&(Ne=sl(Ne)),hr(Ne,fe.FORBID_CONTENTS,sr)),tt&&(ce["#text"]=!0),ie&&hr(ce,["html","head","body"]),ce.table&&(hr(ce,["tbody"]),delete X.tbody),fe.TRUSTED_TYPES_POLICY){if(typeof fe.TRUSTED_TYPES_POLICY.createHTML!="function")throw x0('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof fe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw x0('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');v=fe.TRUSTED_TYPES_POLICY,C=v.createHTML("")}else v===void 0&&(v=xz(d,s)),v!==null&&typeof C=="string"&&(C=v.createHTML(""));ma&&ma(fe),an=fe}},on=hr({},[...av,...iv,...oz]),_e=hr({},[...ov,...lz]),Ee=function(fe){let Ie=b(fe);(!Ie||!Ie.tagName)&&(Ie={namespaceURI:It,tagName:"template"});const We=Sm(fe.tagName),nt=Sm(Ie.tagName);return kt[fe.namespaceURI]?fe.namespaceURI===st?Ie.namespaceURI===pt?We==="svg":Ie.namespaceURI===xt?We==="svg"&&(nt==="annotation-xml"||Ct[nt]):!!on[We]:fe.namespaceURI===xt?Ie.namespaceURI===pt?We==="math":Ie.namespaceURI===st?We==="math"&&er[nt]:!!_e[We]:fe.namespaceURI===pt?Ie.namespaceURI===st&&!er[nt]||Ie.namespaceURI===xt&&!Ct[nt]?!1:!_e[We]&&(Wt[We]||!on[We]):!!(St==="application/xhtml+xml"&&kt[fe.namespaceURI]):!1},dt=function(fe){m0(t.removed,{element:fe});try{b(fe).removeChild(fe)}catch{y(fe)}},Mt=function(fe,Ie){try{m0(t.removed,{attribute:Ie.getAttributeNode(fe),from:Ie})}catch{m0(t.removed,{attribute:null,from:Ie})}if(Ie.removeAttribute(fe),fe==="is")if(Fe||Re)try{dt(Ie)}catch{}else try{Ie.setAttribute(fe,"")}catch{}},W=function(fe){let Ie=null,We=null;if(ze)fe="<remove></remove>"+fe;else{const bt=sv(fe,/^[\r\n\t ]+/);We=bt&&bt[0]}St==="application/xhtml+xml"&&It===pt&&(fe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+fe+"</body></html>");const nt=v?v.createHTML(fe):fe;if(It===pt)try{Ie=new h().parseFromString(nt,St)}catch{}if(!Ie||!Ie.documentElement){Ie=k.createDocument(It,"template",null);try{Ie.documentElement.innerHTML=ut?C:nt}catch{}}const ft=Ie.body||Ie.documentElement;return fe&&We&&ft.insertBefore(r.createTextNode(We),ft.childNodes[0]||null),It===pt?N.call(Ie,ie?"html":"body")[0]:ie?Ie.documentElement:ft},ue=function(fe){return S.call(fe.ownerDocument||fe,fe,A.SHOW_ELEMENT|A.SHOW_COMMENT|A.SHOW_TEXT|A.SHOW_PROCESSING_INSTRUCTION|A.SHOW_CDATA_SECTION,null)},re=function(fe){return fe instanceof f&&(typeof fe.nodeName!="string"||typeof fe.textContent!="string"||typeof fe.removeChild!="function"||!(fe.attributes instanceof u)||typeof fe.removeAttribute!="function"||typeof fe.setAttribute!="function"||typeof fe.namespaceURI!="string"||typeof fe.insertBefore!="function"||typeof fe.hasChildNodes!="function")},Ae=function(fe){return typeof l=="function"&&fe instanceof l};function pe(be,fe,Ie){Up(be,We=>{We.call(t,fe,Ie,an)})}const me=function(fe){let Ie=null;if(pe(L.beforeSanitizeElements,fe,null),re(fe))return dt(fe),!0;const We=sr(fe.nodeName);if(pe(L.uponSanitizeElement,fe,{tagName:We,allowedTags:ce}),Je&&fe.hasChildNodes()&&!Ae(fe.firstElementChild)&&ia(/<[/\w!]/g,fe.innerHTML)&&ia(/<[/\w!]/g,fe.textContent)||fe.nodeType===y0.progressingInstruction||Je&&fe.nodeType===y0.comment&&ia(/<[/\w]/g,fe.data))return dt(fe),!0;if(!(ae.tagCheck instanceof Function&&ae.tagCheck(We))&&(!ce[We]||X[We])){if(!X[We]&&Ge(We)&&(D.tagNameCheck instanceof RegExp&&ia(D.tagNameCheck,We)||D.tagNameCheck instanceof Function&&D.tagNameCheck(We)))return!1;if(tt&&!Ne[We]){const nt=b(fe)||fe.parentNode,ft=p(fe)||fe.childNodes;if(ft&&nt){const bt=ft.length;for(let Vt=bt-1;Vt>=0;--Vt){const Ht=g(ft[Vt],!0);Ht.__removalCount=(fe.__removalCount||0)+1,nt.insertBefore(Ht,m(fe))}}}return dt(fe),!0}return fe instanceof c&&!Ee(fe)||(We==="noscript"||We==="noembed"||We==="noframes")&&ia(/<\/no(script|embed|frames)/i,fe.innerHTML)?(dt(fe),!0):(Te&&fe.nodeType===y0.text&&(Ie=fe.textContent,Up([T,P,R],nt=>{Ie=g0(Ie,nt," ")}),fe.textContent!==Ie&&(m0(t.removed,{element:fe.cloneNode()}),fe.textContent=Ie)),pe(L.afterSanitizeElements,fe,null),!1)},De=function(fe,Ie,We){if(we&&(Ie==="id"||Ie==="name")&&(We in r||We in Wn))return!1;if(!(Y&&!K[Ie]&&ia(z,Ie))){if(!(he&&ia(q,Ie))){if(!(ae.attributeCheck instanceof Function&&ae.attributeCheck(Ie,fe))){if(!U[Ie]||K[Ie]){if(!(Ge(fe)&&(D.tagNameCheck instanceof RegExp&&ia(D.tagNameCheck,fe)||D.tagNameCheck instanceof Function&&D.tagNameCheck(fe))&&(D.attributeNameCheck instanceof RegExp&&ia(D.attributeNameCheck,Ie)||D.attributeNameCheck instanceof Function&&D.attributeNameCheck(Ie,fe))||Ie==="is"&&D.allowCustomizedBuiltInElements&&(D.tagNameCheck instanceof RegExp&&ia(D.tagNameCheck,We)||D.tagNameCheck instanceof Function&&D.tagNameCheck(We))))return!1}else if(!Ve[Ie]){if(!ia(se,g0(We,V,""))){if(!((Ie==="src"||Ie==="xlink:href"||Ie==="href")&&fe!=="script"&&nz(We,"data:")===0&&qe[fe])){if(!(Be&&!ia(M,g0(We,V,"")))){if(We)return!1}}}}}}}return!0},Ge=function(fe){return fe!=="annotation-xml"&&sv(fe,H)},Oe=function(fe){pe(L.beforeSanitizeAttributes,fe,null);const{attributes:Ie}=fe;if(!Ie||re(fe))return;const We={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let nt=Ie.length;for(;nt--;){const ft=Ie[nt],{name:bt,namespaceURI:Vt,value:Ht}=ft,Br=sr(bt),js=Ht;let Er=bt==="value"?js:sz(js);if(We.attrName=Br,We.attrValue=Er,We.keepAttr=!0,We.forceKeepAttr=void 0,pe(L.uponSanitizeAttribute,fe,We),Er=We.attrValue,ve&&(Br==="id"||Br==="name")&&(Mt(bt,fe),Er=Le+Er),Je&&ia(/((--!?|])>)|<\/(style|title|textarea)/i,Er)){Mt(bt,fe);continue}if(Br==="attributename"&&sv(Er,"href")){Mt(bt,fe);continue}if(We.forceKeepAttr)continue;if(!We.keepAttr){Mt(bt,fe);continue}if(!ee&&ia(/\/>/i,Er)){Mt(bt,fe);continue}Te&&Up([T,P,R],ta=>{Er=g0(Er,ta," ")});const Ua=sr(fe.nodeName);if(!De(Ua,Br,Er)){Mt(bt,fe);continue}if(v&&typeof d=="object"&&typeof d.getAttributeType=="function"&&!Vt)switch(d.getAttributeType(Ua,Br)){case"TrustedHTML":{Er=v.createHTML(Er);break}case"TrustedScriptURL":{Er=v.createScriptURL(Er);break}}if(Er!==js)try{Vt?fe.setAttributeNS(Vt,bt,Er):fe.setAttribute(bt,Er),re(fe)?dt(fe):z4(t.removed)}catch{Mt(bt,fe)}}pe(L.afterSanitizeAttributes,fe,null)},Qe=function be(fe){let Ie=null;const We=ue(fe);for(pe(L.beforeSanitizeShadowDOM,fe,null);Ie=We.nextNode();)pe(L.uponSanitizeShadowNode,Ie,null),me(Ie),Oe(Ie),Ie.content instanceof a&&be(Ie.content);pe(L.afterSanitizeShadowDOM,fe,null)};return t.sanitize=function(be){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ie=null,We=null,nt=null,ft=null;if(ut=!be,ut&&(be="<!-->"),typeof be!="string"&&!Ae(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw x0("dirty is not a string, aborting")}else throw x0("toString is not a function");if(!t.isSupported)return be;if($e||Ln(fe),t.removed=[],typeof be=="string"&&(lt=!1),lt){if(be.nodeName){const Ht=sr(be.nodeName);if(!ce[Ht]||X[Ht])throw x0("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof l)Ie=W("<!---->"),We=Ie.ownerDocument.importNode(be,!0),We.nodeType===y0.element&&We.nodeName==="BODY"||We.nodeName==="HTML"?Ie=We:Ie.appendChild(We);else{if(!Fe&&!Te&&!ie&&be.indexOf("<")===-1)return v&&at?v.createHTML(be):be;if(Ie=W(be),!Ie)return Fe?null:at?C:""}Ie&&ze&&dt(Ie.firstChild);const bt=ue(lt?be:Ie);for(;nt=bt.nextNode();)me(nt),Oe(nt),nt.content instanceof a&&Qe(nt.content);if(lt)return be;if(Fe){if(Re)for(ft=I.call(Ie.ownerDocument);Ie.firstChild;)ft.appendChild(Ie.firstChild);else ft=Ie;return(U.shadowroot||U.shadowrootmode)&&(ft=Q.call(n,ft,!0)),ft}let Vt=ie?Ie.outerHTML:Ie.innerHTML;return ie&&ce["!doctype"]&&Ie.ownerDocument&&Ie.ownerDocument.doctype&&Ie.ownerDocument.doctype.name&&ia(m6,Ie.ownerDocument.doctype.name)&&(Vt="<!DOCTYPE "+Ie.ownerDocument.doctype.name+`>
`+Vt),Te&&Up([T,P,R],Ht=>{Vt=g0(Vt,Ht," ")}),v&&at?v.createHTML(Vt):Vt},t.setConfig=function(){let be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ln(be),$e=!0},t.clearConfig=function(){an=null,$e=!1},t.isValidAttribute=function(be,fe,Ie){an||Ln({});const We=sr(be),nt=sr(fe);return De(We,nt,Ie)},t.addHook=function(be,fe){typeof fe=="function"&&m0(L[be],fe)},t.removeHook=function(be,fe){if(fe!==void 0){const Ie=tz(L[be],fe);return Ie===-1?void 0:rz(L[be],Ie,1)[0]}return z4(L[be])},t.removeHooks=function(be){L[be]=[]},t.removeAllHooks=function(){L=tC()},t}var x6=g6();const vz=Object.freeze(Object.defineProperty({__proto__:null,default:x6},Symbol.toStringTag,{value:"Module"}));function yz({htmlContent:e,className:t=""}){const r=G.useRef(null),[n,s]=G.useState(500);return G.useEffect(()=>{var g;if(!r.current||!e)return;const a=r.current,l=(y=>{const m=document.createElement("textarea");return m.innerHTML=y,m.value})(e),u=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          
      <style>
        * {
          box-sizing: border-box;
        }
        body {
          font-family: Arial, sans-serif;
          font-size: 14px;
          line-height: 1.6;
          color: #202124;
          margin: 0;
          padding: 16px;
          background: white;
          overflow-x: hidden;
          word-wrap: break-word;
        }

        /* Table styling - Gmail style */
        table {
          border-collapse: collapse !important;
          width: auto !important;
          max-width: 100%;
          margin: 12px 0;
          font-size: 13px;
        }

        table, th, td {
          border: 1px solid #000 !important;
        }

        th, td {
          padding: 6px 10px !important;
          text-align: left;
          vertical-align: top;
          word-break: break-word;
        }

        th {
          font-weight: 700 !important;
        }

        /* Preserve inline styles and colors */
        th[bgcolor], td[bgcolor] {
          /* Browser will apply bgcolor attribute */
        }

        /* Common email table colors */
        [bgcolor="#FFFF00"], [bgcolor="yellow"], [style*="background:yellow"], [style*="background-color:yellow"] {
          background-color: #FFFF00 !important;
        }

        [bgcolor="#E6E6FA"], [bgcolor="lavender"], [style*="background:lavender"], [style*="background-color:lavender"] {
          background-color: #E6E6FA !important;
        }

        [style*="color:blue"], [style*="color:#0000FF"] {
          color: #0000FF !important;
        }

        [style*="color:darkblue"], [style*="color:#00008B"] {
          color: #00008B !important;
        }

        /* Typography */
        p {
          margin: 8px 0;
        }

        a {
          color: #1a73e8;
          text-decoration: none;
        }

        a:hover {
          text-decoration: underline;
        }

        strong, b {
          font-weight: 700;
        }

        em, i {
          font-style: italic;
        }

        /* Lists */
        ul, ol {
          margin: 8px 0;
          padding-left: 24px;
        }

        li {
          margin: 4px 0;
        }

        /* Blockquotes */
        blockquote {
          margin: 8px 0;
          padding-left: 16px;
          border-left: 3px solid #dadce0;
          color: #5f6368;
        }

        /* Headers */
        h1, h2, h3, h4, h5, h6 {
          margin: 12px 0 8px 0;
          font-weight: 700;
          line-height: 1.3;
        }

        /* Images */
        img {
          max-width: 100%;
          height: auto;
        }

        /* Horizontal rules */
        hr {
          border: none;
          border-top: 1px solid #dadce0;
          margin: 16px 0;
        }

        /* Prevent overflow */
        pre {
          white-space: pre-wrap;
          word-wrap: break-word;
          overflow-x: auto;
        }

        /* Center tag support */
        center {
          text-align: center;
        }
      </style>
    
        </head>
        <body>
          ${x6.sanitize(l,{ALLOWED_TAGS:["html","head","body","meta","title","style","p","br","div","span","a","img","strong","em","u","b","i","s","strike","h1","h2","h3","h4","h5","h6","ul","ol","li","table","thead","tbody","tfoot","tr","th","td","font","center","blockquote","pre","code","hr","sup","sub"],ALLOWED_ATTR:["style","class","id","href","target","rel","src","alt","title","width","height","align","valign","border","cellpadding","cellspacing","bgcolor","color","face","size"],ALLOW_DATA_ATTR:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i})}
        </body>
      </html>
    `,f=new Blob([u],{type:"text/html; charset=UTF-8"}),h=URL.createObjectURL(f);if(a.src=h,!(a.contentDocument||((g=a.contentWindow)==null?void 0:g.document)))return;const x=()=>{var y;try{const m=a.contentDocument||((y=a.contentWindow)==null?void 0:y.document);if(!m)return;const p=()=>{const v=m.body,C=m.documentElement,k=Math.max((v==null?void 0:v.scrollHeight)||0,(v==null?void 0:v.offsetHeight)||0,(C==null?void 0:C.clientHeight)||0,(C==null?void 0:C.scrollHeight)||0,(C==null?void 0:C.offsetHeight)||0);s(Math.max(k+20,100))};p();const b=new ResizeObserver(p);m.body&&b.observe(m.body),setTimeout(p,150),a.__cleanup=()=>{b.disconnect(),URL.revokeObjectURL(h)}}catch(m){console.error("Error measuring iframe height:",m)}};return a.addEventListener("load",x),()=>{a.removeEventListener("load",x),a.__cleanup&&a.__cleanup(),URL.revokeObjectURL(h)}},[e]),!e||e.trim()===""?i.jsx("div",{className:`text-gray-500 italic p-4 ${t}`,children:"No email content available"}):i.jsx("iframe",{ref:r,title:"Email Content",className:`w-full border-0 ${t}`,style:{height:`${n}px`,minHeight:"100px",maxHeight:"800px"},sandbox:"allow-same-origin",loading:"lazy"})}function wz({email:e,parsedData:t,onSave:r,saving:n}){const[s,a]=G.useState(!1),[o,l]=G.useState(null);G.useEffect(()=>{t&&l({product_name:t.productName||"",specification:t.specification||"",quantity:t.quantity||"",supplier_name:t.supplierName||"",supplier_country:t.supplierCountry||"",company_name:t.companyName||"",contact_person:t.contactPerson||"",contact_email:t.contactEmail||"",contact_phone:t.contactPhone||"",priority:t.urgency||"medium",delivery_date:t.deliveryDateExpected||"",remarks:t.remarks||"",coa_required:t.coaRequested||!1,sample_required:t.sampleRequested||!1,price_required:t.priceRequested||!0,agency_letter_required:t.agencyLetterRequested||!1,aceerp_no:"",purchase_price:"",purchase_price_currency:"USD",offered_price:"",offered_price_currency:"USD",delivery_terms:"",inquiry_source:"email",mail_subject:(e==null?void 0:e.subject)||""})},[t,e]);const c=async u=>{const f={inquiryNumber:"",productName:u.product_name,specification:u.specification||"",quantity:u.quantity,supplierName:u.supplier_name||"",supplierCountry:u.supplier_country||"",companyName:u.company_name,contactPerson:u.contact_person||"",contactEmail:u.contact_email||"",contactPhone:u.contact_phone||"",priority:u.priority,purposeIcons:[],deliveryDateExpected:u.delivery_date||"",remarks:u.remarks||"",coaRequested:u.coa_required||!1,msdsRequested:!1,sampleRequested:u.sample_required||!1,priceRequested:u.price_required||!1,agencyLetterRequested:u.agency_letter_required||!1,aceerp_no:u.aceerp_no||"",purchasePrice:u.purchase_price||"",purchasePriceCurrency:u.purchase_price_currency||"USD",offeredPrice:u.offered_price||"",offeredPriceCurrency:u.offered_price_currency||"USD",deliveryDate:u.delivery_date||"",deliveryTerms:u.delivery_terms||""};await r(f)},A={high:"text-green-600 bg-green-50 border-green-200",medium:"text-yellow-600 bg-yellow-50 border-yellow-200",low:"text-red-600 bg-red-50 border-red-200"};return!e||!t?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[i.jsx(Nr,{className:"w-20 h-20 text-gray-300 mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Email Selected"}),i.jsx("p",{className:"text-gray-600 max-w-md",children:"Click on an email from the left panel to automatically parse and fill this inquiry form with AI"}),i.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[i.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[i.jsx(rd,{className:"w-4 h-4 text-blue-500"}),i.jsx("span",{children:"AI extracts product, quantity, company, contact"})]}),i.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[i.jsx(eo,{className:"w-4 h-4 text-green-500"}),i.jsx("span",{children:"Only inquiry number needs manual input"})]})]})]}):i.jsxs("div",{className:"flex flex-col h-full bg-white",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-transparent",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Inquiry"}),t&&i.jsx("div",{className:`px-3 py-1 rounded-lg text-sm font-medium border ${A[t.confidence]}`,children:i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(rd,{className:"w-3.5 h-3.5"}),i.jsxs("span",{children:["AI Confidence: ",t.confidence.toUpperCase()]}),i.jsxs("span",{className:"text-xs",children:["(",Math.round(t.confidenceScore*100),"%)"]})]})})]}),e&&i.jsxs("div",{className:"mt-3 bg-white border border-gray-300 rounded-lg shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>a(!s),className:"w-full flex items-center justify-between px-5 py-3 hover:bg-gray-50 transition border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-sm font-bold text-blue-700",children:(e.from_name||e.from_email).charAt(0).toUpperCase()})}),i.jsxs("div",{className:"text-left flex-1 min-w-0",children:[i.jsx("p",{className:"text-base font-semibold text-gray-900 truncate",children:e.subject}),i.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[i.jsx("p",{className:"text-sm text-gray-900 font-medium",children:e.from_name||"Unknown"}),i.jsx("span",{className:"text-gray-400 text-xs",children:""}),i.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["<",e.from_email,">"]})]})]})]}),s?i.jsx(ME,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"}):i.jsx(ac,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"})]}),s&&i.jsxs("div",{className:"bg-white",children:[i.jsx("div",{className:"px-5 py-3 border-b border-gray-100 bg-gray-50",children:i.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:new Date(e.received_date).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})}),i.jsx("div",{className:"px-5 py-4",children:i.jsx(yz,{htmlContent:e.body,className:"max-h-[600px]"})}),i.jsx("div",{className:"px-5 py-3 bg-blue-50 border-t border-blue-100",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[i.jsx(rd,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:"AI has extracted data from this email. Review the form fields below."})]})})]})]}),(t==null?void 0:t.autoDetectedCompany)&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700 bg-green-50 px-3 py-1.5 rounded-lg mt-3",children:[i.jsx(eo,{className:"w-4 h-4"}),i.jsx("span",{children:"Company auto-detected from email domain"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(eo,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Auto-Generated Inquiry Number"}),i.jsx("p",{className:"text-xs text-green-700",children:"Inquiry number will be automatically generated when you save (format: INQ-2025-NNNN)"})]})]})}),o&&i.jsx(f6,{onSubmit:c,onCancel:()=>{},initialData:o,isEditing:!1})]})})]})}async function bz(e,t,r,n,s){var a;try{const{data:o,error:l}=await oe.from("crm_inquiries").select("*").eq("id",e).single();if(l)throw l;let c=o.status,A=!1;const u={};switch(t){case"send_price":u.price_quoted=!0,u.price_quoted_date=new Date().toISOString().split("T")[0],c="price_quoted",A=!0;break;case"send_coa":u.coa_sent=!0,u.coa_sent_date=new Date().toISOString().split("T")[0],o.price_quoted&&o.coa_sent&&(c="negotiation",A=!0);break;case"send_msds":u.msds_sent=!0,u.msds_sent_date=new Date().toISOString().split("T")[0];break;case"send_sample":u.sample_sent=!0,u.sample_sent_date=new Date().toISOString().split("T")[0],c="sample_sent",A=!0;break}if(A&&(u.status=c),Object.keys(u).length>0){const{error:x}=await oe.from("crm_inquiries").update(u).eq("id",e);if(x)throw x}let f;const{data:h}=await oe.rpc("auto_create_followup",{p_inquiry_id:e,p_action_type:t,p_user_id:n});h&&(f=h);const{error:d}=await oe.from("crm_quick_actions_log").insert({inquiry_id:e,action_type:t,action_label:r,email_sent:!!(s!=null&&s.emailTo),email_to:(s==null?void 0:s.emailTo)||null,email_subject:(s==null?void 0:s.emailSubject)||null,email_body:(s==null?void 0:s.emailBody)||null,template_used:(s==null?void 0:s.templateId)||null,old_status:o.status,new_status:c,status_updated:A,follow_up_created:!!f,follow_up_reminder_id:f||null,notes:(s==null?void 0:s.notes)||null,performed_by:n});if(d)throw d;if(s!=null&&s.emailTo&&(s!=null&&s.emailSubject)&&(s!=null&&s.emailBody)){const{error:x}=await oe.from("crm_email_activities").insert({inquiry_id:e,email_type:"sent",from_email:(a=(await oe.auth.getUser()).data.user)==null?void 0:a.email,to_email:[s.emailTo],subject:s.emailSubject,body:s.emailBody,template_id:s.templateId||null,sent_date:new Date().toISOString(),created_by:n});x&&console.error("Error logging email:",x)}return{success:!0,reminderId:f}}catch(o){return console.error("Error performing quick action:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}async function _z(e,t,r,n,s,a){try{let o=null,l="";switch(n){case"customer_will_revert":o=new Date,o.setDate(o.getDate()+2),l="Customer will revert";break;case"could_not_reach":o=new Date,o.setDate(o.getDate()+1),l="Try calling again";break;case"discussed_price":case"discussed_coa":case"discussed_sample":o=new Date,o.setDate(o.getDate()+3),l="Follow up on discussion";break;case"positive":o=new Date,o.setDate(o.getDate()+2),l="Positive response - follow up";break;case"negative":o=new Date,o.setDate(o.getDate()+7),l="Negative response - check back later";break}const{error:c}=await oe.from("crm_activity_logs").insert({inquiry_id:e,activity_type:t,activity_title:r,activity_description:a||null,outcome:n,next_follow_up_date:o?o.toISOString():null,follow_up_reason:l,created_by:s});if(c)throw c;o&&await oe.from("crm_inquiries").update({next_follow_up:o.toISOString(),last_contact_date:new Date().toISOString()}).eq("id",e);let A;if(o){const{data:u,error:f}=await oe.from("crm_reminders").insert({inquiry_id:e,reminder_type:"follow_up",title:l,due_date:o.toISOString(),assigned_to:s,created_by:s}).select("id").single();!f&&u&&(A=u.id)}return{success:!0,reminderId:A}}catch(o){return console.error("Error logging activity:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}function Bz({inquiry:e,onActionComplete:t}){const[r,n]=G.useState(!1),[s,a]=G.useState("phone_call"),[o,l]=G.useState(!1),c=[{id:"send_price",label:"Send Price",icon:To,color:"bg-green-50 hover:bg-green-100 text-green-700 border-green-200",description:"Auto-updates status & creates 2-day follow-up"},{id:"send_coa",label:"Send COA",icon:Nr,color:"bg-blue-50 hover:bg-blue-100 text-blue-700 border-blue-200",description:"Auto-updates status & creates 1-day follow-up"},{id:"send_msds",label:"Send MSDS",icon:Nr,color:"bg-orange-50 hover:bg-orange-100 text-orange-700 border-orange-200",description:"Sends MSDS document"},{id:"send_sample",label:"Send Sample",icon:YE,color:"bg-purple-50 hover:bg-purple-100 text-purple-700 border-purple-200",description:"Auto-updates status & creates 3-day follow-up"}],A=[{value:"customer_will_revert",label:"Customer Will Revert",followUpDays:2},{value:"could_not_reach",label:"Could Not Reach",followUpDays:1},{value:"discussed_price",label:"Discussed Price/COA",followUpDays:3},{value:"positive",label:"Positive Response",followUpDays:2},{value:"negative",label:"Negative Response",followUpDays:7},{value:"other",label:"Other",followUpDays:3}],u=async(h,d)=>{if(!(!e||!confirm(`Send ${d}?

This will:
- Update inquiry status
- Create automatic follow-up
- Log the action

Continue?`))){l(!0);try{const{data:{user:g}}=await oe.auth.getUser();if(!g)throw new Error("Not authenticated");const y=await bz(e.id,h,d,g.id,{emailTo:e.contact_email||void 0,emailSubject:`Re: ${e.email_subject||e.product_name}`,emailBody:`Dear ${e.contact_person||"Sir/Madam"},

Thank you for your inquiry regarding ${e.product_name}.

Please find the ${d.toLowerCase()} attached.

Best regards`});y.success?(alert(`${d} sent successfully!

Status updated & follow-up created automatically.`),t()):alert(`Failed to send ${d}: ${y.error}`)}catch(g){console.error("Error performing quick action:",g),alert("Failed to perform action. Please try again.")}finally{l(!1)}}},f=async h=>{if(e){l(!0);try{const{data:{user:d}}=await oe.auth.getUser();if(!d)throw new Error("Not authenticated");const x=s==="phone_call"?"Phone Call":s==="meeting"?"Meeting":"WhatsApp Message",g=await _z(e.id,s,x,h,d.id);if(g.success){const y=A.find(m=>m.value===h);alert(`${x} logged!

Follow-up automatically created for ${y==null?void 0:y.followUpDays} days from now.`),n(!1),t()}else alert(`Failed to log activity: ${g.error}`)}catch(d){console.error("Error logging activity:",d),alert("Failed to log activity. Please try again.")}finally{l(!1)}}};return e?i.jsxs("div",{className:"flex flex-col h-full bg-white border-l border-gray-200",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-green-50 to-transparent",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Quick Actions"}),i.jsxs("p",{className:"text-xs text-gray-600",children:["Inquiry #",e.inquiry_number]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(Io,{className:"w-4 h-4"}),"Send Documents (1-Click)"]}),i.jsx("div",{className:"space-y-2",children:c.map(h=>i.jsx("button",{onClick:()=>u(h.id,h.label),disabled:o,className:`w-full p-3 rounded-lg border-2 transition ${h.color} disabled:opacity-50 disabled:cursor-not-allowed text-left`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(h.icon,{className:"w-5 h-5 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-semibold text-sm",children:h.label}),i.jsx("p",{className:"text-xs opacity-75 truncate",children:h.description})]})]})},h.id))})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(IA,{className:"w-4 h-4"}),"Log Activity (1-Click)"]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("button",{onClick:()=>{a("phone_call"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(IA,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Call"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Quick outcome selection"})]})]})}),i.jsx("button",{onClick:()=>{a("meeting"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(ha,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Meeting"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Record meeting outcome"})]})]})}),i.jsx("button",{onClick:()=>{a("whatsapp"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(lh,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log WhatsApp"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Log WhatsApp conversation"})]})]})})]})]}),i.jsx("div",{className:"border-t border-gray-200 pt-4",children:i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Ws,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"text-xs text-blue-800",children:[i.jsx("p",{className:"font-medium mb-1",children:"Auto-Automation Active"}),i.jsxs("ul",{className:"space-y-0.5 text-blue-700",children:[i.jsx("li",{children:" Status updates automatically"}),i.jsx("li",{children:" Follow-ups created automatically"}),i.jsx("li",{children:" All actions logged in timeline"})]})]})]})})})]}),i.jsx(fr,{isOpen:r,onClose:()=>n(!1),title:`Log ${s==="phone_call"?"Phone Call":s==="meeting"?"Meeting":"WhatsApp"}`,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Select the outcome to automatically update follow-up date:"}),i.jsx("div",{className:"space-y-2",children:A.map(h=>i.jsx("button",{onClick:()=>f(h.value),disabled:o,className:"w-full p-4 text-left border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition disabled:opacity-50 disabled:cursor-not-allowed",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(eo,{className:"w-5 h-5 text-gray-400"}),i.jsx("span",{className:"font-medium text-gray-900",children:h.label})]}),i.jsxs("span",{className:"text-xs text-gray-500",children:["+",h.followUpDays,"d follow-up"]})]})},h.value))}),i.jsx("div",{className:"pt-4 border-t border-gray-200",children:i.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Click an outcome to log and auto-create follow-up"})})]})})]}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[i.jsx(Io,{className:"w-20 h-20 text-gray-300 mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Quick Actions"}),i.jsx("p",{className:"text-gray-600 max-w-md",children:"Save an inquiry to see quick action buttons here"}),i.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[i.jsx("p",{children:"One-click actions include:"}),i.jsxs("ul",{className:"list-disc list-inside text-left",children:[i.jsx("li",{children:"Send Price Quote"}),i.jsx("li",{children:"Send COA/MSDS"}),i.jsx("li",{children:"Log Phone Calls"}),i.jsx("li",{children:"Schedule Follow-ups"})]})]})]})}function Cz(e){if(!e)return null;const t=e.trim();if(!t)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const r=t.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2})$/);if(r){const o=r[1].padStart(2,"0"),l=r[2].padStart(2,"0");return`${parseInt(r[3])<50?`20${r[3]}`:`19${r[3]}`}-${l}-${o}`}const n=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(n){const o=n[1].padStart(2,"0"),l=n[2].padStart(2,"0");return`${parseInt(n[3])<50?`20${n[3]}`:`19${n[3]}`}-${l}-${o}`}const s=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(s){const o=s[1].padStart(2,"0"),l=s[2].padStart(2,"0");return`${s[3]}-${l}-${o}`}const a=t.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0");return`${a[3]}-${l}-${o}`}try{const o=new Date(t);if(!isNaN(o.getTime()))return o.toISOString().split("T")[0]}catch{console.warn("Could not parse date:",t)}return null}function Nz(){const{profile:e}=Qr(),[t,r]=G.useState(null),[n,s]=G.useState(null),[a,o]=G.useState(null),[l,c]=G.useState(!1),A=(h,d)=>{r(h),s(d),o(null)},u=async h=>{var d;if(!(!t||!e)){c(!0);try{const{data:{user:x}}=await oe.auth.getUser();if(!x)throw new Error("Not authenticated");let g=null;const{data:y}=await oe.from("customers").select("id, company_name, email, contact_person, phone, address").or(`email.eq.${h.contactEmail},company_name.ilike.${h.companyName}`).limit(1).maybeSingle();if(y){g=y.id;const v={};h.contactPerson&&!y.contact_person&&(v.contact_person=h.contactPerson),h.contactPhone&&!y.phone&&(v.phone=h.contactPhone),h.contactEmail&&h.contactEmail!==y.email&&(v.email=h.contactEmail),Object.keys(v).length>0&&await oe.from("customers").update({...v,updated_at:new Date().toISOString()}).eq("id",g)}else{const{data:v,error:C}=await oe.from("customers").insert({customer_name:h.companyName,company_name:h.companyName,contact_person:h.contactPerson||null,email:h.contactEmail,phone:h.contactPhone||null,is_active:!0,created_by:x.id}).select().single();!C&&v&&(g=v.id)}const m={customer_id:g,inquiry_date:new Date().toISOString().split("T")[0],product_name:h.productName,specification:h.specification||null,quantity:h.quantity,supplier_name:h.supplierName||null,supplier_country:h.supplierCountry||null,company_name:h.companyName,contact_person:h.contactPerson||null,contact_email:h.contactEmail,contact_phone:h.contactPhone||null,mail_subject:t.subject,email_body:t.body,inquiry_source:"email",status:"new",pipeline_status:"new",priority:h.priority,purpose_icons:h.purposeIcons,delivery_date_expected:Cz(h.deliveryDateExpected),ai_confidence_score:(n==null?void 0:n.confidenceScore)||0,auto_detected_company:(n==null?void 0:n.autoDetectedCompany)||!1,auto_detected_contact:(n==null?void 0:n.autoDetectedContact)||!1,coa_sent:!1,msds_sent:!1,sample_sent:!1,price_quoted:!1,price_required:h.priceRequested,coa_required:h.coaRequested,sample_required:h.sampleRequested,agency_letter_required:h.agencyLetterRequested||!1,aceerp_no:h.aceerp_no||null,purchase_price:h.purchasePrice?parseFloat(h.purchasePrice):null,purchase_price_currency:h.purchasePriceCurrency||"USD",offered_price:h.offeredPrice?parseFloat(h.offeredPrice):null,offered_price_currency:h.offeredPriceCurrency||"USD",delivery_date:h.deliveryDate||null,delivery_terms:h.deliveryTerms||null,remarks:h.remarks||null,assigned_to:x.id,created_by:x.id,source:"email",source_email_id:t.id},{data:p,error:b}=await oe.from("crm_inquiries").insert([m]).select().single();if(b)throw b;if(await oe.from("crm_email_inbox").update({is_processed:!0,is_inquiry:!0,converted_to_inquiry:p.id}).eq("id",t.id),h.coaRequested||h.msdsRequested||h.sampleRequested||h.priceRequested||h.agencyLetterRequested){const v=[];h.priceRequested&&v.push({inquiry_id:p.id,reminder_type:"send_price",title:"Send price quote to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.coaRequested&&v.push({inquiry_id:p.id,reminder_type:"send_coa",title:"Send COA to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.msdsRequested&&v.push({inquiry_id:p.id,reminder_type:"send_msds",title:"Send MSDS to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.sampleRequested&&v.push({inquiry_id:p.id,reminder_type:"send_sample",title:"Send sample to customer",due_date:new Date(Date.now()+3*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.agencyLetterRequested&&v.push({inquiry_id:p.id,reminder_type:"send_agency_letter",title:"Send agency letter to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),v.length>0&&await oe.from("crm_reminders").insert(v)}o(p),s(null),alert(`Inquiry #${p.inquiry_number} created successfully!

Use Quick Actions to send documents.`)}catch(x){console.error("Error creating inquiry:",x),(d=x.message)!=null&&d.includes("duplicate key")?alert("This inquiry number already exists. Please use a different number."):alert("Failed to create inquiry. Please try again.")}finally{c(!1)}}},f=()=>{o(null),r(null),s(null)};return i.jsx(as,{children:i.jsxs("div",{className:"h-screen flex flex-col",children:[i.jsx("div",{className:"flex-shrink-0 bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-2 border-b border-blue-800",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(tF,{className:"w-5 h-5 text-white"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-white",children:"CRM Command Center"}),i.jsx("p",{className:"text-blue-100 text-xs",children:"AI-powered inquiry processing"})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-xs text-blue-200",children:"Quick Actions"}),i.jsx("p",{className:"text-xl font-bold text-white",children:"2 Clicks"})]})]})}),i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:i.jsx(Y$,{onEmailSelect:A,selectedEmailId:(t==null?void 0:t.id)||null})}),i.jsx("div",{className:"flex-1",children:i.jsx(wz,{email:t,parsedData:n,onSave:u,saving:l})}),i.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:i.jsx(Bz,{inquiry:a,onActionComplete:f})})]}),a&&i.jsx("div",{className:"flex-shrink-0 bg-green-50 border-t border-green-200 px-6 py-3",children:i.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-800",children:[i.jsx(eo,{className:"w-5 h-5"}),i.jsxs("span",{className:"font-medium",children:["Inquiry #",a.inquiry_number," created successfully! Use Quick Actions on the right "]})]})})]})})}function Sz({isOpen:e,onClose:t,taskId:r,onUpdate:n}){const{user:s}=Qr(),[a,o]=G.useState(null),[l,c]=G.useState([]),[A,u]=G.useState([]),[f,h]=G.useState(!0),[d,x]=G.useState(""),[g,y]=G.useState(!1),[m,p]=G.useState(""),[b,v]=G.useState([]),[C,k]=G.useState(!1),[S,I]=G.useState(!1),N=G.useRef(null),Q=G.useRef(null);G.useEffect(()=>{e&&r&&(L(),T(),P())},[e,r]);const L=async()=>{var F,D,X,K;try{h(!0);const{data:ae,error:he}=await oe.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(name)
        `).eq("id",r).single();if(he)throw he;const Y=ae.assigned_users||[],{data:Be}=await oe.from("user_profiles").select("id, full_name").in("id",Y);o({...ae,creator_name:(F=ae.creator)==null?void 0:F.full_name,assignee_names:(Be==null?void 0:Be.map(ee=>ee.full_name))||[],inquiry_number:(D=ae.inquiry)==null?void 0:D.inquiry_number,customer_name:(X=ae.customer)==null?void 0:X.company_name,product_name:(K=ae.product)==null?void 0:K.name})}catch(ae){console.error("Error loading task:",ae)}finally{h(!1)}},T=async()=>{try{const{data:F,error:D}=await oe.from("task_comments").select(`
          *,
          user:user_id(full_name)
        `).eq("task_id",r).eq("is_deleted",!1).order("created_at",{ascending:!0});if(D)throw D;c((F||[]).map(X=>{var K;return{...X,user_name:((K=X.user)==null?void 0:K.full_name)||"Unknown User"}}))}catch(F){console.error("Error loading comments:",F)}},P=async()=>{try{const{data:F,error:D}=await oe.from("user_profiles").select("id, full_name, email").eq("is_active",!0).order("full_name");if(D)throw D;u(F||[])}catch(F){console.error("Error loading users:",F)}},R=F=>{const D=F.target.value;x(D);const X=D.split(" ").pop()||"";X.startsWith("@")?(p(X.slice(1)),y(!0)):y(!1)},z=(F,D)=>{var K;const X=d.split(" ");X[X.length-1]=`@${F} `,x(X.join(" ")),y(!1),(K=Q.current)==null||K.focus()},q=F=>{const D=/@(\w+)/g,X=[];let K;for(;(K=D.exec(F))!==null;){const ae=K[1],he=A.find(Y=>Y.full_name.replace(/\s+/g,"")===ae);he&&X.push(he.id)}return X},M=async()=>{const F=[];for(const D of b){const X=`${Date.now()}_${D.name}`,K=`tasks/${r}/comments/${X}`,{error:ae}=await oe.storage.from("task-attachments").upload(K,D);ae?console.error("Error uploading file:",ae):F.push(K)}return F},V=async()=>{if(!(!d.trim()&&b.length===0))try{k(!0);const F=await M(),D=q(d),{error:X}=await oe.from("task_comments").insert([{task_id:r,comment_text:d,user_id:s==null?void 0:s.id,mentions:D,attachment_urls:F}]);if(X)throw X;x(""),v([]),T()}catch(F){console.error("Error adding comment:",F),alert("Failed to add comment")}finally{k(!1)}},H=async F=>{try{I(!0);const{error:D}=await oe.from("tasks").update({status:F}).eq("id",r);if(D)throw D;L(),n()}catch(D){console.error("Error updating status:",D),alert("Failed to update status")}finally{I(!1)}},se=F=>{var X;const D=(X=F.split(".").pop())==null?void 0:X.toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(D||"")?i.jsx(GE,{className:"w-4 h-4"}):["pdf"].includes(D||"")?i.jsx(Nr,{className:"w-4 h-4"}):i.jsx(qE,{className:"w-4 h-4"})},ce=async F=>{try{const{data:D,error:X}=await oe.storage.from("task-attachments").download(F);if(X)throw X;const K=URL.createObjectURL(D),ae=document.createElement("a");ae.href=K,ae.download=F.split("/").pop()||"download",document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(K)}catch(D){console.error("Error downloading file:",D)}},B=F=>{const D={to_do:"bg-gray-100 text-gray-700 border-gray-300",in_progress:"bg-blue-100 text-blue-700 border-blue-300",waiting:"bg-orange-100 text-orange-700 border-orange-300",completed:"bg-green-100 text-green-700 border-green-300"};return D[F]||D.to_do},U=F=>{const D={low:"bg-gray-100 text-gray-700",medium:"bg-yellow-100 text-yellow-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"};return D[F]||D.medium};return f||!a?i.jsx(fr,{isOpen:e,onClose:t,title:"Loading...",children:i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx(Bc,{className:"w-8 h-8 animate-spin text-blue-600"})})}):i.jsx(fr,{isOpen:e,onClose:t,title:a.title,size:"xl",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${U(a.priority)}`,children:a.priority.toUpperCase()}),i.jsxs("select",{value:a.status,onChange:F=>H(F.target.value),disabled:S,className:`px-3 py-1 rounded-full text-sm font-medium border-2 ${B(a.status)} cursor-pointer disabled:opacity-50`,children:[i.jsx("option",{value:"to_do",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"waiting",children:"Waiting"}),i.jsx("option",{value:"completed",children:"Completed"})]})]}),a.description&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),i.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:a.description})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(ha,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Deadline:"}),i.jsx("span",{className:"font-medium text-gray-900",children:new Date(a.deadline).toLocaleString()})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(Bo,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Created by:"}),i.jsx("span",{className:"font-medium text-gray-900",children:a.creator_name})]}),a.assignee_names.length>0&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(Bo,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Assigned to:"}),i.jsx("span",{className:"font-medium text-gray-900",children:a.assignee_names.join(", ")})]}),a.inquiry_number&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(hg,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Inquiry:"}),i.jsx("span",{className:"font-medium text-blue-600",children:a.inquiry_number})]}),a.customer_name&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(Bo,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Customer:"}),i.jsx("span",{className:"font-medium text-gray-900",children:a.customer_name})]}),a.product_name&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(hg,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Product:"}),i.jsx("span",{className:"font-medium text-gray-900",children:a.product_name})]})]}),a.attachment_urls.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(jo,{className:"w-4 h-4"}),"Attachments (",a.attachment_urls.length,")"]}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.attachment_urls.map((F,D)=>i.jsxs("button",{onClick:()=>ce(F),className:"flex items-center gap-2 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 text-left",children:[se(F),i.jsx("span",{className:"text-sm text-gray-700 truncate",children:F.split("/").pop()}),i.jsx(TA,{className:"w-4 h-4 ml-auto text-gray-400"})]},D))})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(lh,{className:"w-5 h-5"}),"Discussion (",l.length,")"]}),i.jsx("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:l.length===0?i.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No comments yet. Start the discussion!"}):l.map(F=>i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-medium text-sm",children:F.user_name.charAt(0).toUpperCase()})}),i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("span",{className:"font-medium text-sm text-gray-900",children:F.user_name}),i.jsx("span",{className:"text-xs text-gray-500",children:new Date(F.created_at).toLocaleString()})]}),i.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:F.comment_text}),F.attachment_urls.length>0&&i.jsx("div",{className:"mt-2 space-y-1",children:F.attachment_urls.map((D,X)=>i.jsxs("button",{onClick:()=>ce(D),className:"flex items-center gap-2 text-xs text-blue-600 hover:text-blue-700",children:[se(D),D.split("/").pop()]},X))})]})})]},F.id))}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx("textarea",{ref:Q,value:d,onChange:R,placeholder:"Add a comment... Use @ to mention someone",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3}),g&&i.jsx("div",{className:"absolute bottom-full left-0 mb-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-10",children:A.filter(F=>F.full_name.toLowerCase().includes(m.toLowerCase())).slice(0,5).map(F=>i.jsxs("button",{onClick:()=>z(F.full_name.replace(/\s+/g,""),F.id),className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",children:[i.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs",children:F.full_name.charAt(0).toUpperCase()}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:F.full_name}),i.jsx("p",{className:"text-xs text-gray-500",children:F.email})]})]},F.id))})]}),b.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:b.map((F,D)=>i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-lg text-sm",children:[i.jsx(jo,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:F.name}),i.jsx("button",{onClick:()=>v(X=>X.filter((K,ae)=>ae!==D)),className:"text-gray-500 hover:text-red-600",children:i.jsx(Xs,{className:"w-4 h-4"})})]},D))}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("input",{ref:N,type:"file",multiple:!0,onChange:F=>{F.target.files&&v(Array.from(F.target.files))},className:"hidden"}),i.jsxs("button",{onClick:()=>{var F;return(F=N.current)==null?void 0:F.click()},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition",children:[i.jsx(jo,{className:"w-4 h-4"}),"Attach Files"]}),i.jsx("button",{onClick:V,disabled:C||!d.trim()&&b.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:C?i.jsxs(i.Fragment,{children:[i.jsx(Bc,{className:"w-4 h-4 animate-spin"}),"Posting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Io,{className:"w-4 h-4"}),"Post Comment"]})})]})]})]})]})})}function kz(){const{user:e,profile:t}=Qr(),[r,n]=G.useState([]),[s,a]=G.useState([]),[o,l]=G.useState(!0),[c,A]=G.useState(""),[u,f]=G.useState(!1),[h,d]=G.useState(null),[x,g]=G.useState(!1),[y,m]=G.useState(!1),[p,b]=G.useState(null),[v,C]=G.useState({status:[],priority:[],assignedTo:[],view:"my-tasks"}),[k,S]=G.useState({total:0,pending:0,completed:0,overdue:0});G.useEffect(()=>{I()},[e]),G.useEffect(()=>{Q()},[r,v,c]);const I=async()=>{try{l(!0);let z=oe.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(product_name)
        `).eq("is_deleted",!1).order("deadline",{ascending:!0});const{data:q,error:M}=await z;if(M)throw M;const V=(q==null?void 0:q.map(B=>B.id))||[],{data:H}=await oe.from("task_comments").select("task_id").in("task_id",V).eq("is_deleted",!1),se={};H==null||H.forEach(B=>{se[B.task_id]=(se[B.task_id]||0)+1});const ce=(q||[]).map(B=>{var U,F,D,X;return{...B,creator_name:(U=B.creator)==null?void 0:U.full_name,inquiry_number:(F=B.inquiry)==null?void 0:F.inquiry_number,customer_name:(D=B.customer)==null?void 0:D.company_name,product_name:(X=B.product)==null?void 0:X.product_name,comment_count:se[B.id]||0}});n(ce),N(ce)}catch(z){console.error("Error loading tasks:",z)}finally{l(!1)}},N=z=>{const q=new Date,M=z.filter(V=>V.assigned_users.includes((e==null?void 0:e.id)||"")||V.created_by===(e==null?void 0:e.id));S({total:M.length,pending:M.filter(V=>V.status!=="completed").length,completed:M.filter(V=>V.status==="completed").length,overdue:M.filter(V=>V.status!=="completed"&&new Date(V.deadline)<q).length})},Q=()=>{let z=[...r];if(v.view==="my-tasks")z=z.filter(q=>q.assigned_users.includes((e==null?void 0:e.id)||"")||q.created_by===(e==null?void 0:e.id));else if(v.view==="pending")z=z.filter(q=>q.status!=="completed"&&(q.assigned_users.includes((e==null?void 0:e.id)||"")||q.created_by===(e==null?void 0:e.id)));else if(v.view==="completed")z=z.filter(q=>q.status==="completed"&&(q.assigned_users.includes((e==null?void 0:e.id)||"")||q.created_by===(e==null?void 0:e.id)));else if(v.view==="overdue"){const q=new Date;z=z.filter(M=>M.status!=="completed"&&new Date(M.deadline)<q&&(M.assigned_users.includes((e==null?void 0:e.id)||"")||M.created_by===(e==null?void 0:e.id)))}if(v.status.length>0&&(z=z.filter(q=>v.status.includes(q.status))),v.priority.length>0&&(z=z.filter(q=>v.priority.includes(q.priority))),c){const q=c.toLowerCase();z=z.filter(M=>{var V,H,se,ce;return M.title.toLowerCase().includes(q)||((V=M.description)==null?void 0:V.toLowerCase().includes(q))||((H=M.customer_name)==null?void 0:H.toLowerCase().includes(q))||((se=M.product_name)==null?void 0:se.toLowerCase().includes(q))||((ce=M.inquiry_number)==null?void 0:ce.toLowerCase().includes(q))})}a(z)},L=z=>{switch(z){case"urgent":return i.jsx(VE,{className:"w-4 h-4 text-red-600"});case"high":return i.jsx(sw,{className:"w-4 h-4 text-orange-600"});case"medium":return i.jsx(aw,{className:"w-4 h-4 text-yellow-600"});default:return i.jsx(HE,{className:"w-4 h-4 text-gray-400"})}},T=z=>{const q={to_do:"bg-gray-100 text-gray-700",in_progress:"bg-blue-100 text-blue-700",waiting:"bg-orange-100 text-orange-700",completed:"bg-green-100 text-green-700"},M={to_do:"To Do",in_progress:"In Progress",waiting:"Waiting",completed:"Completed"};return i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q[z]}`,children:M[z]})},P=z=>{const q=new Date(z),M=new Date,V=q.getTime()-M.getTime(),H=Math.floor(V/(1e3*60*60)),se=Math.floor(H/24);return V<0?i.jsx("span",{className:"text-red-600 font-medium",children:"Overdue"}):H<24?i.jsxs("span",{className:"text-orange-600 font-medium",children:["Due in ",H,"h"]}):se<7?i.jsxs("span",{className:"text-yellow-600 font-medium",children:["Due in ",se,"d"]}):i.jsx("span",{className:"text-gray-600",children:q.toLocaleDateString()})},R=async z=>{if(confirm("Are you sure you want to delete this task?"))try{const{error:q}=await oe.from("tasks").update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:e==null?void 0:e.id}).eq("id",z);if(q)throw q;I()}catch(q){console.error("Error deleting task:",q),alert("Failed to delete task")}};return o?i.jsx(as,{children:i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):i.jsxs(as,{children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tasks"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and track team assignments"})]}),i.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"New Task"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(eo,{className:"w-6 h-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Tasks"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.total})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:i.jsx(Ws,{className:"w-6 h-6 text-yellow-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.pending})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(eo,{className:"w-6 h-6 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.completed})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:i.jsx(Fa,{className:"w-6 h-6 text-red-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.overdue})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"p-4 border-b border-gray-200",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[i.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:"my-tasks",label:"My Tasks"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"overdue",label:"Overdue"},{value:"all",label:"All Tasks"}].map(z=>i.jsx("button",{onClick:()=>C({...v,view:z.value}),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${v.view===z.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:z.label},z.value))}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-64",children:[i.jsx(Lc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search tasks...",value:c,onChange:z=>A(z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsx("button",{onClick:()=>f(!u),className:`px-4 py-2 border rounded-lg transition ${u?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:i.jsx(uO,{className:"w-5 h-5"})})]})]}),u&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),i.jsx("div",{className:"space-y-2",children:["to_do","in_progress","waiting","completed"].map(z=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.status.includes(z),onChange:q=>{q.target.checked?C({...v,status:[...v.status,z]}):C({...v,status:v.status.filter(M=>M!==z)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm text-gray-700 capitalize",children:z.replace("_"," ")})]},z))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),i.jsx("div",{className:"space-y-2",children:["urgent","high","medium","low"].map(z=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.priority.includes(z),onChange:q=>{q.target.checked?C({...v,priority:[...v.priority,z]}):C({...v,priority:v.priority.filter(M=>M!==z)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm text-gray-700 capitalize",children:z})]},z))})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{onClick:()=>C({...v,status:[],priority:[],assignedTo:[]}),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Clear All Filters"})})]})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:s.length===0?i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(eo,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tasks found"}),i.jsx("p",{className:"text-gray-600 mb-6",children:c||v.status.length>0||v.priority.length>0?"Try adjusting your filters or search query":"Create your first task to get started"}),!c&&v.status.length===0&&i.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Create Task"]})]}):s.map(z=>i.jsx("div",{className:"p-4 hover:bg-gray-50 transition cursor-pointer",onClick:()=>{d(z),g(!0)},children:i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:"mt-1",children:L(z.priority)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx("h3",{className:"font-medium text-gray-900 truncate",children:z.title}),z.attachment_urls.length>0&&i.jsx(jo,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]}),z.description&&i.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:z.description}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2",children:[T(z.status),i.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx(ha,{className:"w-4 h-4"}),P(z.deadline)]}),z.comment_count>0&&i.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx(lh,{className:"w-4 h-4"}),z.comment_count]}),z.inquiry_number&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[i.jsx(ob,{className:"w-3 h-3"}),z.inquiry_number]}),z.customer_name&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[i.jsx(Bo,{className:"w-3 h-3"}),z.customer_name]}),z.tags.length>0&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[i.jsx(hg,{className:"w-3 h-3"}),z.tags[0],z.tags.length>1&&` +${z.tags.length-1}`]})]})]})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:q=>{q.stopPropagation(),b(p===z.id?null:z.id)},className:"p-1 hover:bg-gray-100 rounded transition",children:i.jsx(gO,{className:"w-5 h-5 text-gray-600"})}),p===z.id&&i.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[i.jsxs("button",{onClick:q=>{q.stopPropagation(),d(z),g(!0),b(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(oh,{className:"w-4 h-4"}),"View Details"]}),(z.created_by===(e==null?void 0:e.id)||(t==null?void 0:t.role)==="admin")&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:q=>{q.stopPropagation(),b(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(so,{className:"w-4 h-4"}),"Edit Task"]}),i.jsxs("button",{onClick:q=>{q.stopPropagation(),R(z.id),b(null)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(ks,{className:"w-4 h-4"}),"Delete Task"]})]})]})]})]})},z.id))})]})]}),y&&i.jsx(d6,{isOpen:y,onClose:()=>m(!1),onSuccess:()=>{m(!1),I()}}),x&&h&&i.jsx(Sz,{isOpen:x,onClose:()=>{g(!1),d(null)},taskId:h.id,onUpdate:I})]})}const Ez="modulepreload",Fz=function(e){return"/"+e},rC={},cv=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Fz(c),c in rC)return;rC[c]=!0;const A=c.endsWith(".css"),u=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=A?"stylesheet":Ez,A||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),A)return new Promise((h,d)=>{f.addEventListener("load",h),f.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})};function Lr(e){"@babel/helpers - typeof";return Lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lr(e)}var io=Uint8Array,ei=Uint16Array,Xb=Int32Array,Yb=new io([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jb=new io([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nC=new io([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),v6=function(e,t){for(var r=new ei(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new Xb(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},y6=v6(Yb,2),jz=y6.b,Bw=y6.r;jz[28]=258,Bw[258]=28;var Tz=v6(Jb,0),sC=Tz.r,Cw=new ei(32768);for(var Jr=0;Jr<32768;++Jr){var Wl=(Jr&43690)>>1|(Jr&21845)<<1;Wl=(Wl&52428)>>2|(Wl&13107)<<2,Wl=(Wl&61680)>>4|(Wl&3855)<<4,Cw[Jr]=((Wl&65280)>>8|(Wl&255)<<8)>>1}var lf=function(e,t,r){for(var n=e.length,s=0,a=new ei(t);s<n;++s)e[s]&&++a[e[s]-1];var o=new ei(t);for(s=1;s<t;++s)o[s]=o[s-1]+a[s-1]<<1;var l;if(r){l=new ei(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var A=s<<4|e[s],u=t-e[s],f=o[e[s]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)l[Cw[f]>>c]=A}else for(l=new ei(n),s=0;s<n;++s)e[s]&&(l[s]=Cw[o[e[s]-1]++]>>15-e[s]);return l},QA=new io(288);for(var Jr=0;Jr<144;++Jr)QA[Jr]=8;for(var Jr=144;Jr<256;++Jr)QA[Jr]=9;for(var Jr=256;Jr<280;++Jr)QA[Jr]=7;for(var Jr=280;Jr<288;++Jr)QA[Jr]=8;var kg=new io(32);for(var Jr=0;Jr<32;++Jr)kg[Jr]=5;var Iz=lf(QA,9,0),Uz=lf(kg,5,0),w6=function(e){return(e+7)/8|0},Lz=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new io(e.subarray(t,r))},el=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},w0=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Av=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,a=r.slice();if(!s)return{t:_6,l:0};if(s==1){var o=new io(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(C,k){return C.f-k.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],A=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=r[r[A].f<r[f].f?A++:f++],c=r[A!=u&&r[A].f<r[f].f?A++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var h=a[0].s,n=1;n<s;++n)a[n].s>h&&(h=a[n].s);var d=new ei(h+1),x=Nw(r[u-1],d,0);if(x>t){var n=0,g=0,y=x-t,m=1<<y;for(a.sort(function(k,S){return d[S.s]-d[k.s]||k.f-S.f});n<s;++n){var p=a[n].s;if(d[p]>t)g+=m-(1<<x-d[p]),d[p]=t;else break}for(g>>=y;g>0;){var b=a[n].s;d[b]<t?g-=1<<t-d[b]++-1:++n}for(;n>=0&&g;--n){var v=a[n].s;d[v]==t&&(--d[v],++g)}x=t}return{t:new io(d),l:x}},Nw=function(e,t,r){return e.s==-1?Math.max(Nw(e.l,t,r+1),Nw(e.r,t,r+1)):t[e.s]=r},aC=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ei(++t),n=0,s=e[0],a=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++a;else{if(!s&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(s),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(s);a=1,s=e[l]}return{c:r.subarray(0,n),n:t}},b0=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},b6=function(e,t,r){var n=r.length,s=w6(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var a=0;a<n;++a)e[s+a+4]=r[a];return(s+4+n)*8},iC=function(e,t,r,n,s,a,o,l,c,A,u){el(t,u++,r),++s[256];for(var f=Av(s,15),h=f.t,d=f.l,x=Av(a,15),g=x.t,y=x.l,m=aC(h),p=m.c,b=m.n,v=aC(g),C=v.c,k=v.n,S=new ei(19),I=0;I<p.length;++I)++S[p[I]&31];for(var I=0;I<C.length;++I)++S[C[I]&31];for(var N=Av(S,7),Q=N.t,L=N.l,T=19;T>4&&!Q[nC[T-1]];--T);var P=A+5<<3,R=b0(s,QA)+b0(a,kg)+o,z=b0(s,h)+b0(a,g)+o+14+3*T+b0(S,Q)+2*S[16]+3*S[17]+7*S[18];if(c>=0&&P<=R&&P<=z)return b6(t,u,e.subarray(c,c+A));var q,M,V,H;if(el(t,u,1+(z<R)),u+=2,z<R){q=lf(h,d,0),M=h,V=lf(g,y,0),H=g;var se=lf(Q,L,0);el(t,u,b-257),el(t,u+5,k-1),el(t,u+10,T-4),u+=14;for(var I=0;I<T;++I)el(t,u+3*I,Q[nC[I]]);u+=3*T;for(var ce=[p,C],B=0;B<2;++B)for(var U=ce[B],I=0;I<U.length;++I){var F=U[I]&31;el(t,u,se[F]),u+=Q[F],F>15&&(el(t,u,U[I]>>5&127),u+=U[I]>>12)}}else q=Iz,M=QA,V=Uz,H=kg;for(var I=0;I<l;++I){var D=n[I];if(D>255){var F=D>>18&31;w0(t,u,q[F+257]),u+=M[F+257],F>7&&(el(t,u,D>>23&31),u+=Yb[F]);var X=D&31;w0(t,u,V[X]),u+=H[X],X>3&&(w0(t,u,D>>5&8191),u+=Jb[X])}else w0(t,u,q[D]),u+=M[D]}return w0(t,u,q[256]),u+M[256]},Dz=new Xb([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_6=new io(0),Pz=function(e,t,r,n,s,a){var o=a.z||e.length,l=new io(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),A=a.l,u=(a.r||0)&7;if(t){u&&(c[0]=a.r>>3);for(var f=Dz[t-1],h=f>>13,d=f&8191,x=(1<<r)-1,g=a.p||new ei(32768),y=a.h||new ei(x+1),m=Math.ceil(r/3),p=2*m,b=function(Je){return(e[Je]^e[Je+1]<<m^e[Je+2]<<p)&x},v=new Xb(25e3),C=new ei(288),k=new ei(32),S=0,I=0,N=a.i||0,Q=0,L=a.w||0,T=0;N+2<o;++N){var P=b(N),R=N&32767,z=y[P];if(g[R]=z,y[P]=R,L<=N){var q=o-N;if((S>7e3||Q>24576)&&(q>423||!A)){u=iC(e,c,0,v,C,k,I,Q,T,N-T,u),Q=S=I=0,T=N;for(var M=0;M<286;++M)C[M]=0;for(var M=0;M<30;++M)k[M]=0}var V=2,H=0,se=d,ce=R-z&32767;if(q>2&&P==b(N-ce))for(var B=Math.min(h,q)-1,U=Math.min(32767,N),F=Math.min(258,q);ce<=U&&--se&&R!=z;){if(e[N+V]==e[N+V-ce]){for(var D=0;D<F&&e[N+D]==e[N+D-ce];++D);if(D>V){if(V=D,H=ce,D>B)break;for(var X=Math.min(ce,D-2),K=0,M=0;M<X;++M){var ae=N-ce+M&32767,he=g[ae],Y=ae-he&32767;Y>K&&(K=Y,z=ae)}}}R=z,z=g[R],ce+=R-z&32767}if(H){v[Q++]=268435456|Bw[V]<<18|sC[H];var Be=Bw[V]&31,ee=sC[H]&31;I+=Yb[Be]+Jb[ee],++C[257+Be],++k[ee],L=N+V,++S}else v[Q++]=e[N],++C[e[N]]}}for(N=Math.max(N,L);N<o;++N)v[Q++]=e[N],++C[e[N]];u=iC(e,c,A,v,C,k,I,Q,T,N-T,u),A||(a.r=u&7|c[u/8|0]<<3,u-=7,a.h=y,a.p=g,a.i=N,a.w=L)}else{for(var N=a.w||0;N<o+A;N+=65535){var Te=N+65535;Te>=o&&(c[u/8|0]=A,Te=o),u=b6(c,u+1,e.subarray(N,Te))}a.i=o}return Lz(l,0,n+w6(u)+s)},B6=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,a=r.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},Oz=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),o=new io(a.length+e.length);o.set(a),o.set(e,a.length),e=o,s.w=a.length}return Pz(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},C6=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Rz=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=B6();s.p(t.dictionary),C6(e,2,s.d())}};function Sw(e,t){t||(t={});var r=B6();r.p(e);var n=Oz(e,t,t.dictionary?6:2,4);return Rz(n,t),C6(n,n.length-4,r.d()),n}var Qz=typeof TextDecoder<"u"&&new TextDecoder,Mz=0;try{Qz.decode(_6,{stream:!0}),Mz=1}catch{}function Hz(e){if(Array.isArray(e))return e}function Kz(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,a,o,l=[],c=!0,A=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){A=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(A)throw s}}return l}}function oC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function qz(e,t){if(e){if(typeof e=="string")return oC(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oC(e,t):void 0}}function Vz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lC(e,t){return Hz(e)||Kz(e,t)||qz(e,t)||Vz()}function cC(e,t="utf8"){return new TextDecoder(t).decode(e)}const Gz=new TextEncoder;function Wz(e){return Gz.encode(e)}const $z=1024*8,zz=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),uv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Zb{constructor(t=$z,r={}){Tr(this,"buffer");Tr(this,"byteLength");Tr(this,"byteOffset");Tr(this,"length");Tr(this,"offset");Tr(this,"lastWrittenByte");Tr(this,"littleEndian");Tr(this,"_data");Tr(this,"_mark");Tr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,a=t.byteLength-s;let o=s;(ArrayBuffer.isView(t)||t instanceof Zb)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=uv[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===zz&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new uv[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new uv[r](a);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return cC(this.readBytes(t))}decodeText(t=1,r="utf8"){return cC(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Wz(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Ud(e){let t=e.length;for(;--t>=0;)e[t]=0}const Xz=3,Yz=258,N6=29,Jz=256,Zz=Jz+1+N6,S6=30,eX=512,tX=new Array((Zz+2)*2);Ud(tX);const rX=new Array(S6*2);Ud(rX);const nX=new Array(eX);Ud(nX);const sX=new Array(Yz-Xz+1);Ud(sX);const aX=new Array(N6);Ud(aX);const iX=new Array(S6);Ud(iX);const oX=(e,t,r,n)=>{let s=e&65535|0,a=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+t[n++]|0,a=a+s|0;while(--o);s%=65521,a%=65521}return s|a<<16|0};var kw=oX;const lX=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},cX=new Uint32Array(lX()),AX=(e,t,r,n)=>{const s=cX,a=n+r;e^=-1;for(let o=n;o<a;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var xo=AX,Ew={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},k6={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const uX=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var dX=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)uX(r,n)&&(e[n]=r[n])}}return e},fX=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,a=e.length;n<a;n++){let o=e[n];r.set(o,s),s+=o.length}return r},E6={assign:dX,flattenChunks:fX};let F6=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{F6=!1}const Xf=new Uint8Array(256);for(let e=0;e<256;e++)Xf[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Xf[254]=Xf[254]=1;var hX=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,a,o=e.length,l=0;for(s=0;s<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),a=0,s=0;a<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t};const pX=(e,t)=>{if(t<65534&&e.subarray&&F6)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var mX=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let o=e[n++];if(o<128){a[s++]=o;continue}let l=Xf[o];if(l>4){a[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){a[s++]=65533;continue}o<65536?a[s++]=o:(o-=65536,a[s++]=55296|o>>10&1023,a[s++]=56320|o&1023)}return pX(a,s)},gX=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Xf[e[r]]>t?r:t},Fw={string2buf:hX,buf2string:mX,utf8border:gX};function xX(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var vX=xX;const Dp=16209,yX=16191;var wX=function(t,r){let n,s,a,o,l,c,A,u,f,h,d,x,g,y,m,p,b,v,C,k,S,I,N,Q;const L=t.state;n=t.next_in,N=t.input,s=n+(t.avail_in-5),a=t.next_out,Q=t.output,o=a-(r-t.avail_out),l=a+(t.avail_out-257),c=L.dmax,A=L.wsize,u=L.whave,f=L.wnext,h=L.window,d=L.hold,x=L.bits,g=L.lencode,y=L.distcode,m=(1<<L.lenbits)-1,p=(1<<L.distbits)-1;e:do{x<15&&(d+=N[n++]<<x,x+=8,d+=N[n++]<<x,x+=8),b=g[d&m];t:for(;;){if(v=b>>>24,d>>>=v,x-=v,v=b>>>16&255,v===0)Q[a++]=b&65535;else if(v&16){C=b&65535,v&=15,v&&(x<v&&(d+=N[n++]<<x,x+=8),C+=d&(1<<v)-1,d>>>=v,x-=v),x<15&&(d+=N[n++]<<x,x+=8,d+=N[n++]<<x,x+=8),b=y[d&p];r:for(;;){if(v=b>>>24,d>>>=v,x-=v,v=b>>>16&255,v&16){if(k=b&65535,v&=15,x<v&&(d+=N[n++]<<x,x+=8,x<v&&(d+=N[n++]<<x,x+=8)),k+=d&(1<<v)-1,k>c){t.msg="invalid distance too far back",L.mode=Dp;break e}if(d>>>=v,x-=v,v=a-o,k>v){if(v=k-v,v>u&&L.sane){t.msg="invalid distance too far back",L.mode=Dp;break e}if(S=0,I=h,f===0){if(S+=A-v,v<C){C-=v;do Q[a++]=h[S++];while(--v);S=a-k,I=Q}}else if(f<v){if(S+=A+f-v,v-=f,v<C){C-=v;do Q[a++]=h[S++];while(--v);if(S=0,f<C){v=f,C-=v;do Q[a++]=h[S++];while(--v);S=a-k,I=Q}}}else if(S+=f-v,v<C){C-=v;do Q[a++]=h[S++];while(--v);S=a-k,I=Q}for(;C>2;)Q[a++]=I[S++],Q[a++]=I[S++],Q[a++]=I[S++],C-=3;C&&(Q[a++]=I[S++],C>1&&(Q[a++]=I[S++]))}else{S=a-k;do Q[a++]=Q[S++],Q[a++]=Q[S++],Q[a++]=Q[S++],C-=3;while(C>2);C&&(Q[a++]=Q[S++],C>1&&(Q[a++]=Q[S++]))}}else if(v&64){t.msg="invalid distance code",L.mode=Dp;break e}else{b=y[(b&65535)+(d&(1<<v)-1)];continue r}break}}else if(v&64)if(v&32){L.mode=yX;break e}else{t.msg="invalid literal/length code",L.mode=Dp;break e}else{b=g[(b&65535)+(d&(1<<v)-1)];continue t}break}}while(n<s&&a<l);C=x>>3,n-=C,x-=C<<3,d&=(1<<x)-1,t.next_in=n,t.next_out=a,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=a<l?257+(l-a):257-(a-l),L.hold=d,L.bits=x};const gu=15,AC=852,uC=592,dC=0,dv=1,fC=2,bX=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_X=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),BX=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),CX=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),NX=(e,t,r,n,s,a,o,l)=>{const c=l.bits;let A=0,u=0,f=0,h=0,d=0,x=0,g=0,y=0,m=0,p=0,b,v,C,k,S,I=null,N;const Q=new Uint16Array(gu+1),L=new Uint16Array(gu+1);let T=null,P,R,z;for(A=0;A<=gu;A++)Q[A]=0;for(u=0;u<n;u++)Q[t[r+u]]++;for(d=c,h=gu;h>=1&&Q[h]===0;h--);if(d>h&&(d=h),h===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&Q[f]===0;f++);for(d<f&&(d=f),y=1,A=1;A<=gu;A++)if(y<<=1,y-=Q[A],y<0)return-1;if(y>0&&(e===dC||h!==1))return-1;for(L[1]=0,A=1;A<gu;A++)L[A+1]=L[A]+Q[A];for(u=0;u<n;u++)t[r+u]!==0&&(o[L[t[r+u]]++]=u);if(e===dC?(I=T=o,N=20):e===dv?(I=bX,T=_X,N=257):(I=BX,T=CX,N=0),p=0,u=0,A=f,S=a,x=d,g=0,C=-1,m=1<<d,k=m-1,e===dv&&m>AC||e===fC&&m>uC)return 1;for(;;){P=A-g,o[u]+1<N?(R=0,z=o[u]):o[u]>=N?(R=T[o[u]-N],z=I[o[u]-N]):(R=96,z=0),b=1<<A-g,v=1<<x,f=v;do v-=b,s[S+(p>>g)+v]=P<<24|R<<16|z|0;while(v!==0);for(b=1<<A-1;p&b;)b>>=1;if(b!==0?(p&=b-1,p+=b):p=0,u++,--Q[A]===0){if(A===h)break;A=t[r+o[u]]}if(A>d&&(p&k)!==C){for(g===0&&(g=d),S+=f,x=A-g,y=1<<x;x+g<h&&(y-=Q[x+g],!(y<=0));)x++,y<<=1;if(m+=1<<x,e===dv&&m>AC||e===fC&&m>uC)return 1;C=p&k,s[C]=d<<24|x<<16|S-a|0}}return p!==0&&(s[S+p]=A-g<<24|64<<16|0),l.bits=d,0};var cf=NX;const SX=0,j6=1,T6=2,{Z_FINISH:hC,Z_BLOCK:kX,Z_TREES:Pp,Z_OK:MA,Z_STREAM_END:EX,Z_NEED_DICT:FX,Z_STREAM_ERROR:Ti,Z_DATA_ERROR:I6,Z_MEM_ERROR:U6,Z_BUF_ERROR:jX,Z_DEFLATED:pC}=k6,px=16180,mC=16181,gC=16182,xC=16183,vC=16184,yC=16185,wC=16186,bC=16187,_C=16188,BC=16189,Eg=16190,tl=16191,fv=16192,CC=16193,hv=16194,NC=16195,SC=16196,kC=16197,EC=16198,Op=16199,Rp=16200,FC=16201,jC=16202,TC=16203,IC=16204,UC=16205,pv=16206,LC=16207,DC=16208,rn=16209,L6=16210,D6=16211,TX=852,IX=592,UX=15,LX=UX,PC=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function DX(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const XA=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<px||t.mode>D6?1:0},P6=e=>{if(XA(e))return Ti;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=px,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(TX),t.distcode=t.distdyn=new Int32Array(IX),t.sane=1,t.back=-1,MA},O6=e=>{if(XA(e))return Ti;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,P6(e)},R6=(e,t)=>{let r;if(XA(e))return Ti;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ti:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,O6(e))},Q6=(e,t)=>{if(!e)return Ti;const r=new DX;e.state=r,r.strm=e,r.window=null,r.mode=px;const n=R6(e,t);return n!==MA&&(e.state=null),n},PX=e=>Q6(e,LX);let OC=!0,mv,gv;const OX=e=>{if(OC){mv=new Int32Array(512),gv=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(cf(j6,e.lens,0,288,mv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;cf(T6,e.lens,0,32,gv,0,e.work,{bits:5}),OC=!1}e.lencode=mv,e.lenbits=9,e.distcode=gv,e.distbits=5},M6=(e,t,r,n)=>{let s;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(t.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},RX=(e,t)=>{let r,n,s,a,o,l,c,A,u,f,h,d,x,g,y=0,m,p,b,v,C,k,S,I;const N=new Uint8Array(4);let Q,L;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(XA(e)||!e.output||!e.input&&e.avail_in!==0)return Ti;r=e.state,r.mode===tl&&(r.mode=fv),o=e.next_out,s=e.output,c=e.avail_out,a=e.next_in,n=e.input,l=e.avail_in,A=r.hold,u=r.bits,f=l,h=c,I=MA;e:for(;;)switch(r.mode){case px:if(r.wrap===0){r.mode=fv;break}for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&2&&A===35615){r.wbits===0&&(r.wbits=15),r.check=0,N[0]=A&255,N[1]=A>>>8&255,r.check=xo(r.check,N,2,0),A=0,u=0,r.mode=mC;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((A&255)<<8)+(A>>8))%31){e.msg="incorrect header check",r.mode=rn;break}if((A&15)!==pC){e.msg="unknown compression method",r.mode=rn;break}if(A>>>=4,u-=4,S=(A&15)+8,r.wbits===0&&(r.wbits=S),S>15||S>r.wbits){e.msg="invalid window size",r.mode=rn;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=A&512?BC:tl,A=0,u=0;break;case mC:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.flags=A,(r.flags&255)!==pC){e.msg="unknown compression method",r.mode=rn;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=rn;break}r.head&&(r.head.text=A>>8&1),r.flags&512&&r.wrap&4&&(N[0]=A&255,N[1]=A>>>8&255,r.check=xo(r.check,N,2,0)),A=0,u=0,r.mode=gC;case gC:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.time=A),r.flags&512&&r.wrap&4&&(N[0]=A&255,N[1]=A>>>8&255,N[2]=A>>>16&255,N[3]=A>>>24&255,r.check=xo(r.check,N,4,0)),A=0,u=0,r.mode=xC;case xC:for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=A&255,r.head.os=A>>8),r.flags&512&&r.wrap&4&&(N[0]=A&255,N[1]=A>>>8&255,r.check=xo(r.check,N,2,0)),A=0,u=0,r.mode=vC;case vC:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length=A,r.head&&(r.head.extra_len=A),r.flags&512&&r.wrap&4&&(N[0]=A&255,N[1]=A>>>8&255,r.check=xo(r.check,N,2,0)),A=0,u=0}else r.head&&(r.head.extra=null);r.mode=yC;case yC:if(r.flags&1024&&(d=r.length,d>l&&(d=l),d&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+d),S)),r.flags&512&&r.wrap&4&&(r.check=xo(r.check,n,d,a)),l-=d,a+=d,r.length-=d),r.length))break e;r.length=0,r.mode=wC;case wC:if(r.flags&2048){if(l===0)break e;d=0;do S=n[a+d++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S));while(S&&d<l);if(r.flags&512&&r.wrap&4&&(r.check=xo(r.check,n,d,a)),l-=d,a+=d,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=bC;case bC:if(r.flags&4096){if(l===0)break e;d=0;do S=n[a+d++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S));while(S&&d<l);if(r.flags&512&&r.wrap&4&&(r.check=xo(r.check,n,d,a)),l-=d,a+=d,S)break e}else r.head&&(r.head.comment=null);r.mode=_C;case _C:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.check&65535)){e.msg="header crc mismatch",r.mode=rn;break}A=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=tl;break;case BC:for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}e.adler=r.check=PC(A),A=0,u=0,r.mode=Eg;case Eg:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,r.hold=A,r.bits=u,FX;e.adler=r.check=1,r.mode=tl;case tl:if(t===kX||t===Pp)break e;case fv:if(r.last){A>>>=u&7,u-=u&7,r.mode=pv;break}for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}switch(r.last=A&1,A>>>=1,u-=1,A&3){case 0:r.mode=CC;break;case 1:if(OX(r),r.mode=Op,t===Pp){A>>>=2,u-=2;break e}break;case 2:r.mode=SC;break;case 3:e.msg="invalid block type",r.mode=rn}A>>>=2,u-=2;break;case CC:for(A>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if((A&65535)!==(A>>>16^65535)){e.msg="invalid stored block lengths",r.mode=rn;break}if(r.length=A&65535,A=0,u=0,r.mode=hv,t===Pp)break e;case hv:r.mode=NC;case NC:if(d=r.length,d){if(d>l&&(d=l),d>c&&(d=c),d===0)break e;s.set(n.subarray(a,a+d),o),l-=d,a+=d,c-=d,o+=d,r.length-=d;break}r.mode=tl;break;case SC:for(;u<14;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.nlen=(A&31)+257,A>>>=5,u-=5,r.ndist=(A&31)+1,A>>>=5,u-=5,r.ncode=(A&15)+4,A>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=rn;break}r.have=0,r.mode=kC;case kC:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.lens[T[r.have++]]=A&7,A>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Q={bits:r.lenbits},I=cf(SX,r.lens,0,19,r.lencode,0,r.work,Q),r.lenbits=Q.bits,I){e.msg="invalid code lengths set",r.mode=rn;break}r.have=0,r.mode=EC;case EC:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[A&(1<<r.lenbits)-1],m=y>>>24,p=y>>>16&255,b=y&65535,!(m<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(b<16)A>>>=m,u-=m,r.lens[r.have++]=b;else{if(b===16){for(L=m+2;u<L;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(A>>>=m,u-=m,r.have===0){e.msg="invalid bit length repeat",r.mode=rn;break}S=r.lens[r.have-1],d=3+(A&3),A>>>=2,u-=2}else if(b===17){for(L=m+3;u<L;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=m,u-=m,S=0,d=3+(A&7),A>>>=3,u-=3}else{for(L=m+7;u<L;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=m,u-=m,S=0,d=11+(A&127),A>>>=7,u-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=rn;break}for(;d--;)r.lens[r.have++]=S}}if(r.mode===rn)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=rn;break}if(r.lenbits=9,Q={bits:r.lenbits},I=cf(j6,r.lens,0,r.nlen,r.lencode,0,r.work,Q),r.lenbits=Q.bits,I){e.msg="invalid literal/lengths set",r.mode=rn;break}if(r.distbits=6,r.distcode=r.distdyn,Q={bits:r.distbits},I=cf(T6,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Q),r.distbits=Q.bits,I){e.msg="invalid distances set",r.mode=rn;break}if(r.mode=Op,t===Pp)break e;case Op:r.mode=Rp;case Rp:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,r.hold=A,r.bits=u,wX(e,h),o=e.next_out,s=e.output,c=e.avail_out,a=e.next_in,n=e.input,l=e.avail_in,A=r.hold,u=r.bits,r.mode===tl&&(r.back=-1);break}for(r.back=0;y=r.lencode[A&(1<<r.lenbits)-1],m=y>>>24,p=y>>>16&255,b=y&65535,!(m<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(p&&!(p&240)){for(v=m,C=p,k=b;y=r.lencode[k+((A&(1<<v+C)-1)>>v)],m=y>>>24,p=y>>>16&255,b=y&65535,!(v+m<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=v,u-=v,r.back+=v}if(A>>>=m,u-=m,r.back+=m,r.length=b,p===0){r.mode=UC;break}if(p&32){r.back=-1,r.mode=tl;break}if(p&64){e.msg="invalid literal/length code",r.mode=rn;break}r.extra=p&15,r.mode=FC;case FC:if(r.extra){for(L=r.extra;u<L;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.length+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=jC;case jC:for(;y=r.distcode[A&(1<<r.distbits)-1],m=y>>>24,p=y>>>16&255,b=y&65535,!(m<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(!(p&240)){for(v=m,C=p,k=b;y=r.distcode[k+((A&(1<<v+C)-1)>>v)],m=y>>>24,p=y>>>16&255,b=y&65535,!(v+m<=u);){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}A>>>=v,u-=v,r.back+=v}if(A>>>=m,u-=m,r.back+=m,p&64){e.msg="invalid distance code",r.mode=rn;break}r.offset=b,r.extra=p&15,r.mode=TC;case TC:if(r.extra){for(L=r.extra;u<L;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}r.offset+=A&(1<<r.extra)-1,A>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=rn;break}r.mode=IC;case IC:if(c===0)break e;if(d=h-c,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=rn;break}d>r.wnext?(d-=r.wnext,x=r.wsize-d):x=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=s,x=o-r.offset,d=r.length;d>c&&(d=c),c-=d,r.length-=d;do s[o++]=g[x++];while(--d);r.length===0&&(r.mode=Rp);break;case UC:if(c===0)break e;s[o++]=r.length,c--,r.mode=Rp;break;case pv:if(r.wrap){for(;u<32;){if(l===0)break e;l--,A|=n[a++]<<u,u+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?xo(r.check,s,h,o-h):kw(r.check,s,h,o-h)),h=c,r.wrap&4&&(r.flags?A:PC(A))!==r.check){e.msg="incorrect data check",r.mode=rn;break}A=0,u=0}r.mode=LC;case LC:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,A+=n[a++]<<u,u+=8}if(r.wrap&4&&A!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=rn;break}A=0,u=0}r.mode=DC;case DC:I=EX;break e;case rn:I=I6;break e;case L6:return U6;case D6:default:return Ti}return e.next_out=o,e.avail_out=c,e.next_in=a,e.avail_in=l,r.hold=A,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<rn&&(r.mode<pv||t!==hC))&&M6(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?xo(r.check,s,h,e.next_out-h):kw(r.check,s,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===tl?128:0)+(r.mode===Op||r.mode===hv?256:0),(f===0&&h===0||t===hC)&&I===MA&&(I=jX),I},QX=e=>{if(XA(e))return Ti;let t=e.state;return t.window&&(t.window=null),e.state=null,MA},MX=(e,t)=>{if(XA(e))return Ti;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,MA):Ti},HX=(e,t)=>{const r=t.length;let n,s,a;return XA(e)||(n=e.state,n.wrap!==0&&n.mode!==Eg)?Ti:n.mode===Eg&&(s=1,s=kw(s,t,r,0),s!==n.check)?I6:(a=M6(e,t,r,r),a?(n.mode=L6,U6):(n.havedict=1,MA))};var KX=O6,qX=R6,VX=P6,GX=PX,WX=Q6,$X=RX,zX=QX,XX=MX,YX=HX,JX="pako inflate (from Nodeca project)",ll={inflateReset:KX,inflateReset2:qX,inflateResetKeep:VX,inflateInit:GX,inflateInit2:WX,inflate:$X,inflateEnd:zX,inflateGetHeader:XX,inflateSetDictionary:YX,inflateInfo:JX};function ZX(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var eY=ZX;const H6=Object.prototype.toString,{Z_NO_FLUSH:tY,Z_FINISH:rY,Z_OK:Yf,Z_STREAM_END:xv,Z_NEED_DICT:vv,Z_STREAM_ERROR:nY,Z_DATA_ERROR:RC,Z_MEM_ERROR:sY}=k6;function gh(e){this.options=E6.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vX,this.strm.avail_out=0;let r=ll.inflateInit2(this.strm,t.windowBits);if(r!==Yf)throw new Error(Ew[r]);if(this.header=new eY,ll.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Fw.string2buf(t.dictionary):H6.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ll.inflateSetDictionary(this.strm,t.dictionary),r!==Yf)))throw new Error(Ew[r])}gh.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?rY:tY,H6.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=ll.inflate(r,o),a===vv&&s&&(a=ll.inflateSetDictionary(r,s),a===Yf?a=ll.inflate(r,o):a===RC&&(a=vv));r.avail_in>0&&a===xv&&r.state.wrap>0&&e[r.next_in]!==0;)ll.inflateReset(r),a=ll.inflate(r,o);switch(a){case nY:case RC:case vv:case sY:return this.onEnd(a),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||a===xv))if(this.options.to==="string"){let c=Fw.utf8border(r.output,r.next_out),A=r.next_out-c,u=Fw.buf2string(r.output,c);r.next_out=A,r.avail_out=n-A,A&&r.output.set(r.output.subarray(c,c+A),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===Yf&&l===0)){if(a===xv)return a=ll.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};gh.prototype.onData=function(e){this.chunks.push(e)};gh.prototype.onEnd=function(e){e===Yf&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E6.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function aY(e,t){const r=new gh(t);if(r.push(e),r.err)throw r.msg||Ew[r.err];return r.result}var iY=gh,oY=aY,lY={Inflate:iY,inflate:oY};const{Inflate:cY,inflate:AY}=lY;var QC=cY,uY=AY;const K6=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;K6[e]=t}const MC=4294967295;function dY(e,t,r){let n=e;for(let s=0;s<r;s++)n=K6[(n^t[s])&255]^n>>>8;return n}function fY(e,t){return(dY(MC,e,t)^MC)>>>0}function HC(e,t,r){const n=e.readUint32(),s=fY(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function q6(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function V6(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function G6(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function W6(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+(t[a-s]>>1)&255}else{for(;a<s;a++)t[a]=e[a]+(r[a]>>1)&255;for(;a<n;a++)t[a]=e[a]+(t[a-s]+r[a]>>1)&255}}function $6(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+t[a-s]&255}else{for(;a<s;a++)t[a]=e[a]+r[a]&255;for(;a<n;a++)t[a]=e[a]+hY(t[a-s],r[a],r[a-s])&255}}function hY(e,t,r){const n=e+t-r,s=Math.abs(n-e),a=Math.abs(n-t),o=Math.abs(n-r);return s<=a&&s<=o?e:a<=o?t:r}function pY(e,t,r,n,s,a){switch(e){case 0:q6(t,r,s);break;case 1:V6(t,r,s,a);break;case 2:G6(t,r,n,s);break;case 3:W6(t,r,n,s,a);break;case 4:$6(t,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${e}`)}}const mY=new Uint16Array([255]),gY=new Uint8Array(mY.buffer),xY=gY[0]===255;function vY(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(a/8)*s,c=new Uint8Array(n*r*l);let A=0;for(let u=0;u<7;u++){const f=o[u],h=Math.ceil((r-f.x)/f.xStep),d=Math.ceil((n-f.y)/f.yStep);if(h<=0||d<=0)continue;const x=h*l,g=new Uint8Array(x);for(let y=0;y<d;y++){const m=t[A++],p=t.subarray(A,A+x);A+=x;const b=new Uint8Array(x);pY(m,p,b,g,x,l),g.set(b);for(let v=0;v<h;v++){const C=f.x+v*f.xStep,k=f.y+y*f.yStep;if(!(C>=r||k>=n))for(let S=0;S<l;S++)c[(k*r+C)*l+S]=b[v*l+S]}}}if(a===16){const u=new Uint16Array(c.buffer);if(xY)for(let f=0;f<u.length;f++)u[f]=yY(u[f]);return u}else return c}function yY(e){return(e&255)<<8|e>>8&255}const wY=new Uint16Array([255]),bY=new Uint8Array(wY.buffer),_Y=bY[0]===255,BY=new Uint8Array(0);function KC(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,o=Math.ceil(a/8)*s,l=Math.ceil(a/8*s*r),c=new Uint8Array(n*l);let A=BY,u=0,f,h;for(let d=0;d<n;d++){switch(f=t.subarray(u+1,u+1+l),h=c.subarray(d*l,(d+1)*l),t[u]){case 0:q6(f,h,l);break;case 1:V6(f,h,l,o);break;case 2:G6(f,h,A,l);break;case 3:W6(f,h,A,l,o);break;case 4:$6(f,h,A,l,o);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}A=h,u+=l+1}if(a===16){const d=new Uint16Array(c.buffer);if(_Y)for(let x=0;x<d.length;x++)d[x]=CY(d[x]);return d}else return c}function CY(e){return(e&255)<<8|e>>8&255}const km=Uint8Array.of(137,80,78,71,13,10,26,10);function qC(e){if(!NY(e.readBytes(km.length)))throw new Error("wrong PNG signature")}function NY(e){if(e.length<km.length)return!1;for(let t=0;t<km.length;t++)if(e[t]!==km[t])return!1;return!0}const SY="tEXt",kY=0,z6=new TextDecoder("latin1");function EY(e){if(jY(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const FY=/^[\u0000-\u00FF]*$/;function jY(e){if(!FY.test(e))throw new Error("invalid latin1 text")}function TY(e,t,r){const n=X6(t);e[n]=IY(t,r-n.length-1)}function X6(e){for(e.mark();e.readByte()!==kY;);const t=e.offset;e.reset();const r=z6.decode(e.readBytes(t-e.offset-1));return e.skip(1),EY(r),r}function IY(e,t){return z6.decode(e.readBytes(t))}const Ka={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},yv={UNKNOWN:-1,DEFLATE:0},VC={UNKNOWN:-1,ADAPTIVE:0},wv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Qp={NONE:0,BACKGROUND:1,PREVIOUS:2},bv={SOURCE:0,OVER:1};class UY extends Zb{constructor(r,n={}){super(r);Tr(this,"_checkCrc");Tr(this,"_inflator");Tr(this,"_png");Tr(this,"_apng");Tr(this,"_end");Tr(this,"_hasPalette");Tr(this,"_palette");Tr(this,"_hasTransparency");Tr(this,"_transparency");Tr(this,"_compressionMethod");Tr(this,"_filterMethod");Tr(this,"_interlaceMethod");Tr(this,"_colorType");Tr(this,"_isAnimated");Tr(this,"_numberOfFrames");Tr(this,"_numberOfPlays");Tr(this,"_frames");Tr(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new QC,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=yv.UNKNOWN,this._filterMethod=VC.UNKNOWN,this._interlaceMethod=wv.UNKNOWN,this._colorType=Ka.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(qC(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(qC(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case SY:TY(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?HC(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?HC(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=LY(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case Ka.GREYSCALE:s=1;break;case Ka.TRUECOLOUR:s=3;break;case Ka.INDEXED_COLOUR:s=1;break;case Ka.GREYSCALE_ALPHA:s=2;break;case Ka.TRUECOLOUR_ALPHA:s=4;break;case Ka.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==yv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let a=0;a<n;a++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Ka.GREYSCALE:case Ka.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Ka.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Ka.UNKNOWN:case Ka.GREYSCALE_ALPHA:case Ka.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=X6(this),s=this.readUint8();if(s!==yv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:uY(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=KC({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(s,a,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case Qp.NONE:break;case Qp.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let o=0;o<this._png.width;o++){const l=(a*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case Qp.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,a=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,A=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:A}};switch(n.blendOp){case bv.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[A+u]}break;case bv.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:A}=a(o,l);for(let u=0;u<this._png.channels;u++){const f=n.data[A+this._png.channels-1]/s,h=u%(this._png.channels-1)===0?1:n.data[A+u],d=Math.floor(f*h+(1-f)*r.data[c+u]);r.data[c+u]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==VC.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===wv.NO_INTERLACE)this._png.data=KC({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===wv.ADAM7)this._png.data=vY({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Qp.NONE,blendOp:bv.SOURCE,data:r}),this._inflator=new QC,this._writingDataChunks=!1}}function LY(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var GC;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(GC||(GC={}));function DY(e,t){return new UY(e,t).decode()}var Jt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function _v(){Jt.console&&typeof Jt.console.log=="function"&&Jt.console.log.apply(Jt.console,arguments)}var Kr={log:_v,warn:function(e){Jt.console&&(typeof Jt.console.warn=="function"?Jt.console.warn.apply(Jt.console,arguments):_v.call(null,arguments))},error:function(e){Jt.console&&(typeof Jt.console.error=="function"?Jt.console.error.apply(Jt.console,arguments):_v(e))}};function Bv(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){aA(n.response,t,r)},n.onerror=function(){Kr.error("could not download file")},n.send()}function WC(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Mp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var aA=Jt.saveAs||((typeof window>"u"?"undefined":Lr(window))!=="object"||window!==Jt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Jt.URL||Jt.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?WC(s.href)?Bv(e,t,r):Mp(s,s.target="_blank"):Mp(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Mp(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(WC(e))Bv(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Mp(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:Lr(a)!=="object"&&(Kr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Bv(e,t,r);var s=e.type==="application/octet-stream",a=/constructor/i.test(Jt.HTMLElement)||Jt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&a)&&(typeof FileReader>"u"?"undefined":Lr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=Jt.URL||Jt.webkitURL,A=c.createObjectURL(e);n?n.location=A:location.href=A,n=null,setTimeout(function(){c.revokeObjectURL(A)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Y6(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,o=s.exec(e);o&&(t=a(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),A=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),A.length==1&&(A="0"+A),"#"+l+c+A}}var Em=Jt.atob.bind(Jt),$C=Jt.btoa.bind(Jt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Cv(e,t){var r=e[0],n=e[1],s=e[2],a=e[3];r=Ds(r,n,s,a,t[0],7,-680876936),a=Ds(a,r,n,s,t[1],12,-389564586),s=Ds(s,a,r,n,t[2],17,606105819),n=Ds(n,s,a,r,t[3],22,-1044525330),r=Ds(r,n,s,a,t[4],7,-176418897),a=Ds(a,r,n,s,t[5],12,1200080426),s=Ds(s,a,r,n,t[6],17,-1473231341),n=Ds(n,s,a,r,t[7],22,-45705983),r=Ds(r,n,s,a,t[8],7,1770035416),a=Ds(a,r,n,s,t[9],12,-1958414417),s=Ds(s,a,r,n,t[10],17,-42063),n=Ds(n,s,a,r,t[11],22,-1990404162),r=Ds(r,n,s,a,t[12],7,1804603682),a=Ds(a,r,n,s,t[13],12,-40341101),s=Ds(s,a,r,n,t[14],17,-1502002290),r=Ps(r,n=Ds(n,s,a,r,t[15],22,1236535329),s,a,t[1],5,-165796510),a=Ps(a,r,n,s,t[6],9,-1069501632),s=Ps(s,a,r,n,t[11],14,643717713),n=Ps(n,s,a,r,t[0],20,-373897302),r=Ps(r,n,s,a,t[5],5,-701558691),a=Ps(a,r,n,s,t[10],9,38016083),s=Ps(s,a,r,n,t[15],14,-660478335),n=Ps(n,s,a,r,t[4],20,-405537848),r=Ps(r,n,s,a,t[9],5,568446438),a=Ps(a,r,n,s,t[14],9,-1019803690),s=Ps(s,a,r,n,t[3],14,-187363961),n=Ps(n,s,a,r,t[8],20,1163531501),r=Ps(r,n,s,a,t[13],5,-1444681467),a=Ps(a,r,n,s,t[2],9,-51403784),s=Ps(s,a,r,n,t[7],14,1735328473),r=Os(r,n=Ps(n,s,a,r,t[12],20,-1926607734),s,a,t[5],4,-378558),a=Os(a,r,n,s,t[8],11,-2022574463),s=Os(s,a,r,n,t[11],16,1839030562),n=Os(n,s,a,r,t[14],23,-35309556),r=Os(r,n,s,a,t[1],4,-1530992060),a=Os(a,r,n,s,t[4],11,1272893353),s=Os(s,a,r,n,t[7],16,-155497632),n=Os(n,s,a,r,t[10],23,-1094730640),r=Os(r,n,s,a,t[13],4,681279174),a=Os(a,r,n,s,t[0],11,-358537222),s=Os(s,a,r,n,t[3],16,-722521979),n=Os(n,s,a,r,t[6],23,76029189),r=Os(r,n,s,a,t[9],4,-640364487),a=Os(a,r,n,s,t[12],11,-421815835),s=Os(s,a,r,n,t[15],16,530742520),r=Rs(r,n=Os(n,s,a,r,t[2],23,-995338651),s,a,t[0],6,-198630844),a=Rs(a,r,n,s,t[7],10,1126891415),s=Rs(s,a,r,n,t[14],15,-1416354905),n=Rs(n,s,a,r,t[5],21,-57434055),r=Rs(r,n,s,a,t[12],6,1700485571),a=Rs(a,r,n,s,t[3],10,-1894986606),s=Rs(s,a,r,n,t[10],15,-1051523),n=Rs(n,s,a,r,t[1],21,-2054922799),r=Rs(r,n,s,a,t[8],6,1873313359),a=Rs(a,r,n,s,t[15],10,-30611744),s=Rs(s,a,r,n,t[6],15,-1560198380),n=Rs(n,s,a,r,t[13],21,1309151649),r=Rs(r,n,s,a,t[4],6,-145523070),a=Rs(a,r,n,s,t[11],10,-1120210379),s=Rs(s,a,r,n,t[2],15,718787259),n=Rs(n,s,a,r,t[9],21,-343485551),e[0]=lc(r,e[0]),e[1]=lc(n,e[1]),e[2]=lc(s,e[2]),e[3]=lc(a,e[3])}function mx(e,t,r,n,s,a){return t=lc(lc(t,e),lc(n,a)),lc(t<<s|t>>>32-s,r)}function Ds(e,t,r,n,s,a,o){return mx(t&r|~t&n,e,t,s,a,o)}function Ps(e,t,r,n,s,a,o){return mx(t&n|r&~n,e,t,s,a,o)}function Os(e,t,r,n,s,a,o){return mx(t^r^n,e,t,s,a,o)}function Rs(e,t,r,n,s,a,o){return mx(r^(t|~n),e,t,s,a,o)}function J6(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Cv(n,PY(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Cv(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Cv(n,s),n}function PY(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var zC="0123456789abcdef".split("");function OY(e){for(var t="",r=0;r<4;r++)t+=zC[e>>8*r+4&15]+zC[e>>8*r&15];return t}function RY(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function jw(e){return J6(e).map(RY).join("")}var QY=function(e){for(var t=0;t<e.length;t++)e[t]=OY(e[t]);return e.join("")}(J6("hello"))!="5d41402abc4b2a76b9719d911017c592";function lc(e,t){if(QY){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Tw(e,t){var r,n,s,a;if(e!==r){for(var o=(s=e,a=1+(256/e.length|0),new Array(a+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var A=0;for(c=0;c<256;c++){var u=l[c];A=(A+u+o.charCodeAt(c))%256,l[c]=l[A],l[A]=u}r=e,n=l}else l=n;var f=t.length,h=0,d=0,x="";for(c=0;c<f;c++)d=(d+(u=l[h=(h+1)%256]))%256,l[h]=l[d],l[d]=u,o=l[(l[h]+l[d])%256],x+=String.fromCharCode(t.charCodeAt(c)^o);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var XC={print:4,modify:8,copy:16,"annot-forms":32};function Eu(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(XC.perm!==void 0)throw new Error("Invalid permission: "+l);s+=XC[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^s)),this.encryptionKey=jw(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Tw(this.encryptionKey,this.padding)}function Fu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function YC(e){if(Lr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var a=Math.random().toString(35);return t[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in t[r]){var o=t[r][a];try{o[0].apply(e,n)}catch(l){Jt.console&&Kr.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Fg(e){if(!(this instanceof Fg))return new Fg(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Z6(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function AA(e,t,r,n,s){if(!(this instanceof AA))return new AA(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Z6.call(this,n,s)}function Gu(e,t,r,n,s){if(!(this instanceof Gu))return new Gu(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Z6.call(this,n,s)}function Qt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],o=[],l=1,c=16,A="S",u=null;Lr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,a=e.compress||e.compressPdf||a,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),A=e.defaultPathOperation||"S"),o=e.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},d={internal:{},__private__:{}};d.__private__.PubSub=YC;var x="1.3",g=d.__private__.getPdfVersion=function(){return x};d.__private__.setPdfVersion=function(E){x=E};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return y};var m=d.__private__.getPageFormat=function(E){return y[E]};s=s||"a4";var p="compat",b="advanced",v=p;function C(){this.saveGraphicsState(),ie(new Pt(Me,0,0,-Me,0,Kc()*Me).toString()+" cm"),this.setFontSize(this.getFontSize()/Me),A="n",v=b}function k(){this.restoreGraphicsState(),A="S",v=p}var S=d.__private__.combineFontStyleAndFontWeight=function(E,J){if(E=="bold"&&J=="normal"||E=="bold"&&J==400||E=="normal"&&J=="italic"||E=="bold"&&J=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return J&&(E=J==400||J==="normal"?E==="italic"?"italic":"normal":J!=700&&J!=="bold"||E!=="normal"?(J==700?"bold":J)+""+E:"bold"),E};d.advancedAPI=function(E){var J=v===p;return J&&C.call(this),typeof E!="function"||(E(this),J&&k.call(this)),this},d.compatAPI=function(E){var J=v===b;return J&&k.call(this),typeof E!="function"||(E(this),J&&C.call(this)),this},d.isAdvancedAPI=function(){return v===b};var I,N=function(E){if(v!==b)throw new Error(E+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Q=d.roundToPrecision=d.__private__.roundToPrecision=function(E,J){var ye=t||J;if(isNaN(E)||isNaN(ye))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return E.toFixed(ye).replace(/0+$/,"")};I=d.hpf=d.__private__.hpf=typeof c=="number"?function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(E,c)}:c==="smart"?function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(E,E>-1&&E<1?16:5)}:function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(E,16)};var L=d.f2=d.__private__.f2=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.f2");return Q(E,2)},T=d.__private__.f3=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.f3");return Q(E,3)},P=d.scale=d.__private__.scale=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.scale");return v===p?E*Me:v===b?E:void 0},R=function(E){return P(function(J){return v===p?Kc()-J:v===b?J:void 0}(E))};d.__private__.setPrecision=d.setPrecision=function(E){typeof parseInt(E,10)=="number"&&(t=parseInt(E,10))};var z,q="00000000000000000000000000000000",M=d.__private__.getFileId=function(){return q},V=d.__private__.setFileId=function(E){return q=E!==void 0&&/^[a-fA-F0-9]{32}$/.test(E)?E.toUpperCase():q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&($n=new Eu(u.userPermissions,u.userPassword,u.ownerPassword,q)),q};d.setFileId=function(E){return V(E),this},d.getFileId=function(){return M()};var H=d.__private__.convertDateToPDFDate=function(E){var J=E.getTimezoneOffset(),ye=J<0?"+":"-",Ce=Math.floor(Math.abs(J/60)),Ue=Math.abs(J%60),et=[ye,F(Ce),"'",F(Ue),"'"].join("");return["D:",E.getFullYear(),F(E.getMonth()+1),F(E.getDate()),F(E.getHours()),F(E.getMinutes()),F(E.getSeconds()),et].join("")},se=d.__private__.convertPDFDateToDate=function(E){var J=parseInt(E.substr(2,4),10),ye=parseInt(E.substr(6,2),10)-1,Ce=parseInt(E.substr(8,2),10),Ue=parseInt(E.substr(10,2),10),et=parseInt(E.substr(12,2),10),ct=parseInt(E.substr(14,2),10);return new Date(J,ye,Ce,Ue,et,ct,0)},ce=d.__private__.setCreationDate=function(E){var J;if(E===void 0&&(E=new Date),E instanceof Date)J=H(E);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(E))throw new Error("Invalid argument passed to jsPDF.setCreationDate");J=E}return z=J},B=d.__private__.getCreationDate=function(E){var J=z;return E==="jsDate"&&(J=se(z)),J};d.setCreationDate=function(E){return ce(E),this},d.getCreationDate=function(E){return B(E)};var U,F=d.__private__.padd2=function(E){return("0"+parseInt(E)).slice(-2)},D=d.__private__.padd2Hex=function(E){return("00"+(E=E.toString())).substr(E.length)},X=0,K=[],ae=[],he=0,Y=[],Be=[],ee=!1,Te=ae;d.__private__.setCustomOutputDestination=function(E){ee=!0,Te=E};var Je=function(E){ee||(Te=E)};d.__private__.resetCustomOutputDestination=function(){ee=!1,Te=ae};var ie=d.__private__.out=function(E){return E=E.toString(),he+=E.length+1,Te.push(E),Te},$e=d.__private__.write=function(E){return ie(arguments.length===1?E.toString():Array.prototype.join.call(arguments," "))},ze=d.__private__.getArrayBuffer=function(E){for(var J=E.length,ye=new ArrayBuffer(J),Ce=new Uint8Array(ye);J--;)Ce[J]=E.charCodeAt(J);return ye},Fe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return Fe};var Re=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(E){return Re=v===b?E/Me:E,this};var at,we=d.__private__.getFontSize=d.getFontSize=function(){return v===p?Re:Re*Me},ve=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(E){return ve=E,this},d.__private__.getR2L=d.getR2L=function(){return ve};var Le,tt=d.__private__.setZoomMode=function(E){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(E))at=E;else if(isNaN(E)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(E)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+E+'" is not recognized.');at=E}else at=parseInt(E,10)};d.__private__.getZoomMode=function(){return at};var lt,it=d.__private__.setPageMode=function(E){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(E)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+E+'" is not recognized.');Le=E};d.__private__.getPageMode=function(){return Le};var Ne=d.__private__.setLayoutMode=function(E){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(E)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+E+'" is not recognized.');lt=E};d.__private__.getLayoutMode=function(){return lt},d.__private__.setDisplayMode=d.setDisplayMode=function(E,J,ye){return tt(E),Ne(J),it(ye),this};var ke={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(E){if(Object.keys(ke).indexOf(E)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ke[E]},d.__private__.getDocumentProperties=function(){return ke},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(E){for(var J in ke)ke.hasOwnProperty(J)&&E[J]&&(ke[J]=E[J]);return this},d.__private__.setDocumentProperty=function(E,J){if(Object.keys(ke).indexOf(E)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ke[E]=J};var qe,Me,Ve,Et,xt,st={},pt={},It=[],ut={},kt={},yt={},Ct={},er=null,Wt=0,St=[],Ar=new YC(d),Fs=e.hotfixes||[],sr={},an={},Wn=[],Pt=function E(J,ye,Ce,Ue,et,ct){if(!(this instanceof E))return new E(J,ye,Ce,Ue,et,ct);isNaN(J)&&(J=1),isNaN(ye)&&(ye=0),isNaN(Ce)&&(Ce=0),isNaN(Ue)&&(Ue=1),isNaN(et)&&(et=0),isNaN(ct)&&(ct=0),this._matrix=[J,ye,Ce,Ue,et,ct]};Object.defineProperty(Pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(E){this._matrix[0]=E}}),Object.defineProperty(Pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(E){this._matrix[1]=E}}),Object.defineProperty(Pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(E){this._matrix[2]=E}}),Object.defineProperty(Pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(E){this._matrix[3]=E}}),Object.defineProperty(Pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(E){this._matrix[4]=E}}),Object.defineProperty(Pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(E){this._matrix[5]=E}}),Object.defineProperty(Pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(E){this._matrix[0]=E}}),Object.defineProperty(Pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(E){this._matrix[1]=E}}),Object.defineProperty(Pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(E){this._matrix[2]=E}}),Object.defineProperty(Pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(E){this._matrix[3]=E}}),Object.defineProperty(Pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(E){this._matrix[4]=E}}),Object.defineProperty(Pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(E){this._matrix[5]=E}}),Object.defineProperty(Pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Pt.prototype.join=function(E){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(E)},Pt.prototype.multiply=function(E){var J=E.sx*this.sx+E.shy*this.shx,ye=E.sx*this.shy+E.shy*this.sy,Ce=E.shx*this.sx+E.sy*this.shx,Ue=E.shx*this.shy+E.sy*this.sy,et=E.tx*this.sx+E.ty*this.shx+this.tx,ct=E.tx*this.shy+E.ty*this.sy+this.ty;return new Pt(J,ye,Ce,Ue,et,ct)},Pt.prototype.decompose=function(){var E=this.sx,J=this.shy,ye=this.shx,Ce=this.sy,Ue=this.tx,et=this.ty,ct=Math.sqrt(E*E+J*J),Ut=(E/=ct)*ye+(J/=ct)*Ce;ye-=E*Ut,Ce-=J*Ut;var Rt=Math.sqrt(ye*ye+Ce*Ce);return Ut/=Rt,E*(Ce/=Rt)<J*(ye/=Rt)&&(E=-E,J=-J,Ut=-Ut,ct=-ct),{scale:new Pt(ct,0,0,Rt,0,0),translate:new Pt(1,0,0,1,Ue,et),rotate:new Pt(E,J,-J,E,0,0),skew:new Pt(1,0,Ut,1,0,0)}},Pt.prototype.toString=function(E){return this.join(" ")},Pt.prototype.inversed=function(){var E=this.sx,J=this.shy,ye=this.shx,Ce=this.sy,Ue=this.tx,et=this.ty,ct=1/(E*Ce-J*ye),Ut=Ce*ct,Rt=-J*ct,Zt=-ye*ct,ar=E*ct;return new Pt(Ut,Rt,Zt,ar,-Ut*Ue-Zt*et,-Rt*Ue-ar*et)},Pt.prototype.applyToPoint=function(E){var J=E.x*this.sx+E.y*this.shx+this.tx,ye=E.x*this.shy+E.y*this.sy+this.ty;return new Ko(J,ye)},Pt.prototype.applyToRectangle=function(E){var J=this.applyToPoint(E),ye=this.applyToPoint(new Ko(E.x+E.w,E.y+E.h));return new Md(J.x,J.y,ye.x-J.x,ye.y-J.y)},Pt.prototype.clone=function(){var E=this.sx,J=this.shy,ye=this.shx,Ce=this.sy,Ue=this.tx,et=this.ty;return new Pt(E,J,ye,Ce,Ue,et)},d.Matrix=Pt;var Ln=d.matrixMult=function(E,J){return J.multiply(E)},on=new Pt(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=on;var _e=function(E,J){if(!kt[E]){var ye=(J instanceof AA?"Sh":"P")+(Object.keys(ut).length+1).toString(10);J.id=ye,kt[E]=ye,ut[ye]=J,Ar.publish("addPattern",J)}};d.ShadingPattern=AA,d.TilingPattern=Gu,d.addShadingPattern=function(E,J){return N("addShadingPattern()"),_e(E,J),this},d.beginTilingPattern=function(E){N("beginTilingPattern()"),Hd(E.boundingBox[0],E.boundingBox[1],E.boundingBox[2]-E.boundingBox[0],E.boundingBox[3]-E.boundingBox[1],E.matrix)},d.endTilingPattern=function(E,J){N("endTilingPattern()"),J.stream=Be[U].join(`
`),_e(E,J),Ar.publish("endTilingPattern",J),Wn.pop().restore()};var Ee,dt=d.__private__.newObject=function(){var E=Mt();return W(E,!0),E},Mt=d.__private__.newObjectDeferred=function(){return X++,K[X]=function(){return he},X},W=function(E,J){return J=typeof J=="boolean"&&J,K[E]=he,J&&ie(E+" 0 obj"),E},ue=d.__private__.newAdditionalObject=function(){var E={objId:Mt(),content:""};return Y.push(E),E},re=Mt(),Ae=Mt(),pe=d.__private__.decodeColorString=function(E){var J=E.split(" ");if(J.length!==2||J[1]!=="g"&&J[1]!=="G")J.length!==5||J[4]!=="k"&&J[4]!=="K"||(J=[(1-J[0])*(1-J[3]),(1-J[1])*(1-J[3]),(1-J[2])*(1-J[3]),"r"]);else{var ye=parseFloat(J[0]);J=[ye,ye,ye,"r"]}for(var Ce="#",Ue=0;Ue<3;Ue++)Ce+=("0"+Math.floor(255*parseFloat(J[Ue])).toString(16)).slice(-2);return Ce},me=d.__private__.encodeColorString=function(E){var J;typeof E=="string"&&(E={ch1:E});var ye=E.ch1,Ce=E.ch2,Ue=E.ch3,et=E.ch4,ct=E.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ye=="string"&&ye.charAt(0)!=="#"){var Ut=new Y6(ye);if(Ut.ok)ye=Ut.toHex();else if(!/^\d*\.?\d*$/.test(ye))throw new Error('Invalid color "'+ye+'" passed to jsPDF.encodeColorString.')}if(typeof ye=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ye)&&(ye="#"+ye[1]+ye[1]+ye[2]+ye[2]+ye[3]+ye[3]),typeof ye=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ye)){var Rt=parseInt(ye.substr(1),16);ye=Rt>>16&255,Ce=Rt>>8&255,Ue=255&Rt}if(Ce===void 0||et===void 0&&ye===Ce&&Ce===Ue)J=typeof ye=="string"?ye+" "+ct[0]:E.precision===2?L(ye/255)+" "+ct[0]:T(ye/255)+" "+ct[0];else if(et===void 0||Lr(et)==="object"){if(et&&!isNaN(et.a)&&et.a===0)return["1.","1.","1.",ct[1]].join(" ");J=typeof ye=="string"?[ye,Ce,Ue,ct[1]].join(" "):E.precision===2?[L(ye/255),L(Ce/255),L(Ue/255),ct[1]].join(" "):[T(ye/255),T(Ce/255),T(Ue/255),ct[1]].join(" ")}else J=typeof ye=="string"?[ye,Ce,Ue,et,ct[2]].join(" "):E.precision===2?[L(ye),L(Ce),L(Ue),L(et),ct[2]].join(" "):[T(ye),T(Ce),T(Ue),T(et),ct[2]].join(" ");return J},De=d.__private__.getFilters=function(){return o},Ge=d.__private__.putStream=function(E){var J=(E=E||{}).data||"",ye=E.filters||De(),Ce=E.alreadyAppliedFilters||[],Ue=E.addLength1||!1,et=J.length,ct=E.objectId,Ut=function(zn){return zn};if(u!==null&&ct===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Ut=$n.encryptor(ct,0));var Rt={};ye===!0&&(ye=["FlateEncode"]);var Zt=E.additionalKeyValues||[],ar=(Rt=Qt.API.processDataByFilters!==void 0?Qt.API.processDataByFilters(J,ye):{data:J,reverseChain:[]}).reverseChain+(Array.isArray(Ce)?Ce.join(" "):Ce.toString());if(Rt.data.length!==0&&(Zt.push({key:"Length",value:Rt.data.length}),Ue===!0&&Zt.push({key:"Length1",value:et})),ar.length!=0)if(ar.split("/").length-1==1)Zt.push({key:"Filter",value:ar});else{Zt.push({key:"Filter",value:"["+ar+"]"});for(var vr=0;vr<Zt.length;vr+=1)if(Zt[vr].key==="DecodeParms"){for(var ln=[],On=0;On<Rt.reverseChain.split("/").length-1;On+=1)ln.push("null");ln.push(Zt[vr].value),Zt[vr].value="["+ln.join(" ")+"]"}}ie("<<");for(var qr=0;qr<Zt.length;qr++)ie("/"+Zt[qr].key+" "+Zt[qr].value);ie(">>"),Rt.data.length!==0&&(ie("stream"),ie(Ut(Rt.data)),ie("endstream"))},Oe=d.__private__.putPage=function(E){var J=E.number,ye=E.data,Ce=E.objId,Ue=E.contentsObjId;W(Ce,!0),ie("<</Type /Page"),ie("/Parent "+E.rootDictionaryObjId+" 0 R"),ie("/Resources "+E.resourceDictionaryObjId+" 0 R"),ie("/MediaBox ["+parseFloat(I(E.mediaBox.bottomLeftX))+" "+parseFloat(I(E.mediaBox.bottomLeftY))+" "+I(E.mediaBox.topRightX)+" "+I(E.mediaBox.topRightY)+"]"),E.cropBox!==null&&ie("/CropBox ["+I(E.cropBox.bottomLeftX)+" "+I(E.cropBox.bottomLeftY)+" "+I(E.cropBox.topRightX)+" "+I(E.cropBox.topRightY)+"]"),E.bleedBox!==null&&ie("/BleedBox ["+I(E.bleedBox.bottomLeftX)+" "+I(E.bleedBox.bottomLeftY)+" "+I(E.bleedBox.topRightX)+" "+I(E.bleedBox.topRightY)+"]"),E.trimBox!==null&&ie("/TrimBox ["+I(E.trimBox.bottomLeftX)+" "+I(E.trimBox.bottomLeftY)+" "+I(E.trimBox.topRightX)+" "+I(E.trimBox.topRightY)+"]"),E.artBox!==null&&ie("/ArtBox ["+I(E.artBox.bottomLeftX)+" "+I(E.artBox.bottomLeftY)+" "+I(E.artBox.topRightX)+" "+I(E.artBox.topRightY)+"]"),typeof E.userUnit=="number"&&E.userUnit!==1&&ie("/UserUnit "+E.userUnit),Ar.publish("putPage",{objId:Ce,pageContext:St[J],pageNumber:J,page:ye}),ie("/Contents "+Ue+" 0 R"),ie(">>"),ie("endobj");var et=ye.join(`
`);return v===b&&(et+=`
Q`),W(Ue,!0),Ge({data:et,filters:De(),objectId:Ue}),ie("endobj"),Ce},Qe=d.__private__.putPages=function(){var E,J,ye=[];for(E=1;E<=Wt;E++)St[E].objId=Mt(),St[E].contentsObjId=Mt();for(E=1;E<=Wt;E++)ye.push(Oe({number:E,data:Be[E],objId:St[E].objId,contentsObjId:St[E].contentsObjId,mediaBox:St[E].mediaBox,cropBox:St[E].cropBox,bleedBox:St[E].bleedBox,trimBox:St[E].trimBox,artBox:St[E].artBox,userUnit:St[E].userUnit,rootDictionaryObjId:re,resourceDictionaryObjId:Ae}));W(re,!0),ie("<</Type /Pages");var Ce="/Kids [";for(J=0;J<Wt;J++)Ce+=ye[J]+" 0 R ";ie(Ce+"]"),ie("/Count "+Wt),ie(">>"),ie("endobj"),Ar.publish("postPutPages")},be=function(E){Ar.publish("putFont",{font:E,out:ie,newObject:dt,putStream:Ge}),E.isAlreadyPutted!==!0&&(E.objectNumber=dt(),ie("<<"),ie("/Type /Font"),ie("/BaseFont /"+Fu(E.postScriptName)),ie("/Subtype /Type1"),typeof E.encoding=="string"&&ie("/Encoding /"+E.encoding),ie("/FirstChar 32"),ie("/LastChar 255"),ie(">>"),ie("endobj"))},fe=function(E){E.objectNumber=dt();var J=[];J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Form"}),J.push({key:"BBox",value:"["+[I(E.x),I(E.y),I(E.x+E.width),I(E.y+E.height)].join(" ")+"]"}),J.push({key:"Matrix",value:"["+E.matrix.toString()+"]"});var ye=E.pages[1].join(`
`);Ge({data:ye,additionalKeyValues:J,objectId:E.objectNumber}),ie("endobj")},Ie=function(E,J){J||(J=21);var ye=dt(),Ce=function(ct,Ut){var Rt,Zt=[],ar=1/(Ut-1);for(Rt=0;Rt<1;Rt+=ar)Zt.push(Rt);if(Zt.push(1),ct[0].offset!=0){var vr={offset:0,color:ct[0].color};ct.unshift(vr)}if(ct[ct.length-1].offset!=1){var ln={offset:1,color:ct[ct.length-1].color};ct.push(ln)}for(var On="",qr=0,zn=0;zn<Zt.length;zn++){for(Rt=Zt[zn];Rt>ct[qr+1].offset;)qr++;var Rn=ct[qr].offset,hs=(Rt-Rn)/(ct[qr+1].offset-Rn),Go=ct[qr].color,Li=ct[qr+1].color;On+=D(Math.round((1-hs)*Go[0]+hs*Li[0]).toString(16))+D(Math.round((1-hs)*Go[1]+hs*Li[1]).toString(16))+D(Math.round((1-hs)*Go[2]+hs*Li[2]).toString(16))}return On.trim()}(E.colors,J),Ue=[];Ue.push({key:"FunctionType",value:"0"}),Ue.push({key:"Domain",value:"[0.0 1.0]"}),Ue.push({key:"Size",value:"["+J+"]"}),Ue.push({key:"BitsPerSample",value:"8"}),Ue.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ue.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ge({data:Ce,additionalKeyValues:Ue,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ye}),ie("endobj"),E.objectNumber=dt(),ie("<< /ShadingType "+E.type),ie("/ColorSpace /DeviceRGB");var et="/Coords ["+I(parseFloat(E.coords[0]))+" "+I(parseFloat(E.coords[1]))+" ";E.type===2?et+=I(parseFloat(E.coords[2]))+" "+I(parseFloat(E.coords[3])):et+=I(parseFloat(E.coords[2]))+" "+I(parseFloat(E.coords[3]))+" "+I(parseFloat(E.coords[4]))+" "+I(parseFloat(E.coords[5])),ie(et+="]"),E.matrix&&ie("/Matrix ["+E.matrix.toString()+"]"),ie("/Function "+ye+" 0 R"),ie("/Extend [true true]"),ie(">>"),ie("endobj")},We=function(E,J){var ye=Mt(),Ce=dt();J.push({resourcesOid:ye,objectOid:Ce}),E.objectNumber=Ce;var Ue=[];Ue.push({key:"Type",value:"/Pattern"}),Ue.push({key:"PatternType",value:"1"}),Ue.push({key:"PaintType",value:"1"}),Ue.push({key:"TilingType",value:"1"}),Ue.push({key:"BBox",value:"["+E.boundingBox.map(I).join(" ")+"]"}),Ue.push({key:"XStep",value:I(E.xStep)}),Ue.push({key:"YStep",value:I(E.yStep)}),Ue.push({key:"Resources",value:ye+" 0 R"}),E.matrix&&Ue.push({key:"Matrix",value:"["+E.matrix.toString()+"]"}),Ge({data:E.stream,additionalKeyValues:Ue,objectId:E.objectNumber}),ie("endobj")},nt=function(E){for(var J in E.objectNumber=dt(),ie("<<"),E)switch(J){case"opacity":ie("/ca "+L(E[J]));break;case"stroke-opacity":ie("/CA "+L(E[J]))}ie(">>"),ie("endobj")},ft=function(E){W(E.resourcesOid,!0),ie("<<"),ie("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var J in ie("/Font <<"),st)st.hasOwnProperty(J)&&(f===!1||f===!0&&h.hasOwnProperty(J))&&ie("/"+J+" "+st[J].objectNumber+" 0 R");ie(">>")}(),function(){if(Object.keys(ut).length>0){for(var J in ie("/Shading <<"),ut)ut.hasOwnProperty(J)&&ut[J]instanceof AA&&ut[J].objectNumber>=0&&ie("/"+J+" "+ut[J].objectNumber+" 0 R");Ar.publish("putShadingPatternDict"),ie(">>")}}(),function(J){if(Object.keys(ut).length>0){for(var ye in ie("/Pattern <<"),ut)ut.hasOwnProperty(ye)&&ut[ye]instanceof d.TilingPattern&&ut[ye].objectNumber>=0&&ut[ye].objectNumber<J&&ie("/"+ye+" "+ut[ye].objectNumber+" 0 R");Ar.publish("putTilingPatternDict"),ie(">>")}}(E.objectOid),function(){if(Object.keys(yt).length>0){var J;for(J in ie("/ExtGState <<"),yt)yt.hasOwnProperty(J)&&yt[J].objectNumber>=0&&ie("/"+J+" "+yt[J].objectNumber+" 0 R");Ar.publish("putGStateDict"),ie(">>")}}(),function(){for(var J in ie("/XObject <<"),sr)sr.hasOwnProperty(J)&&sr[J].objectNumber>=0&&ie("/"+J+" "+sr[J].objectNumber+" 0 R");Ar.publish("putXobjectDict"),ie(">>")}(),ie(">>"),ie("endobj")},bt=function(E){pt[E.fontName]=pt[E.fontName]||{},pt[E.fontName][E.fontStyle]=E.id},Vt=function(E,J,ye,Ce,Ue){var et={id:"F"+(Object.keys(st).length+1).toString(10),postScriptName:E,fontName:J,fontStyle:ye,encoding:Ce,isStandardFont:Ue||!1,metadata:{}};return Ar.publish("addFont",{font:et,instance:this}),st[et.id]=et,bt(et),et.id},Ht=d.__private__.pdfEscape=d.pdfEscape=function(E,J){return function(ye,Ce){var Ue,et,ct,Ut,Rt,Zt,ar,vr,ln;if(ct=(Ce=Ce||{}).sourceEncoding||"Unicode",Rt=Ce.outputEncoding,(Ce.autoencode||Rt)&&st[qe].metadata&&st[qe].metadata[ct]&&st[qe].metadata[ct].encoding&&(Ut=st[qe].metadata[ct].encoding,!Rt&&st[qe].encoding&&(Rt=st[qe].encoding),!Rt&&Ut.codePages&&(Rt=Ut.codePages[0]),typeof Rt=="string"&&(Rt=Ut[Rt]),Rt)){for(ar=!1,Zt=[],Ue=0,et=ye.length;Ue<et;Ue++)(vr=Rt[ye.charCodeAt(Ue)])?Zt.push(String.fromCharCode(vr)):Zt.push(ye[Ue]),Zt[Ue].charCodeAt(0)>>8&&(ar=!0);ye=Zt.join("")}for(Ue=ye.length;ar===void 0&&Ue!==0;)ye.charCodeAt(Ue-1)>>8&&(ar=!0),Ue--;if(!ar)return ye;for(Zt=Ce.noBOM?[]:[254,255],Ue=0,et=ye.length;Ue<et;Ue++){if((ln=(vr=ye.charCodeAt(Ue))>>8)>>8)throw new Error("Character at position "+Ue+" of string '"+ye+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zt.push(ln),Zt.push(vr-(ln<<8))}return String.fromCharCode.apply(void 0,Zt)}(E,J).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Br=d.__private__.beginPage=function(E){Be[++Wt]=[],St[Wt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(E[0]),topRightY:Number(E[1])}},Ua(Wt),Je(Be[U])},js=function(E,J){var ye,Ce,Ue;switch(r=J||r,typeof E=="string"&&(ye=m(E.toLowerCase()),Array.isArray(ye)&&(Ce=ye[0],Ue=ye[1])),Array.isArray(E)&&(Ce=E[0]*Me,Ue=E[1]*Me),isNaN(Ce)&&(Ce=s[0],Ue=s[1]),(Ce>14400||Ue>14400)&&(Kr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ce=Math.min(14400,Ce),Ue=Math.min(14400,Ue)),s=[Ce,Ue],r.substr(0,1)){case"l":Ue>Ce&&(s=[Ue,Ce]);break;case"p":Ce>Ue&&(s=[Ue,Ce])}Br(s),tr(Pd),ie(tu),Rd!==0&&ie(Rd+" J"),Qd!==0&&ie(Qd+" j"),Ar.publish("addPage",{pageNumber:Wt})},Er=function(E){E>0&&E<=Wt&&(Be.splice(E,1),St.splice(E,1),Wt--,U>Wt&&(U=Wt),this.setPage(U))},Ua=function(E){E>0&&E<=Wt&&(U=E)},ta=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return Be.length-1},kl=function(E,J,ye){var Ce,Ue=void 0;return ye=ye||{},E=E!==void 0?E:st[qe].fontName,J=J!==void 0?J:st[qe].fontStyle,Ce=E.toLowerCase(),pt[Ce]!==void 0&&pt[Ce][J]!==void 0?Ue=pt[Ce][J]:pt[E]!==void 0&&pt[E][J]!==void 0?Ue=pt[E][J]:ye.disableWarning===!1&&Kr.warn("Unable to look up font label for font '"+E+"', '"+J+"'. Refer to getFontList() for available fonts."),Ue||ye.noFallback||(Ue=pt.times[J])==null&&(Ue=pt.times.normal),Ue},Dn=d.__private__.putInfo=function(){var E=dt(),J=function(Ce){return Ce};for(var ye in u!==null&&(J=$n.encryptor(E,0)),ie("<<"),ie("/Producer ("+Ht(J("jsPDF "+Qt.version))+")"),ke)ke.hasOwnProperty(ye)&&ke[ye]&&ie("/"+ye.substr(0,1).toUpperCase()+ye.substr(1)+" ("+Ht(J(ke[ye]))+")");ie("/CreationDate ("+Ht(J(z))+")"),ie(">>"),ie("endobj")},JA=d.__private__.putCatalog=function(E){var J=(E=E||{}).rootDictionaryObjId||re;switch(dt(),ie("<<"),ie("/Type /Catalog"),ie("/Pages "+J+" 0 R"),at||(at="fullwidth"),at){case"fullwidth":ie("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ie("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ie("/OpenAction [3 0 R /Fit]");break;case"original":ie("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ye=""+at;ye.substr(ye.length-1)==="%"&&(at=parseInt(at)/100),typeof at=="number"&&ie("/OpenAction [3 0 R /XYZ null null "+L(at)+"]")}switch(lt||(lt="continuous"),lt){case"continuous":ie("/PageLayout /OneColumn");break;case"single":ie("/PageLayout /SinglePage");break;case"two":case"twoleft":ie("/PageLayout /TwoColumnLeft");break;case"tworight":ie("/PageLayout /TwoColumnRight")}Le&&ie("/PageMode /"+Le),Ar.publish("putCatalog"),ie(">>"),ie("endobj")},Sx=d.__private__.putTrailer=function(){ie("trailer"),ie("<<"),ie("/Size "+(X+1)),ie("/Root "+X+" 0 R"),ie("/Info "+(X-1)+" 0 R"),u!==null&&ie("/Encrypt "+$n.oid+" 0 R"),ie("/ID [ <"+q+"> <"+q+"> ]"),ie(">>")},Pn=d.__private__.putHeader=function(){ie("%PDF-"+x),ie("%")},yh=d.__private__.putXRef=function(){var E="0000000000";ie("xref"),ie("0 "+(X+1)),ie("0000000000 65535 f ");for(var J=1;J<=X;J++)typeof K[J]=="function"?ie((E+K[J]()).slice(-10)+" 00000 n "):K[J]!==void 0?ie((E+K[J]).slice(-10)+" 00000 n "):ie("0000000000 00000 n ")},Ao=d.__private__.buildDocument=function(){var E;X=0,he=0,ae=[],K=[],Y=[],re=Mt(),Ae=Mt(),Je(ae),Ar.publish("buildDocument"),Pn(),Qe(),function(){Ar.publish("putAdditionalObjects");for(var ye=0;ye<Y.length;ye++){var Ce=Y[ye];W(Ce.objId,!0),ie(Ce.content),ie("endobj")}Ar.publish("postPutAdditionalObjects")}(),E=[],function(){for(var ye in st)st.hasOwnProperty(ye)&&(f===!1||f===!0&&h.hasOwnProperty(ye))&&be(st[ye])}(),function(){var ye;for(ye in yt)yt.hasOwnProperty(ye)&&nt(yt[ye])}(),function(){for(var ye in sr)sr.hasOwnProperty(ye)&&fe(sr[ye])}(),function(ye){var Ce;for(Ce in ut)ut.hasOwnProperty(Ce)&&(ut[Ce]instanceof AA?Ie(ut[Ce]):ut[Ce]instanceof Gu&&We(ut[Ce],ye))}(E),Ar.publish("putResources"),E.forEach(ft),ft({resourcesOid:Ae,objectOid:Number.MAX_SAFE_INTEGER}),Ar.publish("postPutResources"),u!==null&&($n.oid=dt(),ie("<<"),ie("/Filter /Standard"),ie("/V "+$n.v),ie("/R "+$n.r),ie("/U <"+$n.toHexString($n.U)+">"),ie("/O <"+$n.toHexString($n.O)+">"),ie("/P "+$n.P),ie(">>"),ie("endobj")),Dn(),JA();var J=he;return yh(),Sx(),ie("startxref"),ie(""+J),ie("%%EOF"),Je(Be[U]),ae.join(`
`)},ZA=d.__private__.getBlob=function(E){return new Blob([ze(E)],{type:"application/pdf"})},wh=d.output=d.__private__.output=(Ee=function(E,J){switch(typeof(J=J||{})=="string"?J={filename:J}:J.filename=J.filename||"generated.pdf",E){case void 0:return Ao();case"save":d.save(J.filename);break;case"arraybuffer":return ze(Ao());case"blob":return ZA(Ao());case"bloburi":case"bloburl":if(Jt.URL!==void 0&&typeof Jt.URL.createObjectURL=="function")return Jt.URL&&Jt.URL.createObjectURL(ZA(Ao()))||void 0;Kr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ye="",Ce=Ao();try{ye=$C(Ce)}catch{ye=$C(unescape(encodeURIComponent(Ce)))}return"data:application/pdf;filename="+J.filename+";base64,"+ye;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Jt)==="[object Window]"){var Ue="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",et=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';J.pdfObjectUrl&&(Ue=J.pdfObjectUrl,et="");var ct='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ue+'"'+et+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(J)+");<\/script></body></html>",Ut=Jt.open();return Ut!==null&&Ut.document.write(ct),Ut}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Jt)==="[object Window]"){var Rt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(J.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+J.filename+'" width="500px" height="400px" /></body></html>',Zt=Jt.open();if(Zt!==null){Zt.document.write(Rt);var ar=this;Zt.document.documentElement.querySelector("#pdfViewer").onload=function(){Zt.document.title=J.filename,Zt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ar.output("bloburl"))}}return Zt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Jt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var vr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",J)+'"></iframe></body></html>',ln=Jt.open();if(ln!==null&&(ln.document.write(vr),ln.document.title=J.filename),ln||typeof safari>"u")return ln;break;case"datauri":case"dataurl":return Jt.document.location.href=this.output("datauristring",J);default:return null}},Ee.foo=function(){try{return Ee.apply(this,arguments)}catch(ye){var E=ye.stack||"";~E.indexOf(" at ")&&(E=E.split(" at ")[1]);var J="Error in function "+E.split(`
`)[0].split("<")[0]+": "+ye.message;if(!Jt.console)throw new Error(J);Jt.console.error(J,ye),Jt.alert&&alert(J)}},Ee.foo.bar=Ee,Ee.foo),oi=function(E){return Array.isArray(Fs)===!0&&Fs.indexOf(E)>-1};switch(n){case"pt":Me=1;break;case"mm":Me=72/25.4;break;case"cm":Me=72/2.54;break;case"in":Me=72;break;case"px":Me=oi("px_scaling")==1?.75:96/72;break;case"pc":case"em":Me=12;break;case"ex":Me=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Me=n}var $n=null;ce(),V();var Ro=d.__private__.getPageInfo=d.getPageInfo=function(E){if(isNaN(E)||E%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[E].objId,pageNumber:E,pageContext:St[E]}},bh=d.__private__.getPageInfoByObjId=function(E){if(isNaN(E)||E%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var J in St)if(St[J].objId===E)break;return Ro(J)},kx=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:St[U].objId,pageNumber:U,pageContext:St[U]}};d.addPage=function(){return js.apply(this,arguments),this},d.setPage=function(){return Ua.apply(this,arguments),Je.call(this,Be[U]),this},d.insertPage=function(E){return this.addPage(),this.movePage(U,E),this},d.movePage=function(E,J){var ye,Ce;if(E>J){ye=Be[E],Ce=St[E];for(var Ue=E;Ue>J;Ue--)Be[Ue]=Be[Ue-1],St[Ue]=St[Ue-1];Be[J]=ye,St[J]=Ce,this.setPage(J)}else if(E<J){ye=Be[E],Ce=St[E];for(var et=E;et<J;et++)Be[et]=Be[et+1],St[et]=St[et+1];Be[J]=ye,St[J]=Ce,this.setPage(J)}return this},d.deletePage=function(){return Er.apply(this,arguments),this},d.__private__.text=d.text=function(E,J,ye,Ce,Ue){var et,ct,Ut,Rt,Zt,ar,vr,ln,On,qr=(Ce=Ce||{}).scope||this;if(typeof E=="number"&&typeof J=="number"&&(typeof ye=="string"||Array.isArray(ye))){var zn=ye;ye=J,J=E,E=zn}if(arguments[3]instanceof Pt==0?(Ut=arguments[4],Rt=arguments[5],Lr(vr=arguments[3])==="object"&&vr!==null||(typeof Ut=="string"&&(Rt=Ut,Ut=null),typeof vr=="string"&&(Rt=vr,vr=null),typeof vr=="number"&&(Ut=vr,vr=null),Ce={flags:vr,angle:Ut,align:Rt})):(N("The transform parameter of text() with a Matrix value"),On=Ue),isNaN(J)||isNaN(ye)||E==null)throw new Error("Invalid arguments passed to jsPDF.text");if(E.length===0)return qr;var Rn,hs="",Go=typeof Ce.lineHeightFactor=="number"?Ce.lineHeightFactor:Qc,Li=qr.internal.scaleFactor;function Wo(Sr){return Sr=Sr.split("	").join(Array(Ce.TabLen||9).join(" ")),Ht(Sr,vr)}function qd(Sr){for(var Mr,_n=Sr.concat(),Xn=[],Xo=_n.length;Xo--;)typeof(Mr=_n.shift())=="string"?Xn.push(Mr):Array.isArray(Sr)&&(Mr.length===1||Mr[1]===void 0&&Mr[2]===void 0)?Xn.push(Mr[0]):Xn.push([Mr[0],Mr[1],Mr[2]]);return Xn}function nu(Sr,Mr){var _n;if(typeof Sr=="string")_n=Mr(Sr)[0];else if(Array.isArray(Sr)){for(var Xn,Xo,e0=Sr.concat(),iu=[],Ih=e0.length;Ih--;)typeof(Xn=e0.shift())=="string"?iu.push(Mr(Xn)[0]):Array.isArray(Xn)&&typeof Xn[0]=="string"&&(Xo=Mr(Xn[0],Xn[1],Xn[2]),iu.push([Xo[0],Xo[1],Xo[2]]));_n=iu}return _n}var El=!1,qc=!0;if(typeof E=="string")El=!0;else if(Array.isArray(E)){var Vc=E.concat();ct=[];for(var Fl,ps=Vc.length;ps--;)(typeof(Fl=Vc.shift())!="string"||Array.isArray(Fl)&&typeof Fl[0]!="string")&&(qc=!1);El=qc}if(El===!1)throw new Error('Type of text must be string or Array. "'+E+'" is not recognized.');typeof E=="string"&&(E=E.match(/[\r?\n]/)?E.split(/\r\n|\r|\n/g):[E]);var Gc=Re/qr.internal.scaleFactor,Wc=Gc*(Go-1);switch(Ce.baseline){case"bottom":ye-=Wc;break;case"top":ye+=Gc-Wc;break;case"hanging":ye+=Gc-2*Wc;break;case"middle":ye+=Gc/2-Wc}if((ar=Ce.maxWidth||0)>0&&(typeof E=="string"?E=qr.splitTextToSize(E,ar):Object.prototype.toString.call(E)==="[object Array]"&&(E=E.reduce(function(Sr,Mr){return Sr.concat(qr.splitTextToSize(Mr,ar))},[]))),et={text:E,x:J,y:ye,options:Ce,mutex:{pdfEscape:Ht,activeFontKey:qe,fonts:st,activeFontSize:Re}},Ar.publish("preProcessText",et),E=et.text,Ut=(Ce=et.options).angle,On instanceof Pt==0&&Ut&&typeof Ut=="number"){Ut*=Math.PI/180,Ce.rotationDirection===0&&(Ut=-Ut),v===b&&(Ut=-Ut);var Vd=Math.cos(Ut),Gd=Math.sin(Ut);On=new Pt(Vd,Gd,-Gd,Vd,0,0)}else Ut&&Ut instanceof Pt&&(On=Ut);v!==b||On||(On=on),(Zt=Ce.charSpace||Ho)!==void 0&&(hs+=I(P(Zt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ln=Ce.horizontalScale)!==void 0&&(hs+=I(100*ln)+` Tz
`),Ce.lang;var ra=-1,$o=Ce.renderingMode!==void 0?Ce.renderingMode:Ce.stroke,su=qr.internal.getCurrentPageInfo().pageContext;switch($o){case 0:case!1:case"fill":ra=0;break;case 1:case!0:case"stroke":ra=1;break;case 2:case"fillThenStroke":ra=2;break;case 3:case"invisible":ra=3;break;case 4:case"fillAndAddForClipping":ra=4;break;case 5:case"strokeAndAddPathForClipping":ra=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ra=6;break;case 7:case"addToPathForClipping":ra=7}var jh=su.usedRenderingMode!==void 0?su.usedRenderingMode:-1;ra!==-1?hs+=ra+` Tr
`:jh!==-1&&(hs+=`0 Tr
`),ra!==-1&&(su.usedRenderingMode=ra),Rt=Ce.align||"left";var li,$c=Re*Go,Wd=qr.internal.pageSize.getWidth(),$d=st[qe];Zt=Ce.charSpace||Ho,ar=Ce.maxWidth||0,vr=Object.assign({autoencode:!0,noBOM:!0},Ce.flags);var jl=[],zc=function(Sr){return qr.getStringUnitWidth(Sr,{font:$d,charSpace:Zt,fontSize:Re,doKerning:!1})*Re/Li};if(Object.prototype.toString.call(E)==="[object Array]"){var La;ct=qd(E),Rt!=="left"&&(li=ct.map(zc));var Da,Tl=0;if(Rt==="right"){J-=li[0],E=[],ps=ct.length;for(var zo=0;zo<ps;zo++)zo===0?(Da=Qo(J),La=Mo(ye)):(Da=P(Tl-li[zo]),La=-$c),E.push([ct[zo],Da,La]),Tl=li[zo]}else if(Rt==="center"){J-=li[0]/2,E=[],ps=ct.length;for(var Il=0;Il<ps;Il++)Il===0?(Da=Qo(J),La=Mo(ye)):(Da=P((Tl-li[Il])/2),La=-$c),E.push([ct[Il],Da,La]),Tl=li[Il]}else if(Rt==="left"){E=[],ps=ct.length;for(var zd=0;zd<ps;zd++)E.push(ct[zd])}else if(Rt==="justify"&&$d.encoding==="Identity-H"){E=[],ps=ct.length,ar=ar!==0?ar:Wd;for(var au=0,bn=0;bn<ps;bn++)if(La=bn===0?Mo(ye):-$c,Da=bn===0?Qo(J):au,bn<ps-1){var Th=P((ar-li[bn])/(ct[bn].split(" ").length-1)),fo=ct[bn].split(" ");E.push([fo[0]+" ",Da,La]),au=0;for(var ho=1;ho<fo.length;ho++){var Xd=(zc(fo[ho-1]+" "+fo[ho])-zc(fo[ho]))*Li+Th;ho==fo.length-1?E.push([fo[ho],Xd,0]):E.push([fo[ho]+" ",Xd,0]),au-=Xd}}else E.push([ct[bn],Da,La]);E.push(["",au,0])}else{if(Rt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(E=[],ps=ct.length,ar=ar!==0?ar:Wd,bn=0;bn<ps;bn++){La=bn===0?Mo(ye):-$c,Da=bn===0?Qo(J):0;var Yd=ct[bn].split(" ").length-1,Jd=Yd>0?(ar-li[bn])/Yd:0;bn<ps-1?jl.push(I(P(Jd))):jl.push(0),E.push([ct[bn],Da,La])}}}(typeof Ce.R2L=="boolean"?Ce.R2L:ve)===!0&&(E=nu(E,function(Sr,Mr,_n){return[Sr.split("").reverse().join(""),Mr,_n]})),et={text:E,x:J,y:ye,options:Ce,mutex:{pdfEscape:Ht,activeFontKey:qe,fonts:st,activeFontSize:Re}},Ar.publish("postProcessText",et),E=et.text,Rn=et.mutex.isHex||!1;var Zd=st[qe].encoding;Zd!=="WinAnsiEncoding"&&Zd!=="StandardEncoding"||(E=nu(E,function(Sr,Mr,_n){return[Wo(Sr),Mr,_n]})),ct=qd(E),E=[];for(var Ul,Ll,Dl,Xc=Array.isArray(ct[0])?1:0,Pl="",Yc=function(Sr,Mr,_n){var Xn="";return _n instanceof Pt?(_n=typeof Ce.angle=="number"?Ln(_n,new Pt(1,0,0,1,Sr,Mr)):Ln(new Pt(1,0,0,1,Sr,Mr),_n),v===b&&(_n=Ln(new Pt(1,0,0,-1,0,0),_n)),Xn=_n.join(" ")+` Tm
`):Xn=I(Sr)+" "+I(Mr)+` Td
`,Xn},ci=0;ci<ct.length;ci++){switch(Pl="",Xc){case 1:Dl=(Rn?"<":"(")+ct[ci][0]+(Rn?">":")"),Ul=parseFloat(ct[ci][1]),Ll=parseFloat(ct[ci][2]);break;case 0:Dl=(Rn?"<":"(")+ct[ci]+(Rn?">":")"),Ul=Qo(J),Ll=Mo(ye)}jl!==void 0&&jl[ci]!==void 0&&(Pl=jl[ci]+` Tw
`),ci===0?E.push(Pl+Yc(Ul,Ll,On)+Dl):Xc===0?E.push(Pl+Dl):Xc===1&&E.push(Pl+Yc(Ul,Ll,On)+Dl)}E=Xc===0?E.join(` Tj
T* `):E.join(` Tj
`),E+=` Tj
`;var po=`BT
/`;return po+=qe+" "+Re+` Tf
`,po+=I(Re*Go)+` TL
`,po+=Mc+`
`,po+=hs,po+=E,ie(po+="ET"),h[qe]=!0,qr};var Ex=d.__private__.clip=d.clip=function(E){return ie(E==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Ex("evenodd")},d.__private__.discardPath=d.discardPath=function(){return ie("n"),this};var uo=d.__private__.isValidStyle=function(E){var J=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(E)!==-1&&(J=!0),J};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(E){return uo(E)&&(A=E),this};var _h=d.__private__.getStyle=d.getStyle=function(E){var J=A;switch(E){case"D":case"S":J="S";break;case"F":J="f";break;case"FD":case"DF":J="B";break;case"f":case"f*":case"B":case"B*":J=E}return J},Bh=d.close=function(){return ie("h"),this};d.stroke=function(){return ie("S"),this},d.fill=function(E){return eu("f",E),this},d.fillEvenOdd=function(E){return eu("f*",E),this},d.fillStroke=function(E){return eu("B",E),this},d.fillStrokeEvenOdd=function(E){return eu("B*",E),this};var eu=function(E,J){Lr(J)==="object"?jx(J,E):ie(E)},Rc=function(E){E===null||v===b&&E===void 0||(E=_h(E),ie(E))};function Fx(E,J,ye,Ce,Ue){var et=new Gu(J||this.boundingBox,ye||this.xStep,Ce||this.yStep,this.gState,Ue||this.matrix);et.stream=this.stream;var ct=E+"$$"+this.cloneIndex+++"$$";return _e(ct,et),et}var jx=function(E,J){var ye=kt[E.key],Ce=ut[ye];if(Ce instanceof AA)ie("q"),ie(Tx(J)),Ce.gState&&d.setGState(Ce.gState),ie(E.matrix.toString()+" cm"),ie("/"+ye+" sh"),ie("Q");else if(Ce instanceof Gu){var Ue=new Pt(1,0,0,-1,0,Kc());E.matrix&&(Ue=Ue.multiply(E.matrix||on),ye=Fx.call(Ce,E.key,E.boundingBox,E.xStep,E.yStep,Ue).id),ie("q"),ie("/Pattern cs"),ie("/"+ye+" scn"),Ce.gState&&d.setGState(Ce.gState),ie(J),ie("Q")}},Tx=function(E){switch(E){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Dd=d.moveTo=function(E,J){return ie(I(P(E))+" "+I(R(J))+" m"),this},Ch=d.lineTo=function(E,J){return ie(I(P(E))+" "+I(R(J))+" l"),this},Ui=d.curveTo=function(E,J,ye,Ce,Ue,et){return ie([I(P(E)),I(R(J)),I(P(ye)),I(R(Ce)),I(P(Ue)),I(R(et)),"c"].join(" ")),this};d.__private__.line=d.line=function(E,J,ye,Ce,Ue){if(isNaN(E)||isNaN(J)||isNaN(ye)||isNaN(Ce)||!uo(Ue))throw new Error("Invalid arguments passed to jsPDF.line");return v===p?this.lines([[ye-E,Ce-J]],E,J,[1,1],Ue||"S"):this.lines([[ye-E,Ce-J]],E,J,[1,1]).stroke()},d.__private__.lines=d.lines=function(E,J,ye,Ce,Ue,et){var ct,Ut,Rt,Zt,ar,vr,ln,On,qr,zn,Rn,hs;if(typeof E=="number"&&(hs=ye,ye=J,J=E,E=hs),Ce=Ce||[1,1],et=et||!1,isNaN(J)||isNaN(ye)||!Array.isArray(E)||!Array.isArray(Ce)||!uo(Ue)||typeof et!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Dd(J,ye),ct=Ce[0],Ut=Ce[1],Zt=E.length,zn=J,Rn=ye,Rt=0;Rt<Zt;Rt++)(ar=E[Rt]).length===2?(zn=ar[0]*ct+zn,Rn=ar[1]*Ut+Rn,Ch(zn,Rn)):(vr=ar[0]*ct+zn,ln=ar[1]*Ut+Rn,On=ar[2]*ct+zn,qr=ar[3]*Ut+Rn,zn=ar[4]*ct+zn,Rn=ar[5]*Ut+Rn,Ui(vr,ln,On,qr,zn,Rn));return et&&Bh(),Rc(Ue),this},d.path=function(E){for(var J=0;J<E.length;J++){var ye=E[J],Ce=ye.c;switch(ye.op){case"m":Dd(Ce[0],Ce[1]);break;case"l":Ch(Ce[0],Ce[1]);break;case"c":Ui.apply(this,Ce);break;case"h":Bh()}}return this},d.__private__.rect=d.rect=function(E,J,ye,Ce,Ue){if(isNaN(E)||isNaN(J)||isNaN(ye)||isNaN(Ce)||!uo(Ue))throw new Error("Invalid arguments passed to jsPDF.rect");return v===p&&(Ce=-Ce),ie([I(P(E)),I(R(J)),I(P(ye)),I(P(Ce)),"re"].join(" ")),Rc(Ue),this},d.__private__.triangle=d.triangle=function(E,J,ye,Ce,Ue,et,ct){if(isNaN(E)||isNaN(J)||isNaN(ye)||isNaN(Ce)||isNaN(Ue)||isNaN(et)||!uo(ct))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ye-E,Ce-J],[Ue-ye,et-Ce],[E-Ue,J-et]],E,J,[1,1],ct,!0),this},d.__private__.roundedRect=d.roundedRect=function(E,J,ye,Ce,Ue,et,ct){if(isNaN(E)||isNaN(J)||isNaN(ye)||isNaN(Ce)||isNaN(Ue)||isNaN(et)||!uo(ct))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ut=4/3*(Math.SQRT2-1);return Ue=Math.min(Ue,.5*ye),et=Math.min(et,.5*Ce),this.lines([[ye-2*Ue,0],[Ue*Ut,0,Ue,et-et*Ut,Ue,et],[0,Ce-2*et],[0,et*Ut,-Ue*Ut,et,-Ue,et],[2*Ue-ye,0],[-Ue*Ut,0,-Ue,-et*Ut,-Ue,-et],[0,2*et-Ce],[0,-et*Ut,Ue*Ut,-et,Ue,-et]],E+Ue,J,[1,1],ct,!0),this},d.__private__.ellipse=d.ellipse=function(E,J,ye,Ce,Ue){if(isNaN(E)||isNaN(J)||isNaN(ye)||isNaN(Ce)||!uo(Ue))throw new Error("Invalid arguments passed to jsPDF.ellipse");var et=4/3*(Math.SQRT2-1)*ye,ct=4/3*(Math.SQRT2-1)*Ce;return Dd(E+ye,J),Ui(E+ye,J-ct,E+et,J-Ce,E,J-Ce),Ui(E-et,J-Ce,E-ye,J-ct,E-ye,J),Ui(E-ye,J+ct,E-et,J+Ce,E,J+Ce),Ui(E+et,J+Ce,E+ye,J+ct,E+ye,J),Rc(Ue),this},d.__private__.circle=d.circle=function(E,J,ye,Ce){if(isNaN(E)||isNaN(J)||isNaN(ye)||!uo(Ce))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(E,J,ye,ye,Ce)},d.setFont=function(E,J,ye){return ye&&(J=S(J,ye)),qe=kl(E,J,{disableWarning:!1}),this};var Ix=d.__private__.getFont=d.getFont=function(){return st[kl.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var E,J,ye={};for(E in pt)if(pt.hasOwnProperty(E))for(J in ye[E]=[],pt[E])pt[E].hasOwnProperty(J)&&ye[E].push(J);return ye},d.addFont=function(E,J,ye,Ce,Ue){var et=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&et.indexOf(arguments[3])!==-1?Ue=arguments[3]:arguments[3]&&et.indexOf(arguments[3])==-1&&(ye=S(ye,Ce)),Vt.call(this,E,J,ye,Ue=Ue||"Identity-H")};var Qc,Pd=e.lineWidth||.200025,Ux=d.__private__.getLineWidth=d.getLineWidth=function(){return Pd},tr=d.__private__.setLineWidth=d.setLineWidth=function(E){return Pd=E,ie(I(P(E))+" w"),this};d.__private__.setLineDash=Qt.API.setLineDash=Qt.API.setLineDashPattern=function(E,J){if(E=E||[],J=J||0,isNaN(J)||!Array.isArray(E))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return E=E.map(function(ye){return I(P(ye))}).join(" "),J=I(P(J)),ie("["+E+"] "+J+" d"),this};var Lx=d.__private__.getLineHeight=d.getLineHeight=function(){return Re*Qc};d.__private__.getLineHeight=d.getLineHeight=function(){return Re*Qc};var Dx=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(E){return typeof(E=E||1.15)=="number"&&(Qc=E),this},Px=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Qc};Dx(e.lineHeight);var Qo=d.__private__.getHorizontalCoordinate=function(E){return P(E)},Mo=d.__private__.getVerticalCoordinate=function(E){return v===b?E:St[U].mediaBox.topRightY-St[U].mediaBox.bottomLeftY-P(E)},Ox=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(E){return I(Qo(E))},Rx=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(E){return I(Mo(E))},tu=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return pe(tu)},d.__private__.setStrokeColor=d.setDrawColor=function(E,J,ye,Ce){return tu=me({ch1:E,ch2:J,ch3:ye,ch4:Ce,pdfColorType:"draw",precision:2}),ie(tu),this};var Od=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return pe(Od)},d.__private__.setFillColor=d.setFillColor=function(E,J,ye,Ce){return Od=me({ch1:E,ch2:J,ch3:ye,ch4:Ce,pdfColorType:"fill",precision:2}),ie(Od),this};var Mc=e.textColor||"0 g",Qx=d.__private__.getTextColor=d.getTextColor=function(){return pe(Mc)};d.__private__.setTextColor=d.setTextColor=function(E,J,ye,Ce){return Mc=me({ch1:E,ch2:J,ch3:ye,ch4:Ce,pdfColorType:"text",precision:3}),this};var Ho=e.charSpace,Mx=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(Ho||0)};d.__private__.setCharSpace=d.setCharSpace=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ho=E,this};var Rd=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(E){var J=d.CapJoinStyles[E];if(J===void 0)throw new Error("Line cap style of '"+E+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Rd=J,ie(J+" J"),this};var Qd=0;d.__private__.setLineJoin=d.setLineJoin=function(E){var J=d.CapJoinStyles[E];if(J===void 0)throw new Error("Line join style of '"+E+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qd=J,ie(J+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(E){if(E=E||0,isNaN(E))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ie(I(P(E))+" M"),this},d.GState=Fg,d.setGState=function(E){(E=typeof E=="string"?yt[Ct[E]]:Nh(null,E)).equals(er)||(ie("/"+E.id+" gs"),er=E)};var Nh=function(E,J){if(!E||!Ct[E]){var ye=!1;for(var Ce in yt)if(yt.hasOwnProperty(Ce)&&yt[Ce].equals(J)){ye=!0;break}if(ye)J=yt[Ce];else{var Ue="GS"+(Object.keys(yt).length+1).toString(10);yt[Ue]=J,J.id=Ue}return E&&(Ct[E]=J.id),Ar.publish("addGState",J),J}};d.addGState=function(E,J){return Nh(E,J),this},d.saveGraphicsState=function(){return ie("q"),It.push({key:qe,size:Re,color:Mc}),this},d.restoreGraphicsState=function(){ie("Q");var E=It.pop();return qe=E.key,Re=E.size,Mc=E.color,er=null,this},d.setCurrentTransformationMatrix=function(E){return ie(E.toString()+" cm"),this},d.comment=function(E){return ie("#"+E),this};var Ko=function(E,J){var ye=E||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ye},set:function(et){isNaN(et)||(ye=parseFloat(et))}});var Ce=J||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ce},set:function(et){isNaN(et)||(Ce=parseFloat(et))}});var Ue="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ue},set:function(et){Ue=et.toString()}}),this},Md=function(E,J,ye,Ce){Ko.call(this,E,J),this.type="rect";var Ue=ye||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ue},set:function(ct){isNaN(ct)||(Ue=parseFloat(ct))}});var et=Ce||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return et},set:function(ct){isNaN(ct)||(et=parseFloat(ct))}}),this},ru=function(){this.page=Wt,this.currentPage=U,this.pages=Be.slice(0),this.pagesContext=St.slice(0),this.x=Ve,this.y=Et,this.matrix=xt,this.width=Kd(U),this.height=kh(U),this.outputDestination=Te,this.id="",this.objectNumber=-1};ru.prototype.restore=function(){Wt=this.page,U=this.currentPage,St=this.pagesContext,Be=this.pages,Ve=this.x,Et=this.y,xt=this.matrix,Sh(U,this.width),qo(U,this.height),Te=this.outputDestination};var Hd=function(E,J,ye,Ce,Ue){Wn.push(new ru),Wt=U=0,Be=[],Ve=E,Et=J,xt=Ue,Br([ye,Ce])};for(var Hc in d.beginFormObject=function(E,J,ye,Ce,Ue){return Hd(E,J,ye,Ce,Ue),this},d.endFormObject=function(E){return function(J){if(an[J])Wn.pop().restore();else{var ye=new ru,Ce="Xo"+(Object.keys(sr).length+1).toString(10);ye.id=Ce,an[J]=Ce,sr[Ce]=ye,Ar.publish("addFormObject",ye),Wn.pop().restore()}}(E),this},d.doFormObject=function(E,J){var ye=sr[an[E]];return ie("q"),ie(J.toString()+" cm"),ie("/"+ye.id+" Do"),ie("Q"),this},d.getFormObject=function(E){var J=sr[an[E]];return{x:J.x,y:J.y,width:J.width,height:J.height,matrix:J.matrix}},d.save=function(E,J){return E=E||"generated.pdf",(J=J||{}).returnPromise=J.returnPromise||!1,J.returnPromise===!1?(aA(ZA(Ao()),E),typeof aA.unload=="function"&&Jt.setTimeout&&setTimeout(aA.unload,911),this):new Promise(function(ye,Ce){try{var Ue=aA(ZA(Ao()),E);typeof aA.unload=="function"&&Jt.setTimeout&&setTimeout(aA.unload,911),ye(Ue)}catch(et){Ce(et.message)}})},Qt.API)Qt.API.hasOwnProperty(Hc)&&(Hc==="events"&&Qt.API.events.length?function(E,J){var ye,Ce,Ue;for(Ue=J.length-1;Ue!==-1;Ue--)ye=J[Ue][0],Ce=J[Ue][1],E.subscribe.apply(E,[ye].concat(typeof Ce=="function"?[Ce]:Ce))}(Ar,Qt.API.events):d[Hc]=Qt.API[Hc]);function Kd(E){return St[E].mediaBox.topRightX-St[E].mediaBox.bottomLeftX}function Sh(E,J){St[E].mediaBox.topRightX=J+St[E].mediaBox.bottomLeftX}function kh(E){return St[E].mediaBox.topRightY-St[E].mediaBox.bottomLeftY}function qo(E,J){St[E].mediaBox.topRightY=J+St[E].mediaBox.bottomLeftY}var Vo=d.getPageWidth=function(E){return Kd(E=E||U)/Me},Eh=d.setPageWidth=function(E,J){Sh(E,J*Me)},Kc=d.getPageHeight=function(E){return kh(E=E||U)/Me},Fh=d.setPageHeight=function(E,J){qo(E,J*Me)};return d.internal={pdfEscape:Ht,getStyle:_h,getFont:Ix,getFontSize:we,getCharSpace:Mx,getTextColor:Qx,getLineHeight:Lx,getLineHeightFactor:Px,getLineWidth:Ux,write:$e,getHorizontalCoordinate:Qo,getVerticalCoordinate:Mo,getCoordinateString:Ox,getVerticalCoordinateString:Rx,collections:{},newObject:dt,newAdditionalObject:ue,newObjectDeferred:Mt,newObjectDeferredBegin:W,getFilters:De,putStream:Ge,events:Ar,scaleFactor:Me,pageSize:{getWidth:function(){return Vo(U)},setWidth:function(E){Eh(U,E)},getHeight:function(){return Kc(U)},setHeight:function(E){Fh(U,E)}},encryptionOptions:u,encryption:$n,getEncryptor:function(E){return u!==null?$n.encryptor(E,0):function(J){return J}},output:wh,getNumberOfPages:ta,get pages(){return Be},out:ie,f2:L,f3:T,getPageInfo:Ro,getPageInfoByObjId:bh,getCurrentPageInfo:kx,getPDFVersion:g,Point:Ko,Rectangle:Md,Matrix:Pt,hasHotfix:oi},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Vo(U)},set:function(E){Eh(U,E)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Kc(U)},set:function(E){Fh(U,E)},enumerable:!0,configurable:!0}),(function(E){for(var J=0,ye=Fe.length;J<ye;J++){var Ce=Vt.call(this,E[J][0],E[J][1],E[J][2],Fe[J][3],!0);f===!1&&(h[Ce]=!0);var Ue=E[J][0].split("-");bt({id:Ce,fontName:Ue[0],fontStyle:Ue[1]||""})}Ar.publish("addFonts",{fonts:st,dictionary:pt})}).call(d,Fe),qe="F1",js(s,r),Ar.publish("initialized"),d}Eu.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Eu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Eu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Eu.prototype.processOwnerPassword=function(e,t){return Tw(jw(t).substr(0,5),e)},Eu.prototype.encryptor=function(e,t){var r=jw(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Tw(r,n)}},Fg.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Lr(e)!==Lr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Qt.API={events:[]},Qt.version="3.0.4";var gn=Qt.API,e_=1,YA=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},rr=function(e){return e.toFixed(2)},$l=function(e){return e.toFixed(5)};gn.__acroform__={};var Ia=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},JC=function(e){return e*e_},bo=function(e){var t=new tT,r=Tt.internal.getHeight(e)||0,n=Tt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(rr(n)),Number(rr(r))],t},MY=gn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},HY=gn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},KY=gn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Fn=gn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return KY(e,t-1)},jn=gn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return MY(e,t-1)},Tn=gn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return HY(e,t-1)},qY=gn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],a=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(a)||0,[Number(rr(c.lowerLeft_X)),Number(rr(c.lowerLeft_Y)),Number(rr(c.upperRight_X)),Number(rr(c.upperRight_Y))]},VY=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Iw(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+rr(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=bo(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},Iw=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(L){return L.split(`
`)}):s.map(function(L){return[L]});var a=r,o=Tt.internal.getHeight(e)||0;o=o<0?-o:o;var l=Tt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(L,T,P){if(L+1<s.length){var R=T+" "+s[L+1][0];return Hp(R,e,P).width<=l-4}return!1};a++;e:for(;a>0;){t="",a--;var A,u,f=Hp("3",e,a).height,h=e.multiline?o-a:(o-f)/2,d=h+=2,x=0,g=0,y=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+Hp(t,e,a=12).width+", FieldWidth:"+l+`
`;break}for(var m="",p=0,b=0;b<s.length;b++)if(s.hasOwnProperty(b)){var v=!1;if(s[b].length!==1&&y!==s[b].length-1){if((f+2)*(p+2)+2>o)continue e;m+=s[b][y],v=!0,g=b,b--}else{m=(m+=s[b][y]+" ").substr(m.length-1)==" "?m.substr(0,m.length-1):m;var C=parseInt(b),k=c(C,m,a),S=b>=s.length-1;if(k&&!S){m+=" ",y=0;continue}if(k||S){if(S)g=C;else if(e.multiline&&(f+2)*(p+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(p+2)+2>o)continue e;g=C}}for(var I="",N=x;N<=g;N++){var Q=s[N];if(e.multiline){if(N===g){I+=Q[y]+" ",y=(y+1)%Q.length;continue}if(N===x){I+=Q[Q.length-1]+" ";continue}}I+=Q[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,u=Hp(I,e,a).width,e.textAlign){case"right":A=l-u-2;break;case"center":A=(l-u)/2;break;default:A=2}t+=rr(A)+" "+rr(d)+` Td
`,t+="("+YA(I)+`) Tj
`,t+=-rr(A)+` 0 Td
`,d=-(a+2),u=0,x=v?g:g+1,p++,m=""}break}return n.text=t,n.fontSize=a,n},Hp=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},GY={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},WY=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},$Y=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(oo.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(GY)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");e_=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new rT,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&WY(a,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],A=l.Rect;if(l.Rect&&(l.Rect=qY(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Tt.createDefaultAppearanceStream(l),Lr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=A,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=VY(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var d=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var o in d)if(d.hasOwnProperty(o)){var x=d[o];typeof x=="function"&&(x=x.call(s,l)),f+="/"+o+" "+x+" ",s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x)}}else typeof(x=d)=="function"&&(x=x.call(s,l)),f+="/"+o+" "+x,s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}a&&function(g,y){for(var m in g)if(g.hasOwnProperty(m)){var p=m,b=g[m];y.internal.newObjectDeferredBegin(b.objId,!0),Lr(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete g[p]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},eT=gn.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var s="[",a=0;a<e.length;a++)switch(a!==0&&(s+=" "),Lr(e[a])){case"boolean":case"number":case"object":s+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+YA(n(e[a].toString()))+")"):s+=e[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Nv=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+YA(n(e))+")"},So=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};So.prototype.toString=function(){return this.objId+" 0 R"},So.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},So.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:eT(s,this.objId,this.scope)}):s instanceof So?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var tT=function(){So.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ia(tT,So);var rT=function(){So.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+YA(r(e))+")"}},set:function(r){e=r}})};Ia(rT,So);var oo=function e(){So.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute F supplied.');t=m}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Fn(t,3)},set:function(m){m?this.F=jn(t,3):this.F=Tn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute Ff supplied.');r=m}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(m){n=m!==void 0?m:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(m){n[0]=m}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(m){n[1]=m}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(m){n[2]=m}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(m){n[3]=m}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(m){switch(m){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=m;break;default:throw new Error('Invalid value "'+m+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof jg)return;a="FieldObject"+e.FieldNum++}var m=function(p){return p};return this.scope&&(m=this.scope.internal.getEncryptor(this.objId)),"("+YA(m(a))+")"},set:function(m){a=m.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(m){a=m}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(m){o=m}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(m){l=m}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(m){c=m}});var A=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return A===void 0?50/e_:A},set:function(m){A=m}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(m){u=m}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof jg||this instanceof BA))return Nv(f,this.objId,this.scope)},set:function(m){m=m.toString(),f=m}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof As==0?Nv(h,this.objId,this.scope):h},set:function(m){m=m.toString(),h=this instanceof As==0?m.substr(0,1)==="("?xu(m.substr(1,m.length-2)):xu(m):m}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof As==1?xu(h.substr(1,h.length-1)):h},set:function(m){m=m.toString(),h=this instanceof As==1?"/"+m:m}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(m){this.V=m}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof As==0?Nv(d,this.objId,this.scope):d},set:function(m){m=m.toString(),d=this instanceof As==0?m.substr(0,1)==="("?xu(m.substr(1,m.length-2)):xu(m):m}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof As==1?xu(d.substr(1,d.length-1)):d},set:function(m){m=m.toString(),d=this instanceof As==1?"/"+m:m}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(m){m=!!m,g=m}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(m){x=m}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,1)},set:function(m){m?this.Ff=jn(this.Ff,1):this.Ff=Tn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,2)},set:function(m){m?this.Ff=jn(this.Ff,2):this.Ff=Tn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,3)},set:function(m){m?this.Ff=jn(this.Ff,3):this.Ff=Tn(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(m){if([0,1,2].indexOf(m)===-1)throw new Error('Invalid value "'+m+'" for attribute Q supplied.');y=m}}),Object.defineProperty(this,"textAlign",{get:function(){var m;switch(y){case 0:default:m="left";break;case 1:m="center";break;case 2:m="right"}return m},configurable:!0,enumerable:!0,set:function(m){switch(m){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ia(oo,So);var od=function(){oo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return eT(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,o,l){l||(l=1);for(var c,A=[];c=o.exec(a);)A.push(c[l]);return A}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,18)},set:function(r){r?this.Ff=jn(this.Ff,18):this.Ff=Tn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=jn(this.Ff,19):this.Ff=Tn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,20)},set:function(r){r?(this.Ff=jn(this.Ff,20),t.sort()):this.Ff=Tn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,22)},set:function(r){r?this.Ff=jn(this.Ff,22):this.Ff=Tn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,23)},set:function(r){r?this.Ff=jn(this.Ff,23):this.Ff=Tn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,27)},set:function(r){r?this.Ff=jn(this.Ff,27):this.Ff=Tn(this.Ff,27)}}),this.hasAppearanceStream=!1};Ia(od,oo);var ld=function(){od.call(this),this.fontName="helvetica",this.combo=!1};Ia(ld,od);var cd=function(){ld.call(this),this.combo=!0};Ia(cd,ld);var Fm=function(){cd.call(this),this.edit=!0};Ia(Fm,cd);var As=function(){oo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,15)},set:function(r){r?this.Ff=jn(this.Ff,15):this.Ff=Tn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,16)},set:function(r){r?this.Ff=jn(this.Ff,16):this.Ff=Tn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,17)},set:function(r){r?this.Ff=jn(this.Ff,17):this.Ff=Tn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,26)},set:function(r){r?this.Ff=jn(this.Ff,26):this.Ff=Tn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+YA(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Lr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ia(As,oo);var jm=function(){As.call(this),this.pushButton=!0};Ia(jm,As);var Ad=function(){As.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ia(Ad,As);var jg=function(){var e,t;oo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+YA(s(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Lr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Tt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ia(jg,oo),Ad.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Ad.prototype.createOption=function(e){var t=new jg;return t.Parent=this,t.optionName=e,this.Kids.push(t),zY.call(this.scope,t),t};var Tm=function(){As.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Tt.CheckBox.createAppearanceStream()};Ia(Tm,As);var BA=function(){oo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,13)},set:function(t){t?this.Ff=jn(this.Ff,13):this.Ff=Tn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,21)},set:function(t){t?this.Ff=jn(this.Ff,21):this.Ff=Tn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,23)},set:function(t){t?this.Ff=jn(this.Ff,23):this.Ff=Tn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,24)},set:function(t){t?this.Ff=jn(this.Ff,24):this.Ff=Tn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,25)},set:function(t){t?this.Ff=jn(this.Ff,25):this.Ff=Tn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,26)},set:function(t){t?this.Ff=jn(this.Ff,26):this.Ff=Tn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ia(BA,oo);var Im=function(){BA.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Fn(this.Ff,14)},set:function(e){e?this.Ff=jn(this.Ff,14):this.Ff=Tn(this.Ff,14)}}),this.password=!0};Ia(Im,BA);var Tt={CheckBox:{createAppearanceStream:function(){return{N:{On:Tt.CheckBox.YesNormal},D:{On:Tt.CheckBox.YesPushDown,Off:Tt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=bo(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),a=Iw(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+rr(Tt.internal.getWidth(e))+" "+rr(Tt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+rr(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=bo(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],a=Tt.internal.getHeight(e),o=Tt.internal.getWidth(e),l=Iw(e,e.caption);return s.push("1 g"),s.push("0 0 "+rr(o)+" "+rr(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+rr(o-1)+" "+rr(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+rr(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=bo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+rr(Tt.internal.getWidth(e))+" "+rr(Tt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Tt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Tt.RadioButton.Circle.YesNormal,t.D[e]=Tt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=bo(e);t.scope=e.scope;var r=[],n=Tt.internal.getWidth(e)<=Tt.internal.getHeight(e)?Tt.internal.getWidth(e)/4:Tt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Tt.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+$l(Tt.internal.getWidth(e)/2)+" "+$l(Tt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=bo(e);t.scope=e.scope;var r=[],n=Tt.internal.getWidth(e)<=Tt.internal.getHeight(e)?Tt.internal.getWidth(e)/4:Tt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*Tt.internal.Bezier_C).toFixed(5)),o=Number((n*Tt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+$l(Tt.internal.getWidth(e)/2)+" "+$l(Tt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+$l(Tt.internal.getWidth(e)/2)+" "+$l(Tt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=bo(e);t.scope=e.scope;var r=[],n=Tt.internal.getWidth(e)<=Tt.internal.getHeight(e)?Tt.internal.getWidth(e)/4:Tt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*Tt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+$l(Tt.internal.getWidth(e)/2)+" "+$l(Tt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Tt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Tt.RadioButton.Cross.YesNormal,t.D[e]=Tt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=bo(e);t.scope=e.scope;var r=[],n=Tt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+rr(Tt.internal.getWidth(e)-2)+" "+rr(Tt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(rr(n.x1.x)+" "+rr(n.x1.y)+" m"),r.push(rr(n.x2.x)+" "+rr(n.x2.y)+" l"),r.push(rr(n.x4.x)+" "+rr(n.x4.y)+" m"),r.push(rr(n.x3.x)+" "+rr(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=bo(e);t.scope=e.scope;var r=Tt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+rr(Tt.internal.getWidth(e))+" "+rr(Tt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+rr(Tt.internal.getWidth(e)-2)+" "+rr(Tt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(rr(r.x1.x)+" "+rr(r.x1.y)+" m"),n.push(rr(r.x2.x)+" "+rr(r.x2.y)+" l"),n.push(rr(r.x4.x)+" "+rr(r.x4.y)+" m"),n.push(rr(r.x3.x)+" "+rr(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=bo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+rr(Tt.internal.getWidth(e))+" "+rr(Tt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Tt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Tt.internal.getWidth(e),r=Tt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Tt.internal.getWidth=function(e){var t=0;return Lr(e)==="object"&&(t=JC(e.Rect[2])),t},Tt.internal.getHeight=function(e){var t=0;return Lr(e)==="object"&&(t=JC(e.Rect[3])),t};var zY=gn.addField=function(e){if($Y(this,e),!(e instanceof oo))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};gn.AcroFormChoiceField=od,gn.AcroFormListBox=ld,gn.AcroFormComboBox=cd,gn.AcroFormEditBox=Fm,gn.AcroFormButton=As,gn.AcroFormPushButton=jm,gn.AcroFormRadioButton=Ad,gn.AcroFormCheckBox=Tm,gn.AcroFormTextField=BA,gn.AcroFormPasswordField=Im,gn.AcroFormAppearance=Tt,gn.AcroForm={ChoiceField:od,ListBox:ld,ComboBox:cd,EditBox:Fm,Button:As,PushButton:jm,RadioButton:Ad,CheckBox:Tm,TextField:BA,PasswordField:Im,Appearance:Tt},Qt.AcroForm={ChoiceField:od,ListBox:ld,ComboBox:cd,EditBox:Fm,Button:As,PushButton:jm,RadioButton:Ad,CheckBox:Tm,TextField:BA,PasswordField:Im,Appearance:Tt};Qt.AcroForm;function nT(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(L,T){var P,R,z,q,M,V=r;if((T=T||r)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(k(L))for(M in n)for(z=n[M],P=0;P<z.length;P+=1){for(q=!0,R=0;R<z[P].length;R+=1)if(z[P][R]!==void 0&&z[P][R]!==L[R]){q=!1;break}if(q===!0){V=M;break}}else for(M in n)for(z=n[M],P=0;P<z.length;P+=1){for(q=!0,R=0;R<z[P].length;R+=1)if(z[P][R]!==void 0&&z[P][R]!==L.charCodeAt(R)){q=!1;break}if(q===!0){V=M;break}}return V===r&&T!==r&&(V=T),V},a=function L(T){for(var P=this.internal.write,R=this.internal.putStream,z=(0,this.internal.getFilters)();z.indexOf("FlateEncode")!==-1;)z.splice(z.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var q=[];if(q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Image"}),q.push({key:"Width",value:T.width}),q.push({key:"Height",value:T.height}),T.colorSpace===m.INDEXED?q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(q.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===m.DEVICE_CMYK&&q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),q.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&q.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var M="",V=0,H=T.transparency.length;V<H;V++)M+=T.transparency[V]+" "+T.transparency[V]+" ";q.push({key:"Mask",value:"["+M+"]"})}T.sMask!==void 0&&q.push({key:"SMask",value:T.objectId+1+" 0 R"});var se=T.filter!==void 0?["/"+T.filter]:void 0;if(R({data:T.data,additionalKeyValues:q,alreadyAppliedFilters:se,objectId:T.objectId}),P("endobj"),"sMask"in T&&T.sMask!==void 0){var ce,B=(ce=T.sMaskBitsPerComponent)!==null&&ce!==void 0?ce:T.bitsPerComponent,U={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:B,data:T.sMask};"filter"in T&&(U.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(B," /Columns ").concat(T.width),U.filter=T.filter),L.call(this,U)}if(T.colorSpace===m.INDEXED){var F=this.internal.newObject();R({data:I(new Uint8Array(T.palette)),objectId:F}),P("endobj")}},o=function(){var L=this.internal.collections[t+"images"];for(var T in L)a.call(this,L[T])},l=function(){var L,T=this.internal.collections[t+"images"],P=this.internal.write;for(var R in T)P("/I"+(L=T[R]).index,L.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},A=function(){var L=this.internal.collections[t+"images"];return c.call(this),L},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(L){return typeof e["process"+L.toUpperCase()]=="function"},h=function(L){return Lr(L)==="object"&&L.nodeType===1},d=function(L,T){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var P=""+L.getAttribute("src");if(P.indexOf("data:image/")===0)return Em(unescape(P).split("base64,").pop());var R=e.loadFile(P,!0);if(R!==void 0)return R}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var z;switch(T){case"PNG":z="image/png";break;case"WEBP":z="image/webp";break;default:z="image/jpeg"}return Em(L.toDataURL(z,1).split("base64,").pop())}},x=function(L){var T=this.internal.collections[t+"images"];if(T){for(var P in T)if(L===T[P].alias)return T[P]}},g=function(L,T,P){return L||T||(L=-96,T=-96),L<0&&(L=-1*P.width*72/L/this.internal.scaleFactor),T<0&&(T=-1*P.height*72/T/this.internal.scaleFactor),L===0&&(L=T*P.width/P.height),T===0&&(T=L*P.height/P.width),[L,T]},y=function(L,T,P,R,z,q){var M=g.call(this,P,R,z),V=this.internal.getCoordinateString,H=this.internal.getVerticalCoordinateString,se=A.call(this);if(P=M[0],R=M[1],se[z.index]=z,q){q*=Math.PI/180;var ce=Math.cos(q),B=Math.sin(q),U=function(D){return D.toFixed(4)},F=[U(ce),U(B),U(-1*B),U(ce),0,0,"cm"]}this.internal.write("q"),q?(this.internal.write([1,"0","0",1,V(L),H(T+R),"cm"].join(" ")),this.internal.write(F.join(" ")),this.internal.write([V(P),"0","0",V(R),"0","0","cm"].join(" "))):this.internal.write([V(P),"0","0",V(R),V(L),H(T+R),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+z.index+" Do"),this.internal.write("Q")},m=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var p=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(L){var T,P,R=0;if(typeof L=="string")for(P=L.length,T=0;T<P;T++)R=(R<<5)-R+L.charCodeAt(T),R|=0;else if(k(L))for(P=L.byteLength/2,T=0;T<P;T++)R=(R<<5)-R+L[T],R|=0;return R},v=e.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var T=!0;return L.length===0&&(T=!1),L.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(T=!1),T},C=e.__addimage__.extractImageFromDataUrl=function(L){if(L==null||!(L=L.trim()).startsWith("data:"))return null;var T=L.indexOf(",");return T<0?null:L.substring(0,T).trim().endsWith("base64")?L.substring(T+1):null};e.__addimage__.isArrayBuffer=function(L){return L instanceof ArrayBuffer};var k=e.__addimage__.isArrayBufferView=function(L){return L instanceof Int8Array||L instanceof Uint8Array||L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array},S=e.__addimage__.binaryStringToUint8Array=function(L){for(var T=L.length,P=new Uint8Array(T),R=0;R<T;R++)P[R]=L.charCodeAt(R);return P},I=e.__addimage__.arrayBufferToBinaryString=function(L){for(var T="",P=k(L)?L:new Uint8Array(L),R=0;R<P.length;R+=8192)T+=String.fromCharCode.apply(null,P.subarray(R,R+8192));return T};e.addImage=function(){var L,T,P,R,z,q,M,V,H;if(typeof arguments[1]=="number"?(T=r,P=arguments[1],R=arguments[2],z=arguments[3],q=arguments[4],M=arguments[5],V=arguments[6],H=arguments[7]):(T=arguments[1],P=arguments[2],R=arguments[3],z=arguments[4],q=arguments[5],M=arguments[6],V=arguments[7],H=arguments[8]),Lr(L=arguments[0])==="object"&&!h(L)&&"imageData"in L){var se=L;L=se.imageData,T=se.format||T||r,P=se.x||P||0,R=se.y||R||0,z=se.w||se.width||z,q=se.h||se.height||q,M=se.alias||M,V=se.compression||V,H=se.rotation||se.angle||H}var ce=this.internal.getFilters();if(V===void 0&&ce.indexOf("FlateEncode")!==-1&&(V="SLOW"),isNaN(P)||isNaN(R))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var B=N.call(this,L,T,M,V);return y.call(this,P,R,z,q,B,H),this};var N=function(L,T,P,R){var z,q,M;if(typeof L=="string"&&s(L)===r){L=unescape(L);var V=Q(L,!1);(V!==""||(V=e.loadFile(L,!0))!==void 0)&&(L=V)}if(h(L)&&(L=d(L,T)),T=s(L,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((M=P)==null||M.length===0)&&(P=function(H){return typeof H=="string"||k(H)?b(H):k(H.data)?b(H.data):null}(L)),(z=x.call(this,P))||(L instanceof Uint8Array||T==="RGBA"||(q=L,L=S(L)),z=this["process"+T.toUpperCase()](L,u.call(this),P,function(H){return H&&typeof H=="string"&&(H=H.toUpperCase()),H in e.image_compression?H:p.NONE}(R),q)),!z)throw new Error("An unknown error occurred whilst processing the image.");return z},Q=e.__addimage__.convertBase64ToBinaryString=function(L,T){T=typeof T!="boolean"||T;var P,R="";if(typeof L=="string"){var z;P=(z=C(L))!==null&&z!==void 0?z:L;try{R=Em(P)}catch(q){if(T)throw v(P)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return R};e.getImageProperties=function(L){var T,P,R="";if(h(L)&&(L=d(L)),typeof L=="string"&&s(L)===r&&((R=Q(L,!1))===""&&(R=e.loadFile(L)||""),L=R),P=s(L),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(L instanceof Uint8Array||(L=S(L)),!(T=this["process"+P.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=P,T}})(Qt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Qt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),A=r.pageContext.annotations,u=!1,f=0;f<A.length&&!u;f++)switch((n=A[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<A.length;h++){n=A[h];var d=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(g.objId),p=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+d(m(n.contents))+")",a+=" /Popup "+y.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+d(m(p))+") >>",g.content=a;var b=g.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",y.content=a,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var v=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+d(x(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var C=this.annotations._nameMap[n.options.name];n.options.pageNumber=C.page,n.options.top=C.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+d(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var k=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+k+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:A(n),w:c(r+s),h:A(n+a)},options:o,type:"link"})},e.textWithLink=function(r,n,s,a){var o,l,c=this.getTextWidth(r),A=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(A*u)}else l=c,o=A;return this.text(r,n,s,a),s+=.2*A,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-A,l,o,a),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Qt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&a(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&s.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&a(g)&&t[g.charCodeAt(0)].length>=1};var A=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&a(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&a(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&a(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,m=r,p="",b=0;for(y=0;y<g.length;y+=1)m[g.charCodeAt(y)]!==void 0?(b++,typeof(m=m[g.charCodeAt(y)])=="number"&&(p+=String.fromCharCode(m),m=r,b=0),y===g.length-1&&(m=r,p+=g.charAt(y-(b-1)),y-=b-1,b=0)):(m=r,p+=g.charAt(y-b),y-=b,b=0);return p};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,y,m){return o(g)?a(g)===!1?-1:!A(g)||!o(y)&&!o(m)||!o(m)&&l(y)||l(g)&&!o(y)||l(g)&&c(y)||l(g)&&l(y)?0:u(g)&&o(y)&&!l(y)&&o(m)&&A(m)?3:l(g)||!o(m)?1:2:-1},d=function(g){var y=0,m=0,p=0,b="",v="",C="",k=(g=g||"").split("\\s+"),S=[];for(y=0;y<k.length;y+=1){for(S.push(""),m=0;m<k[y].length;m+=1)b=k[y][m],v=k[y][m-1],C=k[y][m+1],o(b)?(p=h(b,v,C),S[y]+=p!==-1?String.fromCharCode(t[b.charCodeAt(0)][p]):b):S[y]+=b;S[y]=f(S[y])}return S.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,m=[];if(Array.isArray(y)){var p=0;for(m=[],p=0;p<y.length;p+=1)Array.isArray(y[p])?m.push([d(y[p][0]),y[p][1],y[p][2]]):m.push([d(y[p])]);g=m}else g=d(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",x])}(Qt.API),Qt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Qt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var A=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(g){A=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(g){x=g}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,A){n.call(this);var u=(A=A||{}).fontSize||this.getFontSize(),f=A.font||this.getFont(),h=A.scaleFactor||this.internal.scaleFactor,d=0,x=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var m=A.maxWidth;m>0?typeof c=="string"?c=this.splitTextToSize(c,m):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,v){return b.concat(y.splitTextToSize(v,m))},[])):c=Array.isArray(c)?c:[c];for(var p=0;p<c.length;p++)d<(g=this.getStringUnitWidth(c[p],{font:f})*u)&&(d=g);return d!==0&&(x=c.length),{w:d/=h,h:Math.max((x*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var A=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return A.lineNumber!==void 0&&(A.lineNumber===c.lineNumber?(c.x=(A.x||0)+(A.width||0),c.y=A.y||0):A.y+A.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,d&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=A.y+A.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,A,u,f,h){if(n.call(this),!u)throw new Error("No data for PDF table.");var d,x,g,y,m=[],p=[],b=[],v={},C={},k=[],S=[],I=(h=h||{}).autoSize||!1,N=h.printHeaders!==!1,Q=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,L=h.margins||Object.assign({width:this.getPageWidth()},t),T=typeof h.padding=="number"?h.padding:3,P=h.headerBackgroundColor||"#c8c8c8",R=h.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=N,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=Q,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=P,this.internal.__cell__.headerTextColor=R,this.setFontSize(Q),f==null)p=m=Object.keys(u[0]),b=m.map(function(){return"left"});else if(Array.isArray(f)&&Lr(f[0])==="object")for(m=f.map(function(se){return se.name}),p=f.map(function(se){return se.prompt||se.name||""}),b=f.map(function(se){return se.align||"left"}),d=0;d<f.length;d+=1)C[f[d].name]=.7499990551181103*f[d].width;else Array.isArray(f)&&typeof f[0]=="string"&&(p=m=f,b=m.map(function(){return"left"}));if(I||Array.isArray(f)&&typeof f[0]=="string")for(d=0;d<m.length;d+=1){for(v[y=m[d]]=u.map(function(se){return se[y]}),this.setFont(void 0,"bold"),k.push(this.getTextDimensions(p[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=v[y],this.setFont(void 0,"normal"),g=0;g<x.length;g+=1)k.push(this.getTextDimensions(x[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);C[y]=Math.max.apply(null,k)+T+T,k=[]}if(N){var z={};for(d=0;d<m.length;d+=1)z[m[d]]={},z[m[d]].text=p[d],z[m[d]].align=b[d];var q=l.call(this,z,C);S=m.map(function(se){return new a(c,A,C[se],q,z[se].text,void 0,z[se].align)}),this.setTableHeaderRow(S),this.printHeaderRow(1,!1)}var M=f.reduce(function(se,ce){return se[ce.name]=ce.align,se},{});for(d=0;d<u.length;d+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:d,data:u[d]},this);var V=l.call(this,u[d],C);for(g=0;g<m.length;g+=1){var H=u[d][m[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:d,col:g,data:H},this),o.call(this,new a(c,A,C[m[g]],V,H,d+2,M[m[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=A,this};var l=function(c,A){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(d){var x=c[d];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,A[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*f/h+u+u},this).reduce(function(d,x){return Math.max(d,x)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,A){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),A&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(x)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Qt.API);var sT={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},aT=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Uw=nT(aT),iT=[100,200,300,400,500,600,700,800,900],XY=nT(iT);function Sv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return sT[a=a||"normal"]?a:"normal"}(e.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(e.weight),s=function(a){return typeof Uw[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function ZC(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var YY={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},eN={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function tN(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function rN(e){return e.trimLeft()}function JY(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function ZY(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Kp,nN,sN,vu,qp,aN,iN,oN,kv=["times"];function lN(e,t,r,n,s){var a=4,o=AN;switch(s){case Qt.API.image_compression.FAST:a=1,o=cN;break;case Qt.API.image_compression.MEDIUM:a=6,o=uN;break;case Qt.API.image_compression.SLOW:a=9,o=dN}e=function(c,A,u,f){for(var h,d=c.length/A,x=new Uint8Array(c.length+d),g=[eJ,cN,AN,uN,dN],y=0;y<d;y+=1){var m=y*A,p=c.subarray(m,m+A);if(f)x.set(f(p,u,h),m+y);else{for(var b=g.length,v=[],C=0;C<b;C+=1)v[C]=g[C](p,u,h);var k=rJ(v.concat());x.set(v[k],m+y)}h=p}return x}(e,t,Math.ceil(r*n/8),o);var l=Sw(e,{level:a});return Qt.API.__addimage__.arrayBufferToBinaryString(l)}function eJ(e){var t=Array.apply([],e);return t.unshift(0),t}function cN(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=e[s-t]||0;n[s+1]=e[s]-a+256&255}return n}function AN(e,t,r){var n=e.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var o=r&&r[a]||0;s[a+1]=e[a]-o+256&255}return s}function uN(e,t,r){var n=e.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var o=e[a-t]||0,l=r&&r[a]||0;s[a+1]=e[a]+256-(o+l>>>1)&255}return s}function dN(e,t,r){var n=e.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var o=tJ(e[a-t]||0,r&&r[a]||0,r&&r[a-t]||0);s[a+1]=e[a]-o+256&255}return s}function tJ(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),a=Math.abs(e+t-r-r);return n<=s&&n<=a?e:s<=a?t:r}function rJ(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function Ev(e,t,r){var n=t*r,s=Math.floor(n/8),a=16-(n-8*s+r),o=(1<<r)-1;return oT(e,s)>>a&o}function fN(e,t,r,n){var s=r*n,a=Math.floor(s/8),o=16-(s-8*a+n),l=(1<<n)-1,c=(t&l)<<o;(function(A,u,f){if(u+1<A.byteLength)A.setUint16(u,f,!1);else{var h=f>>8&255;A.setUint8(u,h)}})(e,a,oT(e,a)&~(l<<o)&65535|c)}function oT(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function nJ(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],a=s>>7,o=1<<1+(7&s);e[t++],e[t++];var l=null,c=null;a&&(l=t,c=o,t+=3*o);var A=!0,u=[],f=0,h=null,d=0,x=null;for(this.width=r,this.height=n;A&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),d=g>>2&7,t++;break;case 254:for(;;){if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,m=e[t++]|e[t++]<<8,p=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,v=e[t++],C=v>>6&1,k=1<<1+(7&v),S=l,I=c,N=!1;v>>7&&(N=!0,S=t,I=k,t+=3*k);var Q=t;for(t++;;){var L;if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}u.push({x:y,y:m,width:p,height:b,has_local_palette:N,palette_offset:S,palette_size:I,data_offset:Q,data_length:t-Q,transparent_index:h,interlaced:!!C,delay:f,disposal:d});break;case 59:A=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return x},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,P){var R=this.frameInfo(T),z=R.width*R.height,q=new Uint8Array(z);hN(e,R.data_offset,q,z);var M=R.palette_offset,V=R.transparent_index;V===null&&(V=256);var H=R.width,se=r-H,ce=H,B=4*(R.y*r+R.x),U=4*((R.y+R.height)*r+R.x),F=B,D=4*se;R.interlaced===!0&&(D+=4*r*7);for(var X=8,K=0,ae=q.length;K<ae;++K){var he=q[K];if(ce===0&&(ce=H,(F+=D)>=U&&(D=4*se+4*r*(X-1),F=B+(H+se)*(X<<1),X>>=1)),he===V)F+=4;else{var Y=e[M+3*he],Be=e[M+3*he+1],ee=e[M+3*he+2];P[F++]=ee,P[F++]=Be,P[F++]=Y,P[F++]=255}--ce}},this.decodeAndBlitFrameRGBA=function(T,P){var R=this.frameInfo(T),z=R.width*R.height,q=new Uint8Array(z);hN(e,R.data_offset,q,z);var M=R.palette_offset,V=R.transparent_index;V===null&&(V=256);var H=R.width,se=r-H,ce=H,B=4*(R.y*r+R.x),U=4*((R.y+R.height)*r+R.x),F=B,D=4*se;R.interlaced===!0&&(D+=4*r*7);for(var X=8,K=0,ae=q.length;K<ae;++K){var he=q[K];if(ce===0&&(ce=H,(F+=D)>=U&&(D=4*se+4*r*(X-1),F=B+(H+se)*(X<<1),X>>=1)),he===V)F+=4;else{var Y=e[M+3*he],Be=e[M+3*he+1],ee=e[M+3*he+2];P[F++]=Y,P[F++]=Be,P[F++]=ee,P[F++]=255}--ce}}}function hN(e,t,r,n){for(var s=e[t++],a=1<<s,o=a+1,l=o+1,c=s+1,A=(1<<c)-1,u=0,f=0,h=0,d=e[t++],x=new Int32Array(4096),g=null;;){for(;u<16&&d!==0;)f|=e[t++]<<u,u+=8,d===1?d=e[t++]:--d;if(u<c)break;var y=f&A;if(f>>=c,u-=c,y!==a){if(y===o)break;for(var m=y<l?y:g,p=0,b=m;b>a;)b=x[b]>>8,++p;var v=b;if(h+p+(m!==y?1:0)>n)return void Kr.log("Warning, gif stream longer than expected.");r[h++]=v;var C=h+=p;for(m!==y&&(r[h++]=v),b=m;p--;)b=x[b],r[--C]=255&b,b>>=8;g!==null&&l<4096&&(x[l++]=g<<8|v,l>=A+1&&c<12&&(++c,A=A<<1|1)),g=y}else l=o+1,A=(1<<(c=s+1))-1,g=null}return h!==n&&Kr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Fv(e){var t,r,n,s,a,o=Math.floor,l=new Array(64),c=new Array(64),A=new Array(64),u=new Array(64),f=new Array(65535),h=new Array(65535),d=new Array(64),x=new Array(64),g=[],y=0,m=7,p=new Array(64),b=new Array(64),v=new Array(64),C=new Array(256),k=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],N=[0,1,2,3,4,5,6,7,8,9,10,11],Q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function q(B,U){for(var F=0,D=0,X=new Array,K=1;K<=16;K++){for(var ae=1;ae<=B[K];ae++)X[U[D]]=[],X[U[D]][0]=F,X[U[D]][1]=K,D++,F++;F*=2}return X}function M(B){for(var U=B[0],F=B[1]-1;F>=0;)U&1<<F&&(y|=1<<m),F--,--m<0&&(y==255?(V(255),V(0)):V(y),m=7,y=0)}function V(B){g.push(B)}function H(B){V(B>>8&255),V(255&B)}function se(B,U,F,D,X){for(var K,ae=X[0],he=X[240],Y=function(Re,at){var we,ve,Le,tt,lt,it,Ne,ke,qe,Me,Ve=0;for(qe=0;qe<8;++qe){we=Re[Ve],ve=Re[Ve+1],Le=Re[Ve+2],tt=Re[Ve+3],lt=Re[Ve+4],it=Re[Ve+5],Ne=Re[Ve+6];var Et=we+(ke=Re[Ve+7]),xt=we-ke,st=ve+Ne,pt=ve-Ne,It=Le+it,ut=Le-it,kt=tt+lt,yt=tt-lt,Ct=Et+kt,er=Et-kt,Wt=st+It,St=st-It;Re[Ve]=Ct+Wt,Re[Ve+4]=Ct-Wt;var Ar=.707106781*(St+er);Re[Ve+2]=er+Ar,Re[Ve+6]=er-Ar;var Fs=.382683433*((Ct=yt+ut)-(St=pt+xt)),sr=.5411961*Ct+Fs,an=1.306562965*St+Fs,Wn=.707106781*(Wt=ut+pt),Pt=xt+Wn,Ln=xt-Wn;Re[Ve+5]=Ln+sr,Re[Ve+3]=Ln-sr,Re[Ve+1]=Pt+an,Re[Ve+7]=Pt-an,Ve+=8}for(Ve=0,qe=0;qe<8;++qe){we=Re[Ve],ve=Re[Ve+8],Le=Re[Ve+16],tt=Re[Ve+24],lt=Re[Ve+32],it=Re[Ve+40],Ne=Re[Ve+48];var on=we+(ke=Re[Ve+56]),_e=we-ke,Ee=ve+Ne,dt=ve-Ne,Mt=Le+it,W=Le-it,ue=tt+lt,re=tt-lt,Ae=on+ue,pe=on-ue,me=Ee+Mt,De=Ee-Mt;Re[Ve]=Ae+me,Re[Ve+32]=Ae-me;var Ge=.707106781*(De+pe);Re[Ve+16]=pe+Ge,Re[Ve+48]=pe-Ge;var Oe=.382683433*((Ae=re+W)-(De=dt+_e)),Qe=.5411961*Ae+Oe,be=1.306562965*De+Oe,fe=.707106781*(me=W+dt),Ie=_e+fe,We=_e-fe;Re[Ve+40]=We+Qe,Re[Ve+24]=We-Qe,Re[Ve+8]=Ie+be,Re[Ve+56]=Ie-be,Ve++}for(qe=0;qe<64;++qe)Me=Re[qe]*at[qe],d[qe]=Me>0?Me+.5|0:Me-.5|0;return d}(B,U),Be=0;Be<64;++Be)x[S[Be]]=Y[Be];var ee=x[0]-F;F=x[0],ee==0?M(D[0]):(M(D[h[K=32767+ee]]),M(f[K]));for(var Te=63;Te>0&&x[Te]==0;)Te--;if(Te==0)return M(ae),F;for(var Je,ie=1;ie<=Te;){for(var $e=ie;x[ie]==0&&ie<=Te;)++ie;var ze=ie-$e;if(ze>=16){Je=ze>>4;for(var Fe=1;Fe<=Je;++Fe)M(he);ze&=15}K=32767+x[ie],M(X[(ze<<4)+h[K]]),M(f[K]),ie++}return Te!=63&&M(ae),F}function ce(B){B=Math.min(Math.max(B,1),100),a!=B&&(function(U){for(var F=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],D=0;D<64;D++){var X=o((F[D]*U+50)/100);X=Math.min(Math.max(X,1),255),l[S[D]]=X}for(var K=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ae=0;ae<64;ae++){var he=o((K[ae]*U+50)/100);he=Math.min(Math.max(he,1),255),c[S[ae]]=he}for(var Y=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Be=0,ee=0;ee<8;ee++)for(var Te=0;Te<8;Te++)A[Be]=1/(l[S[Be]]*Y[ee]*Y[Te]*8),u[Be]=1/(c[S[Be]]*Y[ee]*Y[Te]*8),Be++}(B<50?Math.floor(5e3/B):Math.floor(200-2*B)),a=B)}this.encode=function(B,U){U&&ce(U),g=new Array,y=0,m=7,H(65496),H(65504),H(16),V(74),V(70),V(73),V(70),V(0),V(1),V(1),V(0),H(1),H(1),V(0),V(0),function(){H(65499),H(132),V(0);for(var ve=0;ve<64;ve++)V(l[ve]);V(1);for(var Le=0;Le<64;Le++)V(c[Le])}(),function(ve,Le){H(65472),H(17),V(8),H(Le),H(ve),V(3),V(1),V(17),V(0),V(2),V(17),V(1),V(3),V(17),V(1)}(B.width,B.height),function(){H(65476),H(418),V(0);for(var ve=0;ve<16;ve++)V(I[ve+1]);for(var Le=0;Le<=11;Le++)V(N[Le]);V(16);for(var tt=0;tt<16;tt++)V(Q[tt+1]);for(var lt=0;lt<=161;lt++)V(L[lt]);V(1);for(var it=0;it<16;it++)V(T[it+1]);for(var Ne=0;Ne<=11;Ne++)V(P[Ne]);V(17);for(var ke=0;ke<16;ke++)V(R[ke+1]);for(var qe=0;qe<=161;qe++)V(z[qe])}(),H(65498),H(12),V(3),V(1),V(0),V(2),V(17),V(3),V(17),V(0),V(63),V(0);var F=0,D=0,X=0;y=0,m=7,this.encode.displayName="_encode_";for(var K,ae,he,Y,Be,ee,Te,Je,ie,$e=B.data,ze=B.width,Fe=B.height,Re=4*ze,at=0;at<Fe;){for(K=0;K<Re;){for(Be=Re*at+K,Te=-1,Je=0,ie=0;ie<64;ie++)ee=Be+(Je=ie>>3)*Re+(Te=4*(7&ie)),at+Je>=Fe&&(ee-=Re*(at+1+Je-Fe)),K+Te>=Re&&(ee-=K+Te-Re+4),ae=$e[ee++],he=$e[ee++],Y=$e[ee++],p[ie]=(k[ae]+k[he+256|0]+k[Y+512|0]>>16)-128,b[ie]=(k[ae+768|0]+k[he+1024|0]+k[Y+1280|0]>>16)-128,v[ie]=(k[ae+1280|0]+k[he+1536|0]+k[Y+1792|0]>>16)-128;F=se(p,A,F,t,n),D=se(b,u,D,r,s),X=se(v,u,X,r,s),K+=32}at+=8}if(m>=0){var we=[];we[1]=m+1,we[0]=(1<<m+1)-1,M(we)}return H(65497),new Uint8Array(g)},e=e||50,function(){for(var B=String.fromCharCode,U=0;U<256;U++)C[U]=B(U)}(),t=q(I,N),r=q(T,P),n=q(Q,L),s=q(R,z),function(){for(var B=1,U=2,F=1;F<=15;F++){for(var D=B;D<U;D++)h[32767+D]=F,f[32767+D]=[],f[32767+D][1]=F,f[32767+D][0]=D;for(var X=-(U-1);X<=-B;X++)h[32767+X]=F,f[32767+X]=[],f[32767+X][1]=F,f[32767+X][0]=U-1+X;B<<=1,U<<=1}}(),function(){for(var B=0;B<256;B++)k[B]=19595*B,k[B+256|0]=38470*B,k[B+512|0]=7471*B+32768,k[B+768|0]=-11059*B,k[B+1024|0]=-21709*B,k[B+1280|0]=32768*B+8421375,k[B+1536|0]=-27439*B,k[B+1792|0]=-5329*B}(),ce(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Mi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function pN(e){function t(N){if(!N)throw Error("assert :P")}function r(N,Q,L){for(var T=0;4>T;T++)if(N[Q+T]!=L.charCodeAt(T))return!0;return!1}function n(N,Q,L,T,P){for(var R=0;R<P;R++)N[Q+R]=L[T+R]}function s(N,Q,L,T){for(var P=0;P<T;P++)N[Q+P]=L}function a(N){return new Int32Array(N)}function o(N,Q){for(var L=[],T=0;T<N;T++)L.push(new Q);return L}function l(N,Q){var L=[];return function T(P,R,z){for(var q=z[R],M=0;M<q&&(P.push(z.length>R+1?[]:new Q),!(z.length<R+1));M++)T(P[M],R+1,z)}(L,0,N),L}var c=function(){var N=this;function Q(w,_){for(var j=1<<_-1>>>0;w&j;)j>>>=1;return j?(w&j-1)+j:w}function L(w,_,j,O,Z){t(!(O%j));do w[_+(O-=j)]=Z;while(0<O)}function T(w,_,j,O,Z){if(t(2328>=Z),512>=Z)var te=a(512);else if((te=a(Z))==null)return 0;return function(ne,le,de,ge,Se,Ke){var xe,je,Pe=le,Ye=1<<de,He=a(16),Ze=a(16);for(t(Se!=0),t(ge!=null),t(ne!=null),t(0<de),je=0;je<Se;++je){if(15<ge[je])return 0;++He[ge[je]]}if(He[0]==Se)return 0;for(Ze[1]=0,xe=1;15>xe;++xe){if(He[xe]>1<<xe)return 0;Ze[xe+1]=Ze[xe]+He[xe]}for(je=0;je<Se;++je)xe=ge[je],0<ge[je]&&(Ke[Ze[xe]++]=je);if(Ze[15]==1)return(ge=new P).g=0,ge.value=Ke[0],L(ne,Pe,1,Ye,ge),Ye;var rt,ht=-1,At=Ye-1,Kt=0,jt=1,or=1,Lt=1<<de;for(je=0,xe=1,Se=2;xe<=de;++xe,Se<<=1){if(jt+=or<<=1,0>(or-=He[xe]))return 0;for(;0<He[xe];--He[xe])(ge=new P).g=xe,ge.value=Ke[je++],L(ne,Pe+Kt,Se,Lt,ge),Kt=Q(Kt,xe)}for(xe=de+1,Se=2;15>=xe;++xe,Se<<=1){if(jt+=or<<=1,0>(or-=He[xe]))return 0;for(;0<He[xe];--He[xe]){if(ge=new P,(Kt&At)!=ht){for(Pe+=Lt,rt=1<<(ht=xe)-de;15>ht&&!(0>=(rt-=He[ht]));)++ht,rt<<=1;Ye+=Lt=1<<(rt=ht-de),ne[le+(ht=Kt&At)].g=rt+de,ne[le+ht].value=Pe-le-ht}ge.g=xe-de,ge.value=Ke[je++],L(ne,Pe+(Kt>>de),Se,Lt,ge),Kt=Q(Kt,xe)}}return jt!=2*Ze[15]-1?0:Ye}(w,_,j,O,Z,te)}function P(){this.value=this.g=0}function R(){this.value=this.g=0}function z(){this.G=o(5,P),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(zc,R)}function q(w,_,j,O){t(w!=null),t(_!=null),t(2147483648>O),w.Ca=254,w.I=0,w.b=-8,w.Ka=0,w.oa=_,w.pa=j,w.Jd=_,w.Yc=j+O,w.Zc=4<=O?j+O-4+1:j,ae(w)}function M(w,_){for(var j=0;0<_--;)j|=Y(w,128)<<_;return j}function V(w,_){var j=M(w,_);return he(w)?-j:j}function H(w,_,j,O){var Z,te=0;for(t(w!=null),t(_!=null),t(4294967288>O),w.Sb=O,w.Ra=0,w.u=0,w.h=0,4<O&&(O=4),Z=0;Z<O;++Z)te+=_[j+Z]<<8*Z;w.Ra=te,w.bb=O,w.oa=_,w.pa=j}function se(w){for(;8<=w.u&&w.bb<w.Sb;)w.Ra>>>=8,w.Ra+=w.oa[w.pa+w.bb]<<Tl-8>>>0,++w.bb,w.u-=8;D(w)&&(w.h=1,w.u=0)}function ce(w,_){if(t(0<=_),!w.h&&_<=Da){var j=F(w)&La[_];return w.u+=_,se(w),j}return w.h=1,w.u=0}function B(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function U(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function F(w){return w.Ra>>>(w.u&Tl-1)>>>0}function D(w){return t(w.bb<=w.Sb),w.h||w.bb==w.Sb&&w.u>Tl}function X(w,_){w.u=_,w.h=D(w)}function K(w){w.u>=zo&&(t(w.u>=zo),se(w))}function ae(w){t(w!=null&&w.oa!=null),w.pa<w.Zc?(w.I=(w.oa[w.pa++]|w.I<<8)>>>0,w.b+=8):(t(w!=null&&w.oa!=null),w.pa<w.Yc?(w.b+=8,w.I=w.oa[w.pa++]|w.I<<8):w.Ka?w.b=0:(w.I<<=8,w.b+=8,w.Ka=1))}function he(w){return M(w,1)}function Y(w,_){var j=w.Ca;0>w.b&&ae(w);var O=w.b,Z=j*_>>>8,te=(w.I>>>O>Z)+0;for(te?(j-=Z,w.I-=Z+1<<O>>>0):j=Z+1,O=j,Z=0;256<=O;)Z+=8,O>>=8;return O=7^Z+Il[O],w.b-=O,w.Ca=(j<<O)-1,te}function Be(w,_,j){w[_+0]=j>>24&255,w[_+1]=j>>16&255,w[_+2]=j>>8&255,w[_+3]=255&j}function ee(w,_){return w[_+0]|w[_+1]<<8}function Te(w,_){return ee(w,_)|w[_+2]<<16}function Je(w,_){return ee(w,_)|ee(w,_+2)<<16}function ie(w,_){var j=1<<_;return t(w!=null),t(0<_),w.X=a(j),w.X==null?0:(w.Mb=32-_,w.Xa=_,1)}function $e(w,_){t(w!=null),t(_!=null),t(w.Xa==_.Xa),n(_.X,0,w.X,0,1<<_.Xa)}function ze(){this.X=[],this.Xa=this.Mb=0}function Fe(w,_,j,O){t(j!=null),t(O!=null);var Z=j[0],te=O[0];return Z==0&&(Z=(w*te+_/2)/_),te==0&&(te=(_*Z+w/2)/w),0>=Z||0>=te?0:(j[0]=Z,O[0]=te,1)}function Re(w,_){return w+(1<<_)-1>>>_}function at(w,_){return((4278255360&w)+(4278255360&_)>>>0&4278255360)+((16711935&w)+(16711935&_)>>>0&16711935)>>>0}function we(w,_){N[_]=function(j,O,Z,te,ne,le,de){var ge;for(ge=0;ge<ne;++ge){var Se=N[w](le[de+ge-1],Z,te+ge);le[de+ge]=at(j[O+ge],Se)}}}function ve(){this.ud=this.hd=this.jd=0}function Le(w,_){return((4278124286&(w^_))>>>1)+(w&_)>>>0}function tt(w){return 0<=w&&256>w?w:0>w?0:255<w?255:void 0}function lt(w,_){return tt(w+(w-_+.5>>1))}function it(w,_,j){return Math.abs(_-j)-Math.abs(w-j)}function Ne(w,_,j,O,Z,te,ne){for(O=te[ne-1],j=0;j<Z;++j)te[ne+j]=O=at(w[_+j],O)}function ke(w,_,j,O,Z){var te;for(te=0;te<j;++te){var ne=w[_+te],le=ne>>8&255,de=16711935&(de=(de=16711935&ne)+((le<<16)+le));O[Z+te]=(4278255360&ne)+de>>>0}}function qe(w,_){_.jd=255&w,_.hd=w>>8&255,_.ud=w>>16&255}function Me(w,_,j,O,Z,te){var ne;for(ne=0;ne<O;++ne){var le=_[j+ne],de=le>>>8,ge=le,Se=255&(Se=(Se=le>>>16)+((w.jd<<24>>24)*(de<<24>>24)>>>5));ge=255&(ge=(ge+=(w.hd<<24>>24)*(de<<24>>24)>>>5)+((w.ud<<24>>24)*(Se<<24>>24)>>>5)),Z[te+ne]=(4278255360&le)+(Se<<16)+ge}}function Ve(w,_,j,O,Z){N[_]=function(te,ne,le,de,ge,Se,Ke,xe,je){for(de=Ke;de<xe;++de)for(Ke=0;Ke<je;++Ke)ge[Se++]=Z(le[O(te[ne++])])},N[w]=function(te,ne,le,de,ge,Se,Ke){var xe=8>>te.b,je=te.Ea,Pe=te.K[0],Ye=te.w;if(8>xe)for(te=(1<<te.b)-1,Ye=(1<<xe)-1;ne<le;++ne){var He,Ze=0;for(He=0;He<je;++He)He&te||(Ze=O(de[ge++])),Se[Ke++]=Z(Pe[Ze&Ye]),Ze>>=xe}else N["VP8LMapColor"+j](de,ge,Pe,Ye,Se,Ke,ne,le,je)}}function Et(w,_,j,O,Z){for(j=_+j;_<j;){var te=w[_++];O[Z++]=te>>16&255,O[Z++]=te>>8&255,O[Z++]=255&te}}function xt(w,_,j,O,Z){for(j=_+j;_<j;){var te=w[_++];O[Z++]=te>>16&255,O[Z++]=te>>8&255,O[Z++]=255&te,O[Z++]=te>>24&255}}function st(w,_,j,O,Z){for(j=_+j;_<j;){var te=(ne=w[_++])>>16&240|ne>>12&15,ne=240&ne|ne>>28&15;O[Z++]=te,O[Z++]=ne}}function pt(w,_,j,O,Z){for(j=_+j;_<j;){var te=(ne=w[_++])>>16&248|ne>>13&7,ne=ne>>5&224|ne>>3&31;O[Z++]=te,O[Z++]=ne}}function It(w,_,j,O,Z){for(j=_+j;_<j;){var te=w[_++];O[Z++]=255&te,O[Z++]=te>>8&255,O[Z++]=te>>16&255}}function ut(w,_,j,O,Z,te){if(te==0)for(j=_+j;_<j;)Be(O,((te=w[_++])[0]>>24|te[1]>>8&65280|te[2]<<8&16711680|te[3]<<24)>>>0),Z+=32;else n(O,Z,w,_,j)}function kt(w,_){N[_][0]=N[w+"0"],N[_][1]=N[w+"1"],N[_][2]=N[w+"2"],N[_][3]=N[w+"3"],N[_][4]=N[w+"4"],N[_][5]=N[w+"5"],N[_][6]=N[w+"6"],N[_][7]=N[w+"7"],N[_][8]=N[w+"8"],N[_][9]=N[w+"9"],N[_][10]=N[w+"10"],N[_][11]=N[w+"11"],N[_][12]=N[w+"12"],N[_][13]=N[w+"13"],N[_][14]=N[w+"0"],N[_][15]=N[w+"0"]}function yt(w){return w==qx||w==Vx||w==Rh||w==Gx}function Ct(){this.eb=[],this.size=this.A=this.fb=0}function er(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Wt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ct,this.f.kb=new er,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ar(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Fs(w){return alert("todo:WebPSamplerProcessPlane"),w.T}function sr(w,_){var j=w.T,O=_.ba.f.RGBA,Z=O.eb,te=O.fb+w.ka*O.A,ne=ui[_.ba.S],le=w.y,de=w.O,ge=w.f,Se=w.N,Ke=w.ea,xe=w.W,je=_.cc,Pe=_.dc,Ye=_.Mc,He=_.Nc,Ze=w.ka,rt=w.ka+w.T,ht=w.U,At=ht+1>>1;for(Ze==0?ne(le,de,null,null,ge,Se,Ke,xe,ge,Se,Ke,xe,Z,te,null,null,ht):(ne(_.ec,_.fc,le,de,je,Pe,Ye,He,ge,Se,Ke,xe,Z,te-O.A,Z,te,ht),++j);Ze+2<rt;Ze+=2)je=ge,Pe=Se,Ye=Ke,He=xe,Se+=w.Rc,xe+=w.Rc,te+=2*O.A,ne(le,(de+=2*w.fa)-w.fa,le,de,je,Pe,Ye,He,ge,Se,Ke,xe,Z,te-O.A,Z,te,ht);return de+=w.fa,w.j+rt<w.o?(n(_.ec,_.fc,le,de,ht),n(_.cc,_.dc,ge,Se,At),n(_.Mc,_.Nc,Ke,xe,At),j--):1&rt||ne(le,de,null,null,ge,Se,Ke,xe,ge,Se,Ke,xe,Z,te+O.A,null,null,ht),j}function an(w,_,j){var O=w.F,Z=[w.J];if(O!=null){var te=w.U,ne=_.ba.S,le=ne==Oh||ne==Rh;_=_.ba.f.RGBA;var de=[0],ge=w.ka;de[0]=w.T,w.Kb&&(ge==0?--de[0]:(--ge,Z[0]-=w.width),w.j+w.ka+w.T==w.o&&(de[0]=w.o-w.j-ge));var Se=_.eb;ge=_.fb+ge*_.A,w=g_(O,Z[0],w.width,te,de,Se,ge+(le?0:3),_.A),t(j==de),w&&yt(ne)&&t0(Se,ge,le,te,de,_.A)}return 0}function Wn(w){var _=w.ma,j=_.ba.S,O=11>j,Z=j==Dh||j==Ph||j==Oh||j==Kx||j==12||yt(j);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!Wd(_.Oa,w,Z?11:12))return 0;if(Z&&yt(j)&&qd(),w.da)alert("todo:use_scaling");else{if(O){if(_.Ib=Fs,w.Kb){if(j=w.U+1>>1,_.memory=a(w.U+2*j),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+w.U,_.Mc=_.cc,_.Nc=_.dc+j,_.Ib=sr,qd()}}else alert("todo:EmitYUV");Z&&(_.Jb=an,O&&Li())}if(O&&!I_){for(w=0;256>w;++w)jI[w]=89858*(w-128)+Mh>>Qh,UI[w]=-22014*(w-128)+Mh,II[w]=-45773*(w-128),TI[w]=113618*(w-128)+Mh>>Qh;for(w=n0;w<zx;++w)_=76283*(w-16)+Mh>>Qh,LI[w-n0]=Dn(_,255),DI[w-n0]=Dn(_+8>>4,15);I_=1}return 1}function Pt(w){var _=w.ma,j=w.U,O=w.T;return t(!(1&w.ka)),0>=j||0>=O?0:(j=_.Ib(w,_),_.Jb!=null&&_.Jb(w,_,j),_.Dc+=j,1)}function Ln(w){w.ma.memory=null}function on(w,_,j,O){return ce(w,8)!=47?0:(_[0]=ce(w,14)+1,j[0]=ce(w,14)+1,O[0]=ce(w,1),ce(w,3)!=0?0:!w.h)}function _e(w,_){if(4>w)return w+1;var j=w-2>>1;return(2+(1&w)<<j)+ce(_,j)+1}function Ee(w,_){return 120<_?_-120:1<=(j=((j=gI[_-1])>>4)*w+(8-(15&j)))?j:1;var j}function dt(w,_,j){var O=F(j),Z=w[_+=255&O].g-8;return 0<Z&&(X(j,j.u+8),O=F(j),_+=w[_].value,_+=O&(1<<Z)-1),X(j,j.u+w[_].g),w[_].value}function Mt(w,_,j){return j.g+=w.g,j.value+=w.value<<_>>>0,t(8>=j.g),w.g}function W(w,_,j){var O=w.xc;return t((_=O==0?0:w.vc[w.md*(j>>O)+(_>>O)])<w.Wb),w.Ya[_]}function ue(w,_,j,O){var Z=w.ab,te=w.c*_,ne=w.C;_=ne+_;var le=j,de=O;for(O=w.Ta,j=w.Ua;0<Z--;){var ge=w.gc[Z],Se=ne,Ke=_,xe=le,je=de,Pe=(de=O,le=j,ge.Ea);switch(t(Se<Ke),t(Ke<=ge.nc),ge.hc){case 2:bn(xe,je,(Ke-Se)*Pe,de,le);break;case 0:var Ye=Se,He=Ke,Ze=de,rt=le,ht=(Lt=ge).Ea;Ye==0&&(zd(xe,je,null,null,1,Ze,rt),Ne(xe,je+1,0,0,ht-1,Ze,rt+1),je+=ht,rt+=ht,++Ye);for(var At=1<<Lt.b,Kt=At-1,jt=Re(ht,Lt.b),or=Lt.K,Lt=Lt.w+(Ye>>Lt.b)*jt;Ye<He;){var gr=or,Yn=Lt,lr=1;for(au(xe,je,Ze,rt-ht,1,Ze,rt);lr<ht;){var Dt=(lr&~Kt)+At;Dt>ht&&(Dt=ht),(0,Yd[gr[Yn++]>>8&15])(xe,je+ +lr,Ze,rt+lr-ht,Dt-lr,Ze,rt+lr),lr=Dt}je+=ht,rt+=ht,++Ye&Kt||(Lt+=jt)}Ke!=ge.nc&&n(de,le-Pe,de,le+(Ke-Se-1)*Pe,Pe);break;case 1:for(Pe=xe,He=je,ht=(xe=ge.Ea)-(rt=xe&~(Ze=(je=1<<ge.b)-1)),Ye=Re(xe,ge.b),At=ge.K,ge=ge.w+(Se>>ge.b)*Ye;Se<Ke;){for(Kt=At,jt=ge,or=new ve,Lt=He+rt,gr=He+xe;He<Lt;)qe(Kt[jt++],or),Jd(or,Pe,He,je,de,le),He+=je,le+=je;He<gr&&(qe(Kt[jt++],or),Jd(or,Pe,He,ht,de,le),He+=ht,le+=ht),++Se&Ze||(ge+=Ye)}break;case 3:if(xe==de&&je==le&&0<ge.b){for(He=de,xe=Pe=le+(Ke-Se)*Pe-(rt=(Ke-Se)*Re(ge.Ea,ge.b)),je=de,Ze=le,Ye=[],rt=(ht=rt)-1;0<=rt;--rt)Ye[rt]=je[Ze+rt];for(rt=ht-1;0<=rt;--rt)He[xe+rt]=Ye[rt];Th(ge,Se,Ke,de,Pe,de,le)}else Th(ge,Se,Ke,xe,je,de,le)}le=O,de=j}de!=j&&n(O,j,le,de,te)}function re(w,_){var j=w.V,O=w.Ba+w.c*w.C,Z=_-w.C;if(t(_<=w.l.o),t(16>=Z),0<Z){var te=w.l,ne=w.Ta,le=w.Ua,de=te.width;if(ue(w,Z,j,O),Z=le=[le],t((j=w.C)<(O=_)),t(te.v<te.va),O>te.o&&(O=te.o),j<te.j){var ge=te.j-j;j=te.j,Z[0]+=ge*de}if(j>=O?j=0:(Z[0]+=4*te.v,te.ka=j-te.j,te.U=te.va-te.v,te.T=O-j,j=1),j){if(le=le[0],11>(j=w.ca).S){var Se=j.f.RGBA,Ke=(O=j.S,Z=te.U,te=te.T,ge=Se.eb,Se.A),xe=te;for(Se=Se.fb+w.Ma*Se.A;0<xe--;){var je=ne,Pe=le,Ye=Z,He=ge,Ze=Se;switch(O){case Lh:Zd(je,Pe,Ye,He,Ze);break;case Dh:Ul(je,Pe,Ye,He,Ze);break;case qx:Ul(je,Pe,Ye,He,Ze),t0(He,Ze,0,Ye,1,0);break;case B_:Xc(je,Pe,Ye,He,Ze);break;case Ph:ut(je,Pe,Ye,He,Ze,1);break;case Vx:ut(je,Pe,Ye,He,Ze,1),t0(He,Ze,0,Ye,1,0);break;case Oh:ut(je,Pe,Ye,He,Ze,0);break;case Rh:ut(je,Pe,Ye,He,Ze,0),t0(He,Ze,1,Ye,1,0);break;case Kx:Ll(je,Pe,Ye,He,Ze);break;case Gx:Ll(je,Pe,Ye,He,Ze),m_(He,Ze,Ye,1,0);break;case C_:Dl(je,Pe,Ye,He,Ze);break;default:t(0)}le+=de,Se+=Ke}w.Ma+=te}else alert("todo:EmitRescaledRowsYUVA");t(w.Ma<=j.height)}}w.C=_,t(w.C<=w.i)}function Ae(w){var _;if(0<w.ua)return 0;for(_=0;_<w.Wb;++_){var j=w.Ya[_].G,O=w.Ya[_].H;if(0<j[1][O[1]+0].g||0<j[2][O[2]+0].g||0<j[3][O[3]+0].g)return 0}return 1}function pe(w,_,j,O,Z,te){if(w.Z!=0){var ne=w.qd,le=w.rd;for(t(Rl[w.Z]!=null);_<j;++_)Rl[w.Z](ne,le,O,Z,O,Z,te),ne=O,le=Z,Z+=te;w.qd=ne,w.rd=le}}function me(w,_){var j=w.l.ma,O=j.Z==0||j.Z==1?w.l.j:w.C;if(O=w.C<O?O:w.C,t(_<=w.l.o),_>O){var Z=w.l.width,te=j.ca,ne=j.tb+Z*O,le=w.V,de=w.Ba+w.c*O,ge=w.gc;t(w.ab==1),t(ge[0].hc==3),ho(ge[0],O,_,le,de,te,ne),pe(j,O,_,te,ne,Z)}w.C=w.Ma=_}function De(w,_,j,O,Z,te,ne){var le=w.$/O,de=w.$%O,ge=w.m,Se=w.s,Ke=j+w.$,xe=Ke;Z=j+O*Z;var je=j+O*te,Pe=280+Se.ua,Ye=w.Pb?le:16777216,He=0<Se.ua?Se.Wa:null,Ze=Se.wc,rt=Ke<je?W(Se,de,le):null;t(w.C<te),t(je<=Z);var ht=!1;e:for(;;){for(;ht||Ke<je;){var At=0;if(le>=Ye){var Kt=Ke-j;t((Ye=w).Pb),Ye.wd=Ye.m,Ye.xd=Kt,0<Ye.s.ua&&$e(Ye.s.Wa,Ye.s.vb),Ye=le+vI}if(de&Ze||(rt=W(Se,de,le)),t(rt!=null),rt.Qb&&(_[Ke]=rt.qb,ht=!0),!ht)if(K(ge),rt.jc){At=ge,Kt=_;var jt=Ke,or=rt.pd[F(At)&zc-1];t(rt.jc),256>or.g?(X(At,At.u+or.g),Kt[jt]=or.value,At=0):(X(At,At.u+or.g-256),t(256<=or.value),At=or.value),At==0&&(ht=!0)}else At=dt(rt.G[0],rt.H[0],ge);if(ge.h)break;if(ht||256>At){if(!ht)if(rt.nd)_[Ke]=(rt.qb|At<<8)>>>0;else{if(K(ge),ht=dt(rt.G[1],rt.H[1],ge),K(ge),Kt=dt(rt.G[2],rt.H[2],ge),jt=dt(rt.G[3],rt.H[3],ge),ge.h)break;_[Ke]=(jt<<24|ht<<16|At<<8|Kt)>>>0}if(ht=!1,++Ke,++de>=O&&(de=0,++le,ne!=null&&le<=te&&!(le%16)&&ne(w,le),He!=null))for(;xe<Ke;)At=_[xe++],He.X[(506832829*At&4294967295)>>>He.Mb]=At}else if(280>At){if(At=_e(At-256,ge),Kt=dt(rt.G[4],rt.H[4],ge),K(ge),Kt=Ee(O,Kt=_e(Kt,ge)),ge.h)break;if(Ke-j<Kt||Z-Ke<At)break e;for(jt=0;jt<At;++jt)_[Ke+jt]=_[Ke+jt-Kt];for(Ke+=At,de+=At;de>=O;)de-=O,++le,ne!=null&&le<=te&&!(le%16)&&ne(w,le);if(t(Ke<=Z),de&Ze&&(rt=W(Se,de,le)),He!=null)for(;xe<Ke;)At=_[xe++],He.X[(506832829*At&4294967295)>>>He.Mb]=At}else{if(!(At<Pe))break e;for(ht=At-280,t(He!=null);xe<Ke;)At=_[xe++],He.X[(506832829*At&4294967295)>>>He.Mb]=At;At=Ke,t(!(ht>>>(Kt=He).Xa)),_[At]=Kt.X[ht],ht=!0}ht||t(ge.h==D(ge))}if(w.Pb&&ge.h&&Ke<Z)t(w.m.h),w.a=5,w.m=w.wd,w.$=w.xd,0<w.s.ua&&$e(w.s.vb,w.s.Wa);else{if(ge.h)break e;ne!=null&&ne(w,le>te?te:le),w.a=0,w.$=Ke-j}return 1}return w.a=3,0}function Ge(w){t(w!=null),w.vc=null,w.yc=null,w.Ya=null;var _=w.Wa;_!=null&&(_.X=null),w.vb=null,t(w!=null)}function Oe(){var w=new Zt;return w==null?null:(w.a=0,w.xb=k_,kt("Predictor","VP8LPredictors"),kt("Predictor","VP8LPredictors_C"),kt("PredictorAdd","VP8LPredictorsAdd"),kt("PredictorAdd","VP8LPredictorsAdd_C"),bn=ke,Jd=Me,Zd=Et,Ul=xt,Ll=st,Dl=pt,Xc=It,N.VP8LMapColor32b=fo,N.VP8LMapColor8b=Xd,w)}function Qe(w,_,j,O,Z){var te=1,ne=[w],le=[_],de=O.m,ge=O.s,Se=null,Ke=0;e:for(;;){if(j)for(;te&&ce(de,1);){var xe=ne,je=le,Pe=O,Ye=1,He=Pe.m,Ze=Pe.gc[Pe.ab],rt=ce(He,2);if(Pe.Oc&1<<rt)te=0;else{switch(Pe.Oc|=1<<rt,Ze.hc=rt,Ze.Ea=xe[0],Ze.nc=je[0],Ze.K=[null],++Pe.ab,t(4>=Pe.ab),rt){case 0:case 1:Ze.b=ce(He,3)+2,Ye=Qe(Re(Ze.Ea,Ze.b),Re(Ze.nc,Ze.b),0,Pe,Ze.K),Ze.K=Ze.K[0];break;case 3:var ht,At=ce(He,8)+1,Kt=16<At?0:4<At?1:2<At?2:3;if(xe[0]=Re(Ze.Ea,Kt),Ze.b=Kt,ht=Ye=Qe(At,1,0,Pe,Ze.K)){var jt,or=At,Lt=Ze,gr=1<<(8>>Lt.b),Yn=a(gr);if(Yn==null)ht=0;else{var lr=Lt.K[0],Dt=Lt.w;for(Yn[0]=Lt.K[0][0],jt=1;jt<1*or;++jt)Yn[jt]=at(lr[Dt+jt],Yn[jt-1]);for(;jt<4*gr;++jt)Yn[jt]=0;Lt.K[0]=null,Lt.K[0]=Yn,ht=1}}Ye=ht;break;case 2:break;default:t(0)}te=Ye}}if(ne=ne[0],le=le[0],te&&ce(de,1)&&!(te=1<=(Ke=ce(de,4))&&11>=Ke)){O.a=3;break e}var _t;if(_t=te)t:{var Bn,nr,xr,zr=O,ms=ne,na=le,pn=Ke,Ts=j,sa=zr.m,Jn=zr.s,yr=[null],Fr=1,mn=0,jr=xI[pn];r:for(;;){if(Ts&&ce(sa,1)){var gs=ce(sa,3)+2,Pi=Re(ms,gs),Cn=Re(na,gs),ya=Pi*Cn;if(!Qe(Pi,Cn,0,zr,yr))break r;for(yr=yr[0],Jn.xc=gs,Bn=0;Bn<ya;++Bn){var Hr=yr[Bn]>>8&65535;yr[Bn]=Hr,Hr>=Fr&&(Fr=Hr+1)}}if(sa.h)break r;for(nr=0;5>nr;++nr){var Zn=N_[nr];!nr&&0<pn&&(Zn+=1<<pn),mn<Zn&&(mn=Zn)}var Oa=o(Fr*jr,P),aa=Fr,Ra=o(aa,z);if(Ra==null)var Qa=null;else t(65536>=aa),Qa=Ra;var wa=a(mn);if(Qa==null||wa==null||Oa==null){zr.a=1;break r}var Ma=Oa;for(Bn=xr=0;Bn<Fr;++Bn){var Vr=Qa[Bn],Ha=Vr.G,Oi=Vr.H,Jc=0,Jo=1,xs=0;for(nr=0;5>nr;++nr){Zn=N_[nr],Ha[nr]=Ma,Oi[nr]=xr,!nr&&0<pn&&(Zn+=1<<pn);s:{var Kh,Xx=Zn,qh=zr,s0=wa,RI=Ma,QI=xr,Yx=0,Ql=qh.m,MI=ce(Ql,1);if(s(s0,0,0,Xx),MI){var HI=ce(Ql,1)+1,KI=ce(Ql,1),D_=ce(Ql,KI==0?1:8);s0[D_]=1,HI==2&&(s0[D_=ce(Ql,8)]=1);var Vh=1}else{var P_=a(19),O_=ce(Ql,4)+4;if(19<O_){qh.a=3;var Gh=0;break s}for(Kh=0;Kh<O_;++Kh)P_[mI[Kh]]=ce(Ql,3);var Jx=void 0,a0=void 0,R_=qh,qI=P_,Wh=Xx,Q_=s0,Zx=0,Ml=R_.m,M_=8,H_=o(128,P);n:for(;T(H_,0,7,qI,19);){if(ce(Ml,1)){var VI=2+2*ce(Ml,3);if((Jx=2+ce(Ml,VI))>Wh)break n}else Jx=Wh;for(a0=0;a0<Wh&&Jx--;){K(Ml);var K_=H_[0+(127&F(Ml))];X(Ml,Ml.u+K_.g);var ou=K_.value;if(16>ou)Q_[a0++]=ou,ou!=0&&(M_=ou);else{var GI=ou==16,q_=ou-16,WI=hI[q_],V_=ce(Ml,fI[q_])+WI;if(a0+V_>Wh)break n;for(var $I=GI?M_:0;0<V_--;)Q_[a0++]=$I}}Zx=1;break n}Zx||(R_.a=3),Vh=Zx}(Vh=Vh&&!Ql.h)&&(Yx=T(RI,QI,8,s0,Xx)),Vh&&Yx!=0?Gh=Yx:(qh.a=3,Gh=0)}if(Gh==0)break r;if(Jo&&pI[nr]==1&&(Jo=Ma[xr].g==0),Jc+=Ma[xr].g,xr+=Gh,3>=nr){var i0,e1=wa[0];for(i0=1;i0<Zn;++i0)wa[i0]>e1&&(e1=wa[i0]);xs+=e1}}if(Vr.nd=Jo,Vr.Qb=0,Jo&&(Vr.qb=(Ha[3][Oi[3]+0].value<<24|Ha[1][Oi[1]+0].value<<16|Ha[2][Oi[2]+0].value)>>>0,Jc==0&&256>Ha[0][Oi[0]+0].value&&(Vr.Qb=1,Vr.qb+=Ha[0][Oi[0]+0].value<<8)),Vr.jc=!Vr.Qb&&6>xs,Vr.jc){var $h,Zo=Vr;for($h=0;$h<zc;++$h){var Hl=$h,Kl=Zo.pd[Hl],zh=Zo.G[0][Zo.H[0]+Hl];256<=zh.value?(Kl.g=zh.g+256,Kl.value=zh.value):(Kl.g=0,Kl.value=0,Hl>>=Mt(zh,8,Kl),Hl>>=Mt(Zo.G[1][Zo.H[1]+Hl],16,Kl),Hl>>=Mt(Zo.G[2][Zo.H[2]+Hl],0,Kl),Mt(Zo.G[3][Zo.H[3]+Hl],24,Kl))}}}Jn.vc=yr,Jn.Wb=Fr,Jn.Ya=Qa,Jn.yc=Oa,_t=1;break t}_t=0}if(!(te=_t)){O.a=3;break e}if(0<Ke){if(ge.ua=1<<Ke,!ie(ge.Wa,Ke)){O.a=1,te=0;break e}}else ge.ua=0;var t1=O,G_=ne,zI=le,r1=t1.s,n1=r1.xc;if(t1.c=G_,t1.i=zI,r1.md=Re(G_,n1),r1.wc=n1==0?-1:(1<<n1)-1,j){O.xb=NI;break e}if((Se=a(ne*le))==null){O.a=1,te=0;break e}te=(te=De(O,Se,0,ne,le,le,null))&&!de.h;break e}return te?(Z!=null?Z[0]=Se:(t(Se==null),t(j)),O.$=0,j||Ge(ge)):Ge(ge),te}function be(w,_){var j=w.c*w.i,O=j+_+16*_;return t(w.c<=_),w.V=a(O),w.V==null?(w.Ta=null,w.Ua=0,w.a=1,0):(w.Ta=w.V,w.Ua=w.Ba+j+_,1)}function fe(w,_){var j=w.C,O=_-j,Z=w.V,te=w.Ba+w.c*j;for(t(_<=w.l.o);0<O;){var ne=16<O?16:O,le=w.l.ma,de=w.l.width,ge=de*ne,Se=le.ca,Ke=le.tb+de*j,xe=w.Ta,je=w.Ua;ue(w,ne,Z,te),x_(xe,je,Se,Ke,ge),pe(le,j,j+ne,Se,Ke,de),O-=ne,Z+=ne*w.c,j+=ne}t(j==_),w.C=w.Ma=_}function Ie(){this.ub=this.yd=this.td=this.Rb=0}function We(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function ft(){this.Yb=function(){var w=[];return function _(j,O,Z){for(var te=Z[O],ne=0;ne<te&&(j.push(Z.length>O+1?[]:0),!(Z.length<O+1));ne++)_(j[ne],O+1,Z)}(w,0,[3,11]),w}()}function bt(){this.jb=a(3),this.Wc=l([4,8],ft),this.Xc=l([4,17],ft)}function Vt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Ht(){this.ld=this.La=this.dd=this.tc=0}function Br(){this.Na=this.la=0}function js(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Er(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ua(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ht),this.Y=0,this.ya=Array(new Er),this.aa=0,this.l=new JA}function ta(){this.y=a(16),this.f=a(8),this.ea=a(8)}function kl(){this.cb=this.a=0,this.sc="",this.m=new B,this.Od=new Ie,this.Kc=new We,this.ed=new Vt,this.Qa=new nt,this.Ic=this.$c=this.Aa=0,this.D=new Ua,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,B),this.ia=0,this.pb=o(4,js),this.Pa=new bt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ta),this.Hd=0,this.rb=Array(new Br),this.sb=0,this.wa=Array(new Ht),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Er),this.L=this.aa=0,this.gd=l([4,2],Ht),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Dn(w,_){return 0>w?0:w>_?_:w}function JA(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Sx(){var w=new kl;return w!=null&&(w.a=0,w.sc="OK",w.cb=0,w.Xb=0,r0||(r0=ZA)),w}function Pn(w,_,j){return w.a==0&&(w.a=_,w.sc=j,w.cb=0),0}function yh(w,_,j){return 3<=j&&w[_+0]==157&&w[_+1]==1&&w[_+2]==42}function Ao(w,_){if(w==null)return 0;if(w.a=0,w.sc="OK",_==null)return Pn(w,2,"null VP8Io passed to VP8GetHeaders()");var j=_.data,O=_.w,Z=_.ha;if(4>Z)return Pn(w,7,"Truncated header.");var te=j[O+0]|j[O+1]<<8|j[O+2]<<16,ne=w.Od;if(ne.Rb=!(1&te),ne.td=te>>1&7,ne.yd=te>>4&1,ne.ub=te>>5,3<ne.td)return Pn(w,3,"Incorrect keyframe parameters.");if(!ne.yd)return Pn(w,4,"Frame not displayable.");O+=3,Z-=3;var le=w.Kc;if(ne.Rb){if(7>Z)return Pn(w,7,"cannot parse picture header");if(!yh(j,O,Z))return Pn(w,3,"Bad code word");le.c=16383&(j[O+4]<<8|j[O+3]),le.Td=j[O+4]>>6,le.i=16383&(j[O+6]<<8|j[O+5]),le.Ud=j[O+6]>>6,O+=7,Z-=7,w.za=le.c+15>>4,w.Ub=le.i+15>>4,_.width=le.c,_.height=le.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,s((te=w.Pa).jb,0,255,te.jb.length),t((te=w.Qa)!=null),te.Cb=0,te.Bb=0,te.Fb=1,s(te.Zb,0,0,te.Zb.length),s(te.Lb,0,0,te.Lb)}if(ne.ub>Z)return Pn(w,7,"bad partition length");q(te=w.m,j,O,ne.ub),O+=ne.ub,Z-=ne.ub,ne.Rb&&(le.Ld=he(te),le.Kd=he(te)),le=w.Qa;var de,ge=w.Pa;if(t(te!=null),t(le!=null),le.Cb=he(te),le.Cb){if(le.Bb=he(te),he(te)){for(le.Fb=he(te),de=0;4>de;++de)le.Zb[de]=he(te)?V(te,7):0;for(de=0;4>de;++de)le.Lb[de]=he(te)?V(te,6):0}if(le.Bb)for(de=0;3>de;++de)ge.jb[de]=he(te)?M(te,8):255}else le.Bb=0;if(te.Ka)return Pn(w,3,"cannot parse segment header");if((le=w.ed).zd=he(te),le.Tb=M(te,6),le.wb=M(te,3),le.Pc=he(te),le.Pc&&he(te)){for(ge=0;4>ge;++ge)he(te)&&(le.vd[ge]=V(te,6));for(ge=0;4>ge;++ge)he(te)&&(le.od[ge]=V(te,6))}if(w.L=le.Tb==0?0:le.zd?1:2,te.Ka)return Pn(w,3,"cannot parse filter header");var Se=Z;if(Z=de=O,O=de+Se,le=Se,w.Xb=(1<<M(w.m,2))-1,Se<3*(ge=w.Xb))j=7;else{for(de+=3*ge,le-=3*ge,Se=0;Se<ge;++Se){var Ke=j[Z+0]|j[Z+1]<<8|j[Z+2]<<16;Ke>le&&(Ke=le),q(w.Jc[+Se],j,de,Ke),de+=Ke,le-=Ke,Z+=3}q(w.Jc[+ge],j,de,le),j=de<O?0:5}if(j!=0)return Pn(w,j,"cannot parse partitions");for(j=M(de=w.m,7),Z=he(de)?V(de,4):0,O=he(de)?V(de,4):0,le=he(de)?V(de,4):0,ge=he(de)?V(de,4):0,de=he(de)?V(de,4):0,Se=w.Qa,Ke=0;4>Ke;++Ke){if(Se.Cb){var xe=Se.Zb[Ke];Se.Fb||(xe+=j)}else{if(0<Ke){w.pb[Ke]=w.pb[0];continue}xe=j}var je=w.pb[Ke];je.Sc[0]=Wx[Dn(xe+Z,127)],je.Sc[1]=$x[Dn(xe+0,127)],je.Eb[0]=2*Wx[Dn(xe+O,127)],je.Eb[1]=101581*$x[Dn(xe+le,127)]>>16,8>je.Eb[1]&&(je.Eb[1]=8),je.Qc[0]=Wx[Dn(xe+ge,117)],je.Qc[1]=$x[Dn(xe+de,127)],je.lc=xe+de}if(!ne.Rb)return Pn(w,4,"Not a key frame.");for(he(te),ne=w.Pa,j=0;4>j;++j){for(Z=0;8>Z;++Z)for(O=0;3>O;++O)for(le=0;11>le;++le)ge=Y(te,BI[j][Z][O][le])?M(te,8):bI[j][Z][O][le],ne.Wc[j][Z].Yb[O][le]=ge;for(Z=0;17>Z;++Z)ne.Xc[j][Z]=ne.Wc[j][CI[Z]]}return w.kc=he(te),w.kc&&(w.Bd=M(te,8)),w.cb=1}function ZA(w,_,j,O,Z,te,ne){var le=_[Z].Yb[j];for(j=0;16>Z;++Z){if(!Y(w,le[j+0]))return Z;for(;!Y(w,le[j+1]);)if(le=_[++Z].Yb[0],j=0,Z==16)return 16;var de=_[Z+1].Yb;if(Y(w,le[j+2])){var ge=w,Se=0;if(Y(ge,(xe=le)[(Ke=j)+3]))if(Y(ge,xe[Ke+6])){for(le=0,Ke=2*(Se=Y(ge,xe[Ke+8]))+(xe=Y(ge,xe[Ke+9+Se])),Se=0,xe=yI[Ke];xe[le];++le)Se+=Se+Y(ge,xe[le]);Se+=3+(8<<Ke)}else Y(ge,xe[Ke+7])?(Se=7+2*Y(ge,165),Se+=Y(ge,145)):Se=5+Y(ge,159);else Se=Y(ge,xe[Ke+4])?3+Y(ge,xe[Ke+5]):2;le=de[2]}else Se=1,le=de[1];de=ne+wI[Z],0>(ge=w).b&&ae(ge);var Ke,xe=ge.b,je=(Ke=ge.Ca>>1)-(ge.I>>xe)>>31;--ge.b,ge.Ca+=je,ge.Ca|=1,ge.I-=(Ke+1&je)<<xe,te[de]=((Se^je)-je)*O[(0<Z)+0]}return 16}function wh(w){var _=w.rb[w.sb-1];_.la=0,_.Na=0,s(w.zc,0,0,w.zc.length),w.ja=0}function oi(w,_,j,O,Z){Z=w[_+j+32*O]+(Z>>3),w[_+j+32*O]=-256&Z?0>Z?0:255:Z}function $n(w,_,j,O,Z,te){oi(w,_,0,j,O+Z),oi(w,_,1,j,O+te),oi(w,_,2,j,O-te),oi(w,_,3,j,O-Z)}function Ro(w){return(20091*w>>16)+w}function bh(w,_,j,O){var Z,te=0,ne=a(16);for(Z=0;4>Z;++Z){var le=w[_+0]+w[_+8],de=w[_+0]-w[_+8],ge=(35468*w[_+4]>>16)-Ro(w[_+12]),Se=Ro(w[_+4])+(35468*w[_+12]>>16);ne[te+0]=le+Se,ne[te+1]=de+ge,ne[te+2]=de-ge,ne[te+3]=le-Se,te+=4,_++}for(Z=te=0;4>Z;++Z)le=(w=ne[te+0]+4)+ne[te+8],de=w-ne[te+8],ge=(35468*ne[te+4]>>16)-Ro(ne[te+12]),oi(j,O,0,0,le+(Se=Ro(ne[te+4])+(35468*ne[te+12]>>16))),oi(j,O,1,0,de+ge),oi(j,O,2,0,de-ge),oi(j,O,3,0,le-Se),te++,O+=32}function kx(w,_,j,O){var Z=w[_+0]+4,te=35468*w[_+4]>>16,ne=Ro(w[_+4]),le=35468*w[_+1]>>16;$n(j,O,0,Z+ne,w=Ro(w[_+1]),le),$n(j,O,1,Z+te,w,le),$n(j,O,2,Z-te,w,le),$n(j,O,3,Z-ne,w,le)}function Ex(w,_,j,O,Z){bh(w,_,j,O),Z&&bh(w,_+16,j,O+4)}function uo(w,_,j,O){Yc(w,_+0,j,O,1),Yc(w,_+32,j,O+128,1)}function _h(w,_,j,O){var Z;for(w=w[_+0]+4,Z=0;4>Z;++Z)for(_=0;4>_;++_)oi(j,O,_,Z,w)}function Bh(w,_,j,O){w[_+0]&&Sr(w,_+0,j,O),w[_+16]&&Sr(w,_+16,j,O+4),w[_+32]&&Sr(w,_+32,j,O+128),w[_+48]&&Sr(w,_+48,j,O+128+4)}function eu(w,_,j,O){var Z,te=a(16);for(Z=0;4>Z;++Z){var ne=w[_+0+Z]+w[_+12+Z],le=w[_+4+Z]+w[_+8+Z],de=w[_+4+Z]-w[_+8+Z],ge=w[_+0+Z]-w[_+12+Z];te[0+Z]=ne+le,te[8+Z]=ne-le,te[4+Z]=ge+de,te[12+Z]=ge-de}for(Z=0;4>Z;++Z)ne=(w=te[0+4*Z]+3)+te[3+4*Z],le=te[1+4*Z]+te[2+4*Z],de=te[1+4*Z]-te[2+4*Z],ge=w-te[3+4*Z],j[O+0]=ne+le>>3,j[O+16]=ge+de>>3,j[O+32]=ne-le>>3,j[O+48]=ge-de>>3,O+=64}function Rc(w,_,j){var O,Z=_-32,te=Pa,ne=255-w[Z-1];for(O=0;O<j;++O){var le,de=te,ge=ne+w[_-1];for(le=0;le<j;++le)w[_+le]=de[ge+w[Z+le]];_+=32}}function Fx(w,_){Rc(w,_,4)}function jx(w,_){Rc(w,_,8)}function Tx(w,_){Rc(w,_,16)}function Dd(w,_){var j;for(j=0;16>j;++j)n(w,_+32*j,w,_-32,16)}function Ch(w,_){var j;for(j=16;0<j;--j)s(w,_,w[_-1],16),_+=32}function Ui(w,_,j){var O;for(O=0;16>O;++O)s(_,j+32*O,w,16)}function Ix(w,_){var j,O=16;for(j=0;16>j;++j)O+=w[_-1+32*j]+w[_+j-32];Ui(O>>5,w,_)}function Qc(w,_){var j,O=8;for(j=0;16>j;++j)O+=w[_-1+32*j];Ui(O>>4,w,_)}function Pd(w,_){var j,O=8;for(j=0;16>j;++j)O+=w[_+j-32];Ui(O>>4,w,_)}function Ux(w,_){Ui(128,w,_)}function tr(w,_,j){return w+2*_+j+2>>2}function Lx(w,_){var j,O=_-32;for(O=new Uint8Array([tr(w[O-1],w[O+0],w[O+1]),tr(w[O+0],w[O+1],w[O+2]),tr(w[O+1],w[O+2],w[O+3]),tr(w[O+2],w[O+3],w[O+4])]),j=0;4>j;++j)n(w,_+32*j,O,0,O.length)}function Dx(w,_){var j=w[_-1],O=w[_-1+32],Z=w[_-1+64],te=w[_-1+96];Be(w,_+0,16843009*tr(w[_-1-32],j,O)),Be(w,_+32,16843009*tr(j,O,Z)),Be(w,_+64,16843009*tr(O,Z,te)),Be(w,_+96,16843009*tr(Z,te,te))}function Px(w,_){var j,O=4;for(j=0;4>j;++j)O+=w[_+j-32]+w[_-1+32*j];for(O>>=3,j=0;4>j;++j)s(w,_+32*j,O,4)}function Qo(w,_){var j=w[_-1+0],O=w[_-1+32],Z=w[_-1+64],te=w[_-1-32],ne=w[_+0-32],le=w[_+1-32],de=w[_+2-32],ge=w[_+3-32];w[_+0+96]=tr(O,Z,w[_-1+96]),w[_+1+96]=w[_+0+64]=tr(j,O,Z),w[_+2+96]=w[_+1+64]=w[_+0+32]=tr(te,j,O),w[_+3+96]=w[_+2+64]=w[_+1+32]=w[_+0+0]=tr(ne,te,j),w[_+3+64]=w[_+2+32]=w[_+1+0]=tr(le,ne,te),w[_+3+32]=w[_+2+0]=tr(de,le,ne),w[_+3+0]=tr(ge,de,le)}function Mo(w,_){var j=w[_+1-32],O=w[_+2-32],Z=w[_+3-32],te=w[_+4-32],ne=w[_+5-32],le=w[_+6-32],de=w[_+7-32];w[_+0+0]=tr(w[_+0-32],j,O),w[_+1+0]=w[_+0+32]=tr(j,O,Z),w[_+2+0]=w[_+1+32]=w[_+0+64]=tr(O,Z,te),w[_+3+0]=w[_+2+32]=w[_+1+64]=w[_+0+96]=tr(Z,te,ne),w[_+3+32]=w[_+2+64]=w[_+1+96]=tr(te,ne,le),w[_+3+64]=w[_+2+96]=tr(ne,le,de),w[_+3+96]=tr(le,de,de)}function Ox(w,_){var j=w[_-1+0],O=w[_-1+32],Z=w[_-1+64],te=w[_-1-32],ne=w[_+0-32],le=w[_+1-32],de=w[_+2-32],ge=w[_+3-32];w[_+0+0]=w[_+1+64]=te+ne+1>>1,w[_+1+0]=w[_+2+64]=ne+le+1>>1,w[_+2+0]=w[_+3+64]=le+de+1>>1,w[_+3+0]=de+ge+1>>1,w[_+0+96]=tr(Z,O,j),w[_+0+64]=tr(O,j,te),w[_+0+32]=w[_+1+96]=tr(j,te,ne),w[_+1+32]=w[_+2+96]=tr(te,ne,le),w[_+2+32]=w[_+3+96]=tr(ne,le,de),w[_+3+32]=tr(le,de,ge)}function Rx(w,_){var j=w[_+0-32],O=w[_+1-32],Z=w[_+2-32],te=w[_+3-32],ne=w[_+4-32],le=w[_+5-32],de=w[_+6-32],ge=w[_+7-32];w[_+0+0]=j+O+1>>1,w[_+1+0]=w[_+0+64]=O+Z+1>>1,w[_+2+0]=w[_+1+64]=Z+te+1>>1,w[_+3+0]=w[_+2+64]=te+ne+1>>1,w[_+0+32]=tr(j,O,Z),w[_+1+32]=w[_+0+96]=tr(O,Z,te),w[_+2+32]=w[_+1+96]=tr(Z,te,ne),w[_+3+32]=w[_+2+96]=tr(te,ne,le),w[_+3+64]=tr(ne,le,de),w[_+3+96]=tr(le,de,ge)}function tu(w,_){var j=w[_-1+0],O=w[_-1+32],Z=w[_-1+64],te=w[_-1+96];w[_+0+0]=j+O+1>>1,w[_+2+0]=w[_+0+32]=O+Z+1>>1,w[_+2+32]=w[_+0+64]=Z+te+1>>1,w[_+1+0]=tr(j,O,Z),w[_+3+0]=w[_+1+32]=tr(O,Z,te),w[_+3+32]=w[_+1+64]=tr(Z,te,te),w[_+3+64]=w[_+2+64]=w[_+0+96]=w[_+1+96]=w[_+2+96]=w[_+3+96]=te}function Od(w,_){var j=w[_-1+0],O=w[_-1+32],Z=w[_-1+64],te=w[_-1+96],ne=w[_-1-32],le=w[_+0-32],de=w[_+1-32],ge=w[_+2-32];w[_+0+0]=w[_+2+32]=j+ne+1>>1,w[_+0+32]=w[_+2+64]=O+j+1>>1,w[_+0+64]=w[_+2+96]=Z+O+1>>1,w[_+0+96]=te+Z+1>>1,w[_+3+0]=tr(le,de,ge),w[_+2+0]=tr(ne,le,de),w[_+1+0]=w[_+3+32]=tr(j,ne,le),w[_+1+32]=w[_+3+64]=tr(O,j,ne),w[_+1+64]=w[_+3+96]=tr(Z,O,j),w[_+1+96]=tr(te,Z,O)}function Mc(w,_){var j;for(j=0;8>j;++j)n(w,_+32*j,w,_-32,8)}function Qx(w,_){var j;for(j=0;8>j;++j)s(w,_,w[_-1],8),_+=32}function Ho(w,_,j){var O;for(O=0;8>O;++O)s(_,j+32*O,w,8)}function Mx(w,_){var j,O=8;for(j=0;8>j;++j)O+=w[_+j-32]+w[_-1+32*j];Ho(O>>4,w,_)}function Rd(w,_){var j,O=4;for(j=0;8>j;++j)O+=w[_+j-32];Ho(O>>3,w,_)}function Qd(w,_){var j,O=4;for(j=0;8>j;++j)O+=w[_-1+32*j];Ho(O>>3,w,_)}function Nh(w,_){Ho(128,w,_)}function Ko(w,_,j){var O=w[_-j],Z=w[_+0],te=3*(Z-O)+Hx[1020+w[_-2*j]-w[_+j]],ne=Uh[112+(te+4>>3)];w[_-j]=Pa[255+O+Uh[112+(te+3>>3)]],w[_+0]=Pa[255+Z-ne]}function Md(w,_,j,O){var Z=w[_+0],te=w[_+j];return Ai[255+w[_-2*j]-w[_-j]]>O||Ai[255+te-Z]>O}function ru(w,_,j,O){return 4*Ai[255+w[_-j]-w[_+0]]+Ai[255+w[_-2*j]-w[_+j]]<=O}function Hd(w,_,j,O,Z){var te=w[_-3*j],ne=w[_-2*j],le=w[_-j],de=w[_+0],ge=w[_+j],Se=w[_+2*j],Ke=w[_+3*j];return 4*Ai[255+le-de]+Ai[255+ne-ge]>O?0:Ai[255+w[_-4*j]-te]<=Z&&Ai[255+te-ne]<=Z&&Ai[255+ne-le]<=Z&&Ai[255+Ke-Se]<=Z&&Ai[255+Se-ge]<=Z&&Ai[255+ge-de]<=Z}function Hc(w,_,j,O){var Z=2*O+1;for(O=0;16>O;++O)ru(w,_+O,j,Z)&&Ko(w,_+O,j)}function Kd(w,_,j,O){var Z=2*O+1;for(O=0;16>O;++O)ru(w,_+O*j,1,Z)&&Ko(w,_+O*j,1)}function Sh(w,_,j,O){var Z;for(Z=3;0<Z;--Z)Hc(w,_+=4*j,j,O)}function kh(w,_,j,O){var Z;for(Z=3;0<Z;--Z)Kd(w,_+=4,j,O)}function qo(w,_,j,O,Z,te,ne,le){for(te=2*te+1;0<Z--;){if(Hd(w,_,j,te,ne))if(Md(w,_,j,le))Ko(w,_,j);else{var de=w,ge=_,Se=j,Ke=de[ge-2*Se],xe=de[ge-Se],je=de[ge+0],Pe=de[ge+Se],Ye=de[ge+2*Se],He=27*(rt=Hx[1020+3*(je-xe)+Hx[1020+Ke-Pe]])+63>>7,Ze=18*rt+63>>7,rt=9*rt+63>>7;de[ge-3*Se]=Pa[255+de[ge-3*Se]+rt],de[ge-2*Se]=Pa[255+Ke+Ze],de[ge-Se]=Pa[255+xe+He],de[ge+0]=Pa[255+je-He],de[ge+Se]=Pa[255+Pe-Ze],de[ge+2*Se]=Pa[255+Ye-rt]}_+=O}}function Vo(w,_,j,O,Z,te,ne,le){for(te=2*te+1;0<Z--;){if(Hd(w,_,j,te,ne))if(Md(w,_,j,le))Ko(w,_,j);else{var de=w,ge=_,Se=j,Ke=de[ge-Se],xe=de[ge+0],je=de[ge+Se],Pe=Uh[112+(4+(Ye=3*(xe-Ke))>>3)],Ye=Uh[112+(Ye+3>>3)],He=Pe+1>>1;de[ge-2*Se]=Pa[255+de[ge-2*Se]+He],de[ge-Se]=Pa[255+Ke+Ye],de[ge+0]=Pa[255+xe-Pe],de[ge+Se]=Pa[255+je-He]}_+=O}}function Eh(w,_,j,O,Z,te){qo(w,_,j,1,16,O,Z,te)}function Kc(w,_,j,O,Z,te){qo(w,_,1,j,16,O,Z,te)}function Fh(w,_,j,O,Z,te){var ne;for(ne=3;0<ne;--ne)Vo(w,_+=4*j,j,1,16,O,Z,te)}function E(w,_,j,O,Z,te){var ne;for(ne=3;0<ne;--ne)Vo(w,_+=4,1,j,16,O,Z,te)}function J(w,_,j,O,Z,te,ne,le){qo(w,_,Z,1,8,te,ne,le),qo(j,O,Z,1,8,te,ne,le)}function ye(w,_,j,O,Z,te,ne,le){qo(w,_,1,Z,8,te,ne,le),qo(j,O,1,Z,8,te,ne,le)}function Ce(w,_,j,O,Z,te,ne,le){Vo(w,_+4*Z,Z,1,8,te,ne,le),Vo(j,O+4*Z,Z,1,8,te,ne,le)}function Ue(w,_,j,O,Z,te,ne,le){Vo(w,_+4,1,Z,8,te,ne,le),Vo(j,O+4,1,Z,8,te,ne,le)}function et(){this.ba=new Wt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ar,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ct(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ut(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Rt(){this.ua=0,this.Wa=new ze,this.vb=new ze,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new P}function Zt(){this.xb=this.a=0,this.l=new JA,this.ca=new Wt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new U,this.Pb=0,this.wd=new U,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Rt,this.ab=0,this.gc=o(4,Ut),this.Oc=0}function ar(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new JA,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vr(w,_,j,O,Z,te,ne){for(w=w==null?0:w[_+0],_=0;_<ne;++_)Z[te+_]=w+j[O+_]&255,w=Z[te+_]}function ln(w,_,j,O,Z,te,ne){var le;if(w==null)vr(null,null,j,O,Z,te,ne);else for(le=0;le<ne;++le)Z[te+le]=w[_+le]+j[O+le]&255}function On(w,_,j,O,Z,te,ne){if(w==null)vr(null,null,j,O,Z,te,ne);else{var le,de=w[_+0],ge=de,Se=de;for(le=0;le<ne;++le)ge=Se+(de=w[_+le])-ge,Se=j[O+le]+(-256&ge?0>ge?0:255:ge)&255,ge=de,Z[te+le]=Se}}function qr(w,_,j,O){var Z=_.width,te=_.o;if(t(w!=null&&_!=null),0>j||0>=O||j+O>te)return null;if(!w.Cc){if(w.ga==null){var ne;if(w.ga=new ar,(ne=w.ga==null)||(ne=_.width*_.o,t(w.Gb.length==0),w.Gb=a(ne),w.Uc=0,w.Gb==null?ne=0:(w.mb=w.Gb,w.nb=w.Uc,w.rc=null,ne=1),ne=!ne),!ne){ne=w.ga;var le=w.Fa,de=w.P,ge=w.qc,Se=w.mb,Ke=w.nb,xe=de+1,je=ge-1,Pe=ne.l;if(t(le!=null&&Se!=null&&_!=null),Rl[0]=null,Rl[1]=vr,Rl[2]=ln,Rl[3]=On,ne.ca=Se,ne.tb=Ke,ne.c=_.width,ne.i=_.height,t(0<ne.c&&0<ne.i),1>=ge)_=0;else if(ne.$a=3&le[de+0],ne.Z=le[de+0]>>2&3,ne.Lc=le[de+0]>>4&3,de=le[de+0]>>6&3,0>ne.$a||1<ne.$a||4<=ne.Z||1<ne.Lc||de)_=0;else if(Pe.put=Pt,Pe.ac=Wn,Pe.bc=Ln,Pe.ma=ne,Pe.width=_.width,Pe.height=_.height,Pe.Da=_.Da,Pe.v=_.v,Pe.va=_.va,Pe.j=_.j,Pe.o=_.o,ne.$a)e:{t(ne.$a==1),_=Oe();t:for(;;){if(_==null){_=0;break e}if(t(ne!=null),ne.mc=_,_.c=ne.c,_.i=ne.i,_.l=ne.l,_.l.ma=ne,_.l.width=ne.c,_.l.height=ne.i,_.a=0,H(_.m,le,xe,je),!Qe(ne.c,ne.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&Ae(_.s)?(ne.ic=1,le=_.c*_.i,_.Ta=null,_.Ua=0,_.V=a(le),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(ne.ic=0,_=be(_,ne.c)),!_))break t;_=1;break e}ne.mc=null,_=0}else _=je>=ne.c*ne.i;ne=!_}if(ne)return null;w.ga.Lc!=1?w.Ga=0:O=te-j}t(w.ga!=null),t(j+O<=te);e:{if(_=(le=w.ga).c,te=le.l.o,le.$a==0){if(xe=w.rc,je=w.Vc,Pe=w.Fa,de=w.P+1+j*_,ge=w.mb,Se=w.nb+j*_,t(de<=w.P+w.qc),le.Z!=0)for(t(Rl[le.Z]!=null),ne=0;ne<O;++ne)Rl[le.Z](xe,je,Pe,de,ge,Se,_),xe=ge,je=Se,Se+=_,de+=_;else for(ne=0;ne<O;++ne)n(ge,Se,Pe,de,_),xe=ge,je=Se,Se+=_,de+=_;w.rc=xe,w.Vc=je}else{if(t(le.mc!=null),_=j+O,t((ne=le.mc)!=null),t(_<=ne.i),ne.C>=_)_=1;else if(le.ic||Li(),le.ic){le=ne.V,xe=ne.Ba,je=ne.c;var Ye=ne.i,He=(Pe=1,de=ne.$/je,ge=ne.$%je,Se=ne.m,Ke=ne.s,ne.$),Ze=je*Ye,rt=je*_,ht=Ke.wc,At=He<rt?W(Ke,ge,de):null;t(He<=Ze),t(_<=Ye),t(Ae(Ke));t:for(;;){for(;!Se.h&&He<rt;){if(ge&ht||(At=W(Ke,ge,de)),t(At!=null),K(Se),256>(Ye=dt(At.G[0],At.H[0],Se)))le[xe+He]=Ye,++He,++ge>=je&&(ge=0,++de<=_&&!(de%16)&&me(ne,de));else{if(!(280>Ye)){Pe=0;break t}Ye=_e(Ye-256,Se);var Kt,jt=dt(At.G[4],At.H[4],Se);if(K(Se),!(He>=(jt=Ee(je,jt=_e(jt,Se)))&&Ze-He>=Ye)){Pe=0;break t}for(Kt=0;Kt<Ye;++Kt)le[xe+He+Kt]=le[xe+He+Kt-jt];for(He+=Ye,ge+=Ye;ge>=je;)ge-=je,++de<=_&&!(de%16)&&me(ne,de);He<rt&&ge&ht&&(At=W(Ke,ge,de))}t(Se.h==D(Se))}me(ne,de>_?_:de);break t}!Pe||Se.h&&He<Ze?(Pe=0,ne.a=Se.h?5:3):ne.$=He,_=Pe}else _=De(ne,ne.V,ne.Ba,ne.c,ne.i,_,fe);if(!_){O=0;break e}}j+O>=te&&(w.Cc=1),O=1}if(!O)return null;if(w.Cc&&((O=w.ga)!=null&&(O.mc=null),w.ga=null,0<w.Ga))return alert("todo:WebPDequantizeLevels"),null}return w.nb+j*Z}function zn(w,_,j,O,Z,te){for(;0<Z--;){var ne,le=w,de=_+(j?1:0),ge=w,Se=_+(j?0:3);for(ne=0;ne<O;++ne){var Ke=ge[Se+4*ne];Ke!=255&&(Ke*=32897,le[de+4*ne+0]=le[de+4*ne+0]*Ke>>23,le[de+4*ne+1]=le[de+4*ne+1]*Ke>>23,le[de+4*ne+2]=le[de+4*ne+2]*Ke>>23)}_+=te}}function Rn(w,_,j,O,Z){for(;0<O--;){var te;for(te=0;te<j;++te){var ne=w[_+2*te+0],le=15&(ge=w[_+2*te+1]),de=4369*le,ge=(240&ge|ge>>4)*de>>16;w[_+2*te+0]=(240&ne|ne>>4)*de>>16&240|(15&ne|ne<<4)*de>>16>>4&15,w[_+2*te+1]=240&ge|le}_+=Z}}function hs(w,_,j,O,Z,te,ne,le){var de,ge,Se=255;for(ge=0;ge<Z;++ge){for(de=0;de<O;++de){var Ke=w[_+de];te[ne+4*de]=Ke,Se&=Ke}_+=j,ne+=le}return Se!=255}function Go(w,_,j,O,Z){var te;for(te=0;te<Z;++te)j[O+te]=w[_+te]>>8}function Li(){t0=zn,m_=Rn,g_=hs,x_=Go}function Wo(w,_,j){N[w]=function(O,Z,te,ne,le,de,ge,Se,Ke,xe,je,Pe,Ye,He,Ze,rt,ht){var At,Kt=ht-1>>1,jt=le[de+0]|ge[Se+0]<<16,or=Ke[xe+0]|je[Pe+0]<<16;t(O!=null);var Lt=3*jt+or+131074>>2;for(_(O[Z+0],255&Lt,Lt>>16,Ye,He),te!=null&&(Lt=3*or+jt+131074>>2,_(te[ne+0],255&Lt,Lt>>16,Ze,rt)),At=1;At<=Kt;++At){var gr=le[de+At]|ge[Se+At]<<16,Yn=Ke[xe+At]|je[Pe+At]<<16,lr=jt+gr+or+Yn+524296,Dt=lr+2*(gr+or)>>3;Lt=Dt+jt>>1,jt=(lr=lr+2*(jt+Yn)>>3)+gr>>1,_(O[Z+2*At-1],255&Lt,Lt>>16,Ye,He+(2*At-1)*j),_(O[Z+2*At-0],255&jt,jt>>16,Ye,He+(2*At-0)*j),te!=null&&(Lt=lr+or>>1,jt=Dt+Yn>>1,_(te[ne+2*At-1],255&Lt,Lt>>16,Ze,rt+(2*At-1)*j),_(te[ne+2*At+0],255&jt,jt>>16,Ze,rt+(2*At+0)*j)),jt=gr,or=Yn}1&ht||(Lt=3*jt+or+131074>>2,_(O[Z+ht-1],255&Lt,Lt>>16,Ye,He+(ht-1)*j),te!=null&&(Lt=3*or+jt+131074>>2,_(te[ne+ht-1],255&Lt,Lt>>16,Ze,rt+(ht-1)*j)))}}function qd(){ui[Lh]=SI,ui[Dh]=E_,ui[B_]=kI,ui[Ph]=F_,ui[Oh]=j_,ui[Kx]=T_,ui[C_]=EI,ui[qx]=E_,ui[Vx]=F_,ui[Rh]=j_,ui[Gx]=T_}function nu(w){return w&-16384?0>w?0:255:w>>FI}function El(w,_){return nu((19077*w>>8)+(26149*_>>8)-14234)}function qc(w,_,j){return nu((19077*w>>8)-(6419*_>>8)-(13320*j>>8)+8708)}function Vc(w,_){return nu((19077*w>>8)+(33050*_>>8)-17685)}function Fl(w,_,j,O,Z){O[Z+0]=El(w,j),O[Z+1]=qc(w,_,j),O[Z+2]=Vc(w,_)}function ps(w,_,j,O,Z){O[Z+0]=Vc(w,_),O[Z+1]=qc(w,_,j),O[Z+2]=El(w,j)}function Gc(w,_,j,O,Z){var te=qc(w,_,j);_=te<<3&224|Vc(w,_)>>3,O[Z+0]=248&El(w,j)|te>>5,O[Z+1]=_}function Wc(w,_,j,O,Z){var te=240&Vc(w,_)|15;O[Z+0]=240&El(w,j)|qc(w,_,j)>>4,O[Z+1]=te}function Vd(w,_,j,O,Z){O[Z+0]=255,Fl(w,_,j,O,Z+1)}function Gd(w,_,j,O,Z){ps(w,_,j,O,Z),O[Z+3]=255}function ra(w,_,j,O,Z){Fl(w,_,j,O,Z),O[Z+3]=255}function $o(w,_,j){N[w]=function(O,Z,te,ne,le,de,ge,Se,Ke){for(var xe=Se+(-2&Ke)*j;Se!=xe;)_(O[Z+0],te[ne+0],le[de+0],ge,Se),_(O[Z+1],te[ne+0],le[de+0],ge,Se+j),Z+=2,++ne,++de,Se+=2*j;1&Ke&&_(O[Z+0],te[ne+0],le[de+0],ge,Se)}}function su(w,_,j){return j==0?w==0?_==0?6:5:_==0?4:0:j}function jh(w,_,j,O,Z){switch(w>>>30){case 3:Yc(_,j,O,Z,0);break;case 2:ci(_,j,O,Z);break;case 1:Sr(_,j,O,Z)}}function li(w,_){var j,O,Z=_.M,te=_.Nb,ne=w.oc,le=w.pc+40,de=w.oc,ge=w.pc+584,Se=w.oc,Ke=w.pc+600;for(j=0;16>j;++j)ne[le+32*j-1]=129;for(j=0;8>j;++j)de[ge+32*j-1]=129,Se[Ke+32*j-1]=129;for(0<Z?ne[le-1-32]=de[ge-1-32]=Se[Ke-1-32]=129:(s(ne,le-32-1,127,21),s(de,ge-32-1,127,9),s(Se,Ke-32-1,127,9)),O=0;O<w.za;++O){var xe=_.ya[_.aa+O];if(0<O){for(j=-1;16>j;++j)n(ne,le+32*j-4,ne,le+32*j+12,4);for(j=-1;8>j;++j)n(de,ge+32*j-4,de,ge+32*j+4,4),n(Se,Ke+32*j-4,Se,Ke+32*j+4,4)}var je=w.Gd,Pe=w.Hd+O,Ye=xe.ad,He=xe.Hc;if(0<Z&&(n(ne,le-32,je[Pe].y,0,16),n(de,ge-32,je[Pe].f,0,8),n(Se,Ke-32,je[Pe].ea,0,8)),xe.Za){var Ze=ne,rt=le-32+16;for(0<Z&&(O>=w.za-1?s(Ze,rt,je[Pe].y[15],4):n(Ze,rt,je[Pe+1].y,0,4)),j=0;4>j;j++)Ze[rt+128+j]=Ze[rt+256+j]=Ze[rt+384+j]=Ze[rt+0+j];for(j=0;16>j;++j,He<<=2)Ze=ne,rt=le+U_[j],Di[xe.Ob[j]](Ze,rt),jh(He,Ye,16*+j,Ze,rt)}else if(Ze=su(O,Z,xe.Ob[0]),Ol[Ze](ne,le),He!=0)for(j=0;16>j;++j,He<<=2)jh(He,Ye,16*+j,ne,le+U_[j]);for(j=xe.Gc,Ze=su(O,Z,xe.Dd),Yo[Ze](de,ge),Yo[Ze](Se,Ke),He=Ye,Ze=de,rt=ge,255&(xe=0|j)&&(170&xe?po(He,256,Ze,rt):Mr(He,256,Ze,rt)),xe=Se,He=Ke,255&(j>>=8)&&(170&j?po(Ye,320,xe,He):Mr(Ye,320,xe,He)),Z<w.Ub-1&&(n(je[Pe].y,0,ne,le+480,16),n(je[Pe].f,0,de,ge+224,8),n(je[Pe].ea,0,Se,Ke+224,8)),j=8*te*w.B,je=w.sa,Pe=w.ta+16*O+16*te*w.R,Ye=w.qa,xe=w.ra+8*O+j,He=w.Ha,Ze=w.Ia+8*O+j,j=0;16>j;++j)n(je,Pe+j*w.R,ne,le+32*j,16);for(j=0;8>j;++j)n(Ye,xe+j*w.B,de,ge+32*j,8),n(He,Ze+j*w.B,Se,Ke+32*j,8)}}function $c(w,_,j,O,Z,te,ne,le,de){var ge=[0],Se=[0],Ke=0,xe=de!=null?de.kd:0,je=de??new ct;if(w==null||12>j)return 7;je.data=w,je.w=_,je.ha=j,_=[_],j=[j],je.gb=[je.gb];e:{var Pe=_,Ye=j,He=je.gb;if(t(w!=null),t(Ye!=null),t(He!=null),He[0]=0,12<=Ye[0]&&!r(w,Pe[0],"RIFF")){if(r(w,Pe[0]+8,"WEBP")){He=3;break e}var Ze=Je(w,Pe[0]+4);if(12>Ze||4294967286<Ze){He=3;break e}if(xe&&Ze>Ye[0]-8){He=7;break e}He[0]=Ze,Pe[0]+=12,Ye[0]-=12}He=0}if(He!=0)return He;for(Ze=0<je.gb[0],j=j[0];;){e:{var rt=w;Ye=_,He=j;var ht=ge,At=Se,Kt=Pe=[0];if((Lt=Ke=[Ke])[0]=0,8>He[0])He=7;else{if(!r(rt,Ye[0],"VP8X")){if(Je(rt,Ye[0]+4)!=10){He=3;break e}if(18>He[0]){He=7;break e}var jt=Je(rt,Ye[0]+8),or=1+Te(rt,Ye[0]+12);if(2147483648<=or*(rt=1+Te(rt,Ye[0]+15))){He=3;break e}Kt!=null&&(Kt[0]=jt),ht!=null&&(ht[0]=or),At!=null&&(At[0]=rt),Ye[0]+=18,He[0]-=18,Lt[0]=1}He=0}}if(Ke=Ke[0],Pe=Pe[0],He!=0)return He;if(Ye=!!(2&Pe),!Ze&&Ke)return 3;if(te!=null&&(te[0]=!!(16&Pe)),ne!=null&&(ne[0]=Ye),le!=null&&(le[0]=0),ne=ge[0],Pe=Se[0],Ke&&Ye&&de==null){He=0;break}if(4>j){He=7;break}if(Ze&&Ke||!Ze&&!Ke&&!r(w,_[0],"ALPH")){j=[j],je.na=[je.na],je.P=[je.P],je.Sa=[je.Sa];e:{jt=w,He=_,Ze=j;var Lt=je.gb;ht=je.na,At=je.P,Kt=je.Sa,or=22,t(jt!=null),t(Ze!=null),rt=He[0];var gr=Ze[0];for(t(ht!=null),t(Kt!=null),ht[0]=null,At[0]=null,Kt[0]=0;;){if(He[0]=rt,Ze[0]=gr,8>gr){He=7;break e}var Yn=Je(jt,rt+4);if(4294967286<Yn){He=3;break e}var lr=8+Yn+1&-2;if(or+=lr,0<Lt&&or>Lt){He=3;break e}if(!r(jt,rt,"VP8 ")||!r(jt,rt,"VP8L")){He=0;break e}if(gr[0]<lr){He=7;break e}r(jt,rt,"ALPH")||(ht[0]=jt,At[0]=rt+8,Kt[0]=Yn),rt+=lr,gr-=lr}}if(j=j[0],je.na=je.na[0],je.P=je.P[0],je.Sa=je.Sa[0],He!=0)break}j=[j],je.Ja=[je.Ja],je.xa=[je.xa];e:if(Lt=w,He=_,Ze=j,ht=je.gb[0],At=je.Ja,Kt=je.xa,jt=He[0],rt=!r(Lt,jt,"VP8 "),or=!r(Lt,jt,"VP8L"),t(Lt!=null),t(Ze!=null),t(At!=null),t(Kt!=null),8>Ze[0])He=7;else{if(rt||or){if(Lt=Je(Lt,jt+4),12<=ht&&Lt>ht-12){He=3;break e}if(xe&&Lt>Ze[0]-8){He=7;break e}At[0]=Lt,He[0]+=8,Ze[0]-=8,Kt[0]=or}else Kt[0]=5<=Ze[0]&&Lt[jt+0]==47&&!(Lt[jt+4]>>5),At[0]=Ze[0];He=0}if(j=j[0],je.Ja=je.Ja[0],je.xa=je.xa[0],_=_[0],He!=0)break;if(4294967286<je.Ja)return 3;if(le==null||Ye||(le[0]=je.xa?2:1),ne=[ne],Pe=[Pe],je.xa){if(5>j){He=7;break}le=ne,xe=Pe,Ye=te,w==null||5>j?w=0:5<=j&&w[_+0]==47&&!(w[_+4]>>5)?(Ze=[0],Lt=[0],ht=[0],H(At=new U,w,_,j),on(At,Ze,Lt,ht)?(le!=null&&(le[0]=Ze[0]),xe!=null&&(xe[0]=Lt[0]),Ye!=null&&(Ye[0]=ht[0]),w=1):w=0):w=0}else{if(10>j){He=7;break}le=Pe,w==null||10>j||!yh(w,_+3,j-3)?w=0:(xe=w[_+0]|w[_+1]<<8|w[_+2]<<16,Ye=16383&(w[_+7]<<8|w[_+6]),w=16383&(w[_+9]<<8|w[_+8]),1&xe||3<(xe>>1&7)||!(xe>>4&1)||xe>>5>=je.Ja||!Ye||!w?w=0:(ne&&(ne[0]=Ye),le&&(le[0]=w),w=1))}if(!w||(ne=ne[0],Pe=Pe[0],Ke&&(ge[0]!=ne||Se[0]!=Pe)))return 3;de!=null&&(de[0]=je,de.offset=_-de.w,t(4294967286>_-de.w),t(de.offset==de.ha-j));break}return He==0||He==7&&Ke&&de==null?(te!=null&&(te[0]|=je.na!=null&&0<je.na.length),O!=null&&(O[0]=ne),Z!=null&&(Z[0]=Pe),0):He}function Wd(w,_,j){var O=_.width,Z=_.height,te=0,ne=0,le=O,de=Z;if(_.Da=w!=null&&0<w.Da,_.Da&&(le=w.cd,de=w.bd,te=w.v,ne=w.j,11>j||(te&=-2,ne&=-2),0>te||0>ne||0>=le||0>=de||te+le>O||ne+de>Z))return 0;if(_.v=te,_.j=ne,_.va=te+le,_.o=ne+de,_.U=le,_.T=de,_.da=w!=null&&0<w.da,_.da){if(!Fe(le,de,j=[w.ib],te=[w.hb]))return 0;_.ib=j[0],_.hb=te[0]}return _.ob=w!=null&&w.ob,_.Kb=w==null||!w.Sd,_.da&&(_.ob=_.ib<3*O/4&&_.hb<3*Z/4,_.Kb=0),1}function $d(w){if(w==null)return 2;if(11>w.S){var _=w.f.RGBA;_.fb+=(w.height-1)*_.A,_.A=-_.A}else _=w.f.kb,w=w.height,_.O+=(w-1)*_.fa,_.fa=-_.fa,_.N+=(w-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(w-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(w-1)*_.lb,_.lb=-_.lb);return 0}function jl(w,_,j,O){if(O==null||0>=w||0>=_)return 2;if(j!=null){if(j.Da){var Z=j.cd,te=j.bd,ne=-2&j.v,le=-2&j.j;if(0>ne||0>le||0>=Z||0>=te||ne+Z>w||le+te>_)return 2;w=Z,_=te}if(j.da){if(!Fe(w,_,Z=[j.ib],te=[j.hb]))return 2;w=Z[0],_=te[0]}}O.width=w,O.height=_;e:{var de=O.width,ge=O.height;if(w=O.S,0>=de||0>=ge||!(w>=Lh&&13>w))w=2;else{if(0>=O.Rd&&O.sd==null){ne=te=Z=_=0;var Se=(le=de*L_[w])*ge;if(11>w||(te=(ge+1)/2*(_=(de+1)/2),w==12&&(ne=(Z=de)*ge)),(ge=a(Se+2*te+ne))==null){w=1;break e}O.sd=ge,11>w?((de=O.f.RGBA).eb=ge,de.fb=0,de.A=le,de.size=Se):((de=O.f.kb).y=ge,de.O=0,de.fa=le,de.Fd=Se,de.f=ge,de.N=0+Se,de.Ab=_,de.Cd=te,de.ea=ge,de.W=0+Se+te,de.Db=_,de.Ed=te,w==12&&(de.F=ge,de.J=0+Se+2*te),de.Tc=ne,de.lb=Z)}if(_=1,Z=O.S,te=O.width,ne=O.height,Z>=Lh&&13>Z)if(11>Z)w=O.f.RGBA,_&=(le=Math.abs(w.A))*(ne-1)+te<=w.size,_&=le>=te*L_[Z],_&=w.eb!=null;else{w=O.f.kb,le=(te+1)/2,Se=(ne+1)/2,de=Math.abs(w.fa),ge=Math.abs(w.Ab);var Ke=Math.abs(w.Db),xe=Math.abs(w.lb),je=xe*(ne-1)+te;_&=de*(ne-1)+te<=w.Fd,_&=ge*(Se-1)+le<=w.Cd,_=(_&=Ke*(Se-1)+le<=w.Ed)&de>=te&ge>=le&Ke>=le,_&=w.y!=null,_&=w.f!=null,_&=w.ea!=null,Z==12&&(_&=xe>=te,_&=je<=w.Tc,_&=w.F!=null)}else _=0;w=_?0:2}}return w!=0||j!=null&&j.fd&&(w=$d(O)),w}var zc=64,La=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Da=24,Tl=32,zo=8,Il=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];we("Predictor0","PredictorAdd0"),N.Predictor0=function(){return 4278190080},N.Predictor1=function(w){return w},N.Predictor2=function(w,_,j){return _[j+0]},N.Predictor3=function(w,_,j){return _[j+1]},N.Predictor4=function(w,_,j){return _[j-1]},N.Predictor5=function(w,_,j){return Le(Le(w,_[j+1]),_[j+0])},N.Predictor6=function(w,_,j){return Le(w,_[j-1])},N.Predictor7=function(w,_,j){return Le(w,_[j+0])},N.Predictor8=function(w,_,j){return Le(_[j-1],_[j+0])},N.Predictor9=function(w,_,j){return Le(_[j+0],_[j+1])},N.Predictor10=function(w,_,j){return Le(Le(w,_[j-1]),Le(_[j+0],_[j+1]))},N.Predictor11=function(w,_,j){var O=_[j+0];return 0>=it(O>>24&255,w>>24&255,(_=_[j-1])>>24&255)+it(O>>16&255,w>>16&255,_>>16&255)+it(O>>8&255,w>>8&255,_>>8&255)+it(255&O,255&w,255&_)?O:w},N.Predictor12=function(w,_,j){var O=_[j+0];return(tt((w>>24&255)+(O>>24&255)-((_=_[j-1])>>24&255))<<24|tt((w>>16&255)+(O>>16&255)-(_>>16&255))<<16|tt((w>>8&255)+(O>>8&255)-(_>>8&255))<<8|tt((255&w)+(255&O)-(255&_)))>>>0},N.Predictor13=function(w,_,j){var O=_[j-1];return(lt((w=Le(w,_[j+0]))>>24&255,O>>24&255)<<24|lt(w>>16&255,O>>16&255)<<16|lt(w>>8&255,O>>8&255)<<8|lt(255&w,255&O))>>>0};var zd=N.PredictorAdd0;N.PredictorAdd1=Ne,we("Predictor2","PredictorAdd2"),we("Predictor3","PredictorAdd3"),we("Predictor4","PredictorAdd4"),we("Predictor5","PredictorAdd5"),we("Predictor6","PredictorAdd6"),we("Predictor7","PredictorAdd7"),we("Predictor8","PredictorAdd8"),we("Predictor9","PredictorAdd9"),we("Predictor10","PredictorAdd10"),we("Predictor11","PredictorAdd11"),we("Predictor12","PredictorAdd12"),we("Predictor13","PredictorAdd13");var au=N.PredictorAdd2;Ve("ColorIndexInverseTransform","MapARGB","32b",function(w){return w>>8&255},function(w){return w}),Ve("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(w){return w},function(w){return w>>8&255});var bn,Th=N.ColorIndexInverseTransform,fo=N.MapARGB,ho=N.VP8LColorIndexInverseTransformAlpha,Xd=N.MapAlpha,Yd=N.VP8LPredictorsAdd=[];Yd.length=16,(N.VP8LPredictors=[]).length=16,(N.VP8LPredictorsAdd_C=[]).length=16,(N.VP8LPredictors_C=[]).length=16;var Jd,Zd,Ul,Ll,Dl,Xc,Pl,Yc,ci,po,Sr,Mr,_n,Xn,Xo,e0,iu,Ih,A_,u_,d_,f_,h_,p_,t0,m_,g_,x_,v_=a(511),y_=a(2041),w_=a(225),b_=a(767),__=0,Hx=y_,Uh=w_,Pa=b_,Ai=v_,Lh=0,Dh=1,B_=2,Ph=3,Oh=4,Kx=5,C_=6,qx=7,Vx=8,Rh=9,Gx=10,fI=[2,3,7],hI=[3,3,11],N_=[280,256,256,256,40],pI=[0,1,1,1,0],mI=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],gI=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],xI=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],vI=8,Wx=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],$x=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],r0=null,yI=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],wI=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],S_=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],bI=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_I=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],BI=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],CI=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ol=[],Di=[],Yo=[],NI=1,k_=2,Rl=[],ui=[];Wo("UpsampleRgbLinePair",Fl,3),Wo("UpsampleBgrLinePair",ps,3),Wo("UpsampleRgbaLinePair",ra,4),Wo("UpsampleBgraLinePair",Gd,4),Wo("UpsampleArgbLinePair",Vd,4),Wo("UpsampleRgba4444LinePair",Wc,2),Wo("UpsampleRgb565LinePair",Gc,2);var SI=N.UpsampleRgbLinePair,kI=N.UpsampleBgrLinePair,E_=N.UpsampleRgbaLinePair,F_=N.UpsampleBgraLinePair,j_=N.UpsampleArgbLinePair,T_=N.UpsampleRgba4444LinePair,EI=N.UpsampleRgb565LinePair,Qh=16,Mh=1<<Qh-1,n0=-227,zx=482,FI=6,I_=0,jI=a(256),TI=a(256),II=a(256),UI=a(256),LI=a(zx-n0),DI=a(zx-n0);$o("YuvToRgbRow",Fl,3),$o("YuvToBgrRow",ps,3),$o("YuvToRgbaRow",ra,4),$o("YuvToBgraRow",Gd,4),$o("YuvToArgbRow",Vd,4),$o("YuvToRgba4444Row",Wc,2),$o("YuvToRgb565Row",Gc,2);var U_=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Hh=[0,2,8],PI=[8,7,6,4,4,2,2,2,1,1,1,1],OI=1;this.WebPDecodeRGBA=function(w,_,j,O,Z){var te=Dh,ne=new et,le=new Wt;ne.ba=le,le.S=te,le.width=[le.width],le.height=[le.height];var de=le.width,ge=le.height,Se=new St;if(Se==null||w==null)var Ke=2;else t(Se!=null),Ke=$c(w,_,j,Se.width,Se.height,Se.Pd,Se.Qd,Se.format,null);if(Ke!=0?de=0:(de!=null&&(de[0]=Se.width[0]),ge!=null&&(ge[0]=Se.height[0]),de=1),de){le.width=le.width[0],le.height=le.height[0],O!=null&&(O[0]=le.width),Z!=null&&(Z[0]=le.height);e:{if(O=new JA,(Z=new ct).data=w,Z.w=_,Z.ha=j,Z.kd=1,_=[0],t(Z!=null),((w=$c(Z.data,Z.w,Z.ha,null,null,null,_,null,Z))==0||w==7)&&_[0]&&(w=4),(_=w)==0){if(t(ne!=null),O.data=Z.data,O.w=Z.w+Z.offset,O.ha=Z.ha-Z.offset,O.put=Pt,O.ac=Wn,O.bc=Ln,O.ma=ne,Z.xa){if((w=Oe())==null){ne=1;break e}if(function(xe,je){var Pe=[0],Ye=[0],He=[0];t:for(;;){if(xe==null)return 0;if(je==null)return xe.a=2,0;if(xe.l=je,xe.a=0,H(xe.m,je.data,je.w,je.ha),!on(xe.m,Pe,Ye,He)){xe.a=3;break t}if(xe.xb=k_,je.width=Pe[0],je.height=Ye[0],!Qe(Pe[0],Ye[0],1,xe,null))break t;return 1}return t(xe.a!=0),0}(w,O)){if(O=(_=jl(O.width,O.height,ne.Oa,ne.ba))==0){t:{O=w;r:for(;;){if(O==null){O=0;break t}if(t(O.s.yc!=null),t(O.s.Ya!=null),t(0<O.s.Wb),t((j=O.l)!=null),t((Z=j.ma)!=null),O.xb!=0){if(O.ca=Z.ba,O.tb=Z.tb,t(O.ca!=null),!Wd(Z.Oa,j,Ph)){O.a=2;break r}if(!be(O,j.width)||j.da)break r;if((j.da||yt(O.ca.S))&&Li(),11>O.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),O.ca.f.kb.F!=null&&Li()),O.Pb&&0<O.s.ua&&O.s.vb.X==null&&!ie(O.s.vb,O.s.Wa.Xa)){O.a=1;break r}O.xb=0}if(!De(O,O.V,O.Ba,O.c,O.i,j.o,re))break r;Z.Dc=O.Ma,O=1;break t}t(O.a!=0),O=0}O=!O}O&&(_=w.a)}else _=w.a}else{if((w=new Sx)==null){ne=1;break e}if(w.Fa=Z.na,w.P=Z.P,w.qc=Z.Sa,Ao(w,O)){if((_=jl(O.width,O.height,ne.Oa,ne.ba))==0){if(w.Aa=0,j=ne.Oa,t((Z=w)!=null),j!=null){if(0<(de=0>(de=j.Md)?0:100<de?255:255*de/100)){for(ge=Se=0;4>ge;++ge)12>(Ke=Z.pb[ge]).lc&&(Ke.ia=de*PI[0>Ke.lc?0:Ke.lc]>>3),Se|=Ke.ia;Se&&(alert("todo:VP8InitRandom"),Z.ia=1)}Z.Ga=j.Id,100<Z.Ga?Z.Ga=100:0>Z.Ga&&(Z.Ga=0)}(function(xe,je){if(xe==null)return 0;if(je==null)return Pn(xe,2,"NULL VP8Io parameter in VP8Decode().");if(!xe.cb&&!Ao(xe,je))return 0;if(t(xe.cb),je.ac==null||je.ac(je)){je.ob&&(xe.L=0);var Pe=Hh[xe.L];if(xe.L==2?(xe.yb=0,xe.zb=0):(xe.yb=je.v-Pe>>4,xe.zb=je.j-Pe>>4,0>xe.yb&&(xe.yb=0),0>xe.zb&&(xe.zb=0)),xe.Va=je.o+15+Pe>>4,xe.Hb=je.va+15+Pe>>4,xe.Hb>xe.za&&(xe.Hb=xe.za),xe.Va>xe.Ub&&(xe.Va=xe.Ub),0<xe.L){var Ye=xe.ed;for(Pe=0;4>Pe;++Pe){var He;if(xe.Qa.Cb){var Ze=xe.Qa.Lb[Pe];xe.Qa.Fb||(Ze+=Ye.Tb)}else Ze=Ye.Tb;for(He=0;1>=He;++He){var rt=xe.gd[Pe][He],ht=Ze;if(Ye.Pc&&(ht+=Ye.vd[0],He&&(ht+=Ye.od[0])),0<(ht=0>ht?0:63<ht?63:ht)){var At=ht;0<Ye.wb&&(At=4<Ye.wb?At>>2:At>>1)>9-Ye.wb&&(At=9-Ye.wb),1>At&&(At=1),rt.dd=At,rt.tc=2*ht+At,rt.ld=40<=ht?2:15<=ht?1:0}else rt.tc=0;rt.La=He}}}Pe=0}else Pn(xe,6,"Frame setup failed"),Pe=xe.a;if(Pe=Pe==0){if(Pe){xe.$c=0,0<xe.Aa||(xe.Ic=OI);t:{Pe=xe.Ic,Ye=4*(At=xe.za);var Kt=32*At,jt=At+1,or=0<xe.L?At*(0<xe.Aa?2:1):0,Lt=(xe.Aa==2?2:1)*At;if((rt=Ye+832+(He=3*(16*Pe+Hh[xe.L])/2*Kt)+(Ze=xe.Fa!=null&&0<xe.Fa.length?xe.Kc.c*xe.Kc.i:0))!=rt)Pe=0;else{if(rt>xe.Vb){if(xe.Vb=0,xe.Ec=a(rt),xe.Fc=0,xe.Ec==null){Pe=Pn(xe,1,"no memory during frame initialization.");break t}xe.Vb=rt}rt=xe.Ec,ht=xe.Fc,xe.Ac=rt,xe.Bc=ht,ht+=Ye,xe.Gd=o(Kt,ta),xe.Hd=0,xe.rb=o(jt+1,Br),xe.sb=1,xe.wa=or?o(or,Ht):null,xe.Y=0,xe.D.Nb=0,xe.D.wa=xe.wa,xe.D.Y=xe.Y,0<xe.Aa&&(xe.D.Y+=At),t(!0),xe.oc=rt,xe.pc=ht,ht+=832,xe.ya=o(Lt,Er),xe.aa=0,xe.D.ya=xe.ya,xe.D.aa=xe.aa,xe.Aa==2&&(xe.D.aa+=At),xe.R=16*At,xe.B=8*At,At=(Kt=Hh[xe.L])*xe.R,Kt=Kt/2*xe.B,xe.sa=rt,xe.ta=ht+At,xe.qa=xe.sa,xe.ra=xe.ta+16*Pe*xe.R+Kt,xe.Ha=xe.qa,xe.Ia=xe.ra+8*Pe*xe.B+Kt,xe.$c=0,ht+=He,xe.mb=Ze?rt:null,xe.nb=Ze?ht:null,t(ht+Ze<=xe.Fc+xe.Vb),wh(xe),s(xe.Ac,xe.Bc,0,Ye),Pe=1}}if(Pe){if(je.ka=0,je.y=xe.sa,je.O=xe.ta,je.f=xe.qa,je.N=xe.ra,je.ea=xe.Ha,je.Vd=xe.Ia,je.fa=xe.R,je.Rc=xe.B,je.F=null,je.J=0,!__){for(Pe=-255;255>=Pe;++Pe)v_[255+Pe]=0>Pe?-Pe:Pe;for(Pe=-1020;1020>=Pe;++Pe)y_[1020+Pe]=-128>Pe?-128:127<Pe?127:Pe;for(Pe=-112;112>=Pe;++Pe)w_[112+Pe]=-16>Pe?-16:15<Pe?15:Pe;for(Pe=-255;510>=Pe;++Pe)b_[255+Pe]=0>Pe?0:255<Pe?255:Pe;__=1}Pl=eu,Yc=Ex,po=uo,Sr=_h,Mr=Bh,ci=kx,_n=Eh,Xn=Kc,Xo=J,e0=ye,iu=Fh,Ih=E,A_=Ce,u_=Ue,d_=Hc,f_=Kd,h_=Sh,p_=kh,Di[0]=Px,Di[1]=Fx,Di[2]=Lx,Di[3]=Dx,Di[4]=Qo,Di[5]=Ox,Di[6]=Mo,Di[7]=Rx,Di[8]=Od,Di[9]=tu,Ol[0]=Ix,Ol[1]=Tx,Ol[2]=Dd,Ol[3]=Ch,Ol[4]=Qc,Ol[5]=Pd,Ol[6]=Ux,Yo[0]=Mx,Yo[1]=jx,Yo[2]=Mc,Yo[3]=Qx,Yo[4]=Qd,Yo[5]=Rd,Yo[6]=Nh,Pe=1}else Pe=0}Pe&&(Pe=function(gr,Yn){for(gr.M=0;gr.M<gr.Va;++gr.M){var lr,Dt=gr.Jc[gr.M&gr.Xb],_t=gr.m,Bn=gr;for(lr=0;lr<Bn.za;++lr){var nr=_t,xr=Bn,zr=xr.Ac,ms=xr.Bc+4*lr,na=xr.zc,pn=xr.ya[xr.aa+lr];if(xr.Qa.Bb?pn.$b=Y(nr,xr.Pa.jb[0])?2+Y(nr,xr.Pa.jb[2]):Y(nr,xr.Pa.jb[1]):pn.$b=0,xr.kc&&(pn.Ad=Y(nr,xr.Bd)),pn.Za=!Y(nr,145)+0,pn.Za){var Ts=pn.Ob,sa=0;for(xr=0;4>xr;++xr){var Jn,yr=na[0+xr];for(Jn=0;4>Jn;++Jn){yr=_I[zr[ms+Jn]][yr];for(var Fr=S_[Y(nr,yr[0])];0<Fr;)Fr=S_[2*Fr+Y(nr,yr[Fr])];yr=-Fr,zr[ms+Jn]=yr}n(Ts,sa,zr,ms,4),sa+=4,na[0+xr]=yr}}else yr=Y(nr,156)?Y(nr,128)?1:3:Y(nr,163)?2:0,pn.Ob[0]=yr,s(zr,ms,yr,4),s(na,0,yr,4);pn.Dd=Y(nr,142)?Y(nr,114)?Y(nr,183)?1:3:2:0}if(Bn.m.Ka)return Pn(gr,7,"Premature end-of-partition0 encountered.");for(;gr.ja<gr.za;++gr.ja){if(Bn=Dt,nr=(_t=gr).rb[_t.sb-1],zr=_t.rb[_t.sb+_t.ja],lr=_t.ya[_t.aa+_t.ja],ms=_t.kc?lr.Ad:0)nr.la=zr.la=0,lr.Za||(nr.Na=zr.Na=0),lr.Hc=0,lr.Gc=0,lr.ia=0;else{var mn,jr;if(nr=zr,zr=Bn,ms=_t.Pa.Xc,na=_t.ya[_t.aa+_t.ja],pn=_t.pb[na.$b],xr=na.ad,Ts=0,sa=_t.rb[_t.sb-1],yr=Jn=0,s(xr,Ts,0,384),na.Za)var gs=0,Pi=ms[3];else{Fr=a(16);var Cn=nr.Na+sa.Na;if(Cn=r0(zr,ms[1],Cn,pn.Eb,0,Fr,0),nr.Na=sa.Na=(0<Cn)+0,1<Cn)Pl(Fr,0,xr,Ts);else{var ya=Fr[0]+3>>3;for(Fr=0;256>Fr;Fr+=16)xr[Ts+Fr]=ya}gs=1,Pi=ms[0]}var Hr=15&nr.la,Zn=15&sa.la;for(Fr=0;4>Fr;++Fr){var Oa=1&Zn;for(ya=jr=0;4>ya;++ya)Hr=Hr>>1|(Oa=(Cn=r0(zr,Pi,Cn=Oa+(1&Hr),pn.Sc,gs,xr,Ts))>gs)<<7,jr=jr<<2|(3<Cn?3:1<Cn?2:xr[Ts+0]!=0),Ts+=16;Hr>>=4,Zn=Zn>>1|Oa<<7,Jn=(Jn<<8|jr)>>>0}for(Pi=Hr,gs=Zn>>4,mn=0;4>mn;mn+=2){for(jr=0,Hr=nr.la>>4+mn,Zn=sa.la>>4+mn,Fr=0;2>Fr;++Fr){for(Oa=1&Zn,ya=0;2>ya;++ya)Cn=Oa+(1&Hr),Hr=Hr>>1|(Oa=0<(Cn=r0(zr,ms[2],Cn,pn.Qc,0,xr,Ts)))<<3,jr=jr<<2|(3<Cn?3:1<Cn?2:xr[Ts+0]!=0),Ts+=16;Hr>>=2,Zn=Zn>>1|Oa<<5}yr|=jr<<4*mn,Pi|=Hr<<4<<mn,gs|=(240&Zn)<<mn}nr.la=Pi,sa.la=gs,na.Hc=Jn,na.Gc=yr,na.ia=43690&yr?0:pn.ia,ms=!(Jn|yr)}if(0<_t.L&&(_t.wa[_t.Y+_t.ja]=_t.gd[lr.$b][lr.Za],_t.wa[_t.Y+_t.ja].La|=!ms),Bn.Ka)return Pn(gr,7,"Premature end-of-file encountered.")}if(wh(gr),_t=Yn,Bn=1,lr=(Dt=gr).D,nr=0<Dt.L&&Dt.M>=Dt.zb&&Dt.M<=Dt.Va,Dt.Aa==0)t:{if(lr.M=Dt.M,lr.uc=nr,li(Dt,lr),Bn=1,lr=(jr=Dt.D).Nb,nr=(yr=Hh[Dt.L])*Dt.R,zr=yr/2*Dt.B,Fr=16*lr*Dt.R,ya=8*lr*Dt.B,ms=Dt.sa,na=Dt.ta-nr+Fr,pn=Dt.qa,xr=Dt.ra-zr+ya,Ts=Dt.Ha,sa=Dt.Ia-zr+ya,Zn=(Hr=jr.M)==0,Jn=Hr>=Dt.Va-1,Dt.Aa==2&&li(Dt,jr),jr.uc)for(Oa=(Cn=Dt).D.M,t(Cn.D.uc),jr=Cn.yb;jr<Cn.Hb;++jr){gs=jr,Pi=Oa;var aa=(Ra=(xs=Cn).D).Nb;mn=xs.R;var Ra=Ra.wa[Ra.Y+gs],Qa=xs.sa,wa=xs.ta+16*aa*mn+16*gs,Ma=Ra.dd,Vr=Ra.tc;if(Vr!=0)if(t(3<=Vr),xs.L==1)0<gs&&f_(Qa,wa,mn,Vr+4),Ra.La&&p_(Qa,wa,mn,Vr),0<Pi&&d_(Qa,wa,mn,Vr+4),Ra.La&&h_(Qa,wa,mn,Vr);else{var Ha=xs.B,Oi=xs.qa,Jc=xs.ra+8*aa*Ha+8*gs,Jo=xs.Ha,xs=xs.Ia+8*aa*Ha+8*gs;aa=Ra.ld,0<gs&&(Xn(Qa,wa,mn,Vr+4,Ma,aa),e0(Oi,Jc,Jo,xs,Ha,Vr+4,Ma,aa)),Ra.La&&(Ih(Qa,wa,mn,Vr,Ma,aa),u_(Oi,Jc,Jo,xs,Ha,Vr,Ma,aa)),0<Pi&&(_n(Qa,wa,mn,Vr+4,Ma,aa),Xo(Oi,Jc,Jo,xs,Ha,Vr+4,Ma,aa)),Ra.La&&(iu(Qa,wa,mn,Vr,Ma,aa),A_(Oi,Jc,Jo,xs,Ha,Vr,Ma,aa))}}if(Dt.ia&&alert("todo:DitherRow"),_t.put!=null){if(jr=16*Hr,Hr=16*(Hr+1),Zn?(_t.y=Dt.sa,_t.O=Dt.ta+Fr,_t.f=Dt.qa,_t.N=Dt.ra+ya,_t.ea=Dt.Ha,_t.W=Dt.Ia+ya):(jr-=yr,_t.y=ms,_t.O=na,_t.f=pn,_t.N=xr,_t.ea=Ts,_t.W=sa),Jn||(Hr-=yr),Hr>_t.o&&(Hr=_t.o),_t.F=null,_t.J=null,Dt.Fa!=null&&0<Dt.Fa.length&&jr<Hr&&(_t.J=qr(Dt,_t,jr,Hr-jr),_t.F=Dt.mb,_t.F==null&&_t.F.length==0)){Bn=Pn(Dt,3,"Could not decode alpha data.");break t}jr<_t.j&&(yr=_t.j-jr,jr=_t.j,t(!(1&yr)),_t.O+=Dt.R*yr,_t.N+=Dt.B*(yr>>1),_t.W+=Dt.B*(yr>>1),_t.F!=null&&(_t.J+=_t.width*yr)),jr<Hr&&(_t.O+=_t.v,_t.N+=_t.v>>1,_t.W+=_t.v>>1,_t.F!=null&&(_t.J+=_t.v),_t.ka=jr-_t.j,_t.U=_t.va-_t.v,_t.T=Hr-jr,Bn=_t.put(_t))}lr+1!=Dt.Ic||Jn||(n(Dt.sa,Dt.ta-nr,ms,na+16*Dt.R,nr),n(Dt.qa,Dt.ra-zr,pn,xr+8*Dt.B,zr),n(Dt.Ha,Dt.Ia-zr,Ts,sa+8*Dt.B,zr))}if(!Bn)return Pn(gr,6,"Output aborted.")}return 1}(xe,je)),je.bc!=null&&je.bc(je),Pe&=1}return Pe?(xe.cb=0,Pe):0})(w,O)||(_=w.a)}}else _=w.a}_==0&&ne.Oa!=null&&ne.Oa.fd&&(_=$d(ne.ba))}ne=_}te=ne!=0?null:11>te?le.f.RGBA.eb:le.f.kb.y}else te=null;return te};var L_=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function A(N,Q){for(var L="",T=0;T<4;T++)L+=String.fromCharCode(N[Q++]);return L}function u(N,Q){return N[Q+0]|N[Q+1]<<8}function f(N,Q){return(N[Q+0]|N[Q+1]<<8|N[Q+2]<<16)>>>0}function h(N,Q){return(N[Q+0]|N[Q+1]<<8|N[Q+2]<<16|N[Q+3]<<24)>>>0}new c;var d=[0],x=[0],g=[],y=new c,m=e,p=function(N,Q){var L={},T=0,P=!1,R=0,z=0;if(L.frames=[],!function(B,U){for(var F=0;F<4;F++)if(B[U+F]!="RIFF".charCodeAt(F))return!0;return!1}(N,Q)){for(h(N,Q+=4),Q+=8;Q<N.length;){var q=A(N,Q),M=h(N,Q+=4);Q+=4;var V=M+(1&M);switch(q){case"VP8 ":case"VP8L":L.frames[T]===void 0&&(L.frames[T]={}),(ce=L.frames[T]).src_off=P?z:Q-8,ce.src_size=R+M+8,T++,P&&(P=!1,R=0,z=0);break;case"VP8X":(ce=L.header={}).feature_flags=N[Q];var H=Q+4;ce.canvas_width=1+f(N,H),H+=3,ce.canvas_height=1+f(N,H),H+=3;break;case"ALPH":P=!0,R=V+8,z=Q-8;break;case"ANIM":(ce=L.header).bgcolor=h(N,Q),H=Q+4,ce.loop_count=u(N,H),H+=2;break;case"ANMF":var se,ce;(ce=L.frames[T]={}).offset_x=2*f(N,Q),Q+=3,ce.offset_y=2*f(N,Q),Q+=3,ce.width=1+f(N,Q),Q+=3,ce.height=1+f(N,Q),Q+=3,ce.duration=f(N,Q),Q+=3,se=N[Q++],ce.dispose=1&se,ce.blend=se>>1&1}q!="ANMF"&&(Q+=V)}return L}}(m,0);p.response=m,p.rgbaoutput=!0,p.dataurl=!1;var b=p.header?p.header:null,v=p.frames?p.frames:null;if(b){b.loop_counter=b.loop_count,d=[b.canvas_height],x=[b.canvas_width];for(var C=0;C<v.length&&v[C].blend!=0;C++);}var k=v[0],S=y.WebPDecodeRGBA(m,k.src_off,k.src_size,x,d);k.rgba=S,k.imgwidth=x[0],k.imgheight=d[0];for(var I=0;I<x[0]*d[0]*4;I++)g[I]=S[I];return this.width=x,this.height=d,this.data=g,this}(function(e){var t,r,n,s,a,o,l,c,A,u=function(B){return B=B||{},this.isStrokeTransparent=B.isStrokeTransparent||!1,this.strokeOpacity=B.strokeOpacity||1,this.strokeStyle=B.strokeStyle||"#000000",this.fillStyle=B.fillStyle||"#000000",this.isFillTransparent=B.isFillTransparent||!1,this.fillOpacity=B.fillOpacity||1,this.font=B.font||"10px sans-serif",this.textBaseline=B.textBaseline||"alphabetic",this.textAlign=B.textAlign||"left",this.lineWidth=B.lineWidth||1,this.lineJoin=B.lineJoin||"miter",this.lineCap=B.lineCap||"butt",this.path=B.path||[],this.transform=B.transform!==void 0?B.transform.clone():new c,this.globalCompositeOperation=B.globalCompositeOperation||"normal",this.globalAlpha=B.globalAlpha||1,this.clip_path=B.clip_path||[],this.currentPoint=B.currentPoint||new o,this.miterLimit=B.miterLimit||10,this.lastPoint=B.lastPoint||new o,this.lineDashOffset=B.lineDashOffset||0,this.lineDash=B.lineDash||[],this.margin=B.margin||[0,0,0,0],this.prevPageLastElemOffset=B.prevPageLastElemOffset||0,this.ignoreClearRect=typeof B.ignoreClearRect!="boolean"||B.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,A=new u}]);var f=function(B){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var U=B;Object.defineProperty(this,"pdf",{get:function(){return U}});var F=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return F},set:function(ie){F=!!ie}});var D=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return D},set:function(ie){D=!!ie}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(ie){isNaN(ie)||(X=ie)}});var K=0;Object.defineProperty(this,"posY",{get:function(){return K},set:function(ie){isNaN(ie)||(K=ie)}}),Object.defineProperty(this,"margin",{get:function(){return A.margin},set:function(ie){var $e;typeof ie=="number"?$e=[ie,ie,ie,ie]:(($e=new Array(4))[0]=ie[0],$e[1]=ie.length>=2?ie[1]:$e[0],$e[2]=ie.length>=3?ie[2]:$e[0],$e[3]=ie.length>=4?ie[3]:$e[1]),A.margin=$e}});var ae=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ae},set:function(ie){ae=ie}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(ie){he=ie}});var Y=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Y},set:function(ie){Y=ie}}),Object.defineProperty(this,"ctx",{get:function(){return A},set:function(ie){ie instanceof u&&(A=ie)}}),Object.defineProperty(this,"path",{get:function(){return A.path},set:function(ie){A.path=ie}});var Be=[];Object.defineProperty(this,"ctxStack",{get:function(){return Be},set:function(ie){Be=ie}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ie){var $e;$e=h(ie),this.ctx.fillStyle=$e.style,this.ctx.isFillTransparent=$e.a===0,this.ctx.fillOpacity=$e.a,this.pdf.setFillColor($e.r,$e.g,$e.b,{a:$e.a}),this.pdf.setTextColor($e.r,$e.g,$e.b,{a:$e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ie){var $e=h(ie);this.ctx.strokeStyle=$e.style,this.ctx.isStrokeTransparent=$e.a===0,this.ctx.strokeOpacity=$e.a,$e.a===0?this.pdf.setDrawColor(255,255,255):($e.a,this.pdf.setDrawColor($e.r,$e.g,$e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ie){["butt","round","square"].indexOf(ie)!==-1&&(this.ctx.lineCap=ie,this.pdf.setLineCap(ie))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ie){isNaN(ie)||(this.ctx.lineWidth=ie,this.pdf.setLineWidth(ie))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ie){["bevel","round","miter"].indexOf(ie)!==-1&&(this.ctx.lineJoin=ie,this.pdf.setLineJoin(ie))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ie){isNaN(ie)||(this.ctx.miterLimit=ie,this.pdf.setMiterLimit(ie))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ie){this.ctx.textBaseline=ie}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ie){["right","end","center","left","start"].indexOf(ie)!==-1&&(this.ctx.textAlign=ie)}});var ee=null,Te=null,Je=null;Object.defineProperty(this,"fontFaces",{get:function(){return Je},set:function(ie){ee=null,Te=null,Je=ie}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ie){var $e;if(this.ctx.font=ie,($e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ie))!==null){var ze=$e[1];$e[2];var Fe=$e[3],Re=$e[4];$e[5];var at=$e[6],we=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Re)[2];Re=Math.floor(we==="px"?parseFloat(Re)*this.pdf.internal.scaleFactor:we==="em"?parseFloat(Re)*this.pdf.getFontSize():parseFloat(Re)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Re);var ve=function(Ve){var Et,xt,st=[],pt=Ve.trim();if(pt==="")return kv;if(pt in eN)return[eN[pt]];for(;pt!=="";){switch(xt=null,Et=(pt=rN(pt)).charAt(0)){case'"':case"'":xt=JY(pt.substring(1),Et);break;default:xt=ZY(pt)}if(xt===null||(st.push(xt[0]),(pt=rN(xt[1]))!==""&&pt.charAt(0)!==","))return kv;pt=pt.replace(/^,/,"")}return st}(at);if(this.fontFaces){var Le=function(Ve,Et){var xt=Ve.getFontList(),st=JSON.stringify(xt);if(ee===null||Te!==st){var pt=function(It){var ut=[];return Object.keys(It).forEach(function(kt){It[kt].forEach(function(yt){var Ct=null;switch(yt){case"bold":Ct={family:kt,weight:"bold"};break;case"italic":Ct={family:kt,style:"italic"};break;case"bolditalic":Ct={family:kt,weight:"bold",style:"italic"};break;case"":case"normal":Ct={family:kt}}Ct!==null&&(Ct.ref={name:kt,style:yt},ut.push(Ct))})}),ut}(xt);ee=function(It){for(var ut={},kt=0;kt<It.length;++kt){var yt=Sv(It[kt]),Ct=yt.family,er=yt.stretch,Wt=yt.style,St=yt.weight;ut[Ct]=ut[Ct]||{},ut[Ct][er]=ut[Ct][er]||{},ut[Ct][er][Wt]=ut[Ct][er][Wt]||{},ut[Ct][er][Wt][St]=yt}return ut}(pt.concat(Et)),Te=st}return ee}(this.pdf,this.fontFaces),tt=ve.map(function(Ve){return{family:Ve,stretch:"normal",weight:Fe,style:ze}}),lt=function(Ve,Et,xt){for(var st=(xt=xt||{}).defaultFontFamily||"times",pt=Object.assign({},YY,xt.genericFontFamilies||{}),It=null,ut=null,kt=0;kt<Et.length;++kt)if(pt[(It=Sv(Et[kt])).family]&&(It.family=pt[It.family]),Ve.hasOwnProperty(It.family)){ut=Ve[It.family];break}if(!(ut=ut||Ve[st]))throw new Error("Could not find a font-family for the rule '"+tN(It)+"' and default family '"+st+"'.");if(ut=function(yt,Ct){if(Ct[yt])return Ct[yt];var er=Uw[yt],Wt=er<=Uw.normal?-1:1,St=ZC(Ct,aT,er,Wt);if(!St)throw new Error("Could not find a matching font-stretch value for "+yt);return St}(It.stretch,ut),ut=function(yt,Ct){if(Ct[yt])return Ct[yt];for(var er=sT[yt],Wt=0;Wt<er.length;++Wt)if(Ct[er[Wt]])return Ct[er[Wt]];throw new Error("Could not find a matching font-style for "+yt)}(It.style,ut),!(ut=function(yt,Ct){if(Ct[yt])return Ct[yt];if(yt===400&&Ct[500])return Ct[500];if(yt===500&&Ct[400])return Ct[400];var er=XY[yt],Wt=ZC(Ct,iT,er,yt<400?-1:1);if(!Wt)throw new Error("Could not find a matching font-weight for value "+yt);return Wt}(It.weight,ut)))throw new Error("Failed to resolve a font for the rule '"+tN(It)+"'.");return ut}(Le,tt);this.pdf.setFont(lt.ref.name,lt.ref.style)}else{var it="";(Fe==="bold"||parseInt(Fe,10)>=700||ze==="bold")&&(it="bold"),ze==="italic"&&(it+="italic"),it.length===0&&(it="normal");for(var Ne="",ke={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},qe=0;qe<ve.length;qe++){if(this.pdf.internal.getFont(ve[qe],it,{noFallback:!0,disableWarning:!0})!==void 0){Ne=ve[qe];break}if(it==="bolditalic"&&this.pdf.internal.getFont(ve[qe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ne=ve[qe],it="bold";else if(this.pdf.internal.getFont(ve[qe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ne=ve[qe],it="normal";break}}if(Ne===""){for(var Me=0;Me<ve.length;Me++)if(ke[ve[Me]]){Ne=ke[ve[Me]];break}}Ne=Ne===""?"Times":Ne,this.pdf.setFont(Ne,it)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ie){this.ctx.globalCompositeOperation=ie}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ie){this.ctx.globalAlpha=ie}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ie){this.ctx.lineDashOffset=ie,ce.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ie){this.ctx.lineDash=ie,ce.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ie){this.ctx.ignoreClearRect=!!ie}})};f.prototype.setLineDash=function(B){this.lineDash=B},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){v.call(this,"fill",!1)},f.prototype.stroke=function(){v.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(B,U){if(isNaN(B)||isNaN(U))throw Kr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var F=this.ctx.transform.applyToPoint(new o(B,U));this.path.push({type:"mt",x:F.x,y:F.y}),this.ctx.lastPoint=new o(B,U)},f.prototype.closePath=function(){var B=new o(0,0),U=0;for(U=this.path.length-1;U!==-1;U--)if(this.path[U].type==="begin"&&Lr(this.path[U+1])==="object"&&typeof this.path[U+1].x=="number"){B=new o(this.path[U+1].x,this.path[U+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(B.x,B.y)},f.prototype.lineTo=function(B,U){if(isNaN(B)||isNaN(U))throw Kr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var F=this.ctx.transform.applyToPoint(new o(B,U));this.path.push({type:"lt",x:F.x,y:F.y}),this.ctx.lastPoint=new o(F.x,F.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),v.call(this,null,!0)},f.prototype.quadraticCurveTo=function(B,U,F,D){if(isNaN(F)||isNaN(D)||isNaN(B)||isNaN(U))throw Kr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new o(F,D)),K=this.ctx.transform.applyToPoint(new o(B,U));this.path.push({type:"qct",x1:K.x,y1:K.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},f.prototype.bezierCurveTo=function(B,U,F,D,X,K){if(isNaN(X)||isNaN(K)||isNaN(B)||isNaN(U)||isNaN(F)||isNaN(D))throw Kr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ae=this.ctx.transform.applyToPoint(new o(X,K)),he=this.ctx.transform.applyToPoint(new o(B,U)),Y=this.ctx.transform.applyToPoint(new o(F,D));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:Y.x,y2:Y.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new o(ae.x,ae.y)},f.prototype.arc=function(B,U,F,D,X,K){if(isNaN(B)||isNaN(U)||isNaN(F)||isNaN(D)||isNaN(X))throw Kr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(K=!!K,!this.ctx.transform.isIdentity){var ae=this.ctx.transform.applyToPoint(new o(B,U));B=ae.x,U=ae.y;var he=this.ctx.transform.applyToPoint(new o(0,F)),Y=this.ctx.transform.applyToPoint(new o(0,0));F=Math.sqrt(Math.pow(he.x-Y.x,2)+Math.pow(he.y-Y.y,2))}Math.abs(X-D)>=2*Math.PI&&(D=0,X=2*Math.PI),this.path.push({type:"arc",x:B,y:U,radius:F,startAngle:D,endAngle:X,counterclockwise:K})},f.prototype.arcTo=function(B,U,F,D,X){throw new Error("arcTo not implemented.")},f.prototype.rect=function(B,U,F,D){if(isNaN(B)||isNaN(U)||isNaN(F)||isNaN(D))throw Kr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(B,U),this.lineTo(B+F,U),this.lineTo(B+F,U+D),this.lineTo(B,U+D),this.lineTo(B,U),this.lineTo(B+F,U),this.lineTo(B,U)},f.prototype.fillRect=function(B,U,F,D){if(isNaN(B)||isNaN(U)||isNaN(F)||isNaN(D))throw Kr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(B,U,F,D),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},f.prototype.strokeRect=function(B,U,F,D){if(isNaN(B)||isNaN(U)||isNaN(F)||isNaN(D))throw Kr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(B,U,F,D),this.stroke())},f.prototype.clearRect=function(B,U,F,D){if(isNaN(B)||isNaN(U)||isNaN(F)||isNaN(D))throw Kr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(B,U,F,D))},f.prototype.save=function(B){B=typeof B!="boolean"||B;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("q");if(this.pdf.setPage(U),B){this.ctx.fontSize=this.pdf.internal.getFontSize();var D=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=D}},f.prototype.restore=function(B){B=typeof B!="boolean"||B;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("Q");this.pdf.setPage(U),B&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(B){var U,F,D,X;if(B.isCanvasGradient===!0&&(B=B.getColor()),!B)return{r:0,g:0,b:0,a:0,style:B};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(B))U=0,F=0,D=0,X=0;else{var K=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(B);if(K!==null)U=parseInt(K[1]),F=parseInt(K[2]),D=parseInt(K[3]),X=1;else if((K=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(B))!==null)U=parseInt(K[1]),F=parseInt(K[2]),D=parseInt(K[3]),X=parseFloat(K[4]);else{if(X=1,typeof B=="string"&&B.charAt(0)!=="#"){var ae=new Y6(B);B=ae.ok?ae.toHex():"#000000"}B.length===4?(U=B.substring(1,2),U+=U,F=B.substring(2,3),F+=F,D=B.substring(3,4),D+=D):(U=B.substring(1,3),F=B.substring(3,5),D=B.substring(5,7)),U=parseInt(U,16),F=parseInt(F,16),D=parseInt(D,16)}}return{r:U,g:F,b:D,a:X,style:B}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(B,U,F,D){if(isNaN(U)||isNaN(F)||typeof B!="string")throw Kr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(D=isNaN(D)?void 0:D,!d.call(this)){var X=V(this.ctx.transform.rotation),K=this.ctx.transform.scaleX;T.call(this,{text:B,x:U,y:F,scale:K,angle:X,align:this.textAlign,maxWidth:D})}},f.prototype.strokeText=function(B,U,F,D){if(isNaN(U)||isNaN(F)||typeof B!="string")throw Kr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){D=isNaN(D)?void 0:D;var X=V(this.ctx.transform.rotation),K=this.ctx.transform.scaleX;T.call(this,{text:B,x:U,y:F,scale:K,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:D})}},f.prototype.measureText=function(B){if(typeof B!="string")throw Kr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var U=this.pdf,F=this.pdf.internal.scaleFactor,D=U.internal.getFontSize(),X=U.getStringUnitWidth(B)*D/U.internal.scaleFactor;return new function(K){var ae=(K=K||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ae}}),this}({width:X*=Math.round(96*F/72*1e4)/1e4})},f.prototype.scale=function(B,U){if(isNaN(B)||isNaN(U))throw Kr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var F=new c(B,0,0,U,0,0);this.ctx.transform=this.ctx.transform.multiply(F)},f.prototype.rotate=function(B){if(isNaN(B))throw Kr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var U=new c(Math.cos(B),Math.sin(B),-Math.sin(B),Math.cos(B),0,0);this.ctx.transform=this.ctx.transform.multiply(U)},f.prototype.translate=function(B,U){if(isNaN(B)||isNaN(U))throw Kr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var F=new c(1,0,0,1,B,U);this.ctx.transform=this.ctx.transform.multiply(F)},f.prototype.transform=function(B,U,F,D,X,K){if(isNaN(B)||isNaN(U)||isNaN(F)||isNaN(D)||isNaN(X)||isNaN(K))throw Kr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ae=new c(B,U,F,D,X,K);this.ctx.transform=this.ctx.transform.multiply(ae)},f.prototype.setTransform=function(B,U,F,D,X,K){B=isNaN(B)?1:B,U=isNaN(U)?0:U,F=isNaN(F)?0:F,D=isNaN(D)?1:D,X=isNaN(X)?0:X,K=isNaN(K)?0:K,this.ctx.transform=new c(B,U,F,D,X,K)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(B,U,F,D,X,K,ae,he,Y){var Be=this.pdf.getImageProperties(B),ee=1,Te=1,Je=1,ie=1;D!==void 0&&he!==void 0&&(Je=he/D,ie=Y/X,ee=Be.width/D*he/D,Te=Be.height/X*Y/X),K===void 0&&(K=U,ae=F,U=0,F=0),D!==void 0&&he===void 0&&(he=D,Y=X),D===void 0&&he===void 0&&(he=Be.width,Y=Be.height);var $e=this.ctx.transform.decompose(),ze=V($e.rotate.shx),Fe=new c,Re=(Fe=(Fe=(Fe=Fe.multiply($e.translate)).multiply($e.skew)).multiply($e.scale)).applyToRectangle(new l(K-U*Je,ae-F*ie,D*ee,X*Te));if(this.autoPaging){for(var at,we=y.call(this,Re),ve=[],Le=0;Le<we.length;Le+=1)ve.indexOf(we[Le])===-1&&ve.push(we[Le]);b(ve);for(var tt=ve[0],lt=ve[ve.length-1],it=tt;it<lt+1;it++){this.pdf.setPage(it);var Ne=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ke=it===1?this.posY+this.margin[0]:this.margin[0],qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Me=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ve=it===1?0:qe+(it-2)*Me;if(this.ctx.clip_path.length!==0){var Et=this.path;at=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=p(at,this.posX+this.margin[3],-Ve+ke+this.ctx.prevPageLastElemOffset),C.call(this,"fill",!0),this.path=Et}var xt=JSON.parse(JSON.stringify(Re));xt=p([xt],this.posX+this.margin[3],-Ve+ke+this.ctx.prevPageLastElemOffset)[0];var st=(it>tt||it<lt)&&g.call(this);st&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ne,Me,null).clip().discardPath()),this.pdf.addImage(B,"JPEG",xt.x,xt.y,xt.w,xt.h,null,null,ze),st&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(B,"JPEG",Re.x,Re.y,Re.w,Re.h,null,null,ze)};var y=function(B,U,F){var D=[];U=U||this.pdf.internal.pageSize.width,F=F||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(B.type){default:case"mt":case"lt":D.push(Math.floor((B.y+X)/F)+1);break;case"arc":D.push(Math.floor((B.y+X-B.radius)/F)+1),D.push(Math.floor((B.y+X+B.radius)/F)+1);break;case"qct":var K=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,B.x1,B.y1,B.x,B.y);D.push(Math.floor((K.y+X)/F)+1),D.push(Math.floor((K.y+K.h+X)/F)+1);break;case"bct":var ae=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,B.x1,B.y1,B.x2,B.y2,B.x,B.y);D.push(Math.floor((ae.y+X)/F)+1),D.push(Math.floor((ae.y+ae.h+X)/F)+1);break;case"rect":D.push(Math.floor((B.y+X)/F)+1),D.push(Math.floor((B.y+B.h+X)/F)+1)}for(var he=0;he<D.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<D[he];)m.call(this);return D},m=function(){var B=this.fillStyle,U=this.strokeStyle,F=this.font,D=this.lineCap,X=this.lineWidth,K=this.lineJoin;this.pdf.addPage(),this.fillStyle=B,this.strokeStyle=U,this.font=F,this.lineCap=D,this.lineWidth=X,this.lineJoin=K},p=function(B,U,F){for(var D=0;D<B.length;D++)switch(B[D].type){case"bct":B[D].x2+=U,B[D].y2+=F;case"qct":B[D].x1+=U,B[D].y1+=F;default:B[D].x+=U,B[D].y+=F}return B},b=function(B){return B.sort(function(U,F){return U-F})},v=function(B,U){var F=this.fillStyle,D=this.strokeStyle,X=this.lineCap,K=this.lineWidth,ae=Math.abs(K*this.ctx.transform.scaleX),he=this.lineJoin;if(this.autoPaging){for(var Y,Be,ee=JSON.parse(JSON.stringify(this.path)),Te=JSON.parse(JSON.stringify(this.path)),Je=[],ie=0;ie<Te.length;ie++)if(Te[ie].x!==void 0)for(var $e=y.call(this,Te[ie]),ze=0;ze<$e.length;ze+=1)Je.indexOf($e[ze])===-1&&Je.push($e[ze]);for(var Fe=0;Fe<Je.length;Fe++)for(;this.pdf.internal.getNumberOfPages()<Je[Fe];)m.call(this);b(Je);for(var Re=Je[0],at=Je[Je.length-1],we=Re;we<at+1;we++){this.pdf.setPage(we),this.fillStyle=F,this.strokeStyle=D,this.lineCap=X,this.lineWidth=ae,this.lineJoin=he;var ve=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Le=we===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],it=we===1?0:tt+(we-2)*lt;if(this.ctx.clip_path.length!==0){var Ne=this.path;Y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=p(Y,this.posX+this.margin[3],-it+Le+this.ctx.prevPageLastElemOffset),C.call(this,B,!0),this.path=Ne}if(Be=JSON.parse(JSON.stringify(ee)),this.path=p(Be,this.posX+this.margin[3],-it+Le+this.ctx.prevPageLastElemOffset),U===!1||we===0){var ke=(we>Re||we<at)&&g.call(this);ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ve,lt,null).clip().discardPath()),C.call(this,B,U),ke&&this.pdf.restoreGraphicsState()}this.lineWidth=K}this.path=ee}else this.lineWidth=ae,C.call(this,B,U),this.lineWidth=K},C=function(B,U){if((B!=="stroke"||U||!x.call(this))&&(B==="stroke"||U||!d.call(this))){for(var F,D,X=[],K=this.path,ae=0;ae<K.length;ae++){var he=K[ae];switch(he.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:he,deltas:[],abs:[]});break;case"lt":var Y=X.length;if(K[ae-1]&&!isNaN(K[ae-1].x)&&(F=[he.x-K[ae-1].x,he.y-K[ae-1].y],Y>0)){for(;Y>=0;Y--)if(X[Y-1].close!==!0&&X[Y-1].begin!==!0){X[Y-1].deltas.push(F),X[Y-1].abs.push(he);break}}break;case"bct":F=[he.x1-K[ae-1].x,he.y1-K[ae-1].y,he.x2-K[ae-1].x,he.y2-K[ae-1].y,he.x-K[ae-1].x,he.y-K[ae-1].y],X[X.length-1].deltas.push(F);break;case"qct":var Be=K[ae-1].x+2/3*(he.x1-K[ae-1].x),ee=K[ae-1].y+2/3*(he.y1-K[ae-1].y),Te=he.x+2/3*(he.x1-he.x),Je=he.y+2/3*(he.y1-he.y),ie=he.x,$e=he.y;F=[Be-K[ae-1].x,ee-K[ae-1].y,Te-K[ae-1].x,Je-K[ae-1].y,ie-K[ae-1].x,$e-K[ae-1].y],X[X.length-1].deltas.push(F);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(he)}}D=U?null:B==="stroke"?"stroke":"fill";for(var ze=!1,Fe=0;Fe<X.length;Fe++)if(X[Fe].arc)for(var Re=X[Fe].abs,at=0;at<Re.length;at++){var we=Re[at];we.type==="arc"?I.call(this,we.x,we.y,we.radius,we.startAngle,we.endAngle,we.counterclockwise,void 0,U,!ze):P.call(this,we.x,we.y),ze=!0}else if(X[Fe].close===!0)this.pdf.internal.out("h"),ze=!1;else if(X[Fe].begin!==!0){var ve=X[Fe].start.x,Le=X[Fe].start.y;R.call(this,X[Fe].deltas,ve,Le),ze=!0}D&&N.call(this,D),U&&Q.call(this)}},k=function(B){var U=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,F=U*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return B-F;case"top":return B+U-F;case"hanging":return B+U-2*F;case"middle":return B+U/2-F;default:return B}},S=function(B){return B+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var B=function(){};return B.colorStops=[],B.addColorStop=function(U,F){this.colorStops.push([U,F])},B.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},B.isCanvasGradient=!0,B},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(B,U,F,D,X,K,ae,he,Y){for(var Be=q.call(this,F,D,X,K),ee=0;ee<Be.length;ee++){var Te=Be[ee];ee===0&&(Y?L.call(this,Te.x1+B,Te.y1+U):P.call(this,Te.x1+B,Te.y1+U)),z.call(this,B,U,Te.x2,Te.y2,Te.x3,Te.y3,Te.x4,Te.y4)}he?Q.call(this):N.call(this,ae)},N=function(B){switch(B){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Q=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(B,U){this.pdf.internal.out(r(B)+" "+n(U)+" m")},T=function(B){var U;switch(B.align){case"right":case"end":U="right";break;case"center":U="center";break;default:U="left"}var F,D,X,K=this.pdf.getTextDimensions(B.text),ae=k.call(this,B.y),he=S.call(this,ae)-K.h,Y=this.ctx.transform.applyToPoint(new o(B.x,ae));if(this.autoPaging){var Be=this.ctx.transform.decompose(),ee=new c;ee=(ee=(ee=ee.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale);for(var Te=this.ctx.transform.applyToRectangle(new l(B.x,ae,K.w,K.h)),Je=ee.applyToRectangle(new l(B.x,he,K.w,K.h)),ie=y.call(this,Je),$e=[],ze=0;ze<ie.length;ze+=1)$e.indexOf(ie[ze])===-1&&$e.push(ie[ze]);b($e);for(var Fe=$e[0],Re=$e[$e.length-1],at=Fe;at<Re+1;at++){this.pdf.setPage(at);var we=at===1?this.posY+this.margin[0]:this.margin[0],ve=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Le=this.pdf.internal.pageSize.height-this.margin[2],tt=Le-this.margin[0],lt=this.pdf.internal.pageSize.width-this.margin[1],it=lt-this.margin[3],Ne=at===1?0:ve+(at-2)*tt;if(this.ctx.clip_path.length!==0){var ke=this.path;F=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=p(F,this.posX+this.margin[3],-1*Ne+we),C.call(this,"fill",!0),this.path=ke}var qe=p([JSON.parse(JSON.stringify(Je))],this.posX+this.margin[3],-Ne+we+this.ctx.prevPageLastElemOffset)[0];B.scale>=.01&&(D=this.pdf.internal.getFontSize(),this.pdf.setFontSize(D*B.scale),X=this.lineWidth,this.lineWidth=X*B.scale);var Me=this.autoPaging!=="text";if(Me||qe.y+qe.h<=Le){if(Me||qe.y>=we&&qe.x<=lt){var Ve=Me?B.text:this.pdf.splitTextToSize(B.text,B.maxWidth||lt-qe.x)[0],Et=p([JSON.parse(JSON.stringify(Te))],this.posX+this.margin[3],-Ne+we+this.ctx.prevPageLastElemOffset)[0],xt=Me&&(at>Fe||at<Re)&&g.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],it,tt,null).clip().discardPath()),this.pdf.text(Ve,Et.x,Et.y,{angle:B.angle,align:U,renderingMode:B.renderingMode}),xt&&this.pdf.restoreGraphicsState()}}else qe.y<Le&&(this.ctx.prevPageLastElemOffset+=Le-qe.y);B.scale>=.01&&(this.pdf.setFontSize(D),this.lineWidth=X)}}else B.scale>=.01&&(D=this.pdf.internal.getFontSize(),this.pdf.setFontSize(D*B.scale),X=this.lineWidth,this.lineWidth=X*B.scale),this.pdf.text(B.text,Y.x+this.posX,Y.y+this.posY,{angle:B.angle,align:U,renderingMode:B.renderingMode,maxWidth:B.maxWidth}),B.scale>=.01&&(this.pdf.setFontSize(D),this.lineWidth=X)},P=function(B,U,F,D){F=F||0,D=D||0,this.pdf.internal.out(r(B+F)+" "+n(U+D)+" l")},R=function(B,U,F){return this.pdf.lines(B,U,F,null,null)},z=function(B,U,F,D,X,K,ae,he){this.pdf.internal.out([t(s(F+B)),t(a(D+U)),t(s(X+B)),t(a(K+U)),t(s(ae+B)),t(a(he+U)),"c"].join(" "))},q=function(B,U,F,D){for(var X=2*Math.PI,K=Math.PI/2;U>F;)U-=X;var ae=Math.abs(F-U);ae<X&&D&&(ae=X-ae);for(var he=[],Y=D?-1:1,Be=U;ae>1e-5;){var ee=Be+Y*Math.min(ae,K);he.push(M.call(this,B,Be,ee)),ae-=Math.abs(ee-Be),Be=ee}return he},M=function(B,U,F){var D=(F-U)/2,X=B*Math.cos(D),K=B*Math.sin(D),ae=X,he=-K,Y=ae*ae+he*he,Be=Y+ae*X+he*K,ee=4/3*(Math.sqrt(2*Y*Be)-Be)/(ae*K-he*X),Te=ae-ee*he,Je=he+ee*ae,ie=Te,$e=-Je,ze=D+U,Fe=Math.cos(ze),Re=Math.sin(ze);return{x1:B*Math.cos(U),y1:B*Math.sin(U),x2:Te*Fe-Je*Re,y2:Te*Re+Je*Fe,x3:ie*Fe-$e*Re,y3:ie*Re+$e*Fe,x4:B*Math.cos(F),y4:B*Math.sin(F)}},V=function(B){return 180*B/Math.PI},H=function(B,U,F,D,X,K){var ae=B+.5*(F-B),he=U+.5*(D-U),Y=X+.5*(F-X),Be=K+.5*(D-K),ee=Math.min(B,X,ae,Y),Te=Math.max(B,X,ae,Y),Je=Math.min(U,K,he,Be),ie=Math.max(U,K,he,Be);return new l(ee,Je,Te-ee,ie-Je)},se=function(B,U,F,D,X,K,ae,he){var Y,Be,ee,Te,Je,ie,$e,ze,Fe,Re,at,we,ve,Le,tt=F-B,lt=D-U,it=X-F,Ne=K-D,ke=ae-X,qe=he-K;for(Be=0;Be<41;Be++)Fe=($e=(ee=B+(Y=Be/40)*tt)+Y*((Je=F+Y*it)-ee))+Y*(Je+Y*(X+Y*ke-Je)-$e),Re=(ze=(Te=U+Y*lt)+Y*((ie=D+Y*Ne)-Te))+Y*(ie+Y*(K+Y*qe-ie)-ze),Be==0?(at=Fe,we=Re,ve=Fe,Le=Re):(at=Math.min(at,Fe),we=Math.min(we,Re),ve=Math.max(ve,Fe),Le=Math.max(Le,Re));return new l(Math.round(at),Math.round(we),Math.round(ve-at),Math.round(Le-we))},ce=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var B,U,F=(B=this.ctx.lineDash,U=this.ctx.lineDashOffset,JSON.stringify({lineDash:B,lineDashOffset:U}));this.prevLineDash!==F&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=F)}}})(Qt.API),function(e){var t=function(o){var l,c,A,u,f,h,d,x,g,y;for(c=[],A=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>A;A+=4)(f=(o.charCodeAt(A)<<24)+(o.charCodeAt(A+1)<<16)+(o.charCodeAt(A+2)<<8)+o.charCodeAt(A+3))!==0?(h=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(x=f%85))/85)-(d=f%85))/85)%85,c.push(h+33,d+33,x+33,g+33,y+33)):c.push(122);return function(m,p){for(var b=p;b>0;b--)m.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,A,u,f,h=String,d="length",x=255,g="charCodeAt",y="slice",m="replace";for(o[y](-2),o=o[y](0,-2)[m](/\s/g,"")[m]("z","!!!!!"),A=[],u=0,f=(o+=l="uuuuu"[y](o[d]%5||5))[d];f>u;u+=5)c=52200625*(o[g](u)-33)+614125*(o[g](u+1)-33)+7225*(o[g](u+2)-33)+85*(o[g](u+3)-33)+(o[g](u+4)-33),A.push(x&c>>24,x&c>>16,x&c>>8,x&c);return function(p,b){for(var v=b;v>0;v--)p.pop()}(A,l[d]),h.fromCharCode.apply(h,A)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",A=0;A<o.length;A+=2)c+=String.fromCharCode("0x"+(o[A]+o[A+1]));return c},a=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Sw(l)).reduce(function(A,u){return A+String.fromCharCode(u)},"")};e.processDataByFilters=function(o,l){var c=0,A=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":A=r(A),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=t(A),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=s(A),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=n(A),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=a(A),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:A,reverseChain:u.reverse().join(" ")}}}(Qt.API),function(e){e.loadFile=function(t,r,n){return function(s,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,A,u){var f=new XMLHttpRequest,h=0,d=function(x){var g=x.length,y=[],m=String.fromCharCode;for(h=0;h<g;h+=1)y.push(m(255&x.charCodeAt(h)));return y.join("")};if(f.open("GET",c,!A),f.overrideMimeType("text/plain; charset=x-user-defined"),A===!1&&(f.onload=function(){f.status===200?u(d(this.responseText)):u(void 0)}),f.send(null),A&&f.status===200)return d(f.responseText)}(s,a,o)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Qt.API),function(e){function t(){return(Jt.html2canvas?Promise.resolve(Jt.html2canvas):cv(()=>Promise.resolve().then(()=>Kne),void 0)).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Jt.DOMPurify?Promise.resolve(Jt.DOMPurify):cv(()=>Promise.resolve().then(()=>vz),void 0)).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Lr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var A=document.createElement(l);for(var u in c.className&&(A.className=c.className),c.innerHTML&&c.dompurify&&(A.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)A.style[u]=c.style[u];return A},a=function l(c,A){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)A!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,A));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var A=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),A);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(A){switch(n(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(A){return this.set({src:s("div",{innerHTML:l,dompurify:A})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,c(this.prop.container,A)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var A=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=u,u)for(var d=0;d<u.length;++d){var x=u[d],g=x.src.find(function(y){return y.format==="truetype"});g&&A.addFont(g.url,x.ref.name,x.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,A.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(A){if(A in o.template.prop)return function(){this.prop[A]=l[A]};switch(A){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[A]=l[A]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var A=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(A):A})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(A,u){return Math.floor(A*u/72*96)}return this.then(function(){(l=l||Qt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,A,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),A!=null&&(this.progress.n=A),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,A,u){return this.setProgress(l?this.progress.val+l:null,c||null,A?this.progress.n+A:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var A=this;return this.thenCore(l,c,function(u,f){return A.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return A.updateProgress(null,u),h}).then(u,f).then(function(h){return A.updateProgress(1),h})})},o.prototype.thenCore=function(l,c,A){A=A||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),h=A.call(f,l,c);return o.convert(h,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(A){c=c.thenCore(A)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Qt.getPageSize=function(l,c,A){if(Lr(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,A=u.format||A}c=c||"mm",A=A||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+A).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var x,g=0,y=0;if(d.hasOwnProperty(h))g=d[h][1]/f,y=d[h][0]/f;else try{g=A[1],y=A[0]}catch{throw new Error("Invalid format: "+A)}if(l==="p"||l==="portrait")l="p",y>g&&(x=y,y=g,g=x);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(x=y,y=g,g=x)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Sv):null;var A=new o(c);return c.worker?A:A.from(l).doCallback()}}(Qt.API),Qt.API.addJS=function(e){return sN=e,this.internal.events.subscribe("postPutResources",function(){Kp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Kp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),nN=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+sN+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Kp!==void 0&&nN!==void 0&&this.internal.out("/Names <</JavaScript "+Kp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var o=s[a],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var A=this.internal.pages.length,u=[];for(a=0;a<A;a++){var f=r.internal.newObject();u.push(f);var h=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<u.length;a++)r.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var o={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var A=0;A<n.children.length;A++)this.renderItems(n.children[A])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(Qt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,a,o,l){var c,A=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,d=256*f.charCodeAt(4)+f.charCodeAt(5),x=f.length,g={width:0,height:0,numcomponents:1},y=4;y<x;y+=2){if(y+=d,t.indexOf(f.charCodeAt(y+1))!==-1){h=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:h,numcomponents:f.charCodeAt(y+9)};break}d=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:A,index:n,alias:s}}return u}}(Qt.API),Qt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,a=DY(e,{checkCrc:!0}),o=a.width,l=a.height,c=a.channels,A=a.palette,u=a.depth;s=A&&c===1?function(I){for(var N=I.width,Q=I.height,L=I.data,T=I.palette,P=I.depth,R=!1,z=[],q=[],M=void 0,V=!1,H=0,se=0;se<T.length;se++){var ce=lC(T[se],4),B=ce[0],U=ce[1],F=ce[2],D=ce[3];z.push(B,U,F),D!=null&&(D===0?(H++,q.length<1&&q.push(se)):D<255&&(V=!0))}if(V||H>1){R=!0,q=void 0;var X=N*Q;M=new Uint8Array(X);for(var K=new DataView(L.buffer),ae=0;ae<X;ae++){var he=Ev(K,ae,P),Y=lC(T[he],4)[3];M[ae]=Y}}else H===0&&(q=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:R?8:void 0,colorBytes:L,alphaBytes:M,needSMask:R,palette:z,mask:q}}(a):c===2||c===4?function(I){for(var N=I.data,Q=I.width,L=I.height,T=I.channels,P=I.depth,R=T===2?"DeviceGray":"DeviceRGB",z=T-1,q=Q*L,M=z,V=q*M,H=1*q,se=Math.ceil(V*P/8),ce=Math.ceil(H*P/8),B=new Uint8Array(se),U=new Uint8Array(ce),F=new DataView(N.buffer),D=new DataView(B.buffer),X=new DataView(U.buffer),K=!1,ae=0;ae<q;ae++){for(var he=ae*T,Y=0;Y<M;Y++)fN(D,Ev(F,he+Y,P),ae*M+Y,P);var Be=Ev(F,he+M,P);Be<(1<<P)-1&&(K=!0),fN(X,Be,1*ae,P)}return{colorSpace:R,colorsPerPixel:z,sMaskBitsPerComponent:K?P:void 0,colorBytes:B,alphaBytes:U,needSMask:K}}(a):function(I){var N=I.data,Q=I.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Q,colorsPerPixel:Q==="DeviceGray"?1:3,colorBytes:N instanceof Uint16Array?function(L){for(var T=L.length,P=new Uint8Array(2*T),R=new DataView(P.buffer,P.byteOffset,P.byteLength),z=0;z<T;z++)R.setUint16(2*z,L[z],!1);return P}(N):N,needSMask:!1}}(a);var f,h,d,x=s,g=x.colorSpace,y=x.colorsPerPixel,m=x.sMaskBitsPerComponent,p=x.colorBytes,b=x.alphaBytes,v=x.needSMask,C=x.palette,k=x.mask,S=null;return n!==Qt.API.image_compression.NONE&&typeof Sw=="function"?(S=function(I){var N;switch(I){case Qt.API.image_compression.FAST:N=11;break;case Qt.API.image_compression.MEDIUM:N=13;break;case Qt.API.image_compression.SLOW:N=14;break;default:N=12}return N}(n),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(S," /Colors ").concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(o),e=lN(p,Math.ceil(o*y*u/8),y,u,n),v&&(d=lN(b,Math.ceil(o*m/8),1,m,n))):(f=void 0,h=void 0,e=p,v&&(d=b)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:k,palette:C,sMask:d,predictor:S,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:m,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,s){var a=new nJ(t),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var A={data:c,width:o,height:l},u=new Fv(100).encode(A,100);return e.processJPEG.call(this,u,r,n,s)},e.processGIF87A=e.processGIF89A}(Qt.API),Mi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Mi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Kr.log("bit decode error:"+r)}},Mi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Mi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=a>>4,c=15&a,A=this.palette[l];if(this.data[o]=A.blue,this.data[o+1]=A.green,this.data[o+2]=A.red,this.data[o+3]=255,2*s+1>=this.width)break;A=this.palette[c],this.data[o+4]=A.blue,this.data[o+4+1]=A.green,this.data[o+4+2]=A.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Mi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},Mi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,l=(a>>5&t)/t*255|0,c=(a>>10&t)/t*255|0,A=a>>15?255:0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=A}this.pos+=e}},Mi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,A=(o>>11)/t*255|0,u=s*this.width*4+4*a;this.data[u]=A,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},Mi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Mi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},Mi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var a=new Mi(t,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new Fv(100).encode(c,100);return e.processJPEG.call(this,A,r,n,s)}}(Qt.API),pN.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var a=new pN(t),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},A=new Fv(100).encode(c,100);return e.processJPEG.call(this,A,r,n,s)}}(Qt.API),Qt.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,a=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,A=0;A<s;A+=4){var u=n[A],f=n[A+1],h=n[A+2],d=n[A+3];a[l++]=u,a[l++]=f,a[l++]=h,o[c++]=d}var x=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Qt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},vu=Qt.API,qp=vu.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,A=t.kerning?t.kerning:s.metadata.Unicode.kerning,u=A.fof?A.fof:1,f=t.doKerning!==!1,h=0,d=e.length,x=0,g=l[0]||c,y=[];for(r=0;r<d;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?y.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(h=f&&Lr(A[n])==="object"&&!isNaN(parseInt(A[n][x],10))?A[n][x]/u:0,y.push((l[n]||g)/c+h)),x=n;return y},aN=vu.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return vu.processArabic&&(e=vu.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:qp.apply(this,arguments).reduce(function(a,o){return a+o},0)},iN=function(e,t,r,n){for(var s=[],a=0,o=e.length,l=0;a!==o&&l+t[a]<r;)l+=t[a],a++;s.push(e.slice(0,a));var c=a;for(l=0;a!==o;)l+t[a]>n&&(s.push(e.slice(c,a)),l=0,c=a),l+=t[a],a++;return c!==a&&s.push(e.slice(c,a)),s},oN=function(e,t,r){r||(r={});var n,s,a,o,l,c,A,u=[],f=[u],h=r.textIndent||0,d=0,x=0,g=e.split(" "),y=qp.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var m=Array(c).join(" "),p=[];g.map(function(v){(v=v.split(/\s*\n/)).length>1?p=p.concat(v.map(function(C,k){return(k&&C.length?`
`:"")+C})):p.push(v[0])}),g=p,c=aN.apply(this,[m,r])}for(a=0,o=g.length;a<o;a++){var b=0;if(n=g[a],c&&n[0]==`
`&&(n=n.substr(1),b=1),h+d+(x=(s=qp.apply(this,[n,r])).reduce(function(v,C){return v+C},0))>t||b){if(x>t){for(l=iN.apply(this,[n,s,t-(h+d),t]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);x=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(v,C){return v+C},0)}else u=[n];f.push(u),h=x+c,d=y}else u.push(n),h+=d+x,d=y}return A=c?function(v,C){return(C?m:"")+v.join(" ")}:function(v){return v.join(" ")},f.map(A)},vu.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var l,c,A=[];for(l=0,c=n.length;l<c;l++)A=A.concat(oN.apply(this,[n[l],o,a]));return A},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=t[a],s[t[a]]=r[a];var o=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var d,x,g,y,m=["{"];for(var p in h){if(d=h[p],isNaN(parseInt(p,10))?x="'"+p+"'":(p=parseInt(p,10),x=(x=o(p).slice(2)).slice(0,-1)+s[x.slice(-1)]),typeof d=="number")d<0?(g=o(d).slice(3),y="-"):(g=o(d).slice(2),y=""),g=y+g.slice(0,-1)+s[g.slice(-1)];else{if(Lr(d)!=="object")throw new Error("Don't know what to do with value type "+Lr(d)+".");g=l(d)}m.push(x+g)}return m.push("}"),m.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,x,g,y,m={},p=1,b=m,v=[],C="",k="",S=h.length-1,I=1;I<S;I+=1)(y=h[I])=="'"?d?(g=d.join(""),d=void 0):d=[]:d?d.push(y):y=="{"?(v.push([b,g]),b={},g=void 0):y=="}"?((x=v.pop())[0][x[1]]=b,g=void 0,b=x[0]):y=="-"?p=-1:g===void 0?n.hasOwnProperty(y)?(C+=n[y],g=parseInt(C,16)*p,p=1,C=""):C+=y:n.hasOwnProperty(y)?(k+=n[y],b[g]=parseInt(k,16)*p,p=1,g=void 0,k=""):k+=y;return m},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var d=h.font,x=f.Unicode[d.postScriptName];x&&(d.metadata.Unicode={},d.metadata.Unicode.widths=x.widths,d.metadata.Unicode.kerning=x.kerning);var g=u.Unicode[d.postScriptName];g&&(d.metadata.Unicode.encoding=g,d.encoding=g.codePages[0])}])}(Qt.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Em(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(Qt),Qt.API.addSvgAsImage=function(e,t,r,n,s,a,o,l){if(isNaN(t)||isNaN(r))throw Kr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Kr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var A=c.getContext("2d");A.fillStyle="#fff",A.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Jt.canvg?Promise.resolve(Jt.canvg):cv(()=>import("./index.es-U_5qEMEu.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(A,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,s,o,l)})},Qt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},Qt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],A=0,u=0,f=0;function h(x,g){var y,m=!1;for(y=0;y<x.length;y+=1)x[y]===g&&(m=!0);return m}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=l.length;for(f=0;f<d;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Lr(e)==="object"){for(s in e)if(a=e[s],h(l,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&h(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(A=0;A<a.length;A+=1)if(n=!0,a[A].length===1&&typeof a[A][0]=="number")c.push(String(a[A]-1));else if(a[A].length>1){for(u=0;u<a[A].length;u+=1)typeof a[A][u]!="number"&&(n=!1);n===!0&&c.push([a[A][0]-1,a[A][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,g=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?g.push("/"+x+" /"+r[x].value):g.push("/"+x+" "+r[x].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),A=a.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+A+" >>"),this.internal.write("stream"),this.internal.write(s+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Qt.API),function(e){var t=e.API,r=t.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,A=["","0","00","000","0000"],u=[""],f=0,h=a.length;f<h;++f){if(l=o.metadata.characterToGlyph(a.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(A[4-l.length],l)}return u.join("")},n=function(a){var o,l,c,A,u,f,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(a).sort(function(d,x){return d-x})).length;f<h;f++)o=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(A=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+A+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),d="",x=0;x<h.length;x++)d+=String.fromCharCode(h[x]);var g=A();u({data:d,addLength1:!0,objectId:g}),c("endobj");var y=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var m=A();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Fu(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var p=A();c("<<"),c("/Type /Font"),c("/BaseFont /"+Fu(l.fontName)),c("/FontDescriptor "+m+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=A(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+Fu(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+p+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,A=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",d=0;d<f.length;d++)h+=String.fromCharCode(f[d]);var x=A();u({data:h,addLength1:!0,objectId:x}),c("endobj");var g=A();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=A();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Fu(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=A();for(var m=0;m<l.metadata.hmtx.widths.length;m++)l.metadata.hmtx.widths[m]=parseInt(l.metadata.hmtx.widths[m]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Fu(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var s=function(a){var o,l=a.text||"",c=a.x,A=a.y,u=a.options||{},f=a.mutex||{},h=f.pdfEscape,d=f.activeFontKey,x=f.fonts,g=d,y="",m=0,p="",b=x[g].encoding;if(x[g].encoding!=="Identity-H")return{text:l,x:c,y:A,options:u,mutex:f};for(p=l,g=d,Array.isArray(l)&&(p=l[0]),m=0;m<p.length;m+=1)x[g].metadata.hasOwnProperty("cmap")&&(o=x[g].metadata.cmap.unicode.codeMap[p[m].charCodeAt(0)]),o||p[m].charCodeAt(0)<256&&x[g].metadata.hasOwnProperty("Unicode")?y+=p[m]:y+="";var v="";return parseInt(g.slice(1))<14||b==="WinAnsiEncoding"?v=h(y,g).split("").map(function(C){return C.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(v=r(y,x[g])),f.isHex=!0,{text:v,x:c,y:A,options:u,mutex:f}};t.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var A=0;for(A=0;A<o.length;A+=1)Array.isArray(o[A])&&o[A].length===3?l.push([s(Object.assign({},c,{text:o[A][0]})).text,o[A][1],o[A][2]]):l.push(s(Object.assign({},c,{text:o[A]})).text);a.text=l}else a.text=s(Object.assign({},c,{text:o})).text}])}(Qt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Qt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,a,o,l,c,A,u,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),p=!1,b=0;this.__bidiEngine__={};var v=function(L){var T=L.charCodeAt(),P=T>>8,R=g[P];return R!==void 0?f[256*R+(255&T)]:P===252||P===253?"AL":m.test(P)?"L":P===8?"R":"N"},C=function(L){for(var T,P=0;P<L.length;P++){if((T=v(L.charAt(P)))==="L")return!1;if(T==="R")return!0}return!1},k=function(L,T,P,R){var z,q,M,V,H=T[R];switch(H){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":p=!1;break;case"N":case"AN":break;case"EN":p&&(H="AN");break;case"AL":p=!0,H="R";break;case"WS":case"BN":H="N";break;case"CS":R<1||R+1>=T.length||(z=P[R-1])!=="EN"&&z!=="AN"||(q=T[R+1])!=="EN"&&q!=="AN"?H="N":p&&(q="AN"),H=q===z?q:"N";break;case"ES":H=(z=R>0?P[R-1]:"B")==="EN"&&R+1<T.length&&T[R+1]==="EN"?"EN":"N";break;case"ET":if(R>0&&P[R-1]==="EN"){H="EN";break}if(p){H="N";break}for(M=R+1,V=T.length;M<V&&T[M]==="ET";)M++;H=M<V&&T[M]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(V=T.length,M=R+1;M<V&&T[M]==="NSM";)M++;if(M<V){var se=L[R],ce=se>=1425&&se<=2303||se===64286;if(z=T[M],ce&&(z==="R"||z==="AL")){H="R";break}}}H=R<1||(z=T[R-1])==="B"?"N":P[R-1];break;case"B":p=!1,s=!0,H=b;break;case"S":a=!0,H="N"}return H},S=function(L,T,P){var R=L.split("");return P&&I(R,P,{hiLevel:b}),R.reverse(),T&&T.reverse(),R.join("")},I=function(L,T,P){var R,z,q,M,V,H=-1,se=L.length,ce=0,B=[],U=b?d:h,F=[];for(p=!1,s=!1,a=!1,z=0;z<se;z++)F[z]=v(L[z]);for(q=0;q<se;q++){if(V=ce,B[q]=k(L,F,B,q),R=240&(ce=U[V][x[B[q]]]),ce&=15,T[q]=M=U[ce][5],R>0)if(R===16){for(z=H;z<q;z++)T[z]=1;H=-1}else H=-1;if(U[ce][6])H===-1&&(H=q);else if(H>-1){for(z=H;z<q;z++)T[z]=M;H=-1}F[q]==="B"&&(T[q]=0),P.hiLevel|=M}a&&function(D,X,K){for(var ae=0;ae<K;ae++)if(D[ae]==="S"){X[ae]=b;for(var he=ae-1;he>=0&&D[he]==="WS";he--)X[he]=b}}(F,T,se)},N=function(L,T,P,R,z){if(!(z.hiLevel<L)){if(L===1&&b===1&&!s)return T.reverse(),void(P&&P.reverse());for(var q,M,V,H,se=T.length,ce=0;ce<se;){if(R[ce]>=L){for(V=ce+1;V<se&&R[V]>=L;)V++;for(H=ce,M=V-1;H<M;H++,M--)q=T[H],T[H]=T[M],T[M]=q,P&&(q=P[H],P[H]=P[M],P[M]=q);ce=V}ce++}}},Q=function(L,T,P){var R=L.split(""),z={hiLevel:b};return P||(P=[]),I(R,P,z),function(q,M,V){if(V.hiLevel!==0&&u)for(var H,se=0;se<q.length;se++)M[se]===1&&(H=y.indexOf(q[se]))>=0&&(q[se]=y[H+1])}(R,P,z),N(2,R,T,P,z),N(1,R,T,P,z),R.join("")};return this.__bidiEngine__.doBidiReorder=function(L,T,P){if(function(z,q){if(q)for(var M=0;M<z.length;M++)q[M]=M;l===void 0&&(l=C(z)),A===void 0&&(A=C(z))}(L,T),o||!c||A)if(o&&c&&l^A)b=l?1:0,L=S(L,T,P);else if(!o&&c&&A)b=l?1:0,L=Q(L,T,P),L=S(L,T);else if(!o||l||c||A){if(o&&!c&&l^A)L=S(L,T),l?(b=0,L=Q(L,T,P)):(b=1,L=Q(L,T,P),L=S(L,T));else if(o&&l&&!c&&A)b=1,L=Q(L,T,P),L=S(L,T);else if(!o&&!c&&l^A){var R=u;l?(b=1,L=Q(L,T,P),b=0,u=!1,L=Q(L,T,P),u=R):(b=0,L=Q(L,T,P),L=S(L,T),b=1,u=!1,L=Q(L,T,P),u=R,L=S(L,T))}}else b=0,L=Q(L,T,P);else b=l?1:0,L=Q(L,T,P);return L},this.__bidiEngine__.setOptions=function(L){L&&(o=L.isInputVisual,c=L.isOutputVisual,l=L.isInputRtl,A=L.isOutputRtl,u=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(Qt),Qt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Ec(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new xJ(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new sJ(this.contents),this.head=new iJ(this),this.name=new uJ(this),this.cmap=new lT(this),this.toUnicode={},this.hhea=new oJ(this),this.maxp=new dJ(this),this.hmtx=new fJ(this),this.post=new cJ(this),this.os2=new lJ(this),this.loca=new gJ(this),this.glyf=new hJ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,A;for(A=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],A.push(Math.round(t*this.scaleFactor));return A}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,a,o,l;for(o=0,a=0,l=(t=""+t).length;0<=l?a<l:a>l;a=0<=l?++a:--a)s=t.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var lo,Ec=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,a,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,a;for(a=[],n=0,s=t.length;n<s;n++)r=t[n],a.push(this.writeByte(r));return a},e}(),sJ=function(){var e;function t(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,a,o,l,c,A,u,f,h,d,x,g;for(g in d=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(d)/c),o=Math.floor(f/c),u=16*d-f,(s=new Ec).writeInt(this.scalarType),s.writeShort(d),s.writeShort(f),s.writeShort(o),s.writeShort(u),a=16*d,A=s.pos+a,l=null,x=[],r)for(h=r[g],s.writeString(g),s.writeInt(e(h)),s.writeInt(A),s.writeInt(h.length),x=x.concat(h),g==="head"&&(l=A),A+=h.length;A%4;)x.push(0),A++;return s.write(x),n=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(n),s.data},e=function(r){var n,s,a,o;for(r=cT.call(r);r.length%4;)r.push(0);for(a=new Ec(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=a.readUInt32();return 4294967295&s},t}(),aJ={}.hasOwnProperty,Do=function(e,t){for(var r in t)aJ.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};lo=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var iJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Ec).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),mN=function(){function e(t,r){var n,s,a,o,l,c,A,u,f,h,d,x,g,y,m,p,b;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(d=t.readUInt16(),h=d/2,t.pos+=6,a=function(){var v,C;for(C=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)C.push(t.readUInt16());return C}(),t.pos+=2,g=function(){var v,C;for(C=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)C.push(t.readUInt16());return C}(),A=function(){var v,C;for(C=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)C.push(t.readUInt16());return C}(),u=function(){var v,C;for(C=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)C.push(t.readUInt16());return C}(),s=(this.length-t.pos+this.offset)/2,l=function(){var v,C;for(C=[],c=v=0;0<=s?v<s:v>s;c=0<=s?++v:--v)C.push(t.readUInt16());return C}(),c=m=0,b=a.length;m<b;c=++m)for(y=a[c],n=p=x=g[c];x<=y?p<=y:p>=y;n=x<=y?++p:--p)u[c]===0?o=n+A[c]:(o=l[u[c]/2+(n-x)-(h-c)]||0)!==0&&(o+=A[c]),this.codeMap[n]=65535&o}t.pos=f}return e.encode=function(t,r){var n,s,a,o,l,c,A,u,f,h,d,x,g,y,m,p,b,v,C,k,S,I,N,Q,L,T,P,R,z,q,M,V,H,se,ce,B,U,F,D,X,K,ae,he,Y,Be,ee;switch(R=new Ec,o=Object.keys(t).sort(function(Te,Je){return Te-Je}),r){case"macroman":for(g=0,y=function(){var Te=[];for(x=0;x<256;++x)Te.push(0);return Te}(),p={0:0},a={},z=0,H=o.length;z<H;z++)p[he=t[s=o[z]]]==null&&(p[he]=++g),a[s]={old:t[s],new:p[t[s]]},y[s]=p[t[s]];return R.writeUInt16(1),R.writeUInt16(0),R.writeUInt32(12),R.writeUInt16(0),R.writeUInt16(262),R.writeUInt16(0),R.write(y),{charMap:a,subtable:R.data,maxGlyphID:g+1};case"unicode":for(T=[],f=[],b=0,p={},n={},m=A=null,q=0,se=o.length;q<se;q++)p[C=t[s=o[q]]]==null&&(p[C]=++b),n[s]={old:C,new:p[C]},l=p[C]-s,m!=null&&l===A||(m&&f.push(m),T.push(s),A=l),m=s;for(m&&f.push(m),f.push(65535),T.push(65535),Q=2*(N=T.length),I=2*Math.pow(Math.log(N)/Math.LN2,2),h=Math.log(I/2)/Math.LN2,S=2*N-I,c=[],k=[],d=[],x=M=0,ce=T.length;M<ce;x=++M){if(L=T[x],u=f[x],L===65535){c.push(0),k.push(0);break}if(L-(P=n[L].new)>=32768)for(c.push(0),k.push(2*(d.length+N-x)),s=V=L;L<=u?V<=u:V>=u;s=L<=u?++V:--V)d.push(n[s].new);else c.push(P-L),k.push(0)}for(R.writeUInt16(3),R.writeUInt16(1),R.writeUInt32(12),R.writeUInt16(4),R.writeUInt16(16+8*N+2*d.length),R.writeUInt16(0),R.writeUInt16(Q),R.writeUInt16(I),R.writeUInt16(h),R.writeUInt16(S),K=0,B=f.length;K<B;K++)s=f[K],R.writeUInt16(s);for(R.writeUInt16(0),ae=0,U=T.length;ae<U;ae++)s=T[ae],R.writeUInt16(s);for(Y=0,F=c.length;Y<F;Y++)l=c[Y],R.writeUInt16(l);for(Be=0,D=k.length;Be<D;Be++)v=k[Be],R.writeUInt16(v);for(ee=0,X=d.length;ee<X;ee++)g=d[ee],R.writeUInt16(g);return{charMap:n,subtable:R.data,maxGlyphID:b+1}}},e}(),lT=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new mN(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=mN.encode(t,r),(s=new Ec).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),oJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),lJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),cJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),AJ=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},uJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,a,o,l,c,A,u,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},a=u=0,f=n.length;u<f;a=++u)s=n[a],t.pos=s.offset,A=t.readString(s.length),o=new AJ(A,s),c[h=s.nameID]==null&&(c[h]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),dJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),fJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,a,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var A,u;for(u=[],r=A=0;0<=s?A<s:A>s;r=0<=s?++A:--A)u.push(t.readInt16());return u}(),this.widths=(function(){var A,u,f,h;for(h=[],A=0,u=(f=this.metrics).length;A<u;A++)a=f[A],h.push(a.advance);return h}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),cT=[].slice,hJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,a,o,l,c,A,u,f;return t in this.cache?this.cache[t]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(t),(s=a.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new Ec(r.read(s))).readShort(),A=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=o===-1?new mJ(l,A,f,c,u):new pJ(l,o,A,f,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,a,o,l,c;for(o=[],a=[],l=0,c=r.length;l<c;l++)s=t[r[l]],a.push(o.length),s&&(o=o.concat(s.encode(n)));return a.push(o.length),{table:o,offsets:a}},e}(),pJ=function(){function e(t,r,n,s,a,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),mJ=function(){function e(t,r,n,s,a){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Ec(cT.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),gJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Do(e,lo),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<n.length;++o)if(n[o]=s,a<r.length&&r[a]==o){++a,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var A=new Array(4*n.length),u=0;u<n.length;++u)A[4*u+3]=255&n[u],A[4*u+2]=(65280&n[u])>>8,A[4*u+1]=(16711680&n[u])>>16,A[4*u]=(4278190080&n[u])>>24;return A},e}(),xJ=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,a,o,l,c;for(s={},o=0,l=t.length;o<l;o++)s[a=t[o]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},e.prototype.encode=function(t,r){var n,s,a,o,l,c,A,u,f,h,d,x,g,y,m;for(s in n=lT.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),d={0:0},m=n.charMap)d[(c=m[s]).old]=c.new;for(x in h=n.maxGlyphID,o)x in d||(d[x]=h++);return u=function(p){var b,v;for(b in v={},p)v[p[b]]=b;return v}(d),f=Object.keys(u).sort(function(p,b){return p-b}),g=function(){var p,b,v;for(v=[],p=0,b=f.length;p<b;p++)l=f[p],v.push(u[l]);return v}(),a=this.font.glyf.encode(o,g,d),A=this.font.loca.encode(a.offsets,g),y={cmap:this.font.cmap.raw(),glyf:a.table,loca:A,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Qt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,a,o;if(Array.isArray(r))return"["+function(){var l,c,A;for(A=[],l=0,c=r.length;l<c;l++)n=r[l],A.push(t.convert(n));return A}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)o=r[s],a.push("/"+s+" "+t.convert(o));return a.push(">>"),a.join(`
`)}return""+r},t}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Lw=function(e,t){return Lw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Lw(e,t)};function co(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Lw(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Dw=function(){return Dw=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Dw.apply(this,arguments)};function oa(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(u){try{A(n.next(u))}catch(f){o(f)}}function c(u){try{A(n.throw(u))}catch(f){o(f)}}function A(u){u.done?a(u.value):s(u.value).then(l,c)}A((n=n.apply(e,[])).next())})}function Qs(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(A){return function(u){return c([A,u])}}function c(A){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(a=A[0]&2?s.return:A[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,A[1])).done)return a;switch(s=0,a&&(A=[A[0]&2,a.value]),A[0]){case 0:case 1:a=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,s=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!a||A[1]>a[0]&&A[1]<a[3])){r.label=A[1];break}if(A[0]===6&&r.label<a[1]){r.label=a[1],a=A;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(A);break}a[2]&&r.ops.pop(),r.trys.pop();continue}A=t.call(e,r)}catch(u){A=[6,u],s=0}finally{n=a=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Vp(e,t,r){if(arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||t)}var bl=function(){function e(t,r,n,s){this.left=t,this.top=r,this.width=n,this.height=s}return e.prototype.add=function(t,r,n,s){return new e(this.left+t,this.top+r,this.width+n,this.height+s)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(s){return s.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),gx=function(e,t){return bl.fromClientRect(e,t.getBoundingClientRect())},vJ=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),s=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new bl(0,0,n,s)},xx=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=e.charCodeAt(r++);(a&64512)===56320?t.push(((s&1023)<<10)+(a&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},kn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},gN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yJ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Gp=0;Gp<gN.length;Gp++)yJ[gN.charCodeAt(Gp)]=Gp;var xN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L0=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Wp=0;Wp<xN.length;Wp++)L0[xN.charCodeAt(Wp)]=Wp;var wJ=function(e){var t=e.length*.75,r=e.length,n,s=0,a,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=L0[e.charCodeAt(n)],o=L0[e.charCodeAt(n+1)],l=L0[e.charCodeAt(n+2)],c=L0[e.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},bJ=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},_J=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},CA=5,t_=11,jv=2,BJ=t_-CA,AT=65536>>CA,CJ=1<<CA,Tv=CJ-1,NJ=1024>>CA,SJ=AT+NJ,kJ=SJ,EJ=32,FJ=kJ+EJ,jJ=65536>>t_,TJ=1<<BJ,IJ=TJ-1,vN=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},UJ=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},LJ=function(e,t){var r=wJ(e),n=Array.isArray(r)?_J(r):new Uint32Array(r),s=Array.isArray(r)?bJ(r):new Uint16Array(r),a=24,o=vN(s,a/2,n[4]/2),l=n[5]===2?vN(s,(a+n[4])/2):UJ(n,Math.ceil((a+n[4])/4));return new DJ(n[0],n[1],n[2],n[3],o,l)},DJ=function(){function e(t,r,n,s,a,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>CA],r=(r<<jv)+(t&Tv),this.data[r];if(t<=65535)return r=this.index[AT+(t-55296>>CA)],r=(r<<jv)+(t&Tv),this.data[r];if(t<this.highStart)return r=FJ-jJ+(t>>t_),r=this.index[r],r+=t>>CA&IJ,r=this.index[r],r=(r<<jv)+(t&Tv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),yN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",PJ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var $p=0;$p<yN.length;$p++)PJ[yN.charCodeAt($p)]=$p;var OJ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",wN=50,RJ=1,uT=2,dT=3,QJ=4,MJ=5,bN=7,fT=8,_N=9,cc=10,Pw=11,BN=12,Ow=13,HJ=14,D0=15,Rw=16,zp=17,_0=18,KJ=19,CN=20,Qw=21,B0=22,Iv=23,yu=24,Va=25,P0=26,O0=27,wu=28,qJ=29,uA=30,VJ=31,Xp=32,Yp=33,Mw=34,Hw=35,Kw=36,Jf=37,qw=38,Um=39,Lm=40,Uv=41,hT=42,GJ=43,WJ=[9001,65288],pT="!",mr="",Jp="",Vw=LJ(OJ),rl=[uA,Kw],Gw=[RJ,uT,dT,MJ],mT=[cc,fT],NN=[O0,P0],$J=Gw.concat(mT),SN=[qw,Um,Lm,Mw,Hw],zJ=[D0,Ow],XJ=function(e,t){t===void 0&&(t="strict");var r=[],n=[],s=[];return e.forEach(function(a,o){var l=Vw.get(a);if(l>wN?(s.push(!0),l-=wN):s.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(a)!==-1)return n.push(o),r.push(Rw);if(l===QJ||l===Pw){if(o===0)return n.push(o),r.push(uA);var c=r[o-1];return $J.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(uA))}if(n.push(o),l===VJ)return r.push(t==="strict"?Qw:Jf);if(l===hT||l===qJ)return r.push(uA);if(l===GJ)return a>=131072&&a<=196605||a>=196608&&a<=262141?r.push(Jf):r.push(uA);r.push(l)}),[n,r,s]},Lv=function(e,t,r,n){var s=n[r];if(Array.isArray(e)?e.indexOf(s)!==-1:e===s)for(var a=r;a<=n.length;){a++;var o=n[a];if(o===t)return!0;if(o!==cc)break}if(s===cc)for(var a=r;a>0;){a--;var l=n[a];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===t)return!0;if(o!==cc)break}if(l!==cc)break}return!1},kN=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===cc)r--;else return n}return 0},YJ=function(e,t,r,n,s){if(r[n]===0)return mr;var a=n-1;if(Array.isArray(s)&&s[a]===!0)return mr;var o=a-1,l=a+1,c=t[a],A=o>=0?t[o]:0,u=t[l];if(c===uT&&u===dT)return mr;if(Gw.indexOf(c)!==-1)return pT;if(Gw.indexOf(u)!==-1||mT.indexOf(u)!==-1)return mr;if(kN(a,t)===fT)return Jp;if(Vw.get(e[a])===Pw||(c===Xp||c===Yp)&&Vw.get(e[l])===Pw||c===bN||u===bN||c===_N||[cc,Ow,D0].indexOf(c)===-1&&u===_N||[zp,_0,KJ,yu,wu].indexOf(u)!==-1||kN(a,t)===B0||Lv(Iv,B0,a,t)||Lv([zp,_0],Qw,a,t)||Lv(BN,BN,a,t))return mr;if(c===cc)return Jp;if(c===Iv||u===Iv)return mr;if(u===Rw||c===Rw)return Jp;if([Ow,D0,Qw].indexOf(u)!==-1||c===HJ||A===Kw&&zJ.indexOf(c)!==-1||c===wu&&u===Kw||u===CN||rl.indexOf(u)!==-1&&c===Va||rl.indexOf(c)!==-1&&u===Va||c===O0&&[Jf,Xp,Yp].indexOf(u)!==-1||[Jf,Xp,Yp].indexOf(c)!==-1&&u===P0||rl.indexOf(c)!==-1&&NN.indexOf(u)!==-1||NN.indexOf(c)!==-1&&rl.indexOf(u)!==-1||[O0,P0].indexOf(c)!==-1&&(u===Va||[B0,D0].indexOf(u)!==-1&&t[l+1]===Va)||[B0,D0].indexOf(c)!==-1&&u===Va||c===Va&&[Va,wu,yu].indexOf(u)!==-1)return mr;if([Va,wu,yu,zp,_0].indexOf(u)!==-1)for(var f=a;f>=0;){var h=t[f];if(h===Va)return mr;if([wu,yu].indexOf(h)!==-1)f--;else break}if([O0,P0].indexOf(u)!==-1)for(var f=[zp,_0].indexOf(c)!==-1?o:a;f>=0;){var h=t[f];if(h===Va)return mr;if([wu,yu].indexOf(h)!==-1)f--;else break}if(qw===c&&[qw,Um,Mw,Hw].indexOf(u)!==-1||[Um,Mw].indexOf(c)!==-1&&[Um,Lm].indexOf(u)!==-1||[Lm,Hw].indexOf(c)!==-1&&u===Lm||SN.indexOf(c)!==-1&&[CN,P0].indexOf(u)!==-1||SN.indexOf(u)!==-1&&c===O0||rl.indexOf(c)!==-1&&rl.indexOf(u)!==-1||c===yu&&rl.indexOf(u)!==-1||rl.concat(Va).indexOf(c)!==-1&&u===B0&&WJ.indexOf(e[l])===-1||rl.concat(Va).indexOf(u)!==-1&&c===_0)return mr;if(c===Uv&&u===Uv){for(var d=r[a],x=1;d>0&&(d--,t[d]===Uv);)x++;if(x%2!==0)return mr}return c===Xp&&u===Yp?mr:Jp},JJ=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=XJ(e,t.lineBreak),n=r[0],s=r[1],a=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(s=s.map(function(l){return[Va,uA,hT].indexOf(l)!==-1?Jf:l}));var o=t.wordBreak==="keep-all"?a.map(function(l,c){return l&&e[c]>=19968&&e[c]<=40959}):void 0;return[n,s,o]},ZJ=function(){function e(t,r,n,s){this.codePoints=t,this.required=r===pT,this.start=n,this.end=s}return e.prototype.slice=function(){return kn.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),eZ=function(e,t){var r=xx(e),n=JJ(r,t),s=n[0],a=n[1],o=n[2],l=r.length,c=0,A=0;return{next:function(){if(A>=l)return{done:!0,value:null};for(var u=mr;A<l&&(u=YJ(r,a,s,++A,o))===mr;);if(u!==mr||A===l){var f=new ZJ(r,u,c,A);return c=A,{value:f,done:!1}}return{done:!0,value:null}}}},tZ=1,rZ=2,xh=4,EN=8,Tg=10,FN=47,Af=92,nZ=9,sZ=32,Zp=34,C0=61,aZ=35,iZ=36,oZ=37,em=39,tm=40,N0=41,lZ=95,_a=45,cZ=33,AZ=60,uZ=62,dZ=64,fZ=91,hZ=93,pZ=61,mZ=123,rm=63,gZ=125,jN=124,xZ=126,vZ=128,TN=65533,Dv=42,gA=43,yZ=44,wZ=58,bZ=59,Zf=46,_Z=0,BZ=8,CZ=11,NZ=14,SZ=31,kZ=127,vo=-1,gT=48,xT=97,vT=101,EZ=102,FZ=117,jZ=122,yT=65,wT=69,bT=70,TZ=85,IZ=90,Ks=function(e){return e>=gT&&e<=57},UZ=function(e){return e>=55296&&e<=57343},bu=function(e){return Ks(e)||e>=yT&&e<=bT||e>=xT&&e<=EZ},LZ=function(e){return e>=xT&&e<=jZ},DZ=function(e){return e>=yT&&e<=IZ},PZ=function(e){return LZ(e)||DZ(e)},OZ=function(e){return e>=vZ},nm=function(e){return e===Tg||e===nZ||e===sZ},Ig=function(e){return PZ(e)||OZ(e)||e===lZ},IN=function(e){return Ig(e)||Ks(e)||e===_a},RZ=function(e){return e>=_Z&&e<=BZ||e===CZ||e>=NZ&&e<=SZ||e===kZ},Zl=function(e,t){return e!==Af?!1:t!==Tg},sm=function(e,t,r){return e===_a?Ig(t)||Zl(t,r):Ig(e)?!0:!!(e===Af&&Zl(e,t))},Pv=function(e,t,r){return e===gA||e===_a?Ks(t)?!0:t===Zf&&Ks(r):Ks(e===Zf?t:e)},QZ=function(e){var t=0,r=1;(e[t]===gA||e[t]===_a)&&(e[t]===_a&&(r=-1),t++);for(var n=[];Ks(e[t]);)n.push(e[t++]);var s=n.length?parseInt(kn.apply(void 0,n),10):0;e[t]===Zf&&t++;for(var a=[];Ks(e[t]);)a.push(e[t++]);var o=a.length,l=o?parseInt(kn.apply(void 0,a),10):0;(e[t]===wT||e[t]===vT)&&t++;var c=1;(e[t]===gA||e[t]===_a)&&(e[t]===_a&&(c=-1),t++);for(var A=[];Ks(e[t]);)A.push(e[t++]);var u=A.length?parseInt(kn.apply(void 0,A),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*u)},MZ={type:2},HZ={type:3},KZ={type:4},qZ={type:13},VZ={type:8},GZ={type:21},WZ={type:9},$Z={type:10},zZ={type:11},XZ={type:12},YZ={type:14},am={type:23},JZ={type:1},ZZ={type:25},eee={type:24},tee={type:26},ree={type:27},nee={type:28},see={type:29},aee={type:31},Ww={type:32},_T=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(xx(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Ww;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Zp:return this.consumeStringToken(Zp);case aZ:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(IN(r)||Zl(n,s)){var a=sm(r,n,s)?rZ:tZ,o=this.consumeName();return{type:5,value:o,flags:a}}break;case iZ:if(this.peekCodePoint(0)===C0)return this.consumeCodePoint(),qZ;break;case em:return this.consumeStringToken(em);case tm:return MZ;case N0:return HZ;case Dv:if(this.peekCodePoint(0)===C0)return this.consumeCodePoint(),YZ;break;case gA:if(Pv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case yZ:return KZ;case _a:var l=t,c=this.peekCodePoint(0),A=this.peekCodePoint(1);if(Pv(l,c,A))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(sm(l,c,A))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(c===_a&&A===uZ)return this.consumeCodePoint(),this.consumeCodePoint(),eee;break;case Zf:if(Pv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case FN:if(this.peekCodePoint(0)===Dv)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===Dv&&(u=this.consumeCodePoint(),u===FN))return this.consumeToken();if(u===vo)return this.consumeToken()}break;case wZ:return tee;case bZ:return ree;case AZ:if(this.peekCodePoint(0)===cZ&&this.peekCodePoint(1)===_a&&this.peekCodePoint(2)===_a)return this.consumeCodePoint(),this.consumeCodePoint(),ZZ;break;case dZ:var f=this.peekCodePoint(0),h=this.peekCodePoint(1),d=this.peekCodePoint(2);if(sm(f,h,d)){var o=this.consumeName();return{type:7,value:o}}break;case fZ:return nee;case Af:if(Zl(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case hZ:return see;case pZ:if(this.peekCodePoint(0)===C0)return this.consumeCodePoint(),VZ;break;case mZ:return zZ;case gZ:return XZ;case FZ:case TZ:var x=this.peekCodePoint(0),g=this.peekCodePoint(1);return x===gA&&(bu(g)||g===rm)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case jN:if(this.peekCodePoint(0)===C0)return this.consumeCodePoint(),WZ;if(this.peekCodePoint(0)===jN)return this.consumeCodePoint(),GZ;break;case xZ:if(this.peekCodePoint(0)===C0)return this.consumeCodePoint(),$Z;break;case vo:return Ww}return nm(t)?(this.consumeWhiteSpace(),aee):Ks(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Ig(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:kn(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();bu(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===rm&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(kn.apply(void 0,t.map(function(c){return c===rm?gT:c})),16),a=parseInt(kn.apply(void 0,t.map(function(c){return c===rm?bT:c})),16);return{type:30,start:s,end:a}}var o=parseInt(kn.apply(void 0,t),16);if(this.peekCodePoint(0)===_a&&bu(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];bu(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var a=parseInt(kn.apply(void 0,l),16);return{type:30,start:o,end:a}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===tm?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===tm?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===vo)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===em||r===Zp){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===vo||this.peekCodePoint(0)===N0)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),am)}for(;;){var s=this.consumeCodePoint();if(s===vo||s===N0)return{type:22,value:kn.apply(void 0,t)};if(nm(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===vo||this.peekCodePoint(0)===N0?(this.consumeCodePoint(),{type:22,value:kn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),am);if(s===Zp||s===em||s===tm||RZ(s))return this.consumeBadUrlRemnants(),am;if(s===Af)if(Zl(s,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),am;else t.push(s)}},e.prototype.consumeWhiteSpace=function(){for(;nm(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===N0||t===vo)return;Zl(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var s=Math.min(r,t);n+=kn.apply(void 0,this._value.splice(0,s)),t-=s}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var s=this._value[n];if(s===vo||s===void 0||s===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(s===Tg)return this._value.splice(0,n),JZ;if(s===Af){var a=this._value[n+1];a!==vo&&a!==void 0&&(a===Tg?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):Zl(s,a)&&(r+=this.consumeStringSlice(n),r+=kn(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=xh,n=this.peekCodePoint(0);for((n===gA||n===_a)&&t.push(this.consumeCodePoint());Ks(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===Zf&&Ks(s))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=EN;Ks(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var a=this.peekCodePoint(2);if((n===wT||n===vT)&&((s===gA||s===_a)&&Ks(a)||Ks(s)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=EN;Ks(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[QZ(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],s=this.peekCodePoint(0),a=this.peekCodePoint(1),o=this.peekCodePoint(2);if(sm(s,a,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return s===oZ?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(bu(t)){for(var r=kn(t);bu(this.peekCodePoint(0))&&r.length<6;)r+=kn(this.consumeCodePoint());nm(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||UZ(n)||n>1114111?TN:n}return t===vo?TN:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(IN(r))t+=kn(r);else if(Zl(r,this.peekCodePoint(0)))t+=kn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),BT=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new _T;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||oee(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Ww:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),vh=function(e){return e.type===15},Ld=function(e){return e.type===17},Or=function(e){return e.type===20},iee=function(e){return e.type===0},$w=function(e,t){return Or(e)&&e.value===t},CT=function(e){return e.type!==31},_d=function(e){return e.type!==31&&e.type!==4},Po=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},oee=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Fc=function(e){return e.type===17||e.type===15},qn=function(e){return e.type===16||Fc(e)},NT=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Cs={type:17,number:0,flags:xh},r_={type:16,number:50,flags:xh},Ac={type:16,number:100,flags:xh},R0=function(e,t,r){var n=e[0],s=e[1];return[Wr(n,t),Wr(typeof s<"u"?s:n,r)]},Wr=function(e,t){if(e.type===16)return e.number/100*t;if(vh(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},ST="deg",kT="grad",ET="rad",FT="turn",vx={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case ST:return Math.PI*t.number/180;case kT:return Math.PI/200*t.number;case ET:return t.number;case FT:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},jT=function(e){return e.type===15&&(e.unit===ST||e.unit===kT||e.unit===ET||e.unit===FT)},TT=function(e){var t=e.filter(Or).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Cs,Cs];case"to top":case"bottom":return Bi(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Cs,Ac];case"to right":case"left":return Bi(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Ac,Ac];case"to bottom":case"top":return Bi(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Ac,Cs];case"to left":case"right":return Bi(270)}return 0},Bi=function(e){return Math.PI*e/180},yc={name:"color",parse:function(e,t){if(t.type===18){var r=lee[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),s=t.value.substring(1,2),a=t.value.substring(2,3);return uc(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),s=t.value.substring(1,2),a=t.value.substring(2,3),o=t.value.substring(3,4);return uc(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),parseInt(o+o,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),s=t.value.substring(2,4),a=t.value.substring(4,6);return uc(parseInt(n,16),parseInt(s,16),parseInt(a,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),s=t.value.substring(2,4),a=t.value.substring(4,6),o=t.value.substring(6,8);return uc(parseInt(n,16),parseInt(s,16),parseInt(a,16),parseInt(o,16)/255)}}if(t.type===20){var l=ml[t.value.toUpperCase()];if(typeof l<"u")return l}return ml.TRANSPARENT}},wc=function(e){return(255&e)===0},os=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,s=255&e>>24;return t<255?"rgba("+s+","+n+","+r+","+t/255+")":"rgb("+s+","+n+","+r+")"},uc=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},UN=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},LN=function(e,t){var r=t.filter(_d);if(r.length===3){var n=r.map(UN),s=n[0],a=n[1],o=n[2];return uc(s,a,o,1)}if(r.length===4){var l=r.map(UN),s=l[0],a=l[1],o=l[2],c=l[3];return uc(s,a,o,c)}return 0};function Ov(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var DN=function(e,t){var r=t.filter(_d),n=r[0],s=r[1],a=r[2],o=r[3],l=(n.type===17?Bi(n.number):vx.parse(e,n))/(Math.PI*2),c=qn(s)?s.number/100:0,A=qn(a)?a.number/100:0,u=typeof o<"u"&&qn(o)?Wr(o,1):1;if(c===0)return uc(A*255,A*255,A*255,1);var f=A<=.5?A*(c+1):A+c-A*c,h=A*2-f,d=Ov(h,f,l+1/3),x=Ov(h,f,l),g=Ov(h,f,l-1/3);return uc(d*255,x*255,g*255,u)},lee={hsl:DN,hsla:DN,rgb:LN,rgba:LN},uf=function(e,t){return yc.parse(e,BT.create(t).parseComponentValue())},ml={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},cee={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Or(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Aee={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},yx=function(e,t){var r=yc.parse(e,t[0]),n=t[1];return n&&qn(n)?{color:r,stop:n}:{color:r,stop:null}},PN=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=Cs),n.stop===null&&(n.stop=Ac);for(var s=[],a=0,o=0;o<e.length;o++){var l=e[o].stop;if(l!==null){var c=Wr(l,t);c>a?s.push(c):s.push(a),a=c}else s.push(null)}for(var A=null,o=0;o<s.length;o++){var u=s[o];if(u===null)A===null&&(A=o);else if(A!==null){for(var f=o-A,h=s[A-1],d=(u-h)/(f+1),x=1;x<=f;x++)s[A+x-1]=d*x;A=null}}return e.map(function(g,y){var m=g.color;return{color:m,stop:Math.max(Math.min(1,s[y]/t),0)}})},uee=function(e,t,r){var n=t/2,s=r/2,a=Wr(e[0],t)-n,o=s-Wr(e[1],r);return(Math.atan2(o,a)+Math.PI*2)%(Math.PI*2)},dee=function(e,t,r){var n=typeof e=="number"?e:uee(e,t,r),s=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),a=t/2,o=r/2,l=s/2,c=Math.sin(n-Math.PI/2)*l,A=Math.cos(n-Math.PI/2)*l;return[s,a-A,a+A,o-c,o+c]},Ki=function(e,t){return Math.sqrt(e*e+t*t)},ON=function(e,t,r,n,s){var a=[[0,0],[0,t],[e,0],[e,t]];return a.reduce(function(o,l){var c=l[0],A=l[1],u=Ki(r-c,n-A);return(s?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:l,optimumDistance:u}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},fee=function(e,t,r,n,s){var a=0,o=0;switch(e.size){case 0:e.shape===0?a=o=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):e.shape===1&&(a=Math.min(Math.abs(t),Math.abs(t-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(e.shape===0)a=o=Math.min(Ki(t,r),Ki(t,r-s),Ki(t-n,r),Ki(t-n,r-s));else if(e.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(t),Math.abs(t-n)),c=ON(n,s,t,r,!0),A=c[0],u=c[1];a=Ki(A-t,(u-r)/l),o=l*a}break;case 1:e.shape===0?a=o=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):e.shape===1&&(a=Math.max(Math.abs(t),Math.abs(t-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(e.shape===0)a=o=Math.max(Ki(t,r),Ki(t,r-s),Ki(t-n,r),Ki(t-n,r-s));else if(e.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(t),Math.abs(t-n)),f=ON(n,s,t,r,!1),A=f[0],u=f[1];a=Ki(A-t,(u-r)/l),o=l*a}break}return Array.isArray(e.size)&&(a=Wr(e.size[0],n),o=e.size.length===2?Wr(e.size[1],s):a),[a,o]},hee=function(e,t){var r=Bi(180),n=[];return Po(t).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&o.value==="to"){r=TT(s);return}else if(jT(o)){r=vx.parse(e,o);return}}var l=yx(e,s);n.push(l)}),{angle:r,stops:n,type:1}},im=function(e,t){var r=Bi(180),n=[];return Po(t).forEach(function(s,a){if(a===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=TT(s);return}else if(jT(o)){r=(vx.parse(e,o)+Bi(270))%Bi(360);return}}var l=yx(e,s);n.push(l)}),{angle:r,stops:n,type:1}},pee=function(e,t){var r=Bi(180),n=[],s=1,a=0,o=3,l=[];return Po(t).forEach(function(c,A){var u=c[0];if(A===0){if(Or(u)&&u.value==="linear"){s=1;return}else if(Or(u)&&u.value==="radial"){s=2;return}}if(u.type===18){if(u.name==="from"){var f=yc.parse(e,u.values[0]);n.push({stop:Cs,color:f})}else if(u.name==="to"){var f=yc.parse(e,u.values[0]);n.push({stop:Ac,color:f})}else if(u.name==="color-stop"){var h=u.values.filter(_d);if(h.length===2){var f=yc.parse(e,h[1]),d=h[0];Ld(d)&&n.push({stop:{type:16,number:d.number*100,flags:d.flags},color:f})}}}}),s===1?{angle:(r+Bi(180))%Bi(360),stops:n,type:s}:{size:o,shape:a,stops:n,position:l,type:s}},IT="closest-side",UT="farthest-side",LT="closest-corner",DT="farthest-corner",PT="circle",OT="ellipse",RT="cover",QT="contain",mee=function(e,t){var r=0,n=3,s=[],a=[];return Po(t).forEach(function(o,l){var c=!0;if(l===0){var A=!1;c=o.reduce(function(f,h){if(A)if(Or(h))switch(h.value){case"center":return a.push(r_),f;case"top":case"left":return a.push(Cs),f;case"right":case"bottom":return a.push(Ac),f}else(qn(h)||Fc(h))&&a.push(h);else if(Or(h))switch(h.value){case PT:return r=0,!1;case OT:return r=1,!1;case"at":return A=!0,!1;case IT:return n=0,!1;case RT:case UT:return n=1,!1;case QT:case LT:return n=2,!1;case DT:return n=3,!1}else if(Fc(h)||qn(h))return Array.isArray(n)||(n=[]),n.push(h),!1;return f},c)}if(c){var u=yx(e,o);s.push(u)}}),{size:n,shape:r,stops:s,position:a,type:2}},om=function(e,t){var r=0,n=3,s=[],a=[];return Po(t).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(u,f){if(Or(f))switch(f.value){case"center":return a.push(r_),!1;case"top":case"left":return a.push(Cs),!1;case"right":case"bottom":return a.push(Ac),!1}else if(qn(f)||Fc(f))return a.push(f),!1;return u},c):l===1&&(c=o.reduce(function(u,f){if(Or(f))switch(f.value){case PT:return r=0,!1;case OT:return r=1,!1;case QT:case IT:return n=0,!1;case UT:return n=1,!1;case LT:return n=2,!1;case RT:case DT:return n=3,!1}else if(Fc(f)||qn(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return u},c)),c){var A=yx(e,o);s.push(A)}}),{size:n,shape:r,stops:s,position:a,type:2}},gee=function(e){return e.type===1},xee=function(e){return e.type===2},n_={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=MT[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function vee(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!MT[e.name])}var MT={"linear-gradient":hee,"-moz-linear-gradient":im,"-ms-linear-gradient":im,"-o-linear-gradient":im,"-webkit-linear-gradient":im,"radial-gradient":mee,"-moz-radial-gradient":om,"-ms-radial-gradient":om,"-o-radial-gradient":om,"-webkit-radial-gradient":om,"-webkit-gradient":pee},yee={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return _d(n)&&vee(n)}).map(function(n){return n_.parse(e,n)})}},wee={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Or(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},bee={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Po(t).map(function(r){return r.filter(qn)}).map(NT)}},_ee={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Po(t).map(function(r){return r.filter(Or).map(function(n){return n.value}).join(" ")}).map(Bee)}},Bee=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},ud;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(ud||(ud={}));var Cee={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Po(t).map(function(r){return r.filter(Nee)})}},Nee=function(e){return Or(e)||qn(e)},wx=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},See=wx("top"),kee=wx("right"),Eee=wx("bottom"),Fee=wx("left"),bx=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return NT(r.filter(qn))}}},jee=bx("top-left"),Tee=bx("top-right"),Iee=bx("bottom-right"),Uee=bx("bottom-left"),_x=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Lee=_x("top"),Dee=_x("right"),Pee=_x("bottom"),Oee=_x("left"),Bx=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return vh(r)?r.number:0}}},Ree=Bx("top"),Qee=Bx("right"),Mee=Bx("bottom"),Hee=Bx("left"),Kee={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},qee={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Vee={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Or).reduce(function(r,n){return r|Gee(n.value)},0)}},Gee=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Wee={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},$ee={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},Ug;(function(e){e.NORMAL="normal",e.STRICT="strict"})(Ug||(Ug={}));var zee={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return Ug.STRICT;case"normal":default:return Ug.NORMAL}}},Xee={name:"line-height",initialValue:"normal",prefix:!1,type:4},RN=function(e,t){return Or(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:qn(e)?Wr(e,t):t},Yee={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:n_.parse(e,t)}},Jee={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},zw={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Cx=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},Zee=Cx("top"),ete=Cx("right"),tte=Cx("bottom"),rte=Cx("left"),nte={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Or).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},ste={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Nx=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},ate=Nx("top"),ite=Nx("right"),ote=Nx("bottom"),lte=Nx("left"),cte={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Ate={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},ute={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&$w(t[0],"none")?[]:Po(t).map(function(r){for(var n={color:ml.TRANSPARENT,offsetX:Cs,offsetY:Cs,blur:Cs},s=0,a=0;a<r.length;a++){var o=r[a];Fc(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:n.blur=o,s++):n.color=yc.parse(e,o)}return n})}},dte={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},fte={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=mte[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},hte=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},pte=function(e){var t=e.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=t[0],n=t[1];t[2],t[3];var s=t[4],a=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],l=t[13];return t[14],t[15],t.length===16?[r,n,s,a,o,l]:null},mte={matrix:hte,matrix3d:pte},QN={type:16,number:50,flags:xh},gte=[QN,QN],xte={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(qn);return r.length!==2?gte:[r[0],r[1]]}},vte={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},df;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(df||(df={}));var yte={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return df.BREAK_ALL;case"keep-all":return df.KEEP_ALL;case"normal":default:return df.NORMAL}}},wte={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(Ld(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},HT={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},bte={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Ld(t)?t.number:1}},_te={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Bte={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Or).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},Cte={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},Nte={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Ste={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(Ld(t))return t.number;if(Or(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},kte={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Or).map(function(r){return r.value})}},Ete={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},rs=function(e,t){return(e&t)!==0},Fte={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},jte={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],s=t.filter(CT),a=0;a<s.length;a++){var o=s[a],l=s[a+1];if(o.type===20){var c=l&&Ld(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},Tte={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(CT),s=0;s<n.length;s++){var a=n[s],o=n[s+1];if(Or(a)&&a.value!=="none"){var l=o&&Ld(o)?o.number:0;r.push({counter:a.value,reset:l})}}return r}},Ite={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(vh).map(function(r){return HT.parse(e,r)})}},Ute={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],s=t.filter(iee);if(s.length%2!==0)return null;for(var a=0;a<s.length;a+=2){var o=s[a].value,l=s[a+1].value;n.push({open:o,close:l})}return n}},MN=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},Lte={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&$w(t[0],"none")?[]:Po(t).map(function(r){for(var n={color:255,offsetX:Cs,offsetY:Cs,blur:Cs,spread:Cs,inset:!1},s=0,a=0;a<r.length;a++){var o=r[a];$w(o,"inset")?n.inset=!0:Fc(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:s===2?n.blur=o:n.spread=o,s++):n.color=yc.parse(e,o)}return n})}},Dte={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(Or).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},Pte={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Ote={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return vh(t)?t.number:0}},Rte=function(){function e(t,r){var n,s;this.animationDuration=Nt(t,Ite,r.animationDuration),this.backgroundClip=Nt(t,cee,r.backgroundClip),this.backgroundColor=Nt(t,Aee,r.backgroundColor),this.backgroundImage=Nt(t,yee,r.backgroundImage),this.backgroundOrigin=Nt(t,wee,r.backgroundOrigin),this.backgroundPosition=Nt(t,bee,r.backgroundPosition),this.backgroundRepeat=Nt(t,_ee,r.backgroundRepeat),this.backgroundSize=Nt(t,Cee,r.backgroundSize),this.borderTopColor=Nt(t,See,r.borderTopColor),this.borderRightColor=Nt(t,kee,r.borderRightColor),this.borderBottomColor=Nt(t,Eee,r.borderBottomColor),this.borderLeftColor=Nt(t,Fee,r.borderLeftColor),this.borderTopLeftRadius=Nt(t,jee,r.borderTopLeftRadius),this.borderTopRightRadius=Nt(t,Tee,r.borderTopRightRadius),this.borderBottomRightRadius=Nt(t,Iee,r.borderBottomRightRadius),this.borderBottomLeftRadius=Nt(t,Uee,r.borderBottomLeftRadius),this.borderTopStyle=Nt(t,Lee,r.borderTopStyle),this.borderRightStyle=Nt(t,Dee,r.borderRightStyle),this.borderBottomStyle=Nt(t,Pee,r.borderBottomStyle),this.borderLeftStyle=Nt(t,Oee,r.borderLeftStyle),this.borderTopWidth=Nt(t,Ree,r.borderTopWidth),this.borderRightWidth=Nt(t,Qee,r.borderRightWidth),this.borderBottomWidth=Nt(t,Mee,r.borderBottomWidth),this.borderLeftWidth=Nt(t,Hee,r.borderLeftWidth),this.boxShadow=Nt(t,Lte,r.boxShadow),this.color=Nt(t,Kee,r.color),this.direction=Nt(t,qee,r.direction),this.display=Nt(t,Vee,r.display),this.float=Nt(t,Wee,r.cssFloat),this.fontFamily=Nt(t,Cte,r.fontFamily),this.fontSize=Nt(t,Nte,r.fontSize),this.fontStyle=Nt(t,Ete,r.fontStyle),this.fontVariant=Nt(t,kte,r.fontVariant),this.fontWeight=Nt(t,Ste,r.fontWeight),this.letterSpacing=Nt(t,$ee,r.letterSpacing),this.lineBreak=Nt(t,zee,r.lineBreak),this.lineHeight=Nt(t,Xee,r.lineHeight),this.listStyleImage=Nt(t,Yee,r.listStyleImage),this.listStylePosition=Nt(t,Jee,r.listStylePosition),this.listStyleType=Nt(t,zw,r.listStyleType),this.marginTop=Nt(t,Zee,r.marginTop),this.marginRight=Nt(t,ete,r.marginRight),this.marginBottom=Nt(t,tte,r.marginBottom),this.marginLeft=Nt(t,rte,r.marginLeft),this.opacity=Nt(t,bte,r.opacity);var a=Nt(t,nte,r.overflow);this.overflowX=a[0],this.overflowY=a[a.length>1?1:0],this.overflowWrap=Nt(t,ste,r.overflowWrap),this.paddingTop=Nt(t,ate,r.paddingTop),this.paddingRight=Nt(t,ite,r.paddingRight),this.paddingBottom=Nt(t,ote,r.paddingBottom),this.paddingLeft=Nt(t,lte,r.paddingLeft),this.paintOrder=Nt(t,Dte,r.paintOrder),this.position=Nt(t,Ate,r.position),this.textAlign=Nt(t,cte,r.textAlign),this.textDecorationColor=Nt(t,_te,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=Nt(t,Bte,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=Nt(t,ute,r.textShadow),this.textTransform=Nt(t,dte,r.textTransform),this.transform=Nt(t,fte,r.transform),this.transformOrigin=Nt(t,xte,r.transformOrigin),this.visibility=Nt(t,vte,r.visibility),this.webkitTextStrokeColor=Nt(t,Pte,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Nt(t,Ote,r.webkitTextStrokeWidth),this.wordBreak=Nt(t,yte,r.wordBreak),this.zIndex=Nt(t,wte,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return wc(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return rs(this.display,4)||rs(this.display,33554432)||rs(this.display,268435456)||rs(this.display,536870912)||rs(this.display,67108864)||rs(this.display,134217728)},e}(),Qte=function(){function e(t,r){this.content=Nt(t,Fte,r.content),this.quotes=Nt(t,Ute,r.quotes)}return e}(),HN=function(){function e(t,r){this.counterIncrement=Nt(t,jte,r.counterIncrement),this.counterReset=Nt(t,Tte,r.counterReset)}return e}(),Nt=function(e,t,r){var n=new _T,s=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(s);var a=new BT(n.read());switch(t.type){case 2:var o=a.parseComponentValue();return t.parse(e,Or(o)?o.value:t.initialValue);case 0:return t.parse(e,a.parseComponentValue());case 1:return t.parse(e,a.parseComponentValues());case 4:return a.parseComponentValue();case 3:switch(t.format){case"angle":return vx.parse(e,a.parseComponentValue());case"color":return yc.parse(e,a.parseComponentValue());case"image":return n_.parse(e,a.parseComponentValue());case"length":var l=a.parseComponentValue();return Fc(l)?l:Cs;case"length-percentage":var c=a.parseComponentValue();return qn(c)?c:Cs;case"time":return HT.parse(e,a.parseComponentValue())}break}},Mte="data-html2canvas-debug",Hte=function(e){var t=e.getAttribute(Mte);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Xw=function(e,t){var r=Hte(e);return r===1||t===r},Oo=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Xw(r,3))debugger;this.styles=new Rte(t,window.getComputedStyle(r,null)),Zw(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=gx(this.context,r),Xw(r,4)&&(this.flags|=16)}return e}(),Kte="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",KN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q0=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lm=0;lm<KN.length;lm++)Q0[KN.charCodeAt(lm)]=lm;var qte=function(e){var t=e.length*.75,r=e.length,n,s=0,a,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=Q0[e.charCodeAt(n)],o=Q0[e.charCodeAt(n+1)],l=Q0[e.charCodeAt(n+2)],c=Q0[e.charCodeAt(n+3)],u[s++]=a<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return A},Vte=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},Gte=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},NA=5,s_=11,Rv=2,Wte=s_-NA,KT=65536>>NA,$te=1<<NA,Qv=$te-1,zte=1024>>NA,Xte=KT+zte,Yte=Xte,Jte=32,Zte=Yte+Jte,ere=65536>>s_,tre=1<<Wte,rre=tre-1,qN=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},nre=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},sre=function(e,t){var r=qte(e),n=Array.isArray(r)?Gte(r):new Uint32Array(r),s=Array.isArray(r)?Vte(r):new Uint16Array(r),a=24,o=qN(s,a/2,n[4]/2),l=n[5]===2?qN(s,(a+n[4])/2):nre(n,Math.ceil((a+n[4])/4));return new are(n[0],n[1],n[2],n[3],o,l)},are=function(){function e(t,r,n,s,a,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=a,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>NA],r=(r<<Rv)+(t&Qv),this.data[r];if(t<=65535)return r=this.index[KT+(t-55296>>NA)],r=(r<<Rv)+(t&Qv),this.data[r];if(t<this.highStart)return r=Zte-ere+(t>>s_),r=this.index[r],r+=t>>NA&rre,r=this.index[r],r=(r<<Rv)+(t&Qv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),VN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ire=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cm=0;cm<VN.length;cm++)ire[VN.charCodeAt(cm)]=cm;var ore=1,Mv=2,Hv=3,GN=4,WN=5,lre=7,$N=8,Kv=9,qv=10,zN=11,XN=12,YN=13,JN=14,Vv=15,cre=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var a=e.charCodeAt(r++);(a&64512)===56320?t.push(((s&1023)<<10)+(a&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},Are=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,a="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},ure=sre(Kte),xi="",Gv="",dre=function(e){return ure.get(e)},fre=function(e,t,r){var n=r-2,s=t[n],a=t[r-1],o=t[r];if(a===Mv&&o===Hv)return xi;if(a===Mv||a===Hv||a===GN||o===Mv||o===Hv||o===GN)return Gv;if(a===$N&&[$N,Kv,zN,XN].indexOf(o)!==-1||(a===zN||a===Kv)&&(o===Kv||o===qv)||(a===XN||a===qv)&&o===qv||o===YN||o===WN||o===lre||a===ore)return xi;if(a===YN&&o===JN){for(;s===WN;)s=t[--n];if(s===JN)return xi}if(a===Vv&&o===Vv){for(var l=0;s===Vv;)l++,s=t[--n];if(l%2===0)return xi}return Gv},hre=function(e){var t=cre(e),r=t.length,n=0,s=0,a=t.map(dre);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=xi;n<r&&(o=fre(t,a,++n))===xi;);if(o!==xi||n===r){var l=Are.apply(null,t.slice(s,n));return s=n,{value:l,done:!1}}return{done:!0,value:null}}}},pre=function(e){for(var t=hre(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},mre=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),a=Math.round(s.height);if(e.body.removeChild(n),a===t)return!0}}return!1},gre=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,s=xx(n.data).map(function(c){return kn(c)}),a=0,o={},l=s.every(function(c,A){r.setStart(n,a),r.setEnd(n,a+c.length);var u=r.getBoundingClientRect();a+=c.length;var f=u.x>o.x||u.y>o.y;return o=u,A===0?!0:f});return e.body.removeChild(t),l},xre=function(){return typeof new Image().crossOrigin<"u"},vre=function(){return typeof new XMLHttpRequest().responseType=="string"},yre=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},ZN=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},wre=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,a=t.toDataURL();s.src=a;var o=Yw(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),eS(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var A=e.createElement("div");return A.style.backgroundImage="url("+a+")",A.style.height=r+"px",ZN(c)?eS(Yw(r,r,0,0,A)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),ZN(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Yw=function(e,t,r,n,s){var a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"svg"),l=document.createElementNS(a,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},eS=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},bs={get SUPPORT_RANGE_BOUNDS(){var e=mre(document);return Object.defineProperty(bs,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=bs.SUPPORT_RANGE_BOUNDS&&gre(document);return Object.defineProperty(bs,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=yre(document);return Object.defineProperty(bs,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?wre(document):Promise.resolve(!1);return Object.defineProperty(bs,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=xre();return Object.defineProperty(bs,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=vre();return Object.defineProperty(bs,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(bs,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(bs,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},ff=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),bre=function(e,t,r,n){var s=Cre(t,r),a=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(bs.SUPPORT_RANGE_BOUNDS){var c=tS(n,o,l.length).getClientRects();if(c.length>1){var A=a_(l),u=0;A.forEach(function(h){a.push(new ff(h,bl.fromDOMRectList(e,tS(n,u+o,h.length).getClientRects()))),u+=h.length})}else a.push(new ff(l,bl.fromDOMRectList(e,c)))}else{var f=n.splitText(l.length);a.push(new ff(l,_re(e,n))),n=f}else bs.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),a},_re=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var s=t.parentNode;if(s){s.replaceChild(n,t);var a=gx(e,n);return n.firstChild&&s.replaceChild(n.firstChild,n),a}}return bl.EMPTY},tS=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(e,t),s.setEnd(e,t+r),s},a_=function(e){if(bs.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return pre(e)},Bre=function(e,t){if(bs.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return Sre(e,t)},Cre=function(e,t){return t.letterSpacing!==0?a_(e):Bre(e,t)},Nre=[32,160,4961,65792,65793,4153,4241],Sre=function(e,t){for(var r=eZ(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],s,a=function(){if(s.value){var o=s.value.slice(),l=xx(o),c="";l.forEach(function(A){Nre.indexOf(A)===-1?c+=kn(A):(c.length&&n.push(c),n.push(kn(A)),c="")}),c.length&&n.push(c)}};!(s=r.next()).done;)a();return n},kre=function(){function e(t,r,n){this.text=Ere(r.data,n.textTransform),this.textBounds=bre(t,this.text,n,r)}return e}(),Ere=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(Fre,jre);case 2:return e.toUpperCase();default:return e}},Fre=/(^|\s|:|-|\(|\))([a-z])/g,jre=function(e,t,r){return e.length>0?t+r.toUpperCase():e},qT=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return t}(Oo),VT=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return t}(Oo),GT=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this,a=new XMLSerializer,o=gx(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(a.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return t}(Oo),WT=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.value=n.value,s}return t}(Oo),Jw=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return t}(Oo),Tre=[{type:15,flags:0,unit:"px",number:3}],Ire=[{type:16,flags:0,number:50}],Ure=function(e){return e.width>e.height?new bl(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new bl(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},Lre=function(e){var t=e.type===Dre?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},Lg="checkbox",Dg="radio",Dre="password",rS=707406591,i_=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=Lre(n),(s.type===Lg||s.type===Dg)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=Ure(s.bounds)),s.type){case Lg:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=Tre;break;case Dg:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=Ire;break}return s}return t}(Oo),$T=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this,a=n.options[n.selectedIndex||0];return s.value=a&&a.text||"",s}return t}(Oo),zT=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.value=n.value,s}return t}(Oo),XT=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=JT(r,n.contentWindow.document.documentElement);var a=n.contentWindow.document.documentElement?uf(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):ml.TRANSPARENT,o=n.contentWindow.document.body?uf(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):ml.TRANSPARENT;s.backgroundColor=wc(a)?wc(o)?s.styles.backgroundColor:o:a}}catch{}return s}return t}(Oo),Pre=["OL","UL","MENU"],Dm=function(e,t,r,n){for(var s=t.firstChild,a=void 0;s;s=a)if(a=s.nextSibling,ZT(s)&&s.data.trim().length>0)r.textNodes.push(new kre(e,s,r.styles));else if(Wu(s))if(nI(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return Dm(e,l,r,n)});else{var o=YT(e,s);o.styles.isVisible()&&(Ore(s,o,n)?o.flags|=4:Rre(o.styles)&&(o.flags|=2),Pre.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?Dm(e,s.shadowRoot,o,n):!Pg(s)&&!eI(s)&&!Og(s)&&Dm(e,s,o,n))}},YT=function(e,t){return e2(t)?new qT(e,t):tI(t)?new VT(e,t):eI(t)?new GT(e,t):Qre(t)?new WT(e,t):Mre(t)?new Jw(e,t):Hre(t)?new i_(e,t):Og(t)?new $T(e,t):Pg(t)?new zT(e,t):rI(t)?new XT(e,t):new Oo(e,t)},JT=function(e,t){var r=YT(e,t);return r.flags|=4,Dm(e,t,r,r),r},Ore=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||o_(e)&&r.styles.isTransparent()},Rre=function(e){return e.isPositioned()||e.isFloating()},ZT=function(e){return e.nodeType===Node.TEXT_NODE},Wu=function(e){return e.nodeType===Node.ELEMENT_NODE},Zw=function(e){return Wu(e)&&typeof e.style<"u"&&!Pm(e)},Pm=function(e){return typeof e.className=="object"},Qre=function(e){return e.tagName==="LI"},Mre=function(e){return e.tagName==="OL"},Hre=function(e){return e.tagName==="INPUT"},Kre=function(e){return e.tagName==="HTML"},eI=function(e){return e.tagName==="svg"},o_=function(e){return e.tagName==="BODY"},tI=function(e){return e.tagName==="CANVAS"},nS=function(e){return e.tagName==="VIDEO"},e2=function(e){return e.tagName==="IMG"},rI=function(e){return e.tagName==="IFRAME"},sS=function(e){return e.tagName==="STYLE"},qre=function(e){return e.tagName==="SCRIPT"},Pg=function(e){return e.tagName==="TEXTAREA"},Og=function(e){return e.tagName==="SELECT"},nI=function(e){return e.tagName==="SLOT"},aS=function(e){return e.tagName.indexOf("-")>0},Vre=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,s=t.counterReset,a=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(a=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return a&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},e}(),iS={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},oS={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Gre={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Wre={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},_u=function(e,t,r,n,s,a){return e<t||e>r?eh(e,s,a.length>0):n.integers.reduce(function(o,l,c){for(;e>=l;)e-=l,o+=n.values[c];return o},"")+a},sI=function(e,t,r,n){var s="";do r||e--,s=n(e)+s,e/=t;while(e*t>=t);return s},Nn=function(e,t,r,n,s){var a=r-t+1;return(e<0?"-":"")+(sI(Math.abs(e),a,n,function(o){return kn(Math.floor(o%a)+t)})+s)},tA=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return sI(Math.abs(e),n,!1,function(s){return t[Math.floor(s%n)]})+r},ju=1,zl=2,Xl=4,M0=8,nl=function(e,t,r,n,s,a){if(e<-9999||e>9999)return eh(e,4,s.length>0);var o=Math.abs(e),l=s;if(o===0)return t[0]+l;for(var c=0;o>0&&c<=4;c++){var A=o%10;A===0&&rs(a,ju)&&l!==""?l=t[A]+l:A>1||A===1&&c===0||A===1&&c===1&&rs(a,zl)||A===1&&c===1&&rs(a,Xl)&&e>100||A===1&&c>1&&rs(a,M0)?l=t[A]+(c>0?r[c-1]:"")+l:A===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(e<0?n:"")+l},lS="",cS="",AS="",Wv="",eh=function(e,t,r){var n=r?". ":"",s=r?"":"",a=r?", ":"",o=r?" ":"";switch(t){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Nn(e,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return tA(e,"",s);case 6:return _u(e,1,3999,iS,3,n).toLowerCase();case 7:return _u(e,1,3999,iS,3,n);case 8:return Nn(e,945,969,!1,n);case 9:return Nn(e,97,122,!1,n);case 10:return Nn(e,65,90,!1,n);case 11:return Nn(e,1632,1641,!0,n);case 12:case 49:return _u(e,1,9999,oS,3,n);case 35:return _u(e,1,9999,oS,3,n).toLowerCase();case 13:return Nn(e,2534,2543,!0,n);case 14:case 30:return Nn(e,6112,6121,!0,n);case 15:return tA(e,"",s);case 16:return tA(e,"",s);case 17:case 48:return nl(e,"",lS,"",s,zl|Xl|M0);case 47:return nl(e,"",cS,"",s,ju|zl|Xl|M0);case 42:return nl(e,"",lS,"",s,zl|Xl|M0);case 41:return nl(e,"",cS,"",s,ju|zl|Xl|M0);case 26:return nl(e,"","",AS,s,0);case 25:return nl(e,"","",AS,s,ju|zl|Xl);case 31:return nl(e,"","",Wv,a,ju|zl|Xl);case 33:return nl(e,"","",Wv,a,0);case 32:return nl(e,"","",Wv,a,ju|zl|Xl);case 18:return Nn(e,2406,2415,!0,n);case 20:return _u(e,1,19999,Wre,3,n);case 21:return Nn(e,2790,2799,!0,n);case 22:return Nn(e,2662,2671,!0,n);case 22:return _u(e,1,10999,Gre,3,n);case 23:return tA(e,"");case 24:return tA(e,"");case 27:return Nn(e,3302,3311,!0,n);case 28:return tA(e,"",s);case 29:return tA(e,"",s);case 34:return Nn(e,3792,3801,!0,n);case 37:return Nn(e,6160,6169,!0,n);case 38:return Nn(e,4160,4169,!0,n);case 39:return Nn(e,2918,2927,!0,n);case 40:return Nn(e,1776,1785,!0,n);case 43:return Nn(e,3046,3055,!0,n);case 44:return Nn(e,3174,3183,!0,n);case 45:return Nn(e,3664,3673,!0,n);case 46:return Nn(e,3872,3881,!0,n);case 3:default:return Nn(e,48,57,!0,n)}},aI="data-html2canvas-ignore",uS=function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new Vre,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,s=$re(t,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var a=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,l=s.contentWindow,c=l.document,A=Yre(s).then(function(){return oa(n,void 0,void 0,function(){var u,f;return Qs(this,function(h){switch(h.label){case 0:return this.scrolledElements.forEach(tne),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),u=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:h.sent(),h.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Xre(c)]:[3,4];case 3:h.sent(),h.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,f)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(Zre(document.doctype)+"<html></html>"),ene(this.referenceElement.ownerDocument,a,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),A},e.prototype.createElementClone=function(t){if(Xw(t,2))debugger;if(tI(t))return this.createCanvasClone(t);if(nS(t))return this.createVideoClone(t);if(sS(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return e2(r)&&(e2(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),aS(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return $v(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(a,o){return o&&typeof o.cssText=="string"?a+o.cssText:a},""),s=t.cloneNode(!1);return s.textContent=n,s}}catch(a){if(this.context.logger.error("Unable to access cssRules property",a),a.name!=="SecurityError")throw a}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var s=t.cloneNode(!1);try{s.width=t.width,s.height=t.height;var a=t.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&a)o.putImageData(a.getImageData(0,0,t.width,t.height),0,0);else{var l=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return s},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var s=t.ownerDocument.createElement("canvas");return s.width=t.offsetWidth,s.height=t.offsetHeight,s},e.prototype.appendChildNode=function(t,r,n){(!Wu(r)||!qre(r)&&!r.hasAttribute(aI)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Wu(r)||!sS(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var s=this,a=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;a;a=a.nextSibling)if(Wu(a)&&nI(a)&&typeof a.assignedNodes=="function"){var o=a.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,n)})}else this.appendChildNode(r,a,n)},e.prototype.cloneNode=function(t,r){if(ZT(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&Wu(t)&&(Zw(t)||Pm(t))){var s=this.createElementClone(t);s.style.transitionProperty="none";var a=n.getComputedStyle(t),o=n.getComputedStyle(t,":before"),l=n.getComputedStyle(t,":after");this.referenceElement===t&&Zw(s)&&(this.clonedReferenceElement=s),o_(s)&&sne(s);var c=this.counters.parse(new HN(this.context,a)),A=this.resolvePseudoContent(t,s,o,hf.BEFORE);aS(t)&&(r=!0),nS(t)||this.cloneChildNodes(t,s,r),A&&s.insertBefore(A,s.firstChild);var u=this.resolvePseudoContent(t,s,l,hf.AFTER);return u&&s.appendChild(u),this.counters.pop(c),(a&&(this.options.copyStyles||Pm(t))&&!rI(t)||r)&&$v(a,s),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([s,t.scrollLeft,t.scrollTop]),(Pg(t)||Og(t))&&(Pg(s)||Og(s))&&(s.value=t.value),s}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,s){var a=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new HN(this.context,n));var c=new Qte(this.context,n),A=l.createElement("html2canvaspseudoelement");$v(n,A),c.content.forEach(function(f){if(f.type===0)A.appendChild(l.createTextNode(f.value));else if(f.type===22){var h=l.createElement("img");h.src=f.value,h.style.opacity="1",A.appendChild(h)}else if(f.type===18){if(f.name==="attr"){var d=f.values.filter(Or);d.length&&A.appendChild(l.createTextNode(t.getAttribute(d[0].value)||""))}else if(f.name==="counter"){var x=f.values.filter(_d),g=x[0],y=x[1];if(g&&Or(g)){var m=a.counters.getCounterValue(g.value),p=y&&Or(y)?zw.parse(a.context,y.value):3;A.appendChild(l.createTextNode(eh(m,p,!1)))}}else if(f.name==="counters"){var b=f.values.filter(_d),g=b[0],v=b[1],y=b[2];if(g&&Or(g)){var C=a.counters.getCounterValues(g.value),k=y&&Or(y)?zw.parse(a.context,y.value):3,S=v&&v.type===0?v.value:"",I=C.map(function(L){return eh(L,k,!1)}).join(S);A.appendChild(l.createTextNode(I))}}}else if(f.type===20)switch(f.value){case"open-quote":A.appendChild(l.createTextNode(MN(c.quotes,a.quoteDepth++,!0)));break;case"close-quote":A.appendChild(l.createTextNode(MN(c.quotes,--a.quoteDepth,!1)));break;default:A.appendChild(l.createTextNode(f.value))}}),A.className=t2+" "+r2;var u=s===hf.BEFORE?" "+t2:" "+r2;return Pm(r)?r.className.baseValue+=u:r.className+=u,A}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),hf;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(hf||(hf={}));var $re=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(aI,"true"),e.body.appendChild(r),r},zre=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},Xre=function(e){return Promise.all([].slice.call(e.images,0).map(zre))},Yre=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var a=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(a),t(e))},50)}})},Jre=["all","d","content"],$v=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);Jre.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},Zre=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},ene=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},tne=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},rne=":before",nne=":after",t2="___html2canvas___pseudoelement_before",r2="___html2canvas___pseudoelement_after",dS=`{
    content: "" !important;
    display: none !important;
}`,sne=function(e){ane(e,"."+t2+rne+dS+`
         .`+r2+nne+dS)},ane=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},iI=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),ine=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(Xv(t)||Ane(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return oa(this,void 0,void 0,function(){var r,n,s,a,o=this;return Qs(this,function(l){switch(l.label){case 0:return r=iI.isSameOrigin(t),n=!zv(t)&&this._options.useCORS===!0&&bs.SUPPORT_CORS_IMAGES&&!r,s=!zv(t)&&!r&&!Xv(t)&&typeof this._options.proxy=="string"&&bs.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!zv(t)&&!Xv(t)&&!s&&!n?[2]:(a=t,s?[4,this.proxy(a)]:[3,2]);case 1:a=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(c,A){var u=new Image;u.onload=function(){return c(u)},u.onerror=A,(une(a)||n)&&(u.crossOrigin="anonymous"),u.src=a,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return A("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=t.substring(0,256);return new Promise(function(a,o){var l=bs.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")a(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return a(f.result)},!1),f.addEventListener("error",function(h){return o(h)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var A=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+A+"url="+encodeURIComponent(t)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var u=r._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+s)}}c.send()})},e}(),one=/^data:image\/svg\+xml/i,lne=/^data:image\/.*;base64,/i,cne=/^data:image\/.*/i,Ane=function(e){return bs.SUPPORT_SVG_DRAWING||!dne(e)},zv=function(e){return cne.test(e)},une=function(e){return lne.test(e)},Xv=function(e){return e.substr(0,4)==="blob"},dne=function(e){return e.substr(-3).toLowerCase()==="svg"||one.test(e)},Bt=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),Bu=function(e,t,r){return new Bt(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Am=function(){function e(t,r,n,s){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=s}return e.prototype.subdivide=function(t,r){var n=Bu(this.start,this.startControl,t),s=Bu(this.startControl,this.endControl,t),a=Bu(this.endControl,this.end,t),o=Bu(n,s,t),l=Bu(s,a,t),c=Bu(o,l,t);return r?new e(this.start,n,o,c):new e(c,l,a,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),bi=function(e){return e.type===1},fne=function(){function e(t){var r=t.styles,n=t.bounds,s=R0(r.borderTopLeftRadius,n.width,n.height),a=s[0],o=s[1],l=R0(r.borderTopRightRadius,n.width,n.height),c=l[0],A=l[1],u=R0(r.borderBottomRightRadius,n.width,n.height),f=u[0],h=u[1],d=R0(r.borderBottomLeftRadius,n.width,n.height),x=d[0],g=d[1],y=[];y.push((a+c)/n.width),y.push((x+f)/n.width),y.push((o+g)/n.height),y.push((A+h)/n.height);var m=Math.max.apply(Math,y);m>1&&(a/=m,o/=m,c/=m,A/=m,f/=m,h/=m,x/=m,g/=m);var p=n.width-c,b=n.height-h,v=n.width-f,C=n.height-g,k=r.borderTopWidth,S=r.borderRightWidth,I=r.borderBottomWidth,N=r.borderLeftWidth,Q=Wr(r.paddingTop,t.bounds.width),L=Wr(r.paddingRight,t.bounds.width),T=Wr(r.paddingBottom,t.bounds.width),P=Wr(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=a>0||o>0?nn(n.left+N/3,n.top+k/3,a-N/3,o-k/3,kr.TOP_LEFT):new Bt(n.left+N/3,n.top+k/3),this.topRightBorderDoubleOuterBox=a>0||o>0?nn(n.left+p,n.top+k/3,c-S/3,A-k/3,kr.TOP_RIGHT):new Bt(n.left+n.width-S/3,n.top+k/3),this.bottomRightBorderDoubleOuterBox=f>0||h>0?nn(n.left+v,n.top+b,f-S/3,h-I/3,kr.BOTTOM_RIGHT):new Bt(n.left+n.width-S/3,n.top+n.height-I/3),this.bottomLeftBorderDoubleOuterBox=x>0||g>0?nn(n.left+N/3,n.top+C,x-N/3,g-I/3,kr.BOTTOM_LEFT):new Bt(n.left+N/3,n.top+n.height-I/3),this.topLeftBorderDoubleInnerBox=a>0||o>0?nn(n.left+N*2/3,n.top+k*2/3,a-N*2/3,o-k*2/3,kr.TOP_LEFT):new Bt(n.left+N*2/3,n.top+k*2/3),this.topRightBorderDoubleInnerBox=a>0||o>0?nn(n.left+p,n.top+k*2/3,c-S*2/3,A-k*2/3,kr.TOP_RIGHT):new Bt(n.left+n.width-S*2/3,n.top+k*2/3),this.bottomRightBorderDoubleInnerBox=f>0||h>0?nn(n.left+v,n.top+b,f-S*2/3,h-I*2/3,kr.BOTTOM_RIGHT):new Bt(n.left+n.width-S*2/3,n.top+n.height-I*2/3),this.bottomLeftBorderDoubleInnerBox=x>0||g>0?nn(n.left+N*2/3,n.top+C,x-N*2/3,g-I*2/3,kr.BOTTOM_LEFT):new Bt(n.left+N*2/3,n.top+n.height-I*2/3),this.topLeftBorderStroke=a>0||o>0?nn(n.left+N/2,n.top+k/2,a-N/2,o-k/2,kr.TOP_LEFT):new Bt(n.left+N/2,n.top+k/2),this.topRightBorderStroke=a>0||o>0?nn(n.left+p,n.top+k/2,c-S/2,A-k/2,kr.TOP_RIGHT):new Bt(n.left+n.width-S/2,n.top+k/2),this.bottomRightBorderStroke=f>0||h>0?nn(n.left+v,n.top+b,f-S/2,h-I/2,kr.BOTTOM_RIGHT):new Bt(n.left+n.width-S/2,n.top+n.height-I/2),this.bottomLeftBorderStroke=x>0||g>0?nn(n.left+N/2,n.top+C,x-N/2,g-I/2,kr.BOTTOM_LEFT):new Bt(n.left+N/2,n.top+n.height-I/2),this.topLeftBorderBox=a>0||o>0?nn(n.left,n.top,a,o,kr.TOP_LEFT):new Bt(n.left,n.top),this.topRightBorderBox=c>0||A>0?nn(n.left+p,n.top,c,A,kr.TOP_RIGHT):new Bt(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||h>0?nn(n.left+v,n.top+b,f,h,kr.BOTTOM_RIGHT):new Bt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=x>0||g>0?nn(n.left,n.top+C,x,g,kr.BOTTOM_LEFT):new Bt(n.left,n.top+n.height),this.topLeftPaddingBox=a>0||o>0?nn(n.left+N,n.top+k,Math.max(0,a-N),Math.max(0,o-k),kr.TOP_LEFT):new Bt(n.left+N,n.top+k),this.topRightPaddingBox=c>0||A>0?nn(n.left+Math.min(p,n.width-S),n.top+k,p>n.width+S?0:Math.max(0,c-S),Math.max(0,A-k),kr.TOP_RIGHT):new Bt(n.left+n.width-S,n.top+k),this.bottomRightPaddingBox=f>0||h>0?nn(n.left+Math.min(v,n.width-N),n.top+Math.min(b,n.height-I),Math.max(0,f-S),Math.max(0,h-I),kr.BOTTOM_RIGHT):new Bt(n.left+n.width-S,n.top+n.height-I),this.bottomLeftPaddingBox=x>0||g>0?nn(n.left+N,n.top+Math.min(C,n.height-I),Math.max(0,x-N),Math.max(0,g-I),kr.BOTTOM_LEFT):new Bt(n.left+N,n.top+n.height-I),this.topLeftContentBox=a>0||o>0?nn(n.left+N+P,n.top+k+Q,Math.max(0,a-(N+P)),Math.max(0,o-(k+Q)),kr.TOP_LEFT):new Bt(n.left+N+P,n.top+k+Q),this.topRightContentBox=c>0||A>0?nn(n.left+Math.min(p,n.width+N+P),n.top+k+Q,p>n.width+N+P?0:c-N+P,A-(k+Q),kr.TOP_RIGHT):new Bt(n.left+n.width-(S+L),n.top+k+Q),this.bottomRightContentBox=f>0||h>0?nn(n.left+Math.min(v,n.width-(N+P)),n.top+Math.min(b,n.height+k+Q),Math.max(0,f-(S+L)),h-(I+T),kr.BOTTOM_RIGHT):new Bt(n.left+n.width-(S+L),n.top+n.height-(I+T)),this.bottomLeftContentBox=x>0||g>0?nn(n.left+N+P,n.top+C,Math.max(0,x-(N+P)),g-(I+T),kr.BOTTOM_LEFT):new Bt(n.left+N+P,n.top+n.height-(I+T))}return e}(),kr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(kr||(kr={}));var nn=function(e,t,r,n,s){var a=4*((Math.sqrt(2)-1)/3),o=r*a,l=n*a,c=e+r,A=t+n;switch(s){case kr.TOP_LEFT:return new Am(new Bt(e,A),new Bt(e,A-l),new Bt(c-o,t),new Bt(c,t));case kr.TOP_RIGHT:return new Am(new Bt(e,t),new Bt(e+o,t),new Bt(c,A-l),new Bt(c,A));case kr.BOTTOM_RIGHT:return new Am(new Bt(c,t),new Bt(c,t+l),new Bt(e+o,A),new Bt(e,A));case kr.BOTTOM_LEFT:default:return new Am(new Bt(c,A),new Bt(c-o,A),new Bt(e,t+l),new Bt(e,t))}},Rg=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},hne=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Qg=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},pne=function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e}(),um=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),mne=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),gne=function(e){return e.type===0},oI=function(e){return e.type===1},xne=function(e){return e.type===2},fS=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},vne=function(e,t,r,n,s){return e.map(function(a,o){switch(o){case 0:return a.add(t,r);case 1:return a.add(t+n,r);case 2:return a.add(t+n,r+s);case 3:return a.add(t,r+s)}return a})},lI=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),cI=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new fne(this.container),this.container.styles.opacity<1&&this.effects.push(new mne(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,a=this.container.styles.transform;this.effects.push(new pne(n,s,a))}if(this.container.styles.overflowX!==0){var o=Rg(this.curves),l=Qg(this.curves);fS(o,l)?this.effects.push(new um(o,6)):(this.effects.push(new um(o,2)),this.effects.push(new um(l,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var a=n.effects.filter(function(c){return!oI(c)});if(r||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,a),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=Rg(n.curves),l=Qg(n.curves);fS(o,l)||s.unshift(new um(l,6))}}else s.unshift.apply(s,a);n=n.parent}return s.filter(function(c){return rs(c.target,t)})},e}(),n2=function(e,t,r,n){e.container.elements.forEach(function(s){var a=rs(s.flags,4),o=rs(s.flags,2),l=new cI(s,e);rs(s.styles.display,2048)&&n.push(l);var c=rs(s.flags,8)?[]:n;if(a||o){var A=a||s.styles.isPositioned()?r:t,u=new lI(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var f=s.styles.zIndex.order;if(f<0){var h=0;A.negativeZIndex.some(function(x,g){return f>x.element.container.styles.zIndex.order?(h=g,!1):h>0}),A.negativeZIndex.splice(h,0,u)}else if(f>0){var d=0;A.positiveZIndex.some(function(x,g){return f>=x.element.container.styles.zIndex.order?(d=g+1,!1):d>0}),A.positiveZIndex.splice(d,0,u)}else A.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else s.styles.isFloating()?A.nonPositionedFloats.push(u):A.nonPositionedInlineLevel.push(u);n2(l,u,a?u:r,c)}else s.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),n2(l,t,r,c);rs(s.flags,8)&&AI(s,c)})},AI=function(e,t){for(var r=e instanceof Jw?e.start:1,n=e instanceof Jw?e.reversed:!1,s=0;s<t.length;s++){var a=t[s];a.container instanceof WT&&typeof a.container.value=="number"&&a.container.value!==0&&(r=a.container.value),a.listValue=eh(r,a.container.styles.listStyleType,!0),r+=n?-1:1}},yne=function(e){var t=new cI(e,null),r=new lI(t),n=[];return n2(t,r,r,n),AI(t.container,n),r},hS=function(e,t){switch(t){case 0:return Ci(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Ci(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Ci(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return Ci(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},wne=function(e,t){switch(t){case 0:return Ci(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Ci(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Ci(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return Ci(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},bne=function(e,t){switch(t){case 0:return Ci(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Ci(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Ci(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return Ci(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},_ne=function(e,t){switch(t){case 0:return dm(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return dm(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return dm(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return dm(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},dm=function(e,t){var r=[];return bi(e)?r.push(e.subdivide(.5,!1)):r.push(e),bi(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Ci=function(e,t,r,n){var s=[];return bi(e)?s.push(e.subdivide(.5,!1)):s.push(e),bi(r)?s.push(r.subdivide(.5,!0)):s.push(r),bi(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),bi(t)?s.push(t.subdivide(.5,!1).reverse()):s.push(t),s},uI=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},Mg=function(e){var t=e.styles,r=e.bounds,n=Wr(t.paddingLeft,r.width),s=Wr(t.paddingRight,r.width),a=Wr(t.paddingTop,r.width),o=Wr(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,a+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+s),-(t.borderTopWidth+t.borderBottomWidth+a+o))},Bne=function(e,t){return e===0?t.bounds:e===2?Mg(t):uI(t)},Cne=function(e,t){return e===0?t.bounds:e===2?Mg(t):uI(t)},Yv=function(e,t,r){var n=Bne(Tu(e.styles.backgroundOrigin,t),e),s=Cne(Tu(e.styles.backgroundClip,t),e),a=Nne(Tu(e.styles.backgroundSize,t),r,n),o=a[0],l=a[1],c=R0(Tu(e.styles.backgroundPosition,t),n.width-o,n.height-l),A=Sne(Tu(e.styles.backgroundRepeat,t),c,a,n,s),u=Math.round(n.left+c[0]),f=Math.round(n.top+c[1]);return[A,u,f,o,l]},Cu=function(e){return Or(e)&&e.value===ud.AUTO},fm=function(e){return typeof e=="number"},Nne=function(e,t,r){var n=t[0],s=t[1],a=t[2],o=e[0],l=e[1];if(!o)return[0,0];if(qn(o)&&l&&qn(l))return[Wr(o,r.width),Wr(l,r.height)];var c=fm(a);if(Or(o)&&(o.value===ud.CONTAIN||o.value===ud.COVER)){if(fm(a)){var A=r.width/r.height;return A<a!=(o.value===ud.COVER)?[r.width,r.width/a]:[r.height*a,r.height]}return[r.width,r.height]}var u=fm(n),f=fm(s),h=u||f;if(Cu(o)&&(!l||Cu(l))){if(u&&f)return[n,s];if(!c&&!h)return[r.width,r.height];if(h&&c){var d=u?n:s*a,x=f?s:n/a;return[d,x]}var g=u?n:r.width,y=f?s:r.height;return[g,y]}if(c){var m=0,p=0;return qn(o)?m=Wr(o,r.width):qn(l)&&(p=Wr(l,r.height)),Cu(o)?m=p*a:(!l||Cu(l))&&(p=m/a),[m,p]}var b=null,v=null;if(qn(o)?b=Wr(o,r.width):l&&qn(l)&&(v=Wr(l,r.height)),b!==null&&(!l||Cu(l))&&(v=u&&f?b/n*s:r.height),v!==null&&Cu(o)&&(b=u&&f?v/s*n:r.width),b!==null&&v!==null)return[b,v];throw new Error("Unable to calculate background-size for element")},Tu=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},Sne=function(e,t,r,n,s){var a=t[0],o=t[1],l=r[0],c=r[1];switch(e){case 2:return[new Bt(Math.round(n.left),Math.round(n.top+o)),new Bt(Math.round(n.left+n.width),Math.round(n.top+o)),new Bt(Math.round(n.left+n.width),Math.round(c+n.top+o)),new Bt(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new Bt(Math.round(n.left+a),Math.round(n.top)),new Bt(Math.round(n.left+a+l),Math.round(n.top)),new Bt(Math.round(n.left+a+l),Math.round(n.height+n.top)),new Bt(Math.round(n.left+a),Math.round(n.height+n.top))];case 1:return[new Bt(Math.round(n.left+a),Math.round(n.top+o)),new Bt(Math.round(n.left+a+l),Math.round(n.top+o)),new Bt(Math.round(n.left+a+l),Math.round(n.top+o+c)),new Bt(Math.round(n.left+a),Math.round(n.top+o+c))];default:return[new Bt(Math.round(s.left),Math.round(s.top)),new Bt(Math.round(s.left+s.width),Math.round(s.top)),new Bt(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Bt(Math.round(s.left),Math.round(s.height+s.top))]}},kne="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",pS="Hidden Text",Ene=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),s=this._document.createElement("img"),a=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),s.src=kne,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",a.style.fontFamily=t,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.appendChild(this._document.createTextNode(pS)),n.appendChild(a),n.appendChild(s);var l=s.offsetTop-a.offsetTop+2;n.removeChild(a),n.appendChild(this._document.createTextNode(pS)),n.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e}(),dI=function(){function e(t,r){this.context=t,this.options=r}return e}(),Fne=1e4,jne=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new Ene(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return n.applyEffect(s)})},t.prototype.applyEffect=function(r){this.ctx.save(),xne(r)&&(this.ctx.globalAlpha=r.opacity),gne(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),oI(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return oa(this,void 0,void 0,function(){var n;return Qs(this,function(s){switch(s.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return oa(this,void 0,void 0,function(){return Qs(this,function(n){switch(n.label){case 0:if(rs(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,s){var a=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=a_(r.text);o.reduce(function(l,c){return a.ctx.fillText(c,l,r.bounds.top+s),l+a.ctx.measureText(c).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=Dne(r.fontFamily).join(", "),a=vh(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,a,s].join(" "),s,a]},t.prototype.renderTextNode=function(r,n){return oa(this,void 0,void 0,function(){var s,a,o,l,c,A,u,f,h=this;return Qs(this,function(d){return s=this.createFontStyle(n),a=s[0],o=s[1],l=s[2],this.ctx.font=a,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),A=c.baseline,u=c.middle,f=n.paintOrder,r.textBounds.forEach(function(x){f.forEach(function(g){switch(g){case 0:h.ctx.fillStyle=os(n.color),h.renderTextWithLetterSpacing(x,n.letterSpacing,A);var y=n.textShadow;y.length&&x.text.trim().length&&(y.slice(0).reverse().forEach(function(m){h.ctx.shadowColor=os(m.color),h.ctx.shadowOffsetX=m.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=m.offsetY.number*h.options.scale,h.ctx.shadowBlur=m.blur.number,h.renderTextWithLetterSpacing(x,n.letterSpacing,A)}),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),n.textDecorationLine.length&&(h.ctx.fillStyle=os(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(m){switch(m){case 1:h.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top+A),x.bounds.width,1);break;case 2:h.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top),x.bounds.width,1);break;case 3:h.ctx.fillRect(x.bounds.left,Math.ceil(x.bounds.top+u),x.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&x.text.trim().length&&(h.ctx.strokeStyle=os(n.webkitTextStrokeColor),h.ctx.lineWidth=n.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(x.text,x.bounds.left,x.bounds.top+A)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var a=Mg(r),o=Qg(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,a.left,a.top,a.width,a.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return oa(this,void 0,void 0,function(){var n,s,a,o,l,c,p,p,A,u,f,h,v,d,x,C,g,y,m,p,b,v,C;return Qs(this,function(k){switch(k.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,s=r.curves,a=n.styles,o=0,l=n.textNodes,k.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,a)]):[3,4];case 2:k.sent(),k.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof qT))return[3,8];k.label=5;case 5:return k.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return p=k.sent(),this.renderReplacedElement(n,s,p),[3,8];case 7:return k.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof VT&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof GT))return[3,12];k.label=9;case 9:return k.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return p=k.sent(),this.renderReplacedElement(n,s,p),[3,12];case 11:return k.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof XT&&n.tree?(A=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,A.render(n.tree)]):[3,14];case 13:u=k.sent(),n.width&&n.height&&this.ctx.drawImage(u,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),k.label=14;case 14:if(n instanceof i_&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===Lg?n.checked&&(this.ctx.save(),this.path([new Bt(n.bounds.left+f*.39363,n.bounds.top+f*.79),new Bt(n.bounds.left+f*.16,n.bounds.top+f*.5549),new Bt(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new Bt(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new Bt(n.bounds.left+f*.72983,n.bounds.top+f*.23),new Bt(n.bounds.left+f*.84,n.bounds.top+f*.34085),new Bt(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=os(rS),this.ctx.fill(),this.ctx.restore()):n.type===Dg&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=os(rS),this.ctx.fill(),this.ctx.restore())),Tne(n)&&n.value.length){switch(h=this.createFontStyle(a),v=h[0],d=h[1],x=this.fontMetrics.getMetrics(v,d).baseline,this.ctx.font=v,this.ctx.fillStyle=os(a.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Une(n.styles.textAlign),C=Mg(n),g=0,n.styles.textAlign){case 1:g+=C.width/2;break;case 2:g+=C.width;break}y=C.add(g,0,0,-C.height/2+1),this.ctx.save(),this.path([new Bt(C.left,C.top),new Bt(C.left+C.width,C.top),new Bt(C.left+C.width,C.top+C.height),new Bt(C.left,C.top+C.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new ff(n.value,y),a.letterSpacing,x),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!rs(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(m=n.styles.listStyleImage,m.type!==0)return[3,18];p=void 0,b=m.url,k.label=15;case 15:return k.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return p=k.sent(),this.ctx.drawImage(p,n.bounds.left-(p.width+10),n.bounds.top),[3,18];case 17:return k.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(v=this.createFontStyle(a)[0],this.ctx.font=v,this.ctx.fillStyle=os(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",C=new bl(n.bounds.left,n.bounds.top+Wr(n.styles.paddingTop,n.bounds.width),n.bounds.width,RN(a.lineHeight,a.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new ff(r.listValue,C),a.letterSpacing,RN(a.lineHeight,a.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),k.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return oa(this,void 0,void 0,function(){var n,s,m,a,o,m,l,c,m,A,u,m,f,h,m,d,x,m,g,y,m;return Qs(this,function(p){switch(p.label){case 0:if(rs(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:p.sent(),n=0,s=r.negativeZIndex,p.label=2;case 2:return n<s.length?(m=s[n],[4,this.renderStack(m)]):[3,5];case 3:p.sent(),p.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:p.sent(),a=0,o=r.nonInlineLevel,p.label=7;case 7:return a<o.length?(m=o[a],[4,this.renderNode(m)]):[3,10];case 8:p.sent(),p.label=9;case 9:return a++,[3,7];case 10:l=0,c=r.nonPositionedFloats,p.label=11;case 11:return l<c.length?(m=c[l],[4,this.renderStack(m)]):[3,14];case 12:p.sent(),p.label=13;case 13:return l++,[3,11];case 14:A=0,u=r.nonPositionedInlineLevel,p.label=15;case 15:return A<u.length?(m=u[A],[4,this.renderStack(m)]):[3,18];case 16:p.sent(),p.label=17;case 17:return A++,[3,15];case 18:f=0,h=r.inlineLevel,p.label=19;case 19:return f<h.length?(m=h[f],[4,this.renderNode(m)]):[3,22];case 20:p.sent(),p.label=21;case 21:return f++,[3,19];case 22:d=0,x=r.zeroOrAutoZIndexOrTransformedOrOpacity,p.label=23;case 23:return d<x.length?(m=x[d],[4,this.renderStack(m)]):[3,26];case 24:p.sent(),p.label=25;case 25:return d++,[3,23];case 26:g=0,y=r.positiveZIndex,p.label=27;case 27:return g<y.length?(m=y[g],[4,this.renderStack(m)]):[3,30];case 28:p.sent(),p.label=29;case 29:return g++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(s,a){var o=bi(s)?s.start:s;a===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),bi(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},t.prototype.renderRepeat=function(r,n,s,a){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(s,a),this.ctx.fill(),this.ctx.translate(-s,-a)},t.prototype.resizeImage=function(r,n,s){var a;if(r.width===n&&r.height===s)return r;var o=(a=this.canvas.ownerDocument)!==null&&a!==void 0?a:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,s),l},t.prototype.renderBackgroundImage=function(r){return oa(this,void 0,void 0,function(){var n,s,a,o,l,c;return Qs(this,function(A){switch(A.label){case 0:n=r.styles.backgroundImage.length-1,s=function(u){var f,h,d,Q,q,M,P,R,I,x,Q,q,M,P,R,g,y,m,p,b,v,C,k,S,I,N,Q,L,T,P,R,z,q,M,V,H,se,ce,B,U,F,D;return Qs(this,function(X){switch(X.label){case 0:if(u.type!==0)return[3,5];f=void 0,h=u.url,X.label=1;case 1:return X.trys.push([1,3,,4]),[4,a.context.cache.match(h)];case 2:return f=X.sent(),[3,4];case 3:return X.sent(),a.context.logger.error("Error loading background-image "+h),[3,4];case 4:return f&&(d=Yv(r,n,[f.width,f.height,f.width/f.height]),Q=d[0],q=d[1],M=d[2],P=d[3],R=d[4],I=a.ctx.createPattern(a.resizeImage(f,P,R),"repeat"),a.renderRepeat(Q,I,q,M)),[3,6];case 5:gee(u)?(x=Yv(r,n,[null,null,null]),Q=x[0],q=x[1],M=x[2],P=x[3],R=x[4],g=dee(u.angle,P,R),y=g[0],m=g[1],p=g[2],b=g[3],v=g[4],C=document.createElement("canvas"),C.width=P,C.height=R,k=C.getContext("2d"),S=k.createLinearGradient(m,b,p,v),PN(u.stops,y).forEach(function(K){return S.addColorStop(K.stop,os(K.color))}),k.fillStyle=S,k.fillRect(0,0,P,R),P>0&&R>0&&(I=a.ctx.createPattern(C,"repeat"),a.renderRepeat(Q,I,q,M))):xee(u)&&(N=Yv(r,n,[null,null,null]),Q=N[0],L=N[1],T=N[2],P=N[3],R=N[4],z=u.position.length===0?[r_]:u.position,q=Wr(z[0],P),M=Wr(z[z.length-1],R),V=fee(u,q,M,P,R),H=V[0],se=V[1],H>0&&se>0&&(ce=a.ctx.createRadialGradient(L+q,T+M,0,L+q,T+M,H),PN(u.stops,H*2).forEach(function(K){return ce.addColorStop(K.stop,os(K.color))}),a.path(Q),a.ctx.fillStyle=ce,H!==se?(B=r.bounds.left+.5*r.bounds.width,U=r.bounds.top+.5*r.bounds.height,F=se/H,D=1/F,a.ctx.save(),a.ctx.translate(B,U),a.ctx.transform(1,0,0,F,0,0),a.ctx.translate(-B,-U),a.ctx.fillRect(L,D*(T-U)+U,P,R*D),a.ctx.restore()):a.ctx.fill())),X.label=6;case 6:return n--,[2]}})},a=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:A.sent(),A.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,s){return oa(this,void 0,void 0,function(){return Qs(this,function(a){return this.path(hS(s,n)),this.ctx.fillStyle=os(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,s,a){return oa(this,void 0,void 0,function(){var o,l;return Qs(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,s,a)]:[3,2];case 1:return c.sent(),[2];case 2:return o=wne(a,s),this.path(o),this.ctx.fillStyle=os(r),this.ctx.fill(),l=bne(a,s),this.path(l),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return oa(this,void 0,void 0,function(){var n,s,a,o,l,c,A,u,f=this;return Qs(this,function(h){switch(h.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,s=!wc(n.backgroundColor)||n.backgroundImage.length,a=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=Ine(Tu(n.backgroundClip,0),r.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),wc(n.backgroundColor)||(this.ctx.fillStyle=os(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(d){f.ctx.save();var x=Rg(r.curves),g=d.inset?0:Fne,y=vne(x,-g+(d.inset?1:-1)*d.spread.number,(d.inset?1:-1)*d.spread.number,d.spread.number*(d.inset?-2:2),d.spread.number*(d.inset?-2:2));d.inset?(f.path(x),f.ctx.clip(),f.mask(y)):(f.mask(x),f.ctx.clip(),f.path(y)),f.ctx.shadowOffsetX=d.offsetX.number+g,f.ctx.shadowOffsetY=d.offsetY.number,f.ctx.shadowColor=os(d.color),f.ctx.shadowBlur=d.blur.number,f.ctx.fillStyle=d.inset?os(d.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),h.label=2;case 2:l=0,c=0,A=a,h.label=3;case 3:return c<A.length?(u=A[c],u.style!==0&&!wc(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,3)];case 6:return h.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,l,r.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,l,r.curves)];case 10:h.sent(),h.label=11;case 11:l++,h.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,s,a,o){return oa(this,void 0,void 0,function(){var l,c,A,u,f,h,d,x,g,y,m,p,b,v,C,k,C,k;return Qs(this,function(S){return this.ctx.save(),l=_ne(a,s),c=hS(a,s),o===2&&(this.path(c),this.ctx.clip()),bi(c[0])?(A=c[0].start.x,u=c[0].start.y):(A=c[0].x,u=c[0].y),bi(c[1])?(f=c[1].end.x,h=c[1].end.y):(f=c[1].x,h=c[1].y),s===0||s===2?d=Math.abs(A-f):d=Math.abs(u-h),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),x=n<3?n*3:n*2,g=n<3?n*2:n,o===3&&(x=n,g=n),y=!0,d<=x*2?y=!1:d<=x*2+g?(m=d/(2*x+g),x*=m,g*=m):(p=Math.floor((d+g)/(x+g)),b=(d-p*x)/(p-1),v=(d-(p+1)*x)/p,g=v<=0||Math.abs(g-b)<Math.abs(g-v)?b:v),y&&(o===3?this.ctx.setLineDash([0,x+g]):this.ctx.setLineDash([x,g])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=os(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(bi(c[0])&&(C=c[3],k=c[0],this.ctx.beginPath(),this.formatPath([new Bt(C.end.x,C.end.y),new Bt(k.start.x,k.start.y)]),this.ctx.stroke()),bi(c[1])&&(C=c[1],k=c[2],this.ctx.beginPath(),this.formatPath([new Bt(C.end.x,C.end.y),new Bt(k.start.x,k.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return oa(this,void 0,void 0,function(){var n;return Qs(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=os(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=yne(r),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(dI),Tne=function(e){return e instanceof zT||e instanceof $T?!0:e instanceof i_&&e.type!==Dg&&e.type!==Lg},Ine=function(e,t){switch(e){case 0:return Rg(t);case 2:return hne(t);case 1:default:return Qg(t)}},Une=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Lne=["-apple-system","system-ui"],Dne=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return Lne.indexOf(t)===-1}):e},Pne=function(e){co(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return t.prototype.render=function(r){return oa(this,void 0,void 0,function(){var n,s;return Qs(this,function(a){switch(a.label){case 0:return n=Yw(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,One(n)];case 1:return s=a.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=os(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(dI),One=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},Rne=function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Vp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Vp([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Vp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Vp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),Qne=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new Rne({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new ine(this,t)}return e.instanceCount=1,e}(),l_=function(e,t){return t===void 0&&(t={}),Mne(e,t)};typeof window<"u"&&iI.setContext(window);var Mne=function(e,t){return oa(void 0,void 0,void 0,function(){var r,n,s,a,o,l,c,A,u,f,h,d,x,g,y,m,p,b,v,C,S,k,S,I,N,Q,L,T,P,R,z,q,M,V,H,se,ce,B,U,F;return Qs(this,function(D){switch(D.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(I=t.allowTaint)!==null&&I!==void 0?I:!1,imageTimeout:(N=t.imageTimeout)!==null&&N!==void 0?N:15e3,proxy:t.proxy,useCORS:(Q=t.useCORS)!==null&&Q!==void 0?Q:!1},a=Dw({logging:(L=t.logging)!==null&&L!==void 0?L:!0,cache:t.cache},s),o={windowWidth:(T=t.windowWidth)!==null&&T!==void 0?T:n.innerWidth,windowHeight:(P=t.windowHeight)!==null&&P!==void 0?P:n.innerHeight,scrollX:(R=t.scrollX)!==null&&R!==void 0?R:n.pageXOffset,scrollY:(z=t.scrollY)!==null&&z!==void 0?z:n.pageYOffset},l=new bl(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new Qne(a,l),A=(q=t.foreignObjectRendering)!==null&&q!==void 0?q:!1,u={allowTaint:(M=t.allowTaint)!==null&&M!==void 0?M:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:A,copyStyles:A},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new uS(c,e,u),h=f.clonedReferenceElement,h?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return d=D.sent(),x=o_(h)||Kre(h)?vJ(h.ownerDocument):gx(c,h),g=x.width,y=x.height,m=x.left,p=x.top,b=Hne(c,h,t.backgroundColor),v={canvas:t.canvas,backgroundColor:b,scale:(H=(V=t.scale)!==null&&V!==void 0?V:n.devicePixelRatio)!==null&&H!==void 0?H:1,x:((se=t.x)!==null&&se!==void 0?se:0)+m,y:((ce=t.y)!==null&&ce!==void 0?ce:0)+p,width:(B=t.width)!==null&&B!==void 0?B:Math.ceil(g),height:(U=t.height)!==null&&U!==void 0?U:Math.ceil(y)},A?(c.logger.debug("Document cloned, using foreign object rendering"),S=new Pne(c,v),[4,S.render(h)]):[3,3];case 2:return C=D.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+m+","+p+" with size "+g+"x"+y+" using computed rendering"),c.logger.debug("Starting DOM parsing"),k=JT(c,h),b===k.styles.backgroundColor&&(k.styles.backgroundColor=ml.TRANSPARENT),c.logger.debug("Starting renderer for element at "+v.x+","+v.y+" with size "+v.width+"x"+v.height),S=new jne(c,v),[4,S.render(k)];case 4:C=D.sent(),D.label=5;case 5:return(!((F=t.removeContainer)!==null&&F!==void 0)||F)&&(uS.destroy(d)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,C]}})})},Hne=function(e,t,r){var n=t.ownerDocument,s=n.documentElement?uf(e,getComputedStyle(n.documentElement).backgroundColor):ml.TRANSPARENT,a=n.body?uf(e,getComputedStyle(n.body).backgroundColor):ml.TRANSPARENT,o=typeof r=="string"?uf(e,r):r===null?ml.TRANSPARENT:4294967295;return t===n.documentElement?wc(s)?wc(a)?o:a:s:o};const Kne=Object.freeze(Object.defineProperty({__proto__:null,default:l_},Symbol.toStringTag,{value:"Module"}));function qne({challan:e,items:t,onClose:r}){var u,f,h,d,x,g,y;const n=G.useRef(null),s=()=>{window.print()},a=async()=>{if(n.current)try{const m=await l_(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:Q=>{const L=Q.getElementById("challan-print-content");L&&(L.style.width="210mm")}}),p=m.toDataURL("image/png",1),b=new Qt("p","mm","a4"),v=b.internal.pageSize.getWidth(),C=b.internal.pageSize.getHeight(),k=m.width,S=m.height,I=v/k,N=S*I;if(N>C){let Q=0,L=N;for(;L>0;)b.addImage(p,"PNG",0,Q,v,N),L-=C,Q-=C,L>0&&b.addPage()}else b.addImage(p,"PNG",0,0,v,N);b.save(`Delivery-Challan-${e.challan_number}.pdf`)}catch(m){console.error("Error generating PDF:",m),alert("Failed to generate PDF. Please try again.")}},o=m=>{const p=new Date(m),b=p.getDate(),v=p.getMonth()+1,C=p.getFullYear();return`${b.toString().padStart(2,"0")}-${v.toString().padStart(2,"0")}-${C}`},l=m=>{const p=new Date(m),v=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][p.getMonth()],C=p.getFullYear();return`${v} ${C}`},c=t.reduce((m,p)=>m+p.quantity,0),A=((f=(u=t[0])==null?void 0:u.products)==null?void 0:f.unit)||"kg";return i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[i.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:i.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[i.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Surat Jalan ",e.challan_number]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:s,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[i.jsx(zE,{className:"h-4 w-4"}),"Cetak"]}),i.jsxs("button",{onClick:a,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[i.jsx(TA,{className:"h-4 w-4"}),"PDF"]}),i.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:i.jsx(Xs,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{id:"challan-print-content",ref:n,className:"p-8",children:[i.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[i.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:i.jsxs("g",{children:[i.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),i.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),i.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),i.jsx("div",{className:"text-right",children:i.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"SURAT JALAN"})})]}),i.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No izin PBF"}),i.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),i.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),i.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[i.jsx("div",{className:"mb-1",children:i.jsx("span",{className:"font-bold",children:"Company Name:"})}),i.jsx("div",{className:"ml-4 mb-2",children:i.jsx("p",{className:"font-semibold",children:((h=e.customers)==null?void 0:h.company_name)||""})}),i.jsx("div",{className:"mb-1",children:i.jsx("span",{className:"font-bold",children:"Address:"})}),i.jsxs("div",{className:"ml-4 mb-2",children:[i.jsx("p",{children:e.delivery_address||""}),i.jsx("p",{children:((d=e.customers)==null?void 0:d.city)||""})]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Phone:"}),i.jsx("span",{className:"ml-2",children:((x=e.customers)==null?void 0:x.phone)||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"No.Izin PBF:"}),i.jsx("span",{className:"ml-2",children:((g=e.customers)==null?void 0:g.pbf_license)||"-"})]})]}),i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right w-64",children:[i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Challan No: "}),i.jsx("span",{children:e.challan_number})]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Challan Date: "}),i.jsx("span",{children:o(e.challan_date)})]}),e.vehicle_number&&i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Vehicle No: "}),i.jsx("span",{children:e.vehicle_number})]})]})]})}),i.jsx("div",{className:"mb-3 border-2 border-black print:mb-2",children:i.jsxs("table",{className:"w-full border-collapse text-xs print:text-[10px]",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b-2 border-black",children:[i.jsx("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"5%"},children:"No"}),i.jsxs("th",{className:"border-r border-black p-2 text-left font-bold print:p-1",style:{width:"30%"},children:["Nama Produk",i.jsx("br",{}),"Product Name"]}),i.jsxs("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"12%"},children:["No Batch",i.jsx("br",{}),"Batch No"]}),i.jsx("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"12%"},children:"Exp. Date"}),i.jsxs("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"18%"},children:["Kemasan",i.jsx("br",{}),"Packaging"]}),i.jsxs("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"8%"},children:["Jumlah",i.jsx("br",{}),"Packs"]}),i.jsxs("th",{className:"p-2 text-center font-bold print:p-1",style:{width:"15%"},children:["Kuantitas",i.jsx("br",{}),"Quantity"]})]})}),i.jsxs("tbody",{children:[t.map((m,p)=>{var b,v,C,k,S;return i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:p+1}),i.jsx("td",{className:"border-r border-black p-2 print:p-1",children:(b=m.products)==null?void 0:b.product_name}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:(v=m.batches)==null?void 0:v.batch_number}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:(C=m.batches)!=null&&C.expiry_date?l(m.batches.expiry_date):"-"}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:m.pack_type&&m.pack_size&&m.number_of_packs?`${m.pack_size} ${((k=m.products)==null?void 0:k.unit)||"kg"}/${m.pack_type}`:m.pack_type&&m.pack_size?`${m.pack_size} ${m.pack_type}`:"-"}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:m.number_of_packs||"-"}),i.jsxs("td",{className:"p-2 text-center print:p-1",children:[m.quantity.toLocaleString()," ",((S=m.products)==null?void 0:S.unit)||A]})]},m.id)}),i.jsxs("tr",{className:"border-t-2 border-black bg-gray-50 font-bold",children:[i.jsx("td",{colSpan:6,className:"border-r border-black p-2 text-right print:p-1",children:"Total Kuantitas / Total Quantity:"}),i.jsxs("td",{className:"p-2 text-center print:p-1",children:[c.toLocaleString()," ",A]})]})]})]})}),i.jsxs("div",{className:"mb-3 p-2 print:mb-2 print:p-1.5",children:[i.jsx("p",{className:"text-xs font-semibold print:text-[10px]",children:"Catatan / Notes:"}),e.notes?i.jsx("p",{className:"text-xs print:text-[10px] mt-1",children:e.notes}):i.jsx("p",{className:"text-xs print:text-[10px] mt-1",children:"Produk dikirim dalam kondisi sesuai persyaratan penyimpanan / Goods are delivered under controlled storage conditions."})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-3 print:gap-2",children:[i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Disiapkan Oleh",i.jsx("br",{}),"Prepared By"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Dikirim Oleh",i.jsx("br",{}),"Delivered By"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Farmasi",i.jsx("br",{}),"Pharmacist"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Diterima Oleh",i.jsx("br",{}),"Received By"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:((y=e.customers)==null?void 0:y.company_name)||""})]})]})]})]})]})}),i.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #challan-print-content,
          #challan-print-content * {
            visibility: visible;
          }

          #challan-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #challan-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}const Vne=e=>e?new Date(e)<new Date:!1;function Gne(){const{profile:e}=Qr(),{setCurrentPage:t,setNavigationData:r}=Bl(),[n,s]=G.useState([]),[a,o]=G.useState([]),[l,c]=G.useState([]),[A,u]=G.useState([]),[f,h]=G.useState(!0),[d,x]=G.useState(!1),[g,y]=G.useState(!1),[m,p]=G.useState(null),[b,v]=G.useState([]),[C,k]=G.useState(null),[S,I]=G.useState(null),[N,Q]=G.useState([]),[L,T]=G.useState(!1),[P,R]=G.useState(""),[z,q]=G.useState(null),[M,V]=G.useState({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),[H,se]=G.useState([]),[ce,B]=G.useState([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}]);G.useEffect(()=>{D(),K(),ae(),he(),F()},[]);const U=async Ne=>{try{let ke=oe.from("sales_orders").select(`
          id,
          so_number,
          customer_id,
          status,
          customers(company_name)
        `).in("status",["approved","stock_reserved","shortage","pending_delivery"]).eq("is_archived",!1).order("so_date",{ascending:!1});Ne&&(ke=ke.eq("customer_id",Ne));const{data:qe,error:Me}=await ke;if(Me)throw Me;se(qe||[])}catch(ke){console.error("Error loading sales orders:",ke)}},F=async()=>{try{const{data:Ne,error:ke}=await oe.from("app_settings").select("*").limit(1).maybeSingle();if(ke)throw ke;k(Ne)}catch(Ne){console.error("Error loading company settings:",Ne)}},D=async()=>{try{const{data:Ne,error:ke}=await oe.from("delivery_challans").select("*, customers(company_name, address, city, phone, pbf_license)").order("challan_date",{ascending:!1});if(ke)throw ke;s(Ne||[])}catch(Ne){console.error("Error loading challans:",Ne)}finally{h(!1)}},X=async()=>{try{const{data:Ne}=await oe.from("app_settings").select("financial_year_start").limit(1).maybeSingle();let ke=new Date().getFullYear().toString().slice(-2);Ne!=null&&Ne.financial_year_start&&(ke=new Date(Ne.financial_year_start).getFullYear().toString().slice(-2));const qe="DO",{data:Me}=await oe.from("delivery_challans").select("challan_number").or(`challan_number.like.DO-${ke}%,challan_number.like.DC-${ke}%`);let Ve=1;if(Me&&Me.length>0){const xt=Me.map(st=>{const pt=st.challan_number.match(/(\d+)$/);return pt?parseInt(pt[1],10):0}).filter(st=>!isNaN(st));xt.length>0&&(Ve=Math.max(...xt)+1)}const Et=String(Ve).padStart(4,"0");return`${qe}-${ke}-${Et}`}catch(Ne){return console.error("Error generating challan number:",Ne),"DO-25-0001"}},K=async()=>{try{const{data:Ne,error:ke}=await oe.from("customers").select("id, company_name, address, city").eq("is_active",!0).order("company_name");if(ke)throw ke;o(Ne||[])}catch(Ne){console.error("Error loading customers:",Ne)}},ae=async()=>{try{const{data:Ne,error:ke}=await oe.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(ke)throw ke;c(Ne||[])}catch(Ne){console.error("Error loading products:",Ne)}},he=async()=>{try{const{data:Ne,error:ke}=await oe.from("batches").select("id, batch_number, product_id, current_stock, expiry_date, packaging_details, import_date").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!0});if(ke)throw ke;u(Ne||[])}catch(Ne){console.error("Error loading batches:",Ne)}},Y=async Ne=>{try{const{data:ke,error:qe}=await oe.from("delivery_challan_items").select("*, products(product_name, product_code, unit), batches(batch_number, expiry_date, packaging_details, current_stock)").eq("challan_id",Ne);if(qe)throw qe;return ke||[]}catch(ke){return console.error("Error loading challan items:",ke),[]}},Be=Ne=>A.filter(qe=>qe.product_id===Ne&&!Vne(qe.expiry_date)).sort((qe,Me)=>{const Ve=new Date(qe.import_date).getTime(),Et=new Date(Me.import_date).getTime();return Ve-Et})[0]||null,ee=Ne=>{const ke=a.find(qe=>qe.id===Ne);ke&&(V({...M,customer_id:Ne,sales_order_id:"",delivery_address:`${ke.address}, ${ke.city}`}),U(Ne))},Te=async Ne=>{if(V({...M,sales_order_id:Ne}),Ne){const ke=H.find(qe=>qe.id===Ne);if(ke){V(qe=>({...qe,customer_id:ke.customer_id}));try{const{data:qe,error:Me}=await oe.from("sales_order_items").select(`
              id,
              product_id,
              quantity,
              products(product_name)
            `).eq("sales_order_id",Ne);if(Me)throw Me;if(qe&&qe.length>0){const Ve=qe.map(Et=>{const xt=A.filter(kt=>kt.product_id===Et.product_id&&kt.current_stock>0),st=xt.length>0?xt[0]:null;if(!st)return{product_id:Et.product_id,batch_id:"",quantity:Et.quantity,pack_size:null,pack_type:null,number_of_packs:null};let pt=null,It=null,ut=null;if(st.packaging_details){const kt=st.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);kt&&(ut=parseInt(kt[1],10),It=kt[2].toLowerCase(),pt=parseFloat(kt[3]))}return{product_id:Et.product_id,batch_id:st.id,quantity:Et.quantity,pack_size:pt,pack_type:It,number_of_packs:ut||1}});B(Ve)}}catch(qe){console.error("Error loading SO items:",qe),alert("Failed to load Sales Order items. Please try again.")}}}else B([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},Je=(Ne,ke)=>{const qe=A.find(Me=>Me.id===ke);if(qe){const Me=[...ce];let Ve=null,Et=null,xt=null;if(qe.packaging_details){const st=qe.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);st&&(xt=parseInt(st[1],10),Et=st[2].toLowerCase(),Ve=parseFloat(st[3]))}Me[Ne]={...Me[Ne],batch_id:ke,pack_size:Ve,pack_type:Et,number_of_packs:xt||1,quantity:Ve&&xt?Ve*xt:0},B(Me)}},ie=(Ne,ke)=>{const qe=[...ce],Me=qe[Ne];Me.pack_size&&(qe[Ne]={...Me,number_of_packs:ke,quantity:Me.pack_size*ke},B(qe))},$e=()=>{B([...ce,{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},ze=Ne=>{ce.length>1&&B(ce.filter((ke,qe)=>qe!==Ne))},Fe=async Ne=>{I(Ne),V({challan_number:Ne.challan_number,customer_id:Ne.customer_id,challan_date:Ne.challan_date,delivery_address:Ne.delivery_address,vehicle_number:Ne.vehicle_number||"",driver_name:Ne.driver_name||"",notes:Ne.notes||""});const ke=await Y(Ne.id);Q(ke),ke.length>0&&B(ke.map(qe=>({product_id:qe.product_id,batch_id:qe.batch_id,quantity:qe.quantity,pack_size:qe.pack_size,pack_type:qe.pack_type,number_of_packs:qe.number_of_packs}))),x(!0)},Re=async Ne=>{if(Ne.preventDefault(),ce.filter(Me=>!Me.product_id||!Me.batch_id||Me.quantity<=0).length>0){alert("Please select product, batch, and enter quantity for all items before saving.");return}if(ce.filter(Me=>Me.batch_id==="").length>0){alert("Some items do not have a batch selected. Please select a batch for all items.");return}try{const{data:{user:Me}}=await oe.auth.getUser();if(!Me)throw new Error("Not authenticated");const Ve={challan_number:M.challan_number,customer_id:M.customer_id,sales_order_id:M.sales_order_id||null,challan_date:M.challan_date,delivery_address:M.delivery_address,vehicle_number:M.vehicle_number||null,driver_name:M.driver_name||null,notes:M.notes||null,approval_status:"pending_approval",created_by:Me.id};let Et;if(S){const pt=[];for(const yt of N)pt.push({batch_id:yt.batch_id,adjustment:yt.quantity});for(const yt of ce){const Ct=pt.find(er=>er.batch_id===yt.batch_id);Ct?Ct.adjustment-=yt.quantity:pt.push({batch_id:yt.batch_id,adjustment:-yt.quantity})}for(const yt of pt)if(yt.adjustment!==0){const{error:Ct}=await oe.rpc("update_batch_stock",{p_batch_id:yt.batch_id,p_adjustment:yt.adjustment});if(Ct){const{data:er}=await oe.from("batches").select("current_stock").eq("id",yt.batch_id).single();if(er){const Wt=er.current_stock+yt.adjustment;await oe.from("batches").update({current_stock:Wt}).eq("id",yt.batch_id)}}}const{data:It,error:ut}=await oe.from("delivery_challans").update(Ve).eq("id",S.id).select().single();if(ut)throw ut;const{error:kt}=await oe.from("delivery_challan_items").delete().eq("challan_id",S.id);if(kt)throw kt;Et=It.id}else{const{data:pt,error:It}=await oe.from("delivery_challans").insert([Ve]).select().single();if(It)throw It;Et=pt.id;for(const ut of ce)if(M.sales_order_id){const{error:kt}=await oe.rpc("fn_deduct_stock_and_release_reservation",{p_so_id:M.sales_order_id,p_batch_id:ut.batch_id,p_product_id:ut.product_id,p_quantity:ut.quantity,p_user_id:Me.id});kt&&console.error("Error releasing reservation:",kt)}if(M.sales_order_id){const{data:ut}=await oe.from("sales_order_items").select("id, product_id, quantity, delivered_quantity").eq("sales_order_id",M.sales_order_id);if(ut){let kt=!0;for(const Ct of ut){const er=ce.find(St=>St.product_id===Ct.product_id),Wt=(Ct.delivered_quantity||0)+((er==null?void 0:er.quantity)||0);await oe.from("sales_order_items").update({delivered_quantity:Wt}).eq("id",Ct.id),Wt<Ct.quantity&&(kt=!1)}const yt=kt?"delivered":"partially_delivered";await oe.from("sales_orders").update({status:yt,is_archived:kt,archived_at:kt?new Date().toISOString():null,archived_by:kt?Me.id:null,archive_reason:kt?"Delivery Challan created and all items delivered":null}).eq("id",M.sales_order_id)}}}const xt=ce.map(pt=>({challan_id:Et,product_id:pt.product_id,batch_id:pt.batch_id,quantity:pt.quantity,pack_size:pt.pack_size,pack_type:pt.pack_type,number_of_packs:pt.number_of_packs})),{error:st}=await oe.from("delivery_challan_items").insert(xt);if(st)throw st;x(!1),Le(),D(),he(),alert(`Delivery Challan ${S?"updated":"created"} successfully!`)}catch(Me){console.error("Error saving challan:",Me);const Ve=(Me==null?void 0:Me.message)||"Unknown error occurred";Ve.includes("batch_id")?alert("Error: Invalid batch selection. Please ensure all items have a valid batch selected."):Ve.includes("foreign key")?alert("Error: Invalid product or batch selection. Please check your selections."):alert(`Failed to save challan: ${Ve}`)}},at=async Ne=>{if(confirm("Are you sure you want to delete this delivery challan? This will revert the linked Sales Order status."))try{const{data:ke}=await oe.from("delivery_challans").select("sales_order_id, id").eq("id",Ne).single(),{error:qe}=await oe.from("delivery_challans").delete().eq("id",Ne);if(qe)throw qe;ke!=null&&ke.sales_order_id&&await oe.from("sales_orders").update({status:"pending_delivery",is_archived:!1,archived_at:null,archived_by:null,archive_reason:null}).eq("id",ke.sales_order_id),D(),alert("Delivery Challan deleted successfully. Sales Order status has been reverted.")}catch(ke){console.error("Error deleting challan:",ke),alert("Failed to delete challan. Please try again.")}},we=async Ne=>{if(confirm("Approve this Delivery Challan? It will be available for invoice creation."))try{const{data:{user:ke}}=await oe.auth.getUser();if(!ke)throw new Error("Not authenticated");const{error:qe}=await oe.from("delivery_challans").update({approval_status:"approved",approved_by:ke.id,approved_at:new Date().toISOString()}).eq("id",Ne);if(qe)throw qe;alert("Delivery Challan approved successfully!"),D()}catch(ke){console.error("Error approving challan:",ke.message),alert("Failed to approve challan")}},ve=async()=>{if(!z||!P.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:Ne}}=await oe.auth.getUser();if(!Ne)throw new Error("Not authenticated");const{error:ke}=await oe.from("delivery_challans").update({approval_status:"rejected",rejected_by:Ne.id,rejected_at:new Date().toISOString(),rejection_reason:P}).eq("id",z);if(ke)throw ke;alert("Delivery Challan rejected"),T(!1),R(""),q(null),D()}catch(Ne){console.error("Error rejecting challan:",Ne.message),alert("Failed to reject challan")}},Le=()=>{I(null),Q([]),V({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),B([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},tt=[{key:"challan_number",label:"DO Number"},{key:"customer",label:"Customer",render:Ne=>{var ke;return i.jsx("div",{className:"font-medium",children:(ke=Ne.customers)==null?void 0:ke.company_name})}},{key:"challan_date",label:"Date",render:Ne=>new Date(Ne.challan_date).toLocaleDateString()},{key:"approval_status",label:"Status / Approval",render:Ne=>{const ke={pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},qe={pending_approval:"Pending Approval",approved:"Approved",rejected:"Rejected"};return i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ke[Ne.approval_status]}`,children:qe[Ne.approval_status]}),Ne.approval_status==="pending_approval"&&(e==null?void 0:e.role)==="admin"&&i.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[i.jsx("button",{onClick:Me=>{Me.stopPropagation(),we(Ne.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Delivery Challan",children:i.jsx(pa,{className:"w-6 h-6 text-green-600"})}),i.jsx("button",{onClick:Me=>{Me.stopPropagation(),q(Ne.id),T(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Delivery Challan",children:i.jsx(zs,{className:"w-6 h-6 text-red-600"})})]}),Ne.approval_status==="approved"&&i.jsx(pa,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),Ne.approval_status==="rejected"&&i.jsx(zs,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}}],lt=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="accounts"||(e==null?void 0:e.role)==="sales"||(e==null?void 0:e.role)==="warehouse",it={total:n.length};return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Delivery Challan (Surat Jalan)"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage delivery orders and dispatch records"})]}),lt&&i.jsxs("button",{onClick:async()=>{Le();const Ne=await X();V(ke=>({...ke,challan_number:Ne})),x(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Create Delivery Challan"]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Delivery Challans"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:it.total})]}),i.jsx(ja,{columns:tt,data:n,loading:f,actions:Ne=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:async()=>{const ke=await Y(Ne.id);p(Ne),v(ke),y(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Challan",children:i.jsx(oh,{className:"w-4 h-4"})}),lt&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:async()=>{const ke=await Y(Ne.id);r({sourceType:"delivery_challan",customerId:Ne.customer_id,challanNumber:Ne.challan_number,challanId:Ne.id,items:ke}),t("sales")},className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Create Invoice from DO",children:i.jsx(Nr,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>Fe(Ne),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Challan",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>at(Ne.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Challan",children:i.jsx(ks,{className:"w-4 h-4"})})]})]})}),i.jsx(fr,{isOpen:d,onClose:()=>{x(!1),Le()},title:S?`Edit DC - ${M.challan_number}`:`Create DC - ${M.challan_number}`,size:"xl",children:i.jsxs("form",{onSubmit:Re,className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),i.jsxs("select",{value:M.customer_id,onChange:Ne=>ee(Ne.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!M.sales_order_id,children:[i.jsx("option",{value:"",children:"Select Customer"}),a.map(Ne=>i.jsx("option",{value:Ne.id,children:Ne.company_name},Ne.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Linked Sales Order"}),i.jsxs("select",{value:M.sales_order_id,onChange:Ne=>Te(Ne.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",disabled:!M.customer_id,children:[i.jsx("option",{value:"",children:"No Sales Order / Manual Entry"}),H.map(Ne=>i.jsxs("option",{value:Ne.id,children:[Ne.so_number," (",Ne.status,")"]},Ne.id))]}),M.customer_id&&H.length===0&&i.jsx("p",{className:"text-xs text-orange-600 mt-1",children:" No active sales orders for this customer"}),!M.customer_id&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a customer first"})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle Number"}),i.jsx("input",{type:"text",value:M.vehicle_number,onChange:Ne=>V({...M,vehicle_number:Ne.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"B 1234 XYZ"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver Name"}),i.jsx("input",{type:"text",value:M.driver_name,onChange:Ne=>V({...M,driver_name:Ne.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Driver name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),i.jsx("input",{type:"date",value:M.challan_date,onChange:Ne=>V({...M,challan_date:Ne.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Address *"}),i.jsx("textarea",{value:M.delivery_address,onChange:Ne=>V({...M,delivery_address:Ne.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:M.notes,onChange:Ne=>V({...M,notes:Ne.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Additional notes..."})]})]}),i.jsxs("div",{className:"border-t pt-3 mt-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Items to Dispatch"}),i.jsx("button",{type:"button",onClick:$e,className:"text-sm px-3 py-1 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg font-medium transition-colors",children:"+ Add Item"})]}),i.jsx("div",{className:"space-y-2",children:ce.map((Ne,ke)=>{const qe=A.filter(Ve=>Ve.product_id===Ne.product_id),Me=A.find(Ve=>Ve.id===Ne.batch_id);return i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product *"}),i.jsxs("select",{value:Ne.product_id,onChange:Ve=>{const Et=[...ce];Et[ke]={...Et[ke],product_id:Ve.target.value,batch_id:""},B(Et)},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),l.map(Ve=>i.jsx("option",{value:Ve.id,children:Ve.product_name},Ve.id))]})]}),Ne.product_id&&i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Batch *"}),qe.length>0&&i.jsx("button",{type:"button",onClick:()=>{const Ve=Be(Ne.product_id);Ve&&Je(ke,Ve.id)},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",title:"Select oldest batch (FIFO)",children:"Use FIFO"})]}),qe.length>0?i.jsxs("select",{value:Ne.batch_id,onChange:Ve=>Je(ke,Ve.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Batch"}),qe.map((Ve,Et)=>{const xt=Et===0?"  FIFO":"",st=Ve.current_stock-(Ve.reserved_stock||0);return i.jsxs("option",{value:Ve.id,children:[Ve.batch_number," (Total: ",Ve.current_stock,"kg, Available: ",st,"kg)",xt]},Ve.id)})]}):i.jsxs("div",{className:"w-full px-2 py-1.5 text-sm border border-red-300 rounded bg-red-50 text-red-700 flex items-center gap-2",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"No batches available for this product"})]})]})]}),Me&&i.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded text-xs space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Batch:"}),i.jsx("span",{className:"font-medium",children:Me.batch_number})]}),Me.expiry_date&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Expiry:"}),i.jsx("span",{className:"font-medium",children:new Date(Me.expiry_date).toLocaleDateString()})]}),Me.packaging_details&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Packaging:"}),i.jsx("span",{className:"font-medium",children:Me.packaging_details})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Total Stock:"}),i.jsxs("span",{className:"font-medium",children:[Me.current_stock," kg"]})]}),Me.reserved_stock>0&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Reserved:"}),i.jsxs("span",{className:"font-medium text-orange-600",children:[Me.reserved_stock," kg"]})]}),i.jsxs("div",{className:"flex justify-between border-t pt-1",children:[i.jsx("span",{className:"text-gray-600 font-semibold",children:"Available:"}),i.jsxs("span",{className:"font-bold text-green-600",children:[Me.current_stock-(Me.reserved_stock||0)," kg"]})]})]}),Ne.pack_size&&i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"No. of Packs *"}),i.jsx("input",{type:"number",value:Ne.number_of_packs||"",onChange:Ve=>ie(ke,Number(Ve.target.value)),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Pack Size"}),i.jsx("input",{type:"text",value:`${Ne.pack_size} kg`,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Total Qty"}),i.jsx("input",{type:"text",value:`${Ne.quantity} kg`,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]})]}),ce.length>1&&i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",onClick:()=>ze(ke),className:"text-xs text-red-600 hover:text-red-700",children:"Remove Item"})})]},ke)})})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t mt-3",children:[i.jsx("button",{type:"button",onClick:()=>{x(!1),Le()},className:"px-5 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:S?"Update Challan":"Create Challan"})]})]})}),g&&m&&i.jsx(qne,{challan:m,items:b,onClose:()=>y(!1),companySettings:C}),L&&i.jsx(fr,{isOpen:L,onClose:()=>{T(!1),R(""),q(null)},title:"Reject Delivery Challan",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{value:P,onChange:Ne=>R(Ne.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this delivery challan..."})]}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>{T(!1),R(""),q(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:ve,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!P.trim(),children:"Reject Challan"})]})]})})]})})}function Wne({invoice:e,items:t,onClose:r}){const n=G.useRef(null),{t:s,language:a}=Es(),o=m=>m==null?"Rp 0":`${m.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,l=m=>{const p=new Date(m),b=a==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v=p.getDate(),C=b[p.getMonth()],k=p.getFullYear();return`${v} ${C} ${k}`},c=m=>{const p=new Date(m),v=(a==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"])[p.getMonth()],C=p.getFullYear();return`${v} ${C}`},A=m=>a==="id"?u(m):f(m),u=m=>{if(m===0)return"Nol";const p=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],b=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],v=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],C=k=>{if(k===0)return"";if(k<10)return p[k];if(k>=10&&k<20)return b[k-10];if(k<100){const Q=Math.floor(k/10),L=k%10;return v[Q]+(L>0?" "+p[L]:"")}const S=Math.floor(k/100),I=k%100;return(S===1?"Seratus":p[S]+" Ratus")+(I>0?" "+C(I):"")};if(m<1e3)return C(m);if(m<1e6){const k=Math.floor(m/1e3),S=m%1e3;return(k===1?"Seribu":C(k)+" Ribu")+(S>0?" "+C(S):"")}if(m<1e9){const k=Math.floor(m/1e6),S=m%1e6,I=C(k)+" Juta",N=S>=1e3?(Math.floor(S/1e3)===1?"Seribu":C(Math.floor(S/1e3))+" Ribu")+(S%1e3>0?" "+C(S%1e3):""):S>0?C(S):"";return I+(N?" "+N:"")}return m.toString()},f=m=>{if(m===0)return"Zero";const p=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],b=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],v=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],C=k=>{if(k===0)return"";if(k<10)return p[k];if(k>=10&&k<20)return b[k-10];if(k<100){const N=Math.floor(k/10),Q=k%10;return v[N]+(Q>0?" "+p[Q]:"")}const S=Math.floor(k/100),I=k%100;return p[S]+" Hundred"+(I>0?" "+C(I):"")};if(m<1e3)return C(m);if(m<1e6){const k=Math.floor(m/1e3),S=m%1e3;return C(k)+" Thousand"+(S>0?" "+C(S):"")}if(m<1e9){const k=Math.floor(m/1e6),S=m%1e6,I=S>=1e3?C(Math.floor(S/1e3))+" Thousand"+(S%1e3>0?" "+C(S%1e3):""):S>0?C(S):"";return C(k)+" Million"+(I?" "+I:"")}return m.toString()},h=()=>{window.print()},d=async()=>{if(n.current)try{const m=await l_(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:Q=>{const L=Q.getElementById("invoice-print-content");L&&(L.style.width="210mm")}}),p=m.toDataURL("image/png",1),b=new Qt("p","mm","a4"),v=b.internal.pageSize.getWidth(),C=b.internal.pageSize.getHeight(),k=m.width,S=m.height,I=v/k,N=S*I;if(N>C){let Q=0,L=N;for(;L>0;)b.addImage(p,"PNG",0,Q,v,N),L-=C,Q-=C,L>0&&b.addPage()}else b.addImage(p,"PNG",0,0,v,N);b.save(`Invoice-${e.invoice_number}.pdf`)}catch(m){console.error("Error generating PDF:",m),alert("Failed to generate PDF. Please try again.")}},x=e.customers,g=e.payment_terms_days||30,y=()=>g===0?"Advance / Immediate":`${g} ${a==="id"?"Hari":"Days"}`;return i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[i.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:i.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[i.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[a==="id"?"Faktur":"Invoice"," ",e.invoice_number]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:h,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[i.jsx(zE,{className:"h-4 w-4"}),a==="id"?"Cetak":"Print"]}),i.jsxs("button",{onClick:d,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[i.jsx(TA,{className:"h-4 w-4"}),"PDF"]}),i.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:i.jsx(Xs,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{id:"invoice-print-content",ref:n,className:"p-8",children:[i.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[i.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:i.jsxs("g",{children:[i.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),i.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),i.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),i.jsx("div",{className:"text-right",children:i.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"INVOICE"})})]}),i.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No izin PBF"}),i.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),i.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),i.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Company Name:"}),i.jsxs("span",{className:"font-semibold",children:[" ",(x==null?void 0:x.company_name)||""]})]}),i.jsxs("div",{className:"pt-1 flex",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),i.jsxs("div",{children:[i.jsx("p",{children:(x==null?void 0:x.address)||""}),i.jsx("p",{children:(x==null?void 0:x.city)||""})]})]}),i.jsxs("div",{className:"flex pt-1",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),i.jsx("span",{children:(x==null?void 0:x.phone)||""})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),i.jsx("span",{children:(x==null?void 0:x.npwp)||""})]})]}),i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"200px"},children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Invoice No:"}),i.jsx("span",{className:"ml-2",children:e.invoice_number})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Invoice Date:"}),i.jsx("span",{className:"ml-2",children:l(e.invoice_date)})]}),i.jsxs("div",{className:"pt-1",children:[i.jsx("span",{className:"font-bold",children:"Po No:"}),i.jsx("span",{className:"ml-2",children:e.po_number||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Payment Terms:"}),i.jsx("span",{className:"ml-2",children:y()})]})]})]})}),i.jsx("div",{children:i.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),i.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Exp. Date"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Total Qty"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),i.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price (IDR)"}),i.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Sub Total (IDR)"})]})}),i.jsxs("tbody",{children:[t.map((m,p)=>{var S,I,N,Q;const b=m.quantity||0,v=m.unit_price||0,C=b*v,k=(S=m.batches)!=null&&S.expiry_date?c(m.batches.expiry_date):"-";return i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:p+1}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((I=m.products)==null?void 0:I.product_name)||"Unknown Product"}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((N=m.batches)==null?void 0:N.batch_number)||"N/A"}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:k}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:b.toLocaleString()}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((Q=m.products)==null?void 0:Q.unit)||"Kg"}),i.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:o(v)}),i.jsx("td",{className:"p-1.5 text-right print:p-1",children:o(C)})]},m.id||p)}),t.length<2&&Array.from({length:2-t.length}).map((m,p)=>i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${p}`))]})]})}),i.jsx("div",{className:"border-2 border-black border-t-0",children:i.jsxs("div",{className:"flex items-stretch",children:[i.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[i.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:a==="id"?"Amount In words:":"Amount in words:"}),i.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:["IDR ",A(Math.round(e.total_amount))," RUPIAH"]})]}),i.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[i.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"Sub Total"}),i.jsx("span",{className:"font-bold",children:o(e.subtotal)})]}),i.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),i.jsx("span",{className:"font-bold",children:o(e.tax_amount)})]}),i.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-sm print:text-xs",children:o(e.total_amount)})]})]})]})}),e.notes&&i.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:i.jsxs("p",{className:"text-xs print:text-[10px]",children:[i.jsx("span",{className:"font-bold",children:"Notes: "}),i.jsx("span",{children:e.notes})]})}),i.jsx("div",{className:"border-2 border-black border-t-0",children:i.jsxs("div",{className:"grid grid-cols-3 gap-0 text-xs print:text-[10px]",children:[i.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[i.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Bank Details:"}),i.jsxs("div",{className:"space-y-0.5 print:space-y-0",children:[i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Bank Name"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"BCA"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Branch"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"Sunter Mall, Jakarta"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account Name"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{className:"whitespace-nowrap",children:"PT. Shubham Anzen Pharma Jaya"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account No."}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"0930 2010 14 (IDR)"})]})]})]}),i.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[i.jsx("p",{className:"font-semibold mb-1",children:"Authorized By:"}),i.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:(x==null?void 0:x.company_name)||""}),i.jsxs("div",{className:"w-4/5 border-t border-black pt-1",children:["(","Signature & Full Name",")"]}),i.jsx("p",{className:"mt-2 font-semibold print:mt-1",children:"Date:"})]}),i.jsxs("div",{className:"p-3 print:p-2",children:[i.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),i.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})})]})]})}),i.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #invoice-print-content,
          #invoice-print-content * {
            visibility: visible;
          }

          #invoice-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #invoice-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function $ne(){const{t:e}=Es(),{profile:t}=Qr(),{navigationData:r,clearNavigationData:n}=Bl(),[s,a]=G.useState([]),[o,l]=G.useState([]),[c,A]=G.useState([]),[u,f]=G.useState([]),[h,d]=G.useState([]),[x,g]=G.useState(""),[y,m]=G.useState(!0),[p,b]=G.useState(!1),[v,C]=G.useState(!1),[k,S]=G.useState(null),[I,N]=G.useState(null),[Q,L]=G.useState([]),[T,P]=G.useState({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),[R,z]=G.useState([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]);G.useEffect(()=>{q(),V(),H(),se()},[]),G.useEffect(()=>{(r==null?void 0:r.sourceType)==="delivery_challan"&&(U(r),n())},[r]);const q=async()=>{try{const{data:we,error:ve}=await oe.from("sales_invoices").select("*, customers(company_name, address, city, phone, npwp, pharmacy_license, gst_vat_type)").order("invoice_date",{ascending:!1});if(ve)throw ve;const Le=await Promise.all((we||[]).map(async tt=>{const{data:lt}=await oe.rpc("get_invoice_paid_amount",{p_invoice_id:tt.id}),it=lt||0,Ne=tt.total_amount-it;return{...tt,paid_amount:it,balance_amount:Ne}}));a(Le)}catch(we){console.error("Error loading invoices:",we)}finally{m(!1)}},M=async()=>{try{const{data:we}=await oe.from("app_settings").select("invoice_prefix, invoice_start_number").maybeSingle(),ve=(we==null?void 0:we.invoice_prefix)||"SAPJ",Le=(we==null?void 0:we.invoice_start_number)||1,{data:tt}=await oe.from("sales_invoices").select("invoice_number").like("invoice_number",`${ve}%`);let lt=Le;if(tt&&tt.length>0){const Ne=tt.map(ke=>{const qe=ke.invoice_number.match(/(\d+)$/);return qe?parseInt(qe[1],10):0}).filter(ke=>!isNaN(ke));Ne.length>0&&(lt=Math.max(...Ne)+1)}const it=String(lt).padStart(3,"0");return`${ve}-${it}`}catch(we){return console.error("Error generating invoice number:",we),"SAPJ-001"}},V=async()=>{try{const{data:we,error:ve}=await oe.from("customers").select("id, company_name, gst_vat_type").eq("is_active",!0).order("company_name");if(ve)throw ve;l(we||[])}catch(we){console.error("Error loading customers:",we)}},H=async()=>{try{const{data:we,error:ve}=await oe.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(ve)throw ve;A(we||[])}catch(we){console.error("Error loading products:",we)}},se=async()=>{try{const{data:we,error:ve}=await oe.from("batches").select("id, batch_number, product_id, current_stock, import_price, duty_charges, freight_charges, other_charges, import_quantity, import_date, expiry_date").eq("is_active",!0).order("import_date",{ascending:!0});if(ve)throw ve;f(we||[])}catch(we){console.error("Error loading batches:",we)}},ce=async we=>{try{const{data:ve,error:Le}=await oe.from("delivery_challans").select("id, challan_number, challan_date, delivery_address, vehicle_number, notes").eq("customer_id",we).order("challan_date",{ascending:!1});if(Le)throw Le;const{data:tt,error:lt}=await oe.from("sales_invoices").select("linked_challan_ids").not("linked_challan_ids","is",null);if(lt)throw lt;const it=new Set;tt==null||tt.forEach(ke=>{var qe;(qe=ke.linked_challan_ids)==null||qe.forEach(Me=>it.add(Me))});const Ne=(ve==null?void 0:ve.filter(ke=>!it.has(ke.id)))||[];d(Ne)}catch(ve){console.error("Error loading pending challans:",ve),d([])}},B=async we=>{if(!we){g(""),z([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]);return}g(we);try{const ve=h.find(it=>it.id===we);if(!ve){console.error("Selected challan not found in pending challans list"),alert("Error: Selected delivery challan not found. Please refresh and try again.");return}P(it=>({...it,delivery_challan_number:ve.challan_number}));const{data:Le,error:tt}=await oe.from("delivery_challan_items").select("product_id, batch_id, quantity, products(product_name, product_code), batches(batch_number, import_price, duty_charges, freight_charges, other_charges, import_quantity)").eq("challan_id",we);if(tt)throw console.error("Database error loading challan items:",tt),tt;if(!Le||Le.length===0){console.warn("No items found for this delivery challan"),alert("This delivery challan has no items. Please add items manually.");return}const lt=[];for(const it of Le){if(!it.product_id){console.warn("Skipping item with missing product_id");continue}let Ne=0;if(it.batch_id){const ke=u.find(qe=>qe.id===it.batch_id);if(ke){const qe=(ke.import_price+ke.duty_charges+ke.freight_charges+ke.other_charges)/ke.import_quantity;Ne=Math.round(qe*1.25)}else console.warn(`Batch ${it.batch_id} not found in loaded batches`)}lt.push({product_id:it.product_id,batch_id:it.batch_id,quantity:it.quantity,unit_price:Ne,tax_rate:11,total:it.quantity*Ne*1.11})}if(lt.length===0){alert("Could not load items from delivery challan. Please add items manually.");return}z(lt)}catch(ve){console.error("Error loading challan items:",ve),alert(`Failed to load delivery challan items: ${ve.message||"Unknown error"}. Please try again or add items manually.`)}},U=async we=>{const ve=await M();P({invoice_number:ve,customer_id:we.customerId,invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:we.challanNumber,po_number:"",notes:`Created from Delivery Challan: ${we.challanNumber}`}),we.customerId&&await ce(we.customerId);const Le=we.items.map(tt=>{const lt=u.find(ke=>ke.id===tt.batch_id),Ne=(lt?(lt.import_price+lt.duty_charges+lt.freight_charges+lt.other_charges)/lt.import_quantity:0)*1.25;return{product_id:tt.product_id,batch_id:tt.batch_id,quantity:tt.quantity,unit_price:Math.round(Ne),tax_rate:11,total:0}});z(Le.map(tt=>({...tt,total:D(tt)}))),b(!0)},F=async we=>{try{const{data:ve,error:Le}=await oe.from("sales_invoice_items").select("*, products(product_name, product_code, unit), batches(batch_number, expiry_date)").eq("invoice_id",we);if(Le)throw Le;return L(ve||[]),ve||[]}catch(ve){return console.error("Error loading invoice items:",ve),[]}},D=we=>{const ve=we.quantity*we.unit_price,Le=ve*(we.tax_rate/100);return ve+Le},X=we=>{if(!we)return 0;const ve=u.find(tt=>tt.id===we);return!ve||!ve.import_quantity?0:(ve.import_price+ve.duty_charges+ve.freight_charges+ve.other_charges)/ve.import_quantity},K=(we,ve)=>ve===0?0:(we-ve)/we*100,ae=(we,ve=25)=>{const Le=X(we);return Math.round(Le*(1+ve/100))},he=(we,ve)=>{const Le=D(ve),tt=[...R];tt[we]={...ve,total:Le},z(tt)},Y=()=>{z([...R,{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])},Be=we=>{R.length>1&&z(R.filter((ve,Le)=>Le!==we))},ee=()=>{const we=R.reduce((tt,lt)=>tt+lt.quantity*lt.unit_price,0),ve=R.reduce((tt,lt)=>{const it=lt.quantity*lt.unit_price;return tt+it*(lt.tax_rate/100)},0),Le=we+ve-T.discount;return{subtotal:we,taxAmount:ve,total:Le}},Te=async we=>{we.preventDefault();try{const{data:{user:ve}}=await oe.auth.getUser();if(!ve)throw new Error("Not authenticated");const Le=ee(),tt=new Date(T.invoice_date);let lt=new Date(tt),it=30;T.payment_terms==="advance"||T.payment_terms==="50-50"?it=0:(it=parseInt(T.payment_terms),isNaN(it)||lt.setDate(lt.getDate()+it));let Ne;if(k){const{error:Me}=await oe.from("sales_invoice_items").delete().eq("invoice_id",k.id);if(Me)throw Me;const{data:Ve,error:Et}=await oe.from("sales_invoices").update({invoice_number:T.invoice_number,customer_id:T.customer_id,invoice_date:T.invoice_date,due_date:lt.toISOString().split("T")[0],discount_amount:T.discount,delivery_challan_number:T.delivery_challan_number||null,po_number:T.po_number||null,payment_terms_days:it,notes:T.notes||null,subtotal:Le.subtotal,tax_amount:Le.taxAmount,total_amount:Le.total,linked_challan_ids:x?[x]:null}).eq("id",k.id).select().single();if(Et)throw Et;Ne=Ve}else{const{data:Me,error:Ve}=await oe.from("sales_invoices").insert([{invoice_number:T.invoice_number,customer_id:T.customer_id,invoice_date:T.invoice_date,due_date:lt.toISOString().split("T")[0],discount_amount:T.discount,delivery_challan_number:T.delivery_challan_number||null,po_number:T.po_number||null,payment_terms_days:it,notes:T.notes||null,subtotal:Le.subtotal,tax_amount:Le.taxAmount,total_amount:Le.total,payment_status:"pending",created_by:ve.id,linked_challan_ids:x?[x]:null}]).select().single();if(Ve)throw Ve;Ne=Me}const ke=R.map(Me=>({invoice_id:Ne.id,product_id:Me.product_id,batch_id:Me.batch_id,quantity:Me.quantity,unit_price:Me.unit_price,tax_rate:Me.tax_rate})),{error:qe}=await oe.from("sales_invoice_items").insert(ke);if(qe)throw qe;await q(),await se(),b(!1),ze()}catch(ve){console.error("Error saving invoice:",ve),alert(`Failed to save invoice: ${ve.message||"Unknown error"}. Please check console for details.`)}},Je=async we=>{N(we),await F(we.id),C(!0)},ie=async we=>{S(we),P({invoice_number:we.invoice_number,customer_id:we.customer_id,invoice_date:we.invoice_date,payment_terms:String(we.payment_terms_days||30),discount:we.discount_amount,delivery_challan_number:we.delivery_challan_number||"",po_number:we.po_number||"",notes:we.notes||""});const ve=await F(we.id);ve.length>0&&z(ve.map(Le=>({product_id:Le.product_id,batch_id:Le.batch_id,quantity:Le.quantity,unit_price:Le.unit_price,tax_rate:Le.tax_rate,total:Le.total}))),b(!0)},$e=async we=>{if(confirm("Are you sure you want to delete this invoice?"))try{const{error:ve}=await oe.from("sales_invoices").delete().eq("id",we);if(ve)throw ve;q()}catch(ve){console.error("Error deleting invoice:",ve),alert("Failed to delete invoice. Please try again.")}},ze=()=>{S(null),g(""),d([]),P({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),z([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])},Fe=[{key:"invoice_number",label:"Invoice #"},{key:"customer",label:"Customer",render:we=>{var ve;return i.jsx("div",{className:"font-medium",children:(ve=we.customers)==null?void 0:ve.company_name})}},{key:"invoice_date",label:"Date",render:we=>new Date(we.invoice_date).toLocaleDateString()},{key:"total_amount",label:"Total Amount",render:we=>i.jsxs("span",{className:"font-medium",children:["Rp ",we.total_amount.toLocaleString("id-ID")]})},{key:"paid_amount",label:"Paid Amount",render:we=>i.jsxs("span",{className:"text-green-600 font-medium",children:["Rp ",(we.paid_amount||0).toLocaleString("id-ID")]})},{key:"balance_amount",label:"Balance",render:we=>i.jsxs("span",{className:`font-medium ${(we.balance_amount||0)===0?"text-gray-400":"text-orange-600"}`,children:["Rp ",(we.balance_amount||0).toLocaleString("id-ID")]})},{key:"payment_status",label:"Payment Status",render:we=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${we.payment_status==="paid"?"bg-green-100 text-green-800":we.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:we.payment_status==="pending"?"Unpaid":we.payment_status==="partial"?"Partially Paid":"Paid"})}],Re=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts"||(t==null?void 0:t.role)==="sales",at={total:s.length,totalRevenue:s.reduce((we,ve)=>we+ve.total_amount,0),pending:s.filter(we=>we.payment_status==="pending").length,paid:s.filter(we=>we.payment_status==="paid").length};return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Invoices"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage sales invoices and track payments"})]}),Re&&i.jsxs("button",{onClick:async()=>{ze();const we=await M();P(ve=>({...ve,invoice_number:we})),b(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Create Invoice"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Invoices"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:at.total})]}),i.jsxs("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-blue-600",children:"Total Revenue"}),i.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:["Rp ",at.totalRevenue.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-red-600",children:"Pending Payment"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:at.pending})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-green-600",children:"Paid"}),i.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:at.paid})]})]}),i.jsx(ja,{columns:Fe,data:s,loading:y,actions:Re?we=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>Je(we),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Invoice",children:i.jsx(oh,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>ie(we),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Invoice",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>$e(we.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Invoice",children:i.jsx(ks,{className:"w-4 h-4"})})]}):void 0}),i.jsx(fr,{isOpen:p,onClose:()=>{b(!1),ze()},title:k?"Edit Sales Invoice":"Create Sales Invoice",size:"xl",children:i.jsxs("form",{onSubmit:Te,className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Invoice Details"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number *"}),i.jsx("input",{type:"text",value:T.invoice_number,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",required:!0,placeholder:"INV-001",readOnly:!0,disabled:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date *"}),i.jsx("input",{type:"date",value:T.invoice_date,onChange:we=>P({...T,invoice_date:we.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{className:"border-r border-gray-200 pr-6",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Customer Information"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),i.jsxs("select",{value:T.customer_id,onChange:we=>{const ve=we.target.value;P({...T,customer_id:ve}),g(""),d([]),ve&&ce(ve)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Customer"}),o.map(we=>i.jsx("option",{value:we.id,children:we.company_name},we.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Delivery Challan (Optional)"}),i.jsxs("select",{value:x,onChange:we=>B(we.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",disabled:!T.customer_id,children:[i.jsx("option",{value:"",children:"No Delivery Challan / Manual Entry"}),h.map(we=>i.jsxs("option",{value:we.id,children:[we.challan_number," - ",new Date(we.challan_date).toLocaleDateString()]},we.id))]}),T.customer_id&&h.length===0&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No pending delivery challans for this customer"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:T.notes,onChange:we=>P({...T,notes:we.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional notes for invoice"})]})]})]}),i.jsxs("div",{className:"pl-6",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Payment Terms"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms *"}),i.jsxs("select",{value:T.payment_terms,onChange:we=>P({...T,payment_terms:we.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"0",children:"Immediate"}),i.jsx("option",{value:"15",children:"15 Days"}),i.jsx("option",{value:"30",children:"30 Days"}),i.jsx("option",{value:"45",children:"45 Days"}),i.jsx("option",{value:"60",children:"60 Days"}),i.jsx("option",{value:"advance",children:"Advance"}),i.jsx("option",{value:"50-50",children:"50% Adv & 50% on Delivery"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Number"}),i.jsx("input",{type:"text",value:T.po_number,onChange:we=>P({...T,po_number:we.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Customer PO Number"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount (Rp)"}),i.jsx("input",{type:"number",value:T.discount===0?"":T.discount,onChange:we=>P({...T,discount:we.target.value===""?0:Number(we.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",placeholder:"0"})]})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Line Items"}),i.jsx("button",{type:"button",onClick:Y,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Item"})]}),i.jsx("div",{className:"space-y-3",children:R.map((we,ve)=>{var Ne;const Le=u.filter(ke=>ke.product_id===we.product_id),tt=X(we.batch_id),lt=K(we.unit_price,tt),it=ae(we.batch_id);return i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[i.jsxs("div",{className:"col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product *"}),i.jsxs("select",{value:we.product_id,onChange:ke=>he(ve,{...we,product_id:ke.target.value,batch_id:null}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),c.map(ke=>i.jsx("option",{value:ke.id,children:ke.product_name},ke.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Batch"}),i.jsxs("select",{value:we.batch_id||"",onChange:ke=>{const qe=ke.target.value||null,Me=ae(qe);he(ve,{...we,batch_id:qe,unit_price:Me})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",disabled:!we.product_id||x!=="",children:[i.jsx("option",{value:"",children:"Select Batch"}),Le.filter(ke=>ke.current_stock>0).map(ke=>i.jsxs("option",{value:ke.id,children:[ke.batch_number," (",ke.current_stock," stock)"]},ke.id)),we.batch_id&&Le.find(ke=>ke.id===we.batch_id&&ke.current_stock===0)&&i.jsxs("option",{value:we.batch_id,children:[(Ne=Le.find(ke=>ke.id===we.batch_id))==null?void 0:Ne.batch_number," (from challan)"]},we.batch_id)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Quantity *"}),i.jsx("input",{type:"number",value:we.quantity===0?"":we.quantity,onChange:ke=>he(ve,{...we,quantity:ke.target.value===""?1:Number(ke.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"1",placeholder:"1"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price *"}),i.jsx("input",{type:"number",value:we.unit_price===0?"":we.unit_price,onChange:ke=>he(ve,{...we,unit_price:ke.target.value===""?0:Number(ke.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"0",placeholder:"0"})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Tax %"}),i.jsx("input",{type:"number",value:we.tax_rate===0?"":we.tax_rate,onChange:ke=>he(ve,{...we,tax_rate:ke.target.value===""?0:Number(ke.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"0",placeholder:"11"})]}),i.jsxs("div",{className:"col-span-2 flex items-end gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Total"}),i.jsx("input",{type:"text",value:(we.total||0).toFixed(2),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]}),R.length>1&&i.jsx("button",{type:"button",onClick:()=>Be(ve),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove Item",children:i.jsx(ks,{className:"w-4 h-4"})})]})]}),we.batch_id&&tt>0&&i.jsxs("div",{className:"flex items-center gap-4 text-xs p-2 bg-white rounded border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Cost/Unit:"}),i.jsxs("span",{className:"font-semibold text-gray-900",children:["Rp ",tt.toLocaleString("id-ID",{maximumFractionDigits:0})]})]}),i.jsx("div",{className:"h-4 w-px bg-gray-300"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Suggested Price (25%):"}),i.jsxs("span",{className:"font-semibold text-blue-600",children:["Rp ",it.toLocaleString("id-ID")]})]}),i.jsx("div",{className:"h-4 w-px bg-gray-300"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Current Margin:"}),i.jsxs("span",{className:`font-semibold ${lt>=20?"text-green-600":lt>=10?"text-yellow-600":"text-red-600"}`,children:[lt.toFixed(1),"%"]})]}),i.jsx("div",{className:"h-4 w-px bg-gray-300"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Profit/Unit:"}),i.jsxs("span",{className:`font-semibold ${we.unit_price>tt?"text-green-600":"text-red-600"}`,children:["Rp ",(we.unit_price-tt).toLocaleString("id-ID",{maximumFractionDigits:0})]})]})]})]},ve)})}),i.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{className:"font-medium",children:["Rp ",ee().subtotal.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Tax:"}),i.jsxs("span",{className:"font-medium",children:["Rp ",ee().taxAmount.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Discount:"}),i.jsxs("span",{className:"font-medium",children:["-Rp ",T.discount.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between text-base font-bold border-t pt-2",children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{className:"text-blue-600",children:["Rp ",ee().total.toLocaleString("id-ID")]})]})]})})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{b(!1),ze()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Create Invoice"})]})]})}),v&&I&&i.jsx(Wne,{invoice:I,items:Q,onClose:()=>{C(!1),N(null),L([])}})]})})}function zne({canManage:e}){const[t,r]=G.useState([]),[n,s]=G.useState(!0),[a,o]=G.useState(!1),[l,c]=G.useState(null),[A,u]=G.useState({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0});G.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:y,error:m}=await oe.from("bank_accounts").select("*").order("created_at",{ascending:!1});if(m)throw m;r(y||[])}catch(y){console.error("Error loading bank accounts:",y)}finally{s(!1)}},h=async y=>{y.preventDefault();try{const{data:{user:m}}=await oe.auth.getUser();if(!m)throw new Error("Not authenticated");if(l){const{error:p}=await oe.from("bank_accounts").update(A).eq("id",l.id);if(p)throw p}else{const{error:p}=await oe.from("bank_accounts").insert([{...A,current_balance:A.opening_balance,created_by:m.id}]);if(p)throw p}o(!1),x(),f()}catch(m){console.error("Error saving bank account:",m),alert(`Failed to save bank account: ${m.message}`)}},d=y=>{c(y),u({account_name:y.account_name,bank_name:y.bank_name,account_number:y.account_number,account_type:y.account_type,currency:y.currency,opening_balance:y.opening_balance}),o(!0)},x=()=>{c(null),u({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0})},g=[{key:"account_name",label:"Account Name"},{key:"bank_name",label:"Bank"},{key:"account_number",label:"Account #"},{key:"type",label:"Type",render:y=>i.jsx("span",{className:"capitalize",children:y.account_type})},{key:"balance",label:"Balance",render:y=>i.jsxs("span",{className:"font-semibold",children:["Rp ",y.current_balance.toLocaleString("id-ID")]})},{key:"status",label:"Status",render:y=>i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:y.is_active?"Active":"Inactive"})}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold",children:"Bank Accounts"}),e&&i.jsxs("button",{onClick:()=>{x(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Add Bank Account"]})]}),i.jsx(ja,{columns:g,data:t,loading:n,actions:e?y=>i.jsx("button",{onClick:()=>d(y),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(so,{className:"w-4 h-4"})}):void 0}),i.jsx(fr,{isOpen:a,onClose:()=>{o(!1),x()},title:l?"Edit Bank Account":"Add Bank Account",children:i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name *"}),i.jsx("input",{type:"text",value:A.account_name,onChange:y=>u({...A,account_name:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name *"}),i.jsx("input",{type:"text",value:A.bank_name,onChange:y=>u({...A,bank_name:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number *"}),i.jsx("input",{type:"text",value:A.account_number,onChange:y=>u({...A,account_number:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type *"}),i.jsxs("select",{value:A.account_type,onChange:y=>u({...A,account_type:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"savings",children:"Savings"}),i.jsx("option",{value:"current",children:"Current"}),i.jsx("option",{value:"credit_card",children:"Credit Card"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),i.jsxs("select",{value:A.currency,onChange:y=>u({...A,currency:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"IDR",children:"IDR (Indonesian Rupiah)"}),i.jsx("option",{value:"USD",children:"USD (US Dollar)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance *"}),i.jsx("input",{type:"number",value:A.opening_balance===0?"":A.opening_balance,onChange:y=>u({...A,opening_balance:y.target.value===""?0:Number(y.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,step:"0.01"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{o(!1),x()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Add"," Account"]})]})]})})]})}function Xne({canManage:e}){var T;const{navigateTo:t}=Bl(),[r,n]=G.useState("invoices"),[s,a]=G.useState([]),[o,l]=G.useState([]),[c,A]=G.useState([]),[u,f]=G.useState(!0),[h,d]=G.useState(!1),[x,g]=G.useState(null),[y,m]=G.useState([]),[p,b]=G.useState({}),[v,C]=G.useState({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""});G.useEffect(()=>{k()},[r]);const k=async()=>{try{const[P,R,z]=await Promise.all([oe.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]).order("due_date",{ascending:!0}),oe.from("customer_payments").select("*, customers(company_name), sales_invoices(invoice_number), bank_accounts(account_name)").order("payment_date",{ascending:!1}).limit(50),oe.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name")]);if(P.error)throw P.error;if(R.error)throw R.error;if(z.error)throw z.error;const q=await Promise.all((P.data||[]).map(async M=>{const{data:V}=await oe.rpc("get_invoice_paid_amount",{p_invoice_id:M.id});return{...M,paid_amount:V||0}}));a(q),l(R.data||[]),A(z.data||[])}catch(P){console.error("Error loading data:",P)}finally{f(!1)}},S=async P=>{g(P);const R=P.total_amount-(P.paid_amount||0);C({...v,payment_number:`PAY-${Date.now()}`,amount:R});try{const{data:z,error:q}=await oe.from("sales_invoices").select("*").eq("customer_id",P.customer_id).in("payment_status",["pending","partial"]).order("invoice_date",{ascending:!0});if(q)throw q;const M=await Promise.all((z||[]).map(async V=>{const{data:H}=await oe.rpc("get_invoice_paid_amount",{p_invoice_id:V.id});return{...V,paid_amount:H||0}}));m(M),b({[P.id]:R})}catch(z){console.error("Error loading customer invoices:",z)}d(!0)},I=async P=>{if(P.preventDefault(),!x)return;const R=Object.values(p).reduce((z,q)=>z+q,0);if(R>v.amount){alert("Total allocated amount cannot exceed payment amount");return}if(R===0){alert("Please allocate the payment to at least one invoice");return}try{const{data:{user:z}}=await oe.auth.getUser();if(!z)throw new Error("Not authenticated");const{data:q,error:M}=await oe.from("customer_payments").insert([{payment_number:v.payment_number,customer_id:x.customer_id,invoice_id:null,payment_date:v.payment_date,amount:v.amount,payment_method:v.payment_method,bank_account_id:v.bank_account_id||null,reference_number:v.reference_number||null,notes:v.notes||null,created_by:z.id}]).select().single();if(M)throw M;const V=Object.entries(p).filter(([se,ce])=>ce>0).map(([se,ce])=>({invoice_id:se,payment_id:q.id,allocated_amount:ce,created_by:z.id})),{error:H}=await oe.from("invoice_payment_allocations").insert(V);if(H)throw H;d(!1),g(null),m([]),b({}),N(),k(),alert("Payment recorded and allocated successfully!")}catch(z){console.error("Error recording payment:",z),alert(`Failed to record payment: ${z.message}`)}},N=()=>{C({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},Q=[{key:"invoice_number",label:"Invoice #",render:P=>i.jsx("button",{onClick:()=>t("sales"),className:"text-blue-600 hover:underline font-medium",children:P.invoice_number})},{key:"customer",label:"Customer",render:P=>{var R;return((R=P.customers)==null?void 0:R.company_name)||"N/A"}},{key:"invoice_date",label:"Date",render:P=>new Date(P.invoice_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:P=>{const R=new Date(P.due_date),q=R<new Date&&P.payment_status!=="paid";return i.jsx("span",{className:q?"text-red-600 font-semibold":"",children:R.toLocaleDateString()})}},{key:"total_amount",label:"Amount",render:P=>`Rp ${P.total_amount.toLocaleString("id-ID")}`},{key:"paid",label:"Paid",render:P=>i.jsxs("span",{className:"text-green-600",children:["Rp ",(P.paid_amount||0).toLocaleString("id-ID")]})},{key:"balance",label:"Balance",render:P=>i.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",(P.total_amount-(P.paid_amount||0)).toLocaleString("id-ID")]})},{key:"status",label:"Status",render:P=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${P.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:P.payment_status})}],L=[{key:"payment_number",label:"Payment #",render:P=>P.payment_number},{key:"payment_date",label:"Date",render:P=>new Date(P.payment_date).toLocaleDateString()},{key:"customer",label:"Customer",render:P=>{var R;return((R=P.customers)==null?void 0:R.company_name)||"N/A"}},{key:"invoice",label:"Invoice",render:P=>{var R;return((R=P.sales_invoices)==null?void 0:R.invoice_number)||"N/A"}},{key:"amount",label:"Amount",render:P=>i.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",P.amount.toLocaleString("id-ID")]})},{key:"method",label:"Method",render:P=>i.jsx("span",{className:"capitalize",children:P.payment_method.replace("_"," ")})},{key:"bank",label:"Bank Account",render:P=>{var R;return((R=P.bank_accounts)==null?void 0:R.account_name)||"Cash"}}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>n("invoices"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="invoices"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Outstanding Invoices (",s.length,")"]}),i.jsx("button",{onClick:()=>n("payments"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Payment History"})]})}),r==="invoices"?i.jsx(i.Fragment,{children:s.length===0&&!u?i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(ao,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"text-lg font-medium",children:"All Caught Up!"}),i.jsx("p",{className:"text-sm mt-2",children:"No outstanding invoices"})]}):i.jsx(ja,{columns:Q,data:s,loading:u,actions:e?P=>i.jsx("button",{onClick:()=>S(P),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition",children:"Record Payment"}):void 0})}):i.jsx(ja,{columns:L,data:o,loading:u}),i.jsx(fr,{isOpen:h,onClose:()=>{d(!1),g(null),m([]),b({}),N()},title:"Record Customer Payment",maxWidth:"max-w-4xl",children:i.jsxs("form",{onSubmit:I,className:"space-y-4",children:[x&&i.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-medium text-lg mb-2",children:(T=x.customers)==null?void 0:T.company_name}),i.jsx("div",{className:"text-gray-600",children:"Recording payment for customer invoices"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Number *"}),i.jsx("input",{type:"text",value:v.payment_number,onChange:P=>C({...v,payment_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),i.jsx("input",{type:"date",value:v.payment_date,onChange:P=>C({...v,payment_date:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:v.amount===0?"":v.amount,onChange:P=>C({...v,amount:P.target.value===""?0:Number(P.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),i.jsxs("select",{value:v.payment_method,onChange:P=>C({...v,payment_method:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),i.jsx("option",{value:"cheque",children:"Cheque"}),i.jsx("option",{value:"credit_card",children:"Credit Card"}),i.jsx("option",{value:"other",children:"Other"})]})]}),v.payment_method!=="cash"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),i.jsxs("select",{value:v.bank_account_id,onChange:P=>C({...v,bank_account_id:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select Bank Account"}),c.map(P=>i.jsxs("option",{value:P.id,children:[P.account_name," - ",P.bank_name]},P.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),i.jsx("input",{type:"text",value:v.reference_number,onChange:P=>C({...v,reference_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Bank reference or cheque number"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:v.notes,onChange:P=>C({...v,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]})]}),y.length>0&&i.jsxs("div",{className:"border rounded-lg p-4 space-y-3 max-h-96 overflow-y-auto",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"Allocate Payment to Invoices"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Select invoices and enter amount to allocate to each"}),y.map(P=>{const R=P.total_amount-(P.paid_amount||0),z=p[P.id]!==void 0,q=p[P.id]||0;return i.jsx("div",{className:"border rounded p-3 space-y-2",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[i.jsx("input",{type:"checkbox",checked:z,onChange:M=>{if(M.target.checked)b(V=>({...V,[P.id]:Math.min(R,v.amount-Object.values(p).reduce((H,se)=>H+se,0))}));else{const V={...p};delete V[P.id],b(V)}},className:"mt-1"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium text-sm",children:P.invoice_number}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Date: ",new Date(P.invoice_date).toLocaleDateString()]}),i.jsxs("div",{className:"text-xs mt-1",children:["Total: Rp ",P.total_amount.toLocaleString("id-ID")]}),i.jsxs("div",{className:"text-xs text-orange-600 font-medium",children:["Balance: Rp ",R.toLocaleString("id-ID")]})]})]}),z&&i.jsx("div",{className:"ml-3 w-32",children:i.jsx("input",{type:"number",value:q||"",onChange:M=>{const V=parseFloat(M.target.value)||0;if(V>R){alert("Cannot allocate more than balance");return}b(H=>({...H,[P.id]:V}))},className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Amount",min:"0",max:R,step:"0.01"})})]})},P.id)}),i.jsxs("div",{className:"border-t pt-3 space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"font-medium",children:"Payment Amount:"}),i.jsxs("span",{className:"font-bold",children:["Rp ",v.amount.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Allocated:"}),i.jsxs("span",{className:Object.values(p).reduce((P,R)=>P+R,0)>v.amount?"text-red-600 font-bold":"text-green-600",children:["Rp ",Object.values(p).reduce((P,R)=>P+R,0).toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Unallocated:"}),i.jsxs("span",{className:"text-gray-600",children:["Rp ",(v.amount-Object.values(p).reduce((P,R)=>P+R,0)).toLocaleString("id-ID")]})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{d(!1),g(null),m([]),b({}),N()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",disabled:Object.values(p).reduce((P,R)=>P+R,0)===0,children:"Record Payment"})]})]})})]})}function Yne({canManage:e}){const{profile:t}=Qr(),[r,n]=G.useState("bills"),[s,a]=G.useState([]),[o,l]=G.useState([]),[c,A]=G.useState([]),[u,f]=G.useState(!0),[h,d]=G.useState(!1),[x,g]=G.useState(!1),[y,m]=G.useState(null),[p,b]=G.useState(null),[v,C]=G.useState({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""}),[k,S]=G.useState({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""});G.useEffect(()=>{I()},[]);const I=async()=>{f(!0),await Promise.all([N(),Q(),L()]),f(!1)},N=async()=>{try{const{data:Y,error:Be}=await oe.from("vendor_bills").select("*").order("bill_date",{ascending:!1});if(Be)throw Be;a(Y||[])}catch(Y){console.error("Error loading bills:",Y)}},Q=async()=>{try{const{data:Y,error:Be}=await oe.from("vendor_payments").select(`
          *,
          vendor_bills (
            bill_number,
            vendor_name
          ),
          bank_accounts (
            account_name,
            bank_name
          )
        `).order("payment_date",{ascending:!1});if(Be)throw Be;l(Y||[])}catch(Y){console.error("Error loading payments:",Y)}},L=async()=>{try{const{data:Y,error:Be}=await oe.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name");if(Be)throw Be;A(Y||[])}catch(Y){console.error("Error loading bank accounts:",Y)}},T=async()=>{const Y="BILL",Be=new Date().getFullYear(),{data:ee}=await oe.from("vendor_bills").select("bill_number").like("bill_number",`${Y}-${Be}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(ee!=null&&ee.bill_number){const Te=parseInt(ee.bill_number.split("-")[2]);return`${Y}-${Be}-${String(Te+1).padStart(5,"0")}`}return`${Y}-${Be}-00001`},P=async()=>{const Y="VPAY",Be=new Date().getFullYear(),{data:ee}=await oe.from("vendor_payments").select("payment_number").like("payment_number",`${Y}-${Be}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(ee!=null&&ee.payment_number){const Te=parseInt(ee.payment_number.split("-")[2]);return`${Y}-${Be}-${String(Te+1).padStart(5,"0")}`}return`${Y}-${Be}-00001`},R=async Y=>{Y.preventDefault();try{const{data:{user:Be}}=await oe.auth.getUser();if(!Be)throw new Error("Not authenticated");const ee=v.amount+v.tax_amount;if(y){const{error:Te}=await oe.from("vendor_bills").update({vendor_name:v.vendor_name,vendor_id:v.vendor_id||null,bill_date:v.bill_date,due_date:v.due_date||null,amount:v.amount,tax_amount:v.tax_amount,total_amount:ee,category:v.category,description:v.description||null}).eq("id",y.id);if(Te)throw Te}else{const Te=await T(),{error:Je}=await oe.from("vendor_bills").insert([{bill_number:Te,vendor_name:v.vendor_name,vendor_id:v.vendor_id||null,bill_date:v.bill_date,due_date:v.due_date||null,amount:v.amount,tax_amount:v.tax_amount,total_amount:ee,category:v.category,description:v.description||null,created_by:Be.id}]);if(Je)throw Je}d(!1),se(),N()}catch(Be){console.error("Error saving bill:",Be),alert("Failed to save bill. Please try again.")}},z=async Y=>{Y.preventDefault();try{const{data:{user:Be}}=await oe.auth.getUser();if(!Be)throw new Error("Not authenticated");if(p){const{error:ee}=await oe.from("vendor_payments").update({payment_date:k.payment_date,amount:k.amount,payment_method:k.payment_method,bank_account_id:k.bank_account_id||null,reference_number:k.reference_number||null,notes:k.notes||null}).eq("id",p.id);if(ee)throw ee}else{const ee=await P(),{error:Te}=await oe.from("vendor_payments").insert([{payment_number:ee,bill_id:k.bill_id,payment_date:k.payment_date,amount:k.amount,payment_method:k.payment_method,bank_account_id:k.bank_account_id||null,reference_number:k.reference_number||null,notes:k.notes||null,created_by:Be.id}]);if(Te)throw Te}g(!1),ce(),Q(),N()}catch(Be){console.error("Error saving payment:",Be),alert("Failed to save payment. Please try again.")}},q=Y=>{m(Y),C({bill_number:Y.bill_number,vendor_name:Y.vendor_name,vendor_id:Y.vendor_id||"",bill_date:Y.bill_date,due_date:Y.due_date||"",amount:Y.amount,tax_amount:Y.tax_amount,category:Y.category,description:Y.description||""}),d(!0)},M=Y=>{b(Y),S({bill_id:Y.bill_id,payment_date:Y.payment_date,amount:Y.amount,payment_method:Y.payment_method,bank_account_id:Y.bank_account_id||"",reference_number:Y.reference_number||"",notes:Y.notes||""}),g(!0)},V=async Y=>{if(confirm("Are you sure you want to delete this bill?"))try{const{error:Be}=await oe.from("vendor_bills").delete().eq("id",Y);if(Be)throw Be;N()}catch(Be){console.error("Error deleting bill:",Be),alert("Failed to delete bill. Please try again.")}},H=async Y=>{if(confirm("Are you sure you want to delete this payment?"))try{const{error:Be}=await oe.from("vendor_payments").delete().eq("id",Y);if(Be)throw Be;Q(),N()}catch(Be){console.error("Error deleting payment:",Be),alert("Failed to delete payment. Please try again.")}},se=()=>{m(null),C({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""})},ce=()=>{b(null),S({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},B=Y=>{switch(Y){case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},U=Y=>Y?{inventory:"Inventory",expense:"Expense",asset:"Asset",other:"Other"}[Y]||Y:"N/A",F=Y=>({cash:"Cash",bank_transfer:"Bank Transfer",cheque:"Cheque",credit_card:"Credit Card",other:"Other"})[Y]||Y,D=s.filter(Y=>Y.payment_status!=="paid").reduce((Y,Be)=>Y+Be.total_amount,0),X=s.filter(Y=>!Y.due_date||Y.payment_status==="paid"?!1:new Date(Y.due_date)<new Date),K=[{key:"bill_number",label:"Bill Number",render:Y=>i.jsx("span",{className:"font-medium text-gray-900",children:Y.bill_number})},{key:"vendor_name",label:"Vendor",render:Y=>Y.vendor_name},{key:"bill_date",label:"Bill Date",render:Y=>new Date(Y.bill_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:Y=>{if(!Y.due_date)return"N/A";const Be=new Date(Y.due_date),ee=Be<new Date&&Y.payment_status!=="paid";return i.jsxs("span",{className:ee?"text-red-600 font-medium":"",children:[Be.toLocaleDateString(),ee&&i.jsx(Fa,{className:"w-3 h-3 inline ml-1"})]})}},{key:"category",label:"Category",render:Y=>U(Y.category)},{key:"total_amount",label:"Total Amount",render:Y=>i.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",Y.total_amount.toLocaleString("id-ID")]})},{key:"payment_status",label:"Status",render:Y=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${B(Y.payment_status)}`,children:Y.payment_status.toUpperCase()})}],ae=[{key:"payment_number",label:"Payment Number",render:Y=>i.jsx("span",{className:"font-medium text-gray-900",children:Y.payment_number})},{key:"bill",label:"Bill Number",render:Y=>{var Be;return((Be=Y.vendor_bills)==null?void 0:Be.bill_number)||"N/A"}},{key:"vendor",label:"Vendor",render:Y=>{var Be;return((Be=Y.vendor_bills)==null?void 0:Be.vendor_name)||"N/A"}},{key:"payment_date",label:"Payment Date",render:Y=>new Date(Y.payment_date).toLocaleDateString()},{key:"amount",label:"Amount",render:Y=>i.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",Y.amount.toLocaleString("id-ID")]})},{key:"payment_method",label:"Method",render:Y=>F(Y.payment_method)},{key:"bank_account",label:"Bank Account",render:Y=>Y.bank_accounts?`${Y.bank_accounts.account_name} - ${Y.bank_accounts.bank_name}`:"N/A"}],he=s.filter(Y=>Y.payment_status!=="paid");return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-red-100",children:"Total Payable"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rp ",D.toLocaleString("id-ID")]})]}),i.jsx(To,{className:"w-8 h-8 text-red-200"})]})}),i.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-orange-600",children:"Overdue Bills"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:X.length})]}),i.jsx(Fa,{className:"w-8 h-8 text-orange-400"})]})}),i.jsx("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-600",children:"Total Bills"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:s.length})]}),i.jsx(Nr,{className:"w-8 h-8 text-blue-400"})]})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>n("bills"),className:`px-4 py-2 rounded-lg transition ${r==="bills"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[i.jsx(Nr,{className:"w-4 h-4 inline mr-2"}),"Bills"]}),i.jsxs("button",{onClick:()=>n("payments"),className:`px-4 py-2 rounded-lg transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[i.jsx(To,{className:"w-4 h-4 inline mr-2"}),"Payments"]})]}),e&&i.jsxs("div",{className:"flex gap-2",children:[r==="bills"&&i.jsxs("button",{onClick:()=>{se(),d(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Add Bill"]}),r==="payments"&&i.jsxs("button",{onClick:()=>{ce(),g(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Record Payment"]})]})]}),r==="bills"?i.jsx(ja,{columns:K,data:s,loading:u,actions:e?Y=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>q(Y),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>V(Y.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(ks,{className:"w-4 h-4"})})]}):void 0}):i.jsx(ja,{columns:ae,data:o,loading:u,actions:e?Y=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>M(Y),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>H(Y.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(ks,{className:"w-4 h-4"})})]}):void 0}),i.jsx(fr,{isOpen:h,onClose:()=>{d(!1),se()},title:y?"Edit Vendor Bill":"Add Vendor Bill",children:i.jsxs("form",{onSubmit:R,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Name *"}),i.jsx("input",{type:"text",value:v.vendor_name,onChange:Y=>C({...v,vendor_name:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor ID (Optional)"}),i.jsx("input",{type:"text",value:v.vendor_id,onChange:Y=>C({...v,vendor_id:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),i.jsxs("select",{value:v.category||"",onChange:Y=>C({...v,category:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"expense",children:"Expense"}),i.jsx("option",{value:"inventory",children:"Inventory"}),i.jsx("option",{value:"asset",children:"Asset"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Date *"}),i.jsx("input",{type:"date",value:v.bill_date,onChange:Y=>C({...v,bill_date:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsx("input",{type:"date",value:v.due_date,onChange:Y=>C({...v,due_date:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:v.amount===0?"":v.amount,onChange:Y=>C({...v,amount:Y.target.value===""?0:Number(Y.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Amount (Rp)"}),i.jsx("input",{type:"number",value:v.tax_amount===0?"":v.tax_amount,onChange:Y=>C({...v,tax_amount:Y.target.value===""?0:Number(Y.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),i.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["Rp ",(v.amount+v.tax_amount).toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:v.description,onChange:Y=>C({...v,description:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{d(!1),se()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:y?"Update Bill":"Add Bill"})]})]})}),i.jsx(fr,{isOpen:x,onClose:()=>{g(!1),ce()},title:p?"Edit Payment":"Record Payment",children:i.jsxs("form",{onSubmit:z,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill *"}),i.jsxs("select",{value:k.bill_id,onChange:Y=>{const Be=Y.target.value,ee=he.find(Te=>Te.id===Be);S({...k,bill_id:Be,amount:ee?ee.total_amount:0})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!p,children:[i.jsx("option",{value:"",children:"Select a bill"}),he.map(Y=>i.jsxs("option",{value:Y.id,children:[Y.bill_number," - ",Y.vendor_name," (Rp ",Y.total_amount.toLocaleString("id-ID"),")"]},Y.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),i.jsx("input",{type:"date",value:k.payment_date,onChange:Y=>S({...k,payment_date:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:k.amount===0?"":k.amount,onChange:Y=>S({...k,amount:Y.target.value===""?0:Number(Y.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),i.jsxs("select",{value:k.payment_method,onChange:Y=>S({...k,payment_method:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"cheque",children:"Cheque"}),i.jsx("option",{value:"credit_card",children:"Credit Card"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),i.jsxs("select",{value:k.bank_account_id,onChange:Y=>S({...k,bank_account_id:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select bank account"}),c.map(Y=>i.jsxs("option",{value:Y.id,children:[Y.account_name," - ",Y.bank_name]},Y.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),i.jsx("input",{type:"text",value:k.reference_number,onChange:Y=>S({...k,reference_number:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Transaction/Check number"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:k.notes,onChange:Y=>S({...k,notes:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{g(!1),ce()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:p?"Update Payment":"Record Payment"})]})]})})]})}function Jne(){const[e,t]=G.useState([]),[r,n]=G.useState(!0),[s,a]=G.useState(new Date().toISOString().split("T")[0]);G.useEffect(()=>{o()},[s]);const o=async()=>{try{n(!0);const{data:u,error:f}=await oe.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]);if(f)throw f;const h=await Promise.all((u||[]).map(async g=>{const{data:y}=await oe.rpc("get_invoice_paid_amount",{p_invoice_id:g.id}),m=y||0,p=g.total_amount-m,b=new Date(g.due_date),v=new Date(s),C=Math.floor((v.getTime()-b.getTime())/(1e3*60*60*24));return{...g,balance:p,days_overdue:C}})),d=new Map;h.forEach(g=>{var p;const y=g.customer_id;d.has(y)||d.set(y,{customer_id:y,customer_name:((p=g.customers)==null?void 0:p.company_name)||"Unknown",total_outstanding:0,current:0,days_1_30:0,days_31_60:0,days_61_90:0,days_90_plus:0,invoice_count:0});const m=d.get(y);m.total_outstanding+=g.balance,m.invoice_count+=1,g.days_overdue<0?m.current+=g.balance:g.days_overdue<=30?m.days_1_30+=g.balance:g.days_overdue<=60?m.days_31_60+=g.balance:g.days_overdue<=90?m.days_61_90+=g.balance:m.days_90_plus+=g.balance});const x=Array.from(d.values()).sort((g,y)=>y.total_outstanding-g.total_outstanding);t(x)}catch(u){console.error("Error loading ageing data:",u),alert("Failed to load ageing report")}finally{n(!1)}},l=()=>{const u=["Customer","Total Outstanding","Current (Not Due)","1-30 Days","31-60 Days","61-90 Days","90+ Days","Invoice Count"],f=e.map(y=>[y.customer_name,y.total_outstanding,y.current,y.days_1_30,y.days_31_60,y.days_61_90,y.days_90_plus,y.invoice_count]),h=[u.join(","),...f.map(y=>y.join(","))].join(`
`),d=new Blob([h],{type:"text/csv"}),x=URL.createObjectURL(d),g=document.createElement("a");g.href=x,g.download=`ageing_report_${s}.csv`,g.click(),URL.revokeObjectURL(x)},c=e.reduce((u,f)=>({total_outstanding:u.total_outstanding+f.total_outstanding,current:u.current+f.current,days_1_30:u.days_1_30+f.days_1_30,days_31_60:u.days_31_60+f.days_31_60,days_61_90:u.days_61_90+f.days_61_90,days_90_plus:u.days_90_plus+f.days_90_plus,invoice_count:u.invoice_count+f.invoice_count}),{total_outstanding:0,current:0,days_1_30:0,days_31_60:0,days_61_90:0,days_90_plus:0,invoice_count:0}),A=c.days_1_30+c.days_31_60+c.days_61_90+c.days_90_plus;return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Accounts Receivable Ageing Report"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Track overdue invoices by ageing buckets"})]}),i.jsxs("button",{onClick:l,disabled:e.length===0,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(AO,{className:"w-4 h-4"}),"Export CSV"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Outstanding"}),i.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:["Rp ",c.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[c.invoice_count," invoices"]})]}),i.jsx(ao,{className:"w-10 h-10 text-gray-400"})]})}),i.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-6 border border-green-200",children:[i.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Current (Not Due)"}),i.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["Rp ",c.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[c.total_outstanding>0?(c.current/c.total_outstanding*100).toFixed(1):0,"% of total"]})]}),i.jsxs("div",{className:"bg-orange-50 rounded-lg shadow p-6 border border-orange-200",children:[i.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Overdue"}),i.jsxs("p",{className:"text-2xl font-bold text-orange-900 mt-1",children:["Rp ",A.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[c.total_outstanding>0?(A/c.total_outstanding*100).toFixed(1):0,"% of total"]})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-6 border border-red-200",children:[i.jsx("p",{className:"text-sm text-red-700 font-medium",children:"90+ Days Critical"}),i.jsxs("p",{className:"text-2xl font-bold text-red-900 mt-1",children:["Rp ",c.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Immediate action required"})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx(ha,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"font-medium text-gray-700",children:"As of Date:"})]}),i.jsx("input",{type:"date",value:s,onChange:u=>a(u.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsxs("span",{className:"text-sm text-gray-500",children:["Report generated as of ",new Date(s).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoices"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Outstanding"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-green-700 uppercase tracking-wider",children:"Current"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-yellow-700 uppercase tracking-wider",children:"1-30 Days"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-orange-700 uppercase tracking-wider",children:"31-60 Days"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-red-700 uppercase tracking-wider",children:"61-90 Days"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-red-900 uppercase tracking-wider",children:"90+ Days"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-3",children:"Loading ageing data..."})]})})}):e.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:[i.jsx(ao,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-lg font-medium",children:"No Outstanding Invoices"}),i.jsx("p",{className:"text-sm mt-2",children:"All invoices are fully paid!"})]})}):i.jsxs(i.Fragment,{children:[e.map(u=>i.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:u.customer_name})}),i.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-500",children:u.invoice_count}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm font-bold text-gray-900",children:["Rp ",u.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:u.current>0?i.jsxs("span",{className:"text-green-600 font-medium",children:["Rp ",u.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:u.days_1_30>0?i.jsxs("span",{className:"text-yellow-600 font-medium",children:["Rp ",u.days_1_30.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:u.days_31_60>0?i.jsxs("span",{className:"text-orange-600 font-medium",children:["Rp ",u.days_31_60.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:u.days_61_90>0?i.jsxs("span",{className:"text-red-600 font-medium",children:["Rp ",u.days_61_90.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:u.days_90_plus>0?i.jsxs("span",{className:"text-red-900 font-bold",children:["Rp ",u.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})})]},u.customer_id)),i.jsxs("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-300",children:[i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL"}),i.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:c.invoice_count}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-gray-900",children:["Rp ",c.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-green-700",children:["Rp ",c.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-yellow-700",children:["Rp ",c.days_1_30.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-orange-700",children:["Rp ",c.days_31_60.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-red-700",children:["Rp ",c.days_61_90.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-red-900",children:["Rp ",c.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})})]})})})]})})}function Zne(){const{t:e}=Es(),{profile:t}=Qr(),[r,n]=G.useState("expenses"),[s,a]=G.useState([]),[o,l]=G.useState([]),[c,A]=G.useState(!0),[u,f]=G.useState(!1),[h,d]=G.useState(null),[x,g]=G.useState("all"),[y,m]=G.useState({start:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[p,b]=G.useState({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",document_urls:[]});G.useEffect(()=>{v(),C()},[]);const v=async()=>{try{const{data:q,error:M}=await oe.from("finance_expenses").select("*, batches(batch_number)").order("expense_date",{ascending:!1}).order("created_at",{ascending:!1});if(M)throw M;a(q||[])}catch(q){console.error("Error loading expenses:",q)}finally{A(!1)}},C=async()=>{try{const{data:q,error:M}=await oe.from("batches").select("id, batch_number").eq("is_active",!0).order("import_date",{ascending:!1});if(M)throw M;l(q||[])}catch(q){console.error("Error loading batches:",q)}},k=async q=>{q.preventDefault();try{const{data:{user:M}}=await oe.auth.getUser();if(!M)throw new Error("Not authenticated");if(h){const{error:V}=await oe.from("finance_expenses").update({...p,batch_id:p.batch_id||null,description:p.description||null,document_urls:p.document_urls.length>0?p.document_urls:null}).eq("id",h.id);if(V)throw V}else{const{error:V}=await oe.from("finance_expenses").insert([{...p,batch_id:p.batch_id||null,description:p.description||null,document_urls:p.document_urls.length>0?p.document_urls:null,created_by:M.id}]);if(V)throw V}f(!1),N(),v()}catch(M){console.error("Error saving expense:",M),alert("Failed to save expense. Please try again.")}},S=q=>{d(q),b({expense_category:q.expense_category,amount:q.amount,expense_date:q.expense_date,description:q.description||"",batch_id:q.batch_id||"",document_urls:q.document_urls||[]}),f(!0)},I=async q=>{if(confirm("Are you sure you want to delete this expense?"))try{const{error:M}=await oe.from("finance_expenses").delete().eq("id",q);if(M)throw M;v()}catch(M){console.error("Error deleting expense:",M),alert("Failed to delete expense. Please try again.")}},N=()=>{d(null),b({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",document_urls:[]})},Q={duty:{label:"Duty",color:"bg-red-100 text-red-800"},freight:{label:"Freight",color:"bg-blue-100 text-blue-800"},warehouse_rent:{label:"Warehouse Rent",color:"bg-yellow-100 text-yellow-800"},utilities:{label:"Utilities",color:"bg-green-100 text-green-800"},salary:{label:"Salary",color:"bg-purple-100 text-purple-800"},other:{label:"Other",color:"bg-gray-100 text-gray-800"}},L=s.filter(q=>{const M=x==="all"||q.expense_category===x,V=new Date(q.expense_date),H=V>=new Date(y.start)&&V<=new Date(y.end);return M&&H}),T={totalExpenses:L.reduce((q,M)=>q+M.amount,0),duty:s.filter(q=>q.expense_category==="duty").reduce((q,M)=>q+M.amount,0),freight:s.filter(q=>q.expense_category==="freight").reduce((q,M)=>q+M.amount,0),operations:s.filter(q=>["warehouse_rent","utilities","salary"].includes(q.expense_category)).reduce((q,M)=>q+M.amount,0),other:s.filter(q=>q.expense_category==="other").reduce((q,M)=>q+M.amount,0)},P=[{key:"expense_date",label:"Date",render:q=>new Date(q.expense_date).toLocaleDateString()},{key:"expense_category",label:"Category",render:q=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${Q[q.expense_category].color}`,children:Q[q.expense_category].label})},{key:"amount",label:"Amount",render:q=>i.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",q.amount.toLocaleString("id-ID")]})},{key:"batch",label:"Batch",render:q=>{var M;return((M=q.batches)==null?void 0:M.batch_number)||"N/A"}},{key:"description",label:"Description",render:q=>i.jsx("span",{className:"text-sm text-gray-600",children:q.description||"-"})}],R=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts",z=[{id:"expenses",label:"Expenses",icon:vO},{id:"banks",label:"Bank Accounts",icon:cO},{id:"receivables",label:"Receivables",icon:ao},{id:"payables",label:"Payables",icon:iw},{id:"ageing",label:"Ageing Report",icon:To}];return i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Finance Management"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive financial tracking and reporting"})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:z.map(q=>{const M=q.icon,V=r===q.id;return i.jsxs("button",{onClick:()=>n(q.id),className:["flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm",V?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"].join(" "),children:[i.jsx(M,{className:"w-5 h-5"}),q.label]},q.id)})})}),i.jsxs("div",{className:"p-6",children:[r==="expenses"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:R&&i.jsxs("button",{onClick:()=>{N(),f(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition ml-auto",children:[i.jsx(Gn,{className:"w-5 h-5"}),"Add Expense"]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow p-3 md:p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:"text-xs md:text-sm text-blue-100 truncate",children:"Total Expenses"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold mt-0.5",children:["Rp ",T.totalExpenses.toLocaleString("id-ID")]})]}),i.jsx(To,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-200 flex-shrink-0 ml-2"})]})}),i.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-red-600 truncate",children:"Duty"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-red-600 mt-0.5",children:["Rp ",T.duty.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-blue-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-blue-600 truncate",children:"Freight"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-blue-600 mt-0.5",children:["Rp ",T.freight.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-yellow-600 truncate",children:"Operations"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-yellow-600 mt-0.5",children:["Rp ",T.operations.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Other"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-gray-600 mt-0.5",children:["Rp ",T.other.toLocaleString("id-ID")]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),i.jsx("input",{type:"date",value:y.start,onChange:q=>m({...y,start:q.target.value}),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),i.jsx("input",{type:"date",value:y.end,onChange:q=>m({...y,end:q.target.value}),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1.5 rounded-lg text-sm transition ${x==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),Object.entries(Q).map(([q,M])=>i.jsx("button",{onClick:()=>g(q),className:`px-3 py-1.5 rounded-lg text-sm transition ${x===q?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:M.label},q))]})]})}),i.jsx(ja,{columns:P,data:L,loading:c,actions:R?q=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>S(q),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(so,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>I(q.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(ks,{className:"w-4 h-4"})})]}):void 0}),i.jsx(fr,{isOpen:u,onClose:()=>{f(!1),N()},title:h?"Edit Expense":"Add New Expense",children:i.jsxs("form",{onSubmit:k,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expense Category *"}),i.jsx("select",{value:p.expense_category,onChange:q=>b({...p,expense_category:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:Object.entries(Q).map(([q,M])=>i.jsx("option",{value:q,children:M.label},q))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:p.amount===0?"":p.amount,onChange:q=>b({...p,amount:q.target.value===""?0:Number(q.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expense Date *"}),i.jsx("input",{type:"date",value:p.expense_date,onChange:q=>b({...p,expense_date:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Batch (Optional)"}),i.jsxs("select",{value:p.batch_id,onChange:q=>b({...p,batch_id:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"None"}),o.map(q=>i.jsx("option",{value:q.id,children:q.batch_number},q.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:p.description,onChange:q=>b({...p,description:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional details about this expense"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(jo,{className:"w-4 h-4 inline mr-1"}),"Attach Documents (Receipts, Photos, etc.)"]}),i.jsx(rF,{currentUrls:p.document_urls,onUploadComplete:q=>b({...p,document_urls:q}),folder:"expense-documents"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{f(!1),N()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:h?"Update Expense":"Add Expense"})]})]})})]}),r==="banks"&&i.jsx(zne,{canManage:R}),r==="receivables"&&i.jsx(Xne,{canManage:R}),r==="payables"&&i.jsx(Yne,{canManage:R}),r==="ageing"&&i.jsx(Jne,{})]})]})]})})}function ese(){const[e,t]=G.useState(null),[r,n]=G.useState(!0),[s,a]=G.useState(!1);G.useEffect(()=>{o();const f=setInterval(()=>{o()},5e3);return()=>clearInterval(f)},[]);const o=async()=>{try{const{data:{user:f}}=await oe.auth.getUser();if(!f)return;const{data:h,error:d}=await oe.from("gmail_connections").select("*").eq("user_id",f.id).maybeSingle();if(d&&d.code!=="PGRST116")throw d;t(h)}catch(f){console.error("Error loading Gmail connection:",f)}finally{n(!1)}},l=()=>{{alert(`Gmail integration is not configured. Please add VITE_GOOGLE_CLIENT_ID to your .env file.

Steps:
1. Go to Google Cloud Console
2. Create OAuth 2.0 credentials
3. Add the Client ID to .env file
4. Restart the dev server

See GMAIL_SETUP.md for detailed instructions.`);return}},c=async()=>{if(confirm("Are you sure you want to disconnect your Gmail account? Email syncing will stop."))try{const{data:{user:f}}=await oe.auth.getUser();if(!f)return;const{error:h}=await oe.from("gmail_connections").update({is_connected:!1,sync_enabled:!1,access_token:null,refresh_token:null}).eq("user_id",f.id);if(h)throw h;alert("Gmail account disconnected successfully"),o()}catch(f){console.error("Error disconnecting Gmail:",f),alert("Failed to disconnect Gmail account")}},A=async()=>{if(e)try{const{error:f}=await oe.from("gmail_connections").update({sync_enabled:!e.sync_enabled}).eq("id",e.id);if(f)throw f;o()}catch(f){console.error("Error toggling sync:",f),alert("Failed to update sync settings")}},u=async()=>{if(s)return;a(!0),console.log({title:"Email Sync Started",message:"Syncing emails in background. You can continue using the app."});try{const{data:{session:h}}=await oe.auth.getSession();if(!h){alert("Please sign in to sync emails"),a(!1);return}const d="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",x=new AbortController,g=setTimeout(()=>x.abort(),12e4),y=await fetch(d,{method:"POST",headers:{Authorization:`Bearer ${h.access_token}`,"Content-Type":"application/json"},signal:x.signal});if(clearTimeout(g),!y.ok){const p=await y.text();throw new Error(`Server error (${y.status}): ${p}`)}const m=await y.json();if(m.success)alert(`Email sync completed!

 Total messages found: ${m.totalMessages}
 New emails processed: ${m.processedCount}
 New inquiries: ${m.newInquiriesCount}`),o();else throw new Error(m.error||"Sync failed")}catch(h){console.error("Error syncing emails:",h),h instanceof Error&&h.name==="AbortError"?alert("Sync is taking longer than expected. It will continue in the background. Check back in a few minutes."):alert(`Failed to sync emails: ${h instanceof Error?h.message:"Unknown error"}`)}finally{a(!1)}};return r?i.jsx("div",{className:"flex justify-center items-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(XE,{className:"w-5 h-5 text-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold",children:"Gmail Integration"})]}),e!=null&&e.is_connected?i.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),i.jsx("span",{className:"text-sm font-medium text-green-700",children:"Connected"})]}):i.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg",children:[i.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),i.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Not Connected"})]})]}),e!=null&&e.is_connected?i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[i.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:i.jsx(pa,{className:"w-8 h-8 text-green-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Gmail Connected"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.email_address}),e.last_sync&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Last synced: ",new Date(e.last_sync).toLocaleString()]}),e.access_token_expires_at&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Token expires: ",new Date(e.access_token_expires_at).toLocaleString()]})]})]}),i.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition",children:[i.jsx($E,{className:"w-4 h-4"}),"Disconnect"]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:"Sync Settings"}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Automatic Email Sync"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Fetch new emails every 10 minutes"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:e.sync_enabled,onChange:A,className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),i.jsx("div",{className:"pt-4 border-t",children:i.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-medium disabled:opacity-50",children:[i.jsx(td,{className:`w-4 h-4 ${s?"animate-spin":""}`}),s?"Syncing...":"Sync Now"]})})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Fa,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-yellow-800",children:[i.jsx("p",{className:"font-medium mb-1",children:"Important Security Information"}),i.jsxs("ul",{className:"space-y-1 text-xs",children:[i.jsx("li",{children:" Your Gmail password is never stored or accessed by this app"}),i.jsx("li",{children:" Access tokens are encrypted in the database"}),i.jsx("li",{children:" You can revoke access anytime from Google Account settings"}),i.jsx("li",{children:" Only emails marked as inquiry-related are processed"})]})]})]})})]}):i.jsx("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:i.jsx($s,{className:"w-8 h-8 text-blue-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Connect Your Gmail Account"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Securely connect your Gmail account to automatically fetch pharmaceutical inquiry emails. Your password is never stored - we use Google's OAuth2 for maximum security."}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[i.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"What you'll get:"}),i.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[i.jsx("li",{children:" Automatic email fetching every 10 minutes"}),i.jsx("li",{children:" AI-powered inquiry extraction from emails"}),i.jsx("li",{children:" Send emails directly from CRM"}),i.jsx("li",{children:" Complete email activity tracking"})]})]}),i.jsxs("button",{onClick:l,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-medium",children:[i.jsx($s,{className:"w-5 h-5"}),"Connect Gmail Account"]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["By connecting, you authorize this app to read and send emails on your behalf. You can revoke access anytime from your ",i.jsx("a",{href:"https://myaccount.google.com/permissions",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Google Account settings"}),"."]})]})]})}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Fa,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-red-800",children:[i.jsx("p",{className:"font-medium mb-1",children:"Gmail Integration Not Configured"}),i.jsx("p",{children:"Gmail OAuth2 credentials are not set up. Please contact your administrator to configure the VITE_GOOGLE_CLIENT_ID environment variable. Refer to GMAIL_SETUP.md for setup instructions."})]})]})})]})}function tse({users:e,onRefresh:t}){const[r,n]=G.useState(!1),[s,a]=G.useState(!1),[o,l]=G.useState(null),[c,A]=G.useState(!1),[u,f]=G.useState({username:"",email:"",password:"",full_name:"",role:"sales"}),h=async p=>{p.preventDefault(),A(!0);try{const{data:b,error:v}=await oe.auth.signUp({email:u.email,password:u.password,options:{data:{full_name:u.full_name,email_verified:!0}}});if(v)throw v;if(!b.user)throw new Error("Failed to create user");const{error:C}=await oe.from("user_profiles").insert([{id:b.user.id,username:u.username.toLowerCase(),email:u.email,full_name:u.full_name,role:u.role,is_active:!0}]);if(C)throw C;alert(`User ${u.full_name} created successfully! Username: ${u.username}`),n(!1),f({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(b){console.error("Error creating user:",b),alert(b.message||"Failed to create user. Please try again.")}finally{A(!1)}},d=async p=>{if(p.preventDefault(),!!o){A(!0);try{const{error:b}=await oe.from("user_profiles").update({username:u.username.toLowerCase(),full_name:u.full_name,role:u.role}).eq("id",o.id);if(b)throw b;alert(`User ${u.full_name} updated successfully!`),a(!1),l(null),f({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(b){console.error("Error updating user:",b),alert(b.message||"Failed to update user. Please try again.")}finally{A(!1)}}},x=p=>{l(p),f({username:p.username,email:p.email,password:"",full_name:p.full_name,role:p.role}),a(!0)},g=async(p,b)=>{if(confirm(`Are you sure you want to ${b?"deactivate":"activate"} this user?`))try{const{error:C}=await oe.from("user_profiles").update({is_active:!b}).eq("id",p);if(C)throw C;alert(`User ${b?"deactivated":"activated"} successfully!`),t()}catch(C){console.error("Error updating user status:",C),alert("Failed to update user status.")}},y=async(p,b)=>{if(confirm(`Are you sure you want to permanently delete user "${b}"? This action cannot be undone.`))try{const{error:v}=await oe.from("user_profiles").delete().eq("id",p);if(v)throw v;alert("User deleted successfully!"),t()}catch(v){console.error("Error deleting user:",v),alert("Failed to delete user. The user may have associated records.")}},m=p=>{switch(p){case"admin":return"bg-purple-100 text-purple-800 border-purple-300";case"sales":return"bg-blue-100 text-blue-800 border-blue-300";case"accounts":return"bg-green-100 text-green-800 border-green-300";case"warehouse":return"bg-orange-100 text-orange-800 border-orange-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(Bo,{className:"w-5 h-5"}),"User Management"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage system users, roles, and access permissions"})]}),i.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[i.jsx(ow,{className:"w-4 h-4"}),"Add New User"]})]}),i.jsx("div",{className:"space-y-3",children:e.length===0?i.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx(Bo,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-600",children:"No users found"}),i.jsx("button",{onClick:()=>n(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Add your first user"})]}):e.map(p=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-md",children:i.jsx("span",{className:"text-white font-bold text-lg",children:p.full_name.charAt(0).toUpperCase()})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-900",children:p.full_name}),i.jsxs("p",{className:"text-sm text-gray-600 font-mono",children:["@",p.username]}),i.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mt-0.5",children:[i.jsx($s,{className:"w-3 h-3"}),p.email]}),i.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Created: ",new Date(p.created_at).toLocaleDateString()]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("span",{className:`px-3 py-1 border rounded-full text-xs font-medium capitalize flex items-center gap-1.5 ${m(p.role)}`,children:[i.jsx(Q1,{className:"w-3 h-3"}),p.role]}),i.jsx("button",{onClick:()=>x(p),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit user",children:i.jsx(fg,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>g(p.id,p.is_active),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition flex items-center gap-1.5 ${p.is_active?"bg-green-100 text-green-800 hover:bg-green-200 border border-green-300":"bg-red-100 text-red-800 hover:bg-red-200 border border-red-300"}`,title:p.is_active?"Click to deactivate":"Click to activate",children:p.is_active?i.jsxs(i.Fragment,{children:[i.jsx(pa,{className:"w-3.5 h-3.5"}),"Active"]}):i.jsxs(i.Fragment,{children:[i.jsx(zs,{className:"w-3.5 h-3.5"}),"Inactive"]})}),i.jsx("button",{onClick:()=>y(p.id,p.username),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete user",children:i.jsx(ks,{className:"w-4 h-4"})})]})]},p.id))}),i.jsx(fr,{isOpen:r,onClose:()=>{n(!1),f({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Add New User",children:i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-sm text-blue-800",children:"Create a new user account. The user will be able to log in with their username and password."})}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(Bo,{className:"w-4 h-4"}),"Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:u.full_name,onChange:p=>f({...u,full_name:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(Bo,{className:"w-4 h-4"}),"Username ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:u.username,onChange:p=>f({...u,username:p.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx($s,{className:"w-4 h-4"}),"Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",value:u.email,onChange:p=>f({...u,email:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"user@company.com",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For system notifications only. Login uses username."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(pO,{className:"w-4 h-4"}),"Password ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"password",value:u.password,onChange:p=>f({...u,password:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Minimum 6 characters",minLength:6,required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters. User can change this after logging in."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(Q1,{className:"w-4 h-4"}),"Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:u.role,onChange:p=>f({...u,role:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),i.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),i.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),i.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{n(!1),f({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:c,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c,children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(ow,{className:"w-4 h-4"}),"Create User"]})})]})]})}),i.jsx(fr,{isOpen:s,onClose:()=>{a(!1),l(null),f({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Edit User",children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-sm text-amber-800",children:"Editing user profile. Email cannot be changed. To reset password, user must use password reset feature."})}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(Bo,{className:"w-4 h-4"}),"Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:u.full_name,onChange:p=>f({...u,full_name:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(Bo,{className:"w-4 h-4"}),"Username ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:u.username,onChange:p=>f({...u,username:p.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx($s,{className:"w-4 h-4"}),"Email Address"]}),i.jsx("input",{type:"email",value:u.email,className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed",disabled:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(Q1,{className:"w-4 h-4"}),"Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:u.role,onChange:p=>f({...u,role:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),i.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),i.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),i.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{a(!1),l(null),f({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:c,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c,children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(fg,{className:"w-4 h-4"}),"Save Changes"]})})]})]})})]})}function rse(){const[e,t]=G.useState([]),[r,n]=G.useState(!0),[s,a]=G.useState(!1),[o,l]=G.useState(null),[c,A]=G.useState({template_name:"",subject:"",body:"",category:"custom",variables:[]}),u=[{value:"price_quote",label:"Price Quote"},{value:"coa_msds",label:"COA/MSDS"},{value:"follow_up",label:"Follow-up"},{value:"thank_you",label:"Thank You"},{value:"custom",label:"Custom"}],f=["{{contact_person}}","{{company_name}}","{{product_name}}","{{specification}}","{{quantity}}","{{supplier_name}}","{{supplier_country}}","{{inquiry_number}}","{{user_name}}"];G.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:v,error:C}=await oe.from("crm_email_templates").select("*").order("created_at",{ascending:!1});if(C)throw C;t(v||[])}catch(v){console.error("Error loading templates:",v)}finally{n(!1)}},d=async v=>{v.preventDefault();try{const{data:{user:C}}=await oe.auth.getUser();if(!C)throw new Error("Not authenticated");if(o){const{error:k}=await oe.from("crm_email_templates").update({template_name:c.template_name,subject:c.subject,body:c.body,category:c.category,variables:c.variables,updated_at:new Date().toISOString()}).eq("id",o.id);if(k)throw k;alert("Template updated successfully!")}else{const{error:k}=await oe.from("crm_email_templates").insert([{...c,created_by:C.id,is_active:!0,use_count:0}]);if(k)throw k;alert("Template created successfully!")}b(),a(!1),h()}catch(C){console.error("Error saving template:",C),alert(C.message||"Failed to save template")}},x=v=>{l(v),A({template_name:v.template_name,subject:v.subject,body:v.body,category:v.category,variables:v.variables||[]}),a(!0)},g=async v=>{try{const{data:{user:C}}=await oe.auth.getUser();if(!C)throw new Error("Not authenticated");const{error:k}=await oe.from("crm_email_templates").insert([{template_name:`${v.template_name} (Copy)`,subject:v.subject,body:v.body,category:v.category,variables:v.variables,created_by:C.id,is_active:!0,use_count:0}]);if(k)throw k;alert("Template duplicated successfully!"),h()}catch(C){console.error("Error duplicating template:",C),alert("Failed to duplicate template")}},y=async(v,C)=>{if(confirm(`Are you sure you want to delete "${C}"?`))try{const{error:k}=await oe.from("crm_email_templates").delete().eq("id",v);if(k)throw k;alert("Template deleted successfully!"),h()}catch(k){console.error("Error deleting template:",k),alert("Failed to delete template")}},m=async(v,C)=>{try{const{error:k}=await oe.from("crm_email_templates").update({is_active:!C}).eq("id",v);if(k)throw k;h()}catch(k){console.error("Error updating template:",k),alert("Failed to update template status")}},p=v=>{A(C=>({...C,body:C.body+" "+v,variables:C.variables.includes(v)?C.variables:[...C.variables,v]}))},b=()=>{l(null),A({template_name:"",subject:"",body:"",category:"custom",variables:[]})};return r?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(Nr,{className:"w-5 h-5"}),"Email Templates"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage reusable email templates with variable placeholders"})]}),i.jsxs("button",{onClick:()=>{b(),a(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[i.jsx(Gn,{className:"w-4 h-4"}),"New Template"]})]}),i.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.length===0?i.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx(Nr,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-600",children:"No templates found"}),i.jsx("button",{onClick:()=>a(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Create your first template"})]}):e.map(v=>{var C,k;return i.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:v.template_name}),i.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-700 rounded",children:((C=u.find(S=>S.value===v.category))==null?void 0:C.label)||v.category})]}),i.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[i.jsx("strong",{children:"Subject:"})," ",v.subject]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[i.jsxs("span",{children:["Used ",v.use_count," times"]}),((k=v.variables)==null?void 0:k.length)>0&&i.jsxs("span",{children:["Variables: ",v.variables.length]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>m(v.id,v.is_active),className:`p-2 rounded-lg transition ${v.is_active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-50"}`,title:v.is_active?"Active":"Inactive",children:v.is_active?i.jsx(pa,{className:"w-4 h-4"}):i.jsx(zs,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>g(v),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition",title:"Duplicate",children:i.jsx(lO,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>x(v),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit",children:i.jsx(fg,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>y(v.id,v.template_name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:i.jsx(ks,{className:"w-4 h-4"})})]})]})},v.id)})}),i.jsx(fr,{isOpen:s,onClose:()=>{a(!1),b()},title:o?"Edit Template":"Create New Template",children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Name *"}),i.jsx("input",{type:"text",value:c.template_name,onChange:v=>A({...c,template_name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"e.g., Price Quote - English"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),i.jsx("select",{value:c.category,onChange:v=>A({...c,category:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:u.map(v=>i.jsx("option",{value:v.value,children:v.label},v.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Subject *"}),i.jsx("input",{type:"text",value:c.subject,onChange:v=>A({...c,subject:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"Use variables like {{product_name}}"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Body (HTML) *"}),i.jsx("div",{className:"mb-2 flex flex-wrap gap-1",children:f.map(v=>i.jsx("button",{type:"button",onClick:()=>p(v),className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:v},v))}),i.jsx("textarea",{value:c.body,onChange:v=>A({...c,body:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Enter email template body..."})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{a(!1),b()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:o?"Update Template":"Create Template"})]})]})})]})}function nse(){const{t:e}=Es(),{profile:t}=Qr(),[r,n]=G.useState("company"),[s,a]=G.useState(!0),[o,l]=G.useState(!1),[c,A]=G.useState(null),[u,f]=G.useState([]),[h,d]=G.useState({company_name:"",company_address:"",company_phone:"",company_email:"",tax_rate:11,invoice_prefix:"SAPJ",invoice_start_number:1,email_host:"",email_port:587,email_username:"",low_stock_threshold:100,expiry_alert_days:30,default_language:"en",financial_year_start:"2024-01-01",financial_year_end:"2024-12-31",current_financial_year:"2024"});G.useEffect(()=>{(t==null?void 0:t.role)==="admin"&&(x(),g())},[t]);const x=async()=>{try{const{data:m,error:p}=await oe.from("app_settings").select("*").limit(1).maybeSingle();if(p)throw p;m&&(A(m),d({company_name:m.company_name||"",company_address:m.company_address||"",company_phone:m.company_phone||"",company_email:m.company_email||"",tax_rate:m.tax_rate||11,invoice_prefix:m.invoice_prefix||"SAPJ",invoice_start_number:m.invoice_start_number||1,email_host:m.email_host||"",email_port:m.email_port||587,email_username:m.email_username||"",low_stock_threshold:m.low_stock_threshold||100,expiry_alert_days:m.expiry_alert_days||30,default_language:m.default_language||"en",financial_year_start:m.financial_year_start||"2024-01-01",financial_year_end:m.financial_year_end||"2024-12-31",current_financial_year:m.current_financial_year||"2024"}))}catch(m){console.error("Error loading settings:",m)}finally{a(!1)}},g=async()=>{try{const{data:m,error:p}=await oe.from("user_profiles").select("id, email, full_name, role, is_active, created_at, username").order("created_at",{ascending:!1});if(p)throw p;f(m||[])}catch(m){console.error("Error loading users:",m),f([])}},y=async m=>{m.preventDefault(),l(!0);try{if(c){const{error:p}=await oe.from("app_settings").update({...h,email_host:h.email_host||null,email_username:h.email_username||null}).eq("id",c.id);if(p)throw p}else{const{error:p}=await oe.from("app_settings").insert([{...h,email_host:h.email_host||null,email_username:h.email_username||null}]);if(p)throw p}alert("Settings saved successfully!"),x()}catch(p){console.error("Error saving settings:",p),alert("Failed to save settings. Please try again.")}finally{l(!1)}};return(t==null?void 0:t.role)!=="admin"?i.jsx(as,{children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx("p",{className:"text-xl text-gray-600",children:"You do not have permission to access settings."}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Only administrators can view and modify system settings."})]})}):s?i.jsx(as,{children:i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):i.jsx(as,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Configure system settings and manage users"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"flex -mb-px",children:[i.jsx("button",{onClick:()=>n("company"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="company"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(FB,{className:"w-4 h-4"}),"Company Profile"]})}),i.jsx("button",{onClick:()=>n("users"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="users"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(lb,{className:"w-4 h-4"}),"Users"]})}),i.jsx("button",{onClick:()=>n("financial"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="financial"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ha,{className:"w-4 h-4"}),"Financial Year"]})}),i.jsx("button",{onClick:()=>n("system"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="system"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ri,{className:"w-4 h-4"}),"System"]})}),i.jsx("button",{onClick:()=>n("gmail"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="gmail"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx($s,{className:"w-4 h-4"}),"Gmail"]})}),i.jsx("button",{onClick:()=>n("templates"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="templates"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Nr,{className:"w-4 h-4"}),"Email Templates"]})})]})}),i.jsxs("div",{className:"p-6",children:[r==="gmail"&&i.jsx(ese,{}),r==="templates"&&i.jsx(rse,{}),r==="company"&&i.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(FB,{className:"w-5 h-5"}),"Company Information"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),i.jsx("input",{type:"text",value:h.company_name,onChange:m=>d({...h,company_name:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),i.jsx("textarea",{value:h.company_address,onChange:m=>d({...h,company_address:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"text",value:h.company_phone,onChange:m=>d({...h,company_phone:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:h.company_email,onChange:m=>d({...h,company_email:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(To,{className:"w-5 h-5"}),"Financial Settings"]}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Tax Rate (%)"}),i.jsx("input",{type:"number",value:h.tax_rate,onChange:m=>d({...h,tax_rate:Number(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Prefix"}),i.jsx("input",{type:"text",value:h.invoice_prefix,onChange:m=>d({...h,invoice_prefix:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Start Number"}),i.jsx("input",{type:"number",value:h.invoice_start_number,onChange:m=>d({...h,invoice_start_number:Number(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[i.jsx(M1,{className:"w-5 h-5"}),o?"Saving...":"Save Settings"]})})]}),r==="users"&&i.jsx(tse,{users:u,onRefresh:g}),r==="financial"&&i.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(ha,{className:"w-5 h-5"}),"Financial Year Configuration"]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:i.jsx("p",{className:"text-sm text-blue-800",children:"Configure your company's financial year period. This will be used to filter reports and dashboard statistics. The system will automatically organize data based on the selected financial year."})}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Financial Year *"}),i.jsxs("select",{value:h.current_financial_year,onChange:m=>{const p=m.target.value;d({...h,current_financial_year:p,financial_year_start:`${p}-01-01`,financial_year_end:`${p}-12-31`})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"2023",children:"2023"}),i.jsx("option",{value:"2024",children:"2024"}),i.jsx("option",{value:"2025",children:"2025"}),i.jsx("option",{value:"2026",children:"2026"}),i.jsx("option",{value:"2027",children:"2027"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the active financial year"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),i.jsx("input",{type:"date",value:h.financial_year_start,onChange:m=>d({...h,financial_year_start:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year start date"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),i.jsx("input",{type:"date",value:h.financial_year_end,onChange:m=>d({...h,financial_year_end:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year end date"})]})]}),i.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Active Financial Year Period:"}),i.jsxs("p",{className:"text-lg font-bold text-green-900",children:[new Date(h.financial_year_start).toLocaleDateString()," - ",new Date(h.financial_year_end).toLocaleDateString()]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[i.jsx(M1,{className:"w-5 h-5"}),o?"Saving...":"Save Financial Year"]})})]}),r==="system"&&i.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(ri,{className:"w-5 h-5"}),"Inventory Alerts"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Low Stock Threshold"}),i.jsx("input",{type:"number",value:h.low_stock_threshold,onChange:m=>d({...h,low_stock_threshold:Number(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when stock falls below this quantity"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Alert Days"}),i.jsx("input",{type:"number",value:h.expiry_alert_days,onChange:m=>d({...h,expiry_alert_days:Number(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when products will expire within this many days"})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx($s,{className:"w-5 h-5"}),"Email Configuration (Optional)"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),i.jsx("input",{type:"text",value:h.email_host,onChange:m=>d({...h,email_host:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"smtp.example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Port"}),i.jsx("input",{type:"number",value:h.email_port,onChange:m=>d({...h,email_port:Number(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Username"}),i.jsx("input",{type:"text",value:h.email_username,onChange:m=>d({...h,email_username:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"user@example.com"})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Language Preference"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Language"}),i.jsxs("select",{value:h.default_language,onChange:m=>d({...h,default_language:m.target.value}),className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"en",children:"English"}),i.jsx("option",{value:"id",children:"Indonesian"})]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[i.jsx(M1,{className:"w-5 h-5"}),o?"Saving...":"Save Settings"]})})]})]})]})]})})}const Jv=[{email:"admin@pharma.com",password:"admin123",fullName:"Admin User",role:"admin"},{email:"accounts@pharma.com",password:"accounts123",fullName:"Accounts Manager",role:"accounts"},{email:"sales@pharma.com",password:"sales123",fullName:"Sales Representative",role:"sales"},{email:"warehouse@pharma.com",password:"warehouse123",fullName:"Warehouse Staff",role:"warehouse"}];function sse(){const[e,t]=G.useState(!1),[r,n]=G.useState([]),[s,a]=G.useState(!0),o=async()=>{t(!0),n([]);const l=[];for(const c of Jv){try{const{data:A,error:u}=await oe.auth.signUp({email:c.email,password:c.password});if(u){l.push({email:c.email,success:!1,message:`Auth error: ${u.message}`});continue}if(!A.user){l.push({email:c.email,success:!1,message:"No user data returned"});continue}const{error:f}=await oe.from("user_profiles").insert({id:A.user.id,email:c.email,full_name:c.fullName,role:c.role,language:"en",is_active:!0});if(f){l.push({email:c.email,success:!1,message:`Profile error: ${f.message}`});continue}l.push({email:c.email,success:!0,message:`Created successfully (${c.role})`})}catch(A){l.push({email:c.email,success:!1,message:`Error: ${A.message}`})}n([...l])}t(!1)};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl p-8",children:[i.jsx("div",{className:"flex items-center justify-center mb-6",children:i.jsx("div",{className:"bg-blue-600 p-3 rounded-full",children:i.jsx(ow,{className:"w-8 h-8 text-white"})})}),i.jsx("h1",{className:"text-3xl font-bold text-center text-gray-900 mb-2",children:"Database Setup"}),i.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Create sample users for your Pharma Trading System"}),s&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Important Instructions:"}),i.jsxs("ol",{className:"text-sm text-blue-800 space-y-2 list-decimal list-inside",children:[i.jsx("li",{children:"This page will create 4 test users with their profiles"}),i.jsx("li",{children:"Make sure your Supabase email confirmation is disabled in your project settings"}),i.jsx("li",{children:"If email confirmation is enabled, you'll need to confirm emails manually"}),i.jsx("li",{children:"Click the button below to create all users at once"})]}),i.jsx("button",{onClick:()=>a(!1),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Got it, hide this"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Users to create:"}),i.jsx("div",{className:"space-y-2",children:Jv.map(l=>i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:l.email}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Password: ",l.password," | Role: ",l.role]})]}),i.jsx("span",{className:`px-2 py-1 text-xs rounded ${l.role==="admin"?"bg-red-100 text-red-700":l.role==="accounts"?"bg-green-100 text-green-700":l.role==="sales"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:l.role})]},l.email))})]}),i.jsx("button",{onClick:o,disabled:e,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium text-lg mb-6",children:e?"Creating Users...":"Create All Users"}),r.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Results:"}),r.map((l,c)=>i.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${l.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[l.success?i.jsx(pa,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}):i.jsx(zs,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:`font-medium ${l.success?"text-green-900":"text-red-900"}`,children:l.email}),i.jsx("div",{className:`text-sm ${l.success?"text-green-700":"text-red-700"}`,children:l.message})]})]},c))]}),r.length>0&&r.every(l=>l.success)&&i.jsxs("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:[i.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"Success!"}),i.jsx("p",{className:"text-sm text-green-800 mb-3",children:"All users created successfully. You can now navigate to the login page and use any of these credentials:"}),i.jsx("div",{className:"text-sm text-green-800 space-y-1",children:Jv.map(l=>i.jsxs("div",{children:[" ",l.email," / ",l.password]},l.email))}),i.jsx("button",{onClick:()=>window.location.href="/",className:"mt-4 w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition font-medium",children:"Go to Login"})]}),r.length>0&&r.some(l=>!l.success)&&i.jsxs("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[i.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Partial Success"}),i.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Some users failed to create. This is usually because:"}),i.jsxs("ul",{className:"text-sm text-yellow-800 list-disc list-inside space-y-1",children:[i.jsx("li",{children:"The email already exists"}),i.jsx("li",{children:"Email confirmation is required (check Supabase Auth settings)"}),i.jsx("li",{children:"RLS policies prevented profile creation"})]}),i.jsx("p",{className:"text-sm text-yellow-800 mt-3",children:"See CREATE_USERS.md for manual setup instructions."})]})]})})}function ase(){const[e,t]=G.useState("loading"),[r,n]=G.useState("Processing Gmail connection...");G.useEffect(()=>{s()},[]);const s=async()=>{try{console.log("Starting Gmail OAuth callback...");const a=new URLSearchParams(window.location.search),o=a.get("code"),l=a.get("error");if(console.log("Callback params:",{hasCode:!!o,error:l}),l){t("error"),n(`Authorization failed: ${l}`),setTimeout(()=>window.close(),3e3);return}if(!o){t("error"),n("No authorization code received"),setTimeout(()=>window.close(),3e3);return}const{data:{user:c}}=await oe.auth.getUser();if(!c){t("error"),n("User not authenticated"),setTimeout(()=>window.close(),3e3);return}const A=void 0,u=void 0,f=`${window.location.origin}/auth/gmail/callback`;if(console.log("OAuth config:",{hasClientId:!!A,hasClientSecret:!!u,redirectUri:f}),!A||!u)throw new Error("Google OAuth credentials not configured. Please check your .env file.");console.log("Exchanging code for token...");const h=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code:o,client_id:A,client_secret:u,redirect_uri:f,grant_type:"authorization_code"})});if(!h.ok){const p=await h.text();throw console.error("Token exchange failed:",p),new Error(`Token exchange failed: ${p}`)}const d=await h.json();console.log("Token received, fetching profile...");const x=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${d.access_token}`}});if(!x.ok){const p=await x.text();throw console.error("Profile fetch failed:",{status:x.status,statusText:x.statusText,body:p}),new Error(`Failed to fetch Gmail profile (${x.status}): ${p}`)}const g=await x.json();console.log("Profile fetched:",g.email);const y=new Date;y.setSeconds(y.getSeconds()+d.expires_in);const{error:m}=await oe.from("gmail_connections").upsert({user_id:c.id,email_address:g.email,access_token:d.access_token,refresh_token:d.refresh_token,access_token_expires_at:y.toISOString(),is_connected:!0,sync_enabled:!0,last_sync:null},{onConflict:"user_id,email_address"});if(m)throw console.error("Database error:",m),m;console.log("Gmail connection saved to database"),t("success"),n("Gmail connected successfully! You can close this window."),setTimeout(()=>{window.opener&&window.opener.location.reload(),window.close()},2e3)}catch(a){console.error("Callback error:",a),t("error"),n(a instanceof Error?a.message:"Failed to connect Gmail"),setTimeout(()=>window.close(),5e3)}};return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e==="loading"&&i.jsxs(i.Fragment,{children:[i.jsx(Bc,{className:"w-16 h-16 text-blue-600 mx-auto mb-4 animate-spin"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connecting Gmail..."}),i.jsx("p",{className:"text-gray-600",children:r})]}),e==="success"&&i.jsxs(i.Fragment,{children:[i.jsx(pa,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Success!"}),i.jsx("p",{className:"text-gray-600",children:r})]}),e==="error"&&i.jsxs(i.Fragment,{children:[i.jsx(zs,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connection Failed"}),i.jsx("p",{className:"text-gray-600",children:r}),i.jsx("button",{onClick:()=>window.close(),className:"mt-4 px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition",children:"Close Window"})]})]})})}function ise({existingOrder:e,onSuccess:t,onCancel:r}){const{user:n}=Qr(),{t:s}=Es(),[a,o]=G.useState([]),[l,c]=G.useState([]),[A,u]=G.useState({}),[f,h]=G.useState(!1),[d,x]=G.useState({customer_id:"",customer_po_number:"",customer_po_date:new Date().toISOString().split("T")[0],so_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",notes:""}),[g,y]=G.useState(null),[m,p]=G.useState([{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}]);G.useEffect(()=>{b(),v()},[]),G.useEffect(()=>{if(e&&(x({customer_id:e.customer_id,customer_po_number:e.customer_po_number,customer_po_date:e.customer_po_date,so_date:e.so_date,expected_delivery_date:e.expected_delivery_date||"",notes:e.notes||""}),e.sales_order_items&&e.sales_order_items.length>0)){const M=e.sales_order_items.map(V=>({product_id:V.product_id,quantity:V.quantity,unit_price:V.unit_price,discount_percent:V.discount_percent,discount_amount:V.discount_amount,tax_percent:V.tax_percent,tax_amount:V.tax_amount,line_total:V.line_total,item_delivery_date:V.item_delivery_date||"",notes:V.notes||""}));p(M),M.forEach(V=>{V.product_id&&C(V.product_id)})}},[e]);const b=async()=>{try{const{data:M,error:V}=await oe.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(V)throw V;o(M||[])}catch(M){console.error("Error fetching customers:",M.message)}},v=async()=>{try{const{data:M,error:V}=await oe.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(V)throw V;c(M||[])}catch(M){console.error("Error fetching products:",M.message)}},C=async M=>{try{const{data:V,error:H}=await oe.from("batches").select("id, current_stock").eq("product_id",M);if(H)throw H;const se=(V==null?void 0:V.reduce((F,D)=>F+Number(D.current_stock),0))||0,{data:ce}=await oe.from("stock_reservations").select("reserved_quantity").eq("product_id",M).eq("status","active"),B=(ce==null?void 0:ce.reduce((F,D)=>F+Number(D.reserved_quantity),0))||0,U=se-B;u(F=>({...F,[M]:{total_stock:se,reserved_stock:B,free_stock:U}}))}catch(V){console.error("Error fetching stock info:",V.message)}},k=(M,V)=>{if(!l.find(ce=>ce.id===V))return;const se=[...m];se[M].product_id=V,se[M].unit_price=0,p(se),S(M),C(V)},S=M=>{const V=m[M],H=V.quantity*V.unit_price,se=V.discount_percent>0?H*V.discount_percent/100:V.discount_amount,ce=H-se,B=ce*V.tax_percent/100,U=ce+B,F=[...m];F[M]={...V,discount_amount:se,tax_amount:B,line_total:U},p(F)},I=(M,V,H)=>{const se=[...m];se[M]={...se[M],[V]:H};const ce=se[M],B=ce.quantity*ce.unit_price,U=ce.discount_percent>0?B*ce.discount_percent/100:ce.discount_amount,F=B-U,D=F*ce.tax_percent/100,X=F+D;se[M]={...ce,discount_amount:U,tax_amount:D,line_total:X},p(se)},N=()=>{p([...m,{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}])},Q=M=>{if(m.length===1){alert("At least one item is required");return}p(m.filter((V,H)=>H!==M))},L=async()=>{if(!g)return null;try{const M=g.name.split(".").pop(),H=`customer-po/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${M}`}`,{error:se}=await oe.storage.from("sales-order-documents").upload(H,g);if(se)throw se;const{data:{publicUrl:ce}}=oe.storage.from("sales-order-documents").getPublicUrl(H);return ce}catch(M){throw console.error("Error uploading file:",M.message),M}},T=async(M,V=!1)=>{if(M.preventDefault(),!d.customer_id){alert("Please select a customer");return}if(!d.customer_po_number.trim()){alert("Please enter customer PO number");return}if(m.length===0||m.some(H=>!H.product_id||H.quantity<=0)){alert("Please add valid items to the order");return}try{h(!0);let H=(e==null?void 0:e.customer_po_file_url)||null;g&&(H=await L());const se=m.reduce((U,F)=>U+(F.quantity*F.unit_price-F.discount_amount),0),ce=m.reduce((U,F)=>U+F.tax_amount,0),B=m.reduce((U,F)=>U+F.line_total,0);if(e){const{error:U}=await oe.from("sales_orders").update({customer_id:d.customer_id,customer_po_number:d.customer_po_number,customer_po_date:d.customer_po_date,customer_po_file_url:H,so_date:d.so_date,expected_delivery_date:d.expected_delivery_date||null,notes:d.notes||null,status:V?"pending_approval":"draft",subtotal_amount:se,tax_amount:ce,total_amount:B,updated_at:new Date().toISOString()}).eq("id",e.id);if(U)throw U;const{error:F}=await oe.from("sales_order_items").delete().eq("sales_order_id",e.id);if(F)throw F;const D=m.map(K=>({sales_order_id:e.id,product_id:K.product_id,quantity:K.quantity,unit_price:K.unit_price,discount_percent:K.discount_percent,discount_amount:K.discount_amount,tax_percent:K.tax_percent,tax_amount:K.tax_amount,line_total:K.line_total,item_delivery_date:K.item_delivery_date||null,notes:K.notes||null})),{error:X}=await oe.from("sales_order_items").insert(D);if(X)throw X;alert(`Sales order updated successfully${V?" and submitted for approval":""}!`)}else{const{data:U,error:F}=await oe.from("sales_orders").insert({so_number:"",customer_id:d.customer_id,customer_po_number:d.customer_po_number,customer_po_date:d.customer_po_date,customer_po_file_url:H,so_date:d.so_date,expected_delivery_date:d.expected_delivery_date||null,notes:d.notes||null,status:V?"pending_approval":"draft",subtotal_amount:se,tax_amount:ce,total_amount:B,created_by:n==null?void 0:n.id}).select().single();if(F)throw F;const D=m.map(K=>({sales_order_id:U.id,product_id:K.product_id,quantity:K.quantity,unit_price:K.unit_price,discount_percent:K.discount_percent,discount_amount:K.discount_amount,tax_percent:K.tax_percent,tax_amount:K.tax_amount,line_total:K.line_total,item_delivery_date:K.item_delivery_date||null,notes:K.notes||null})),{error:X}=await oe.from("sales_order_items").insert(D);if(X)throw X;alert(`Sales order created successfully${V?" and submitted for approval":""}!`)}t()}catch(H){console.error(e?"Error updating sales order:":"Error creating sales order:",H.message),alert((e?"Failed to update sales order: ":"Failed to create sales order: ")+H.message)}finally{h(!1)}},P=(M,V)=>{const H=A[M];if(!H)return null;const se=H.free_stock>=V;return i.jsxs("div",{className:`text-xs ${se?"text-green-600":"text-red-600"}`,children:[s("salesOrders.freeStock"),": ",H.free_stock," ",!se&&"(Insufficient!)"]})},R=m.reduce((M,V)=>M+(V.quantity*V.unit_price-V.discount_amount),0),z=m.reduce((M,V)=>M+V.tax_amount,0),q=m.reduce((M,V)=>M+V.line_total,0);return i.jsxs("form",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("sales.customer")," *"]}),i.jsxs("select",{value:d.customer_id,onChange:M=>x({...d,customer_id:M.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[i.jsxs("option",{value:"",children:[s("common.filter")," ",s("sales.customer")]}),a.map(M=>i.jsx("option",{value:M.id,children:M.company_name},M.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("salesOrders.customerPoNumber")," *"]}),i.jsx("input",{type:"text",value:d.customer_po_number,onChange:M=>x({...d,customer_po_number:M.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("salesOrders.customerPoDate")," *"]}),i.jsx("input",{type:"date",value:d.customer_po_date,onChange:M=>x({...d,customer_po_date:M.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.soDate")}),i.jsx("input",{type:"date",value:d.so_date,onChange:M=>x({...d,so_date:M.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.expectedDeliveryDate")}),i.jsx("input",{type:"date",value:d.expected_delivery_date,onChange:M=>x({...d,expected_delivery_date:M.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.uploadPo")}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:M=>{var V;return y(((V=M.target.files)==null?void 0:V[0])||null)},className:"w-full border rounded-lg px-3 py-2"}),g&&i.jsx("button",{type:"button",onClick:()=>y(null),className:"text-red-600 hover:text-red-800",children:i.jsx(Xs,{className:"w-5 h-5"})})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.notes")}),i.jsx("textarea",{value:d.notes,onChange:M=>x({...d,notes:M.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Items"}),i.jsxs("button",{type:"button",onClick:N,className:"flex items-center gap-1 text-blue-600 hover:text-blue-800 text-sm",children:[i.jsx(Gn,{className:"w-4 h-4"})," ",s("sales.addItem")]})]}),i.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:m.map((M,V)=>i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsxs("label",{className:"text-xs text-gray-600",children:[s("salesOrders.product")," *"]}),i.jsxs("select",{value:M.product_id,onChange:H=>k(V,H.target.value),className:"w-full border rounded px-2 py-1 text-sm",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),l.map(H=>i.jsx("option",{value:H.id,children:H.product_name},H.id))]}),M.product_id&&P(M.product_id,M.quantity)]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-xs text-gray-600",children:[s("sales.quantity")," *"]}),i.jsx("input",{type:"text",value:M.quantity===0?"":M.quantity,onChange:H=>{const se=H.target.value;if(se==="")I(V,"quantity",0);else{const ce=parseFloat(se);isNaN(ce)||I(V,"quantity",ce)}},onBlur:H=>{H.target.value===""&&I(V,"quantity",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter quantity",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:s("sales.unitPrice")}),i.jsx("input",{type:"text",value:M.unit_price===0?"":M.unit_price,onChange:H=>{const se=H.target.value;if(se==="")I(V,"unit_price",0);else{const ce=parseFloat(se);isNaN(ce)||I(V,"unit_price",ce)}},onBlur:H=>{H.target.value===""&&I(V,"unit_price",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter price"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.discountPercent")}),i.jsx("input",{type:"text",value:M.discount_percent===0?"":M.discount_percent,onChange:H=>{const se=H.target.value;if(se==="")I(V,"discount_percent",0);else{const ce=parseFloat(se);!isNaN(ce)&&ce>=0&&ce<=100&&I(V,"discount_percent",ce)}},onBlur:H=>{H.target.value===""&&I(V,"discount_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.taxPercent")}),i.jsx("input",{type:"text",value:M.tax_percent===0?"":M.tax_percent,onChange:H=>{const se=H.target.value;if(se==="")I(V,"tax_percent",0);else{const ce=parseFloat(se);!isNaN(ce)&&ce>=0&&ce<=100&&I(V,"tax_percent",ce)}},onBlur:H=>{H.target.value===""&&I(V,"tax_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]})]}),i.jsxs("div",{className:"grid grid-cols-6 gap-2 mt-2",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Item Delivery Date"}),i.jsx("input",{type:"date",value:M.item_delivery_date,onChange:H=>I(V,"item_delivery_date",H.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),i.jsxs("div",{className:"col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Notes"}),i.jsx("input",{type:"text",value:M.notes,onChange:H=>I(V,"notes",H.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),i.jsxs("div",{className:"flex items-end justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.lineTotal")}),i.jsxs("div",{className:"text-sm font-medium",children:["Rp ",M.line_total.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),i.jsx("button",{type:"button",onClick:()=>Q(V),className:"text-red-600 hover:text-red-800",children:i.jsx(ks,{className:"w-4 h-4"})})]})]})]},V))})]}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{children:[s("sales.subtotal"),":"]}),i.jsxs("span",{className:"font-medium",children:["Rp ",R.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{children:[s("sales.tax"),":"]}),i.jsxs("span",{className:"font-medium",children:["Rp ",z.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),i.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[i.jsxs("span",{children:[s("salesOrders.grandTotal"),":"]}),i.jsxs("span",{children:["Rp ",q.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",disabled:f,children:s("common.cancel")}),i.jsx("button",{type:"button",onClick:M=>T(M,!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",disabled:f,children:s(f?"common.loading":"salesOrders.saveAsDraft")}),i.jsx("button",{type:"button",onClick:M=>T(M,!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:f,children:f?`${s("common.submit")}...`:s("salesOrders.submitForApproval")})]})]})}function ose(){var at,we;const{user:e,profile:t}=Qr(),{t:r}=Es(),[n,s]=G.useState("active"),[a,o]=G.useState([]),[l,c]=G.useState([]),[A,u]=G.useState([]),[f,h]=G.useState(!0),[d,x]=G.useState(""),[g,y]=G.useState("all"),[m,p]=G.useState(!1),[b,v]=G.useState(!1),[C,k]=G.useState(null),[S,I]=G.useState(null),[N,Q]=G.useState(!1),[L,T]=G.useState(""),[P,R]=G.useState(null),[z,q]=G.useState(!1),[M,V]=G.useState(null),[H,se]=G.useState(!1),[ce,B]=G.useState(""),[U,F]=G.useState(null);G.useEffect(()=>{D(),X()},[n]),G.useEffect(()=>{K()},[d,g,a,n]);const D=async()=>{try{h(!0);let ve=oe.from("sales_orders").select(`
          *,
          customers (
            id,
            company_name
          ),
          sales_order_items (
            id,
            product_id,
            quantity,
            unit_price,
            discount_percent,
            discount_amount,
            tax_percent,
            tax_amount,
            line_total,
            item_delivery_date,
            notes,
            delivered_quantity,
            products (
              id,
              product_name,
              product_code
            )
          )
        `);n==="active"?ve=ve.eq("is_archived",!1):ve=ve.eq("is_archived",!0);const{data:Le,error:tt}=await ve.order("created_at",{ascending:!1});if(tt)throw tt;o(Le||[])}catch(ve){console.error("Error fetching sales orders:",ve.message),alert("Failed to load sales orders")}finally{h(!1)}},X=async()=>{try{const{data:ve,error:Le}=await oe.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(Le)throw Le;u(ve||[])}catch(ve){console.error("Error fetching customers:",ve.message)}},K=()=>{let ve=a;d&&(ve=ve.filter(Le=>{var tt;return Le.so_number.toLowerCase().includes(d.toLowerCase())||Le.customer_po_number.toLowerCase().includes(d.toLowerCase())||((tt=Le.customers)==null?void 0:tt.company_name.toLowerCase().includes(d.toLowerCase()))})),g!=="all"&&(ve=ve.filter(Le=>Le.status===g)),c(ve)},ae=ve=>{const tt={draft:{color:"bg-gray-100 text-gray-800",label:"Draft"},pending_approval:{color:"bg-yellow-100 text-yellow-800",label:"Pending Approval"},approved:{color:"bg-green-100 text-green-800",label:"Approved"},rejected:{color:"bg-red-100 text-red-800",label:"Rejected"},stock_reserved:{color:"bg-blue-100 text-blue-800",label:"Stock Reserved"},shortage:{color:"bg-orange-100 text-orange-800",label:"Shortage"},pending_delivery:{color:"bg-purple-100 text-purple-800",label:"Pending Delivery"},partially_delivered:{color:"bg-indigo-100 text-indigo-800",label:"Partially Delivered"},delivered:{color:"bg-teal-100 text-teal-800",label:"Delivered"},closed:{color:"bg-gray-100 text-gray-800",label:"Closed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[ve]||{color:"bg-gray-100 text-gray-800",label:ve};return i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${tt.color}`,children:tt.label})},he=async ve=>{if(confirm("Submit this sales order for approval?"))try{const{error:Le}=await oe.from("sales_orders").update({status:"pending_approval",updated_at:new Date().toISOString()}).eq("id",ve);if(Le)throw Le;alert("Sales order submitted for approval successfully!"),D()}catch(Le){console.error("Error submitting for approval:",Le.message),alert("Failed to submit for approval")}},Y=async()=>{if(!U||!ce.trim()){alert("Please enter an archive reason");return}try{const{data:{user:ve}}=await oe.auth.getUser();if(!ve)throw new Error("Not authenticated");const{error:Le}=await oe.from("sales_orders").update({is_archived:!0,archived_at:new Date().toISOString(),archived_by:ve.id,archive_reason:ce,updated_at:new Date().toISOString()}).eq("id",U);if(Le)throw Le;alert("Sales order archived successfully!"),se(!1),B(""),F(null),D()}catch(ve){console.error("Error archiving order:",ve.message),alert("Failed to archive order")}},Be=async ve=>{if(confirm("Unarchive this sales order?"))try{const{error:Le}=await oe.from("sales_orders").update({is_archived:!1,archived_at:null,archived_by:null,archive_reason:null,updated_at:new Date().toISOString()}).eq("id",ve);if(Le)throw Le;alert("Sales order unarchived successfully!"),D()}catch(Le){console.error("Error unarchiving order:",Le.message),alert("Failed to unarchive order")}},ee=async ve=>{const Le=prompt("Enter cancellation reason:");if(Le)try{const{data:{user:tt}}=await oe.auth.getUser();if(!tt)throw new Error("Not authenticated");const{error:lt}=await oe.rpc("fn_cancel_sales_order",{p_so_id:ve,p_canceller_id:tt.id,p_reason:Le});if(lt)throw lt;alert("Sales order cancelled successfully!"),D()}catch(tt){console.error("Error cancelling order:",tt.message),alert("Failed to cancel order")}},Te=async ve=>{if(confirm("Are you sure you want to delete this sales order?"))try{const{error:Le}=await oe.from("sales_orders").delete().eq("id",ve);if(Le)throw Le;alert("Sales order deleted successfully!"),D()}catch(Le){console.error("Error deleting order:",Le.message),alert("Failed to delete order")}},Je=ve=>{k(ve),v(!0)},ie=ve=>{I(ve),p(!0)},$e=async ve=>{if(confirm("Approve this sales order? Stock will be reserved automatically."))try{const{data:{user:Le}}=await oe.auth.getUser();if(!Le)throw new Error("Not authenticated");const{error:tt}=await oe.from("sales_orders").update({status:"approved",approved_by:Le.id,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",ve);if(tt)throw tt;const{data:lt,error:it}=await oe.rpc("fn_reserve_stock_for_so_v2",{p_so_id:ve});if(it)console.error("Error reserving stock:",it),console.error("Supabase request failed",it),alert("Order approved but stock reservation failed: "+it.message);else if(lt&&lt.length>0){const Ne=lt[0];Ne.success?alert(" Sales order approved and stock fully reserved!"):alert(` Order approved with stock shortage.

`+Ne.message+`

Import requirements have been created automatically.`)}else alert("Sales order approved!");D()}catch(Le){console.error("Error approving order:",Le.message),alert("Failed to approve order")}},ze=async()=>{if(!P||!L.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:ve}}=await oe.auth.getUser();if(!ve)throw new Error("Not authenticated");const{error:Le}=await oe.from("sales_orders").update({status:"rejected",rejected_by:ve.id,rejected_at:new Date().toISOString(),rejection_reason:L,updated_at:new Date().toISOString()}).eq("id",P);if(Le)throw Le;alert("Sales order rejected"),Q(!1),T(""),R(null),D()}catch(ve){console.error("Error rejecting order:",ve.message),alert("Failed to reject order")}},Fe=ve=>{V(ve),q(!0)},Re={total:a.length,pending_approval:a.filter(ve=>ve.status==="pending_approval").length,stock_reserved:a.filter(ve=>ve.status==="stock_reserved").length,shortage:a.filter(ve=>ve.status==="shortage").length,delivered:a.filter(ve=>ve.status==="delivered").length};return i.jsx(as,{children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Orders"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer purchase orders and track delivery"})]}),i.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[i.jsx(Gn,{className:"w-5 h-5"}),"New Sales Order"]})]}),i.jsx("div",{className:"mb-6 border-b border-gray-200",children:i.jsxs("nav",{className:"flex gap-4",children:[i.jsx("button",{onClick:()=>s("active"),className:`px-4 py-2 font-medium border-b-2 transition ${n==="active"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Orders"}),i.jsx("button",{onClick:()=>s("archived"),className:`px-4 py-2 font-medium border-b-2 transition ${n==="archived"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Archived Orders"})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4 mb-6",children:[i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Orders"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:Re.total})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending Approval"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:Re.pending_approval})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Stock Reserved"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:Re.stock_reserved})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Shortage"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-orange-600",children:Re.shortage})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Delivered"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:Re.delivered})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[i.jsxs("div",{className:"p-4 border-b flex gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(Lc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search by SO number, PO number, or customer...",value:d,onChange:ve=>x(ve.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),i.jsxs("select",{value:g,onChange:ve=>y(ve.target.value),className:"border rounded-lg px-4 py-2",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"draft",children:"Draft"}),i.jsx("option",{value:"pending_approval",children:"Pending Approval"}),i.jsx("option",{value:"approved",children:"Approved"}),i.jsx("option",{value:"stock_reserved",children:"Stock Reserved"}),i.jsx("option",{value:"shortage",children:"Shortage"}),i.jsx("option",{value:"pending_delivery",children:"Pending Delivery"}),i.jsx("option",{value:"partially_delivered",children:"Partially Delivered"}),i.jsx("option",{value:"delivered",children:"Delivered"}),i.jsx("option",{value:"rejected",children:"Rejected"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PO Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Delivery Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status / Approval"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):l.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:"No sales orders found"})}):l.map(ve=>{var Le;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:ve.so_number})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:(Le=ve.customers)==null?void 0:Le.company_name})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:ve.customer_po_number}),i.jsx("div",{className:"text-xs text-gray-500",children:new Date(ve.customer_po_date).toLocaleDateString()})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ve.so_date).toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ve.expected_delivery_date?new Date(ve.expected_delivery_date).toLocaleDateString():"-"}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["Rp ",ve.total_amount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[ae(ve.status),ve.status==="pending_approval"&&(t==null?void 0:t.role)==="admin"&&i.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[i.jsx("button",{onClick:tt=>{tt.stopPropagation(),$e(ve.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Order",children:i.jsx(pa,{className:"w-6 h-6 text-green-600"})}),i.jsx("button",{onClick:tt=>{tt.stopPropagation(),R(ve.id),Q(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Order",children:i.jsx(zs,{className:"w-6 h-6 text-red-600"})})]}),ve.status==="approved"&&i.jsx(pa,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),ve.status==="rejected"&&i.jsx(zs,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>Je(ve),className:"text-blue-600 hover:text-blue-800",title:"View",children:i.jsx(oh,{className:"w-4 h-4"})}),ve.customer_po_file_url&&i.jsx("button",{onClick:()=>Fe(ve.customer_po_file_url),className:"text-purple-600 hover:text-purple-800",title:"View Customer PO",children:i.jsx(jo,{className:"w-4 h-4"})}),(ve.status==="draft"||ve.status==="rejected")&&i.jsx("button",{onClick:()=>ie(ve),className:"text-indigo-600 hover:text-indigo-800",title:"Edit",children:i.jsx(so,{className:"w-4 h-4"})}),ve.status==="draft"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>he(ve.id),className:"text-green-600 hover:text-green-800",title:"Submit for Approval",children:i.jsx(jB,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>Te(ve.id),className:"text-red-600 hover:text-red-800",title:"Delete",children:i.jsx(ks,{className:"w-4 h-4"})})]}),!["cancelled","closed","delivered","rejected"].includes(ve.status)&&n==="active"&&i.jsx("button",{onClick:()=>ee(ve.id),className:"text-orange-600 hover:text-orange-800",title:"Cancel",children:i.jsx(zs,{className:"w-4 h-4"})}),n==="active"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&["delivered","cancelled"].includes(ve.status)&&i.jsx("button",{onClick:()=>{F(ve.id),se(!0)},className:"text-gray-600 hover:text-gray-800",title:"Archive Order",children:i.jsx(Nr,{className:"w-4 h-4"})}),n==="archived"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&i.jsx("button",{onClick:()=>Be(ve.id),className:"text-green-600 hover:text-green-800",title:"Unarchive Order",children:i.jsx(jB,{className:"w-4 h-4"})})]})})]},ve.id)})})]})})]}),m&&i.jsx(fr,{isOpen:m,onClose:()=>{p(!1),I(null)},title:S?"Edit Sales Order":"Create Sales Order",maxWidth:"max-w-6xl",children:i.jsx(ise,{existingOrder:S||void 0,onSuccess:()=>{p(!1),I(null),D()},onCancel:()=>{p(!1),I(null)}})}),b&&C&&i.jsx(fr,{isOpen:b,onClose:()=>{v(!1),k(null)},title:`Sales Order: ${C.so_number}`,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer"}),i.jsx("p",{className:"text-sm text-gray-900",children:(at=C.customers)==null?void 0:at.company_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),i.jsx("div",{className:"mt-1",children:ae(C.status)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer PO Number"}),i.jsx("p",{className:"text-sm text-gray-900",children:C.customer_po_number})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer PO Date"}),i.jsx("p",{className:"text-sm text-gray-900",children:new Date(C.customer_po_date).toLocaleDateString()})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"SO Date"}),i.jsx("p",{className:"text-sm text-gray-900",children:new Date(C.so_date).toLocaleDateString()})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Expected Delivery"}),i.jsx("p",{className:"text-sm text-gray-900",children:C.expected_delivery_date?new Date(C.expected_delivery_date).toLocaleDateString():"Not specified"})]})]}),C.notes&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notes"}),i.jsx("p",{className:"text-sm text-gray-900 mt-1",children:C.notes})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Items"}),i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left",children:"Product"}),i.jsx("th",{className:"px-4 py-2 text-right",children:"Qty"}),i.jsx("th",{className:"px-4 py-2 text-right",children:"Price"}),i.jsx("th",{className:"px-4 py-2 text-right",children:"Total"})]})}),i.jsx("tbody",{children:(we=C.sales_order_items)==null?void 0:we.map(ve=>{var Le;return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-4 py-2",children:(Le=ve.products)==null?void 0:Le.product_name}),i.jsx("td",{className:"px-4 py-2 text-right",children:ve.quantity}),i.jsxs("td",{className:"px-4 py-2 text-right",children:["$",ve.unit_price.toFixed(2)]}),i.jsxs("td",{className:"px-4 py-2 text-right",children:["$",ve.line_total.toFixed(2)]})]},ve.id)})}),i.jsx("tfoot",{className:"bg-gray-50 font-medium",children:i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"px-4 py-2 text-right",children:"Total:"}),i.jsxs("td",{className:"px-4 py-2 text-right",children:["$",C.total_amount.toFixed(2)]})]})})]})]}),C.rejection_reason&&i.jsxs("div",{className:"bg-red-50 p-3 rounded",children:[i.jsx("label",{className:"text-sm font-medium text-red-700",children:"Rejection Reason"}),i.jsx("p",{className:"text-sm text-red-900 mt-1",children:C.rejection_reason})]})]})}),N&&i.jsx(fr,{isOpen:N,onClose:()=>{Q(!1),T(""),R(null)},title:"Reject Sales Order",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{value:L,onChange:ve=>T(ve.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this sales order..."})]}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>{Q(!1),T(""),R(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:ze,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!L.trim(),children:"Reject Order"})]})]})}),H&&i.jsx(fr,{isOpen:H,onClose:()=>{se(!1),B(""),F(null)},title:"Archive Sales Order",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Archive Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{value:ce,onChange:ve=>B(ve.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter reason for archiving this sales order (e.g., Completed and delivered, Cancelled by customer)..."})]}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>{se(!1),B(""),F(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:Y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:!ce.trim(),children:"Archive Order"})]})]})}),z&&M&&i.jsx(fr,{isOpen:z,onClose:()=>{q(!1),V(null)},title:"Customer Purchase Order",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[i.jsx(Nr,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Customer Purchase Order"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click to open in new tab"})]}),i.jsx(ob,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),i.jsx("div",{className:"text-xs text-gray-500 text-center pt-2",children:"Document opens in a new browser tab"})]})})]})})}function lse({requirements:e,onRefresh:t,canEdit:r}){const[n,s]=G.useState(null),[a,o]=G.useState(""),l=G.useRef(null),c=[{value:"high",label:"High",color:"text-red-600",bgColor:"bg-red-50"},{value:"medium",label:"Medium",color:"text-orange-600",bgColor:"bg-orange-50"},{value:"low",label:"Low",color:"text-green-600",bgColor:"bg-green-50"}],A=[{value:"pending",label:"Pending",color:"text-gray-600",bgColor:"bg-gray-50"},{value:"ordered",label:"Ordered",color:"text-blue-600",bgColor:"bg-blue-50"},{value:"partially_received",label:"Partially Received",color:"text-yellow-600",bgColor:"bg-yellow-50"},{value:"received",label:"Received",color:"text-green-600",bgColor:"bg-green-50"},{value:"cancelled",label:"Cancelled",color:"text-red-600",bgColor:"bg-red-50"}];G.useEffect(()=>{n&&l.current&&l.current.focus()},[n]);const u=(p,b,v)=>{if(console.log("startEditing called:",{id:p,field:b,currentValue:v,canEdit:r}),!r){console.log("Cannot edit - canEdit is false");return}s({id:p,field:b}),o(v||""),console.log("Editing cell set:",{id:p,field:b})},f=()=>{s(null),o("")},h=async(p,b)=>{try{const v={};b==="required_quantity"||b==="shortage_quantity"||b==="lead_time_days"?v[b]=Number(a):v[b]=a;const{error:C}=await oe.from("import_requirements").update(v).eq("id",p);if(C)throw C;t(),f()}catch(v){console.error("Error updating import requirement:",v),alert("Failed to update")}},d=(p,b,v)=>{p.key==="Enter"?h(b,v):p.key==="Escape"&&f()},x=p=>c.find(v=>v.value===p)||c[1],g=p=>A.find(v=>v.value===p)||A[0],y=p=>{const b=new Date,C=new Date(p).getTime()-b.getTime();return Math.ceil(C/(1e3*60*60*24))},m=p=>p<0?"text-red-700 font-bold":p<=7?"text-red-600 font-semibold":p<=30?"text-orange-600":"text-gray-600";return i.jsxs("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:[i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Product"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Sales Order"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Customer"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Required Qty"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Shortage Qty"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Delivery Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Priority"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Lead Time"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Notes"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(p=>{var k,S,I,N;const b=y(p.required_delivery_date),v=x(p.priority),C=g(p.status);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-4 py-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:(k=p.products)==null?void 0:k.product_name}),i.jsx("div",{className:"text-xs text-gray-500",children:(S=p.products)==null?void 0:S.product_code})]}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(I=p.sales_orders)==null?void 0:I.so_number}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(N=p.customers)==null?void 0:N.company_name}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===p.id&&n.field==="required_quantity"?i.jsx("input",{ref:l,type:"number",value:a,onChange:Q=>o(Q.target.value),onBlur:()=>h(p.id,"required_quantity"),onKeyDown:Q=>d(Q,p.id,"required_quantity"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsx("div",{onClick:()=>u(p.id,"required_quantity",p.required_quantity),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:p.required_quantity.toLocaleString()})}),i.jsx("td",{className:"px-4 py-3 text-sm text-red-600 font-semibold",children:p.shortage_quantity.toLocaleString()}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===p.id&&n.field==="required_delivery_date"?i.jsx("input",{ref:l,type:"date",value:a,onChange:Q=>o(Q.target.value),onBlur:()=>h(p.id,"required_delivery_date"),onKeyDown:Q=>d(Q,p.id,"required_delivery_date"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsxs("div",{onClick:()=>u(p.id,"required_delivery_date",p.required_delivery_date),className:`${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[i.jsx("div",{className:"text-sm",children:new Date(p.required_delivery_date).toLocaleDateString()}),i.jsx("div",{className:`text-xs ${m(b)}`,children:b<0?`${Math.abs(b)} days overdue`:`${b} days`})]})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===p.id&&n.field==="priority"?i.jsx("select",{ref:l,value:a,onChange:Q=>o(Q.target.value),onBlur:()=>h(p.id,"priority"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(Q=>i.jsx("option",{value:Q.value,children:Q.label},Q.value))}):i.jsx("div",{onClick:()=>u(p.id,"priority",p.priority),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${v.color} ${v.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:v.label})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===p.id&&n.field==="status"?i.jsx("select",{ref:l,value:a,onChange:Q=>o(Q.target.value),onBlur:()=>h(p.id,"status"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:A.map(Q=>i.jsx("option",{value:Q.value,children:Q.label},Q.value))}):i.jsx("div",{onClick:()=>u(p.id,"status",p.status),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${C.color} ${C.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:C.label})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===p.id&&n.field==="lead_time_days"?i.jsx("input",{ref:l,type:"number",value:a,onChange:Q=>o(Q.target.value),onBlur:()=>h(p.id,"lead_time_days"),onKeyDown:Q=>d(Q,p.id,"lead_time_days"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsxs("div",{onClick:()=>u(p.id,"lead_time_days",p.lead_time_days),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[p.lead_time_days," days"]})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===p.id&&n.field==="notes"?i.jsx("textarea",{ref:l,value:a,onChange:Q=>o(Q.target.value),onBlur:()=>h(p.id,"notes"),rows:2,className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsx("div",{onClick:()=>u(p.id,"notes",p.notes),className:`text-sm text-gray-600 max-w-xs truncate ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,title:p.notes||"Click to add notes",children:p.notes||"-"})})]},p.id)})})]}),e.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"No import requirements found"})]})}function cse(){const{profile:e}=Qr(),[t,r]=G.useState([]),[n,s]=G.useState({}),[a,o]=G.useState(!0),[l,c]=G.useState("pending"),[A,u]=G.useState("all"),f=!0;G.useEffect(()=>{h()},[l]);const h=async()=>{try{o(!0);let y=oe.from("import_requirements").select(`
          *,
          products (product_name, product_code),
          sales_orders (so_number),
          customers (company_name)
        `).order("priority",{ascending:!0}).order("required_delivery_date",{ascending:!0});l!=="all"&&(y=y.eq("status",l));const{data:m,error:p}=await y;if(p)throw p;r(m||[]);const b=[...new Set(m==null?void 0:m.map(v=>v.product_id))];b.length>0&&await d(b)}catch(y){console.error("Error fetching import requirements:",y.message),alert("Failed to load import requirements")}finally{o(!1)}},d=async y=>{try{const m={};for(const p of y){const{data:b}=await oe.from("batches").select("current_stock").eq("product_id",p),v=(b==null?void 0:b.reduce((S,I)=>S+Number(I.current_stock),0))||0,{data:C}=await oe.from("stock_reservations").select("reserved_quantity").eq("product_id",p).eq("status","active"),k=(C==null?void 0:C.reduce((S,I)=>S+Number(I.reserved_quantity),0))||0;m[p]={product_id:p,total_stock:v,reserved_stock:k,free_stock:v-k}}s(m)}catch(m){console.error("Error fetching stock info:",m.message)}},x=t.filter(y=>A==="all"?!0:y.priority===A),g={total:t.length,high_priority:t.filter(y=>y.priority==="high"&&y.status==="pending").length,pending:t.filter(y=>y.status==="pending").length,ordered:t.filter(y=>y.status==="ordered").length};return i.jsx(as,{children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Requirements"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage product import needs based on stock shortages"})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6",children:[i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(ri,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Requirements"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:g.total})]})]})}),i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(Fo,{className:"w-5 h-5 md:w-6 md:h-6 text-red-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"High Priority"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-red-600",children:g.high_priority})]})]})}),i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(ha,{className:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:g.pending})]})]})}),i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(ao,{className:"w-5 h-5 md:w-6 md:h-6 text-green-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Ordered"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:g.ordered})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[i.jsxs("div",{className:"p-4 border-b flex gap-4",children:[i.jsxs("select",{value:l,onChange:y=>c(y.target.value),className:"border rounded-lg px-4 py-2",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"pending",children:"Pending"}),i.jsx("option",{value:"ordered",children:"Ordered"}),i.jsx("option",{value:"partially_received",children:"Partially Received"}),i.jsx("option",{value:"received",children:"Received"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsxs("select",{value:A,onChange:y=>u(y.target.value),className:"border rounded-lg px-4 py-2",children:[i.jsx("option",{value:"all",children:"All Priorities"}),i.jsx("option",{value:"high",children:"High Priority"}),i.jsx("option",{value:"medium",children:"Medium Priority"}),i.jsx("option",{value:"low",children:"Low Priority"})]}),i.jsxs("div",{className:"ml-auto text-sm text-gray-600 flex items-center gap-2",children:[i.jsx(ri,{className:"w-4 h-4"}),"Click any cell to edit"]})]}),a?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):i.jsx(lse,{requirements:x,onRefresh:h,canEdit:f})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Fo,{className:"w-5 h-5 text-blue-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"About Import Requirements"}),i.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Import requirements are automatically generated when sales orders are approved but stock is insufficient. The system tracks shortages and helps procurement plan imports based on customer delivery dates and priorities."})]})]})})]})})}function Ase(){const{profile:e}=Qr(),{setCurrentPage:t}=Bl(),[r,n]=G.useState([]),[s,a]=G.useState(!1),[o,l]=G.useState(!1);G.useEffect(()=>{(e==null?void 0:e.role)==="admin"&&c()},[e]);const c=async()=>{try{const f=[],{data:h}=await oe.from("sales_orders").select(`
          id,
          so_number,
          so_date,
          total_amount,
          customers (company_name)
        `).eq("status","pending_approval").order("created_at",{ascending:!1}).limit(5);h&&h.forEach(x=>{var g;f.push({id:x.id,type:"sales_order",number:x.so_number,customer_name:((g=x.customers)==null?void 0:g.company_name)||"Unknown",amount:x.total_amount,date:x.so_date})});const{data:d}=await oe.from("delivery_challans").select(`
          id,
          challan_number,
          challan_date,
          customers (company_name)
        `).eq("approval_status","pending_approval").order("created_at",{ascending:!1}).limit(5);d&&d.forEach(x=>{var g;f.push({id:x.id,type:"delivery_challan",number:x.challan_number,customer_name:((g=x.customers)==null?void 0:g.company_name)||"Unknown",date:x.challan_date})}),n(f),f.length>0&&!o&&a(!0)}catch(f){console.error("Error loading pending approvals:",f)}},A=f=>{a(!1),l(!0),f.type==="sales_order"?t("sales-orders"):t("delivery-challan")},u=()=>{a(!1),l(!0)};return!s||r.length===0?null:i.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-96 max-h-[600px] overflow-hidden rounded-lg shadow-2xl bg-white border border-gray-200 animate-slide-up",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),i.jsx("h3",{className:"font-semibold",children:"Pending Approvals"}),i.jsx("span",{className:"bg-white/20 text-xs px-2 py-0.5 rounded-full",children:r.length})]}),i.jsx("button",{onClick:u,className:"text-white/80 hover:text-white transition",children:i.jsx(Xs,{className:"w-5 h-5"})})]}),i.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:r.map((f,h)=>i.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition ${h===0?"bg-blue-50":""}`,onClick:()=>A(f),children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${f.type==="sales_order"?"bg-blue-100 text-blue-600":"bg-green-100 text-green-600"}`,children:f.type==="sales_order"?i.jsx(Nr,{className:"w-5 h-5"}):i.jsx(JE,{className:"w-5 h-5"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-gray-900",children:f.type==="sales_order"?"Sales Order":"Delivery Challan"}),i.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:f.number})]}),i.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:new Date(f.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),i.jsx("p",{className:"text-sm text-gray-700 mt-1 truncate",children:f.customer_name}),f.amount&&i.jsxs("p",{className:"text-xs font-medium text-blue-600 mt-1",children:["Rp ",f.amount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),h===0&&i.jsx("div",{className:"flex items-center gap-2 mt-2",children:i.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"Click to review "})})]})]})},`${f.type}-${f.id}`))}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 text-center",children:i.jsx("button",{onClick:()=>{u(),t("sales-orders")},className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All Pending Approvals"})}),i.jsx("style",{children:`
        @keyframes slide-up {
          from {
            transform: translateY(100%);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out;
        }
      `})]})}async function c_(e){try{const{error:t}=await oe.from("notifications").insert([{user_id:e.userId,type:e.type,title:e.title,message:e.message,reference_id:e.referenceId||null,reference_type:e.referenceType||null,is_read:!1}]);if(t)throw t}catch(t){console.error("Error creating notification:",t)}}async function mS(){var e;try{const{data:t}=await oe.from("app_settings").select("low_stock_threshold").maybeSingle(),r=(t==null?void 0:t.low_stock_threshold)||100,{data:n}=await oe.from("batches").select("id, batch_number, current_stock, products(product_name)").eq("is_active",!0).lt("current_stock",r);if(n&&n.length>0){const{data:s}=await oe.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse"]);if(s)for(const a of s)(e=(await oe.from("notifications").select("id").eq("user_id",a.id).eq("type","low_stock").eq("is_read",!1).limit(1)).data)!=null&&e.length||await c_({userId:a.id,type:"low_stock",title:"Low Stock Alert",message:`${n.length} batch(es) are running low on stock.`})}}catch(t){console.error("Error checking low stock:",t)}}async function gS(){var e;try{const{data:t}=await oe.from("app_settings").select("expiry_alert_days").maybeSingle(),r=(t==null?void 0:t.expiry_alert_days)||30,n=new Date;n.setDate(n.getDate()+r);const{data:s}=await oe.from("batches").select("id, batch_number, expiry_date, products(product_name)").eq("is_active",!0).not("expiry_date","is",null).lte("expiry_date",n.toISOString()).gte("expiry_date",new Date().toISOString());if(s&&s.length>0){const{data:a}=await oe.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse","sales"]);if(a)for(const o of a)(e=(await oe.from("notifications").select("id").eq("user_id",o.id).eq("type","near_expiry").eq("is_read",!1).limit(1)).data)!=null&&e.length||await c_({userId:o.id,type:"near_expiry",title:"Products Near Expiry",message:`${s.length} batch(es) will expire within ${r} days.`})}}catch(t){console.error("Error checking expiry dates:",t)}}async function xS(){try{const e=new Date().toISOString().split("T")[0],{data:t}=await oe.from("crm_activities").select("id, customer_id, activity_type, customers(company_name)").eq("is_completed",!1).not("follow_up_date","is",null).lte("follow_up_date",e);if(t&&t.length>0){const{data:r}=await oe.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","sales"]);if(r)for(const n of r)await c_({userId:n.id,type:"follow_up",title:"Follow-ups Due",message:`You have ${t.length} follow-up(s) due today.`})}}catch(e){console.error("Error checking follow-ups:",e)}}async function use(){await mS(),await gS(),await xS(),setInterval(async()=>{await mS(),await gS(),await xS()},3e5)}function dse(){const{user:e,profile:t,loading:r}=Qr(),{currentPage:n}=Bl();if(G.useEffect(()=>{e&&t&&use()},[e,t]),window.location.pathname==="/setup")return i.jsx(sse,{});if(window.location.pathname==="/auth/gmail/callback")return i.jsx(ase,{});if(r)return i.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});if(!e||!t)return i.jsx(YP,{});const s=()=>{switch(n){case"dashboard":return i.jsx(PB,{});case"products":return i.jsx(CO,{});case"stock":return i.jsx(EO,{});case"batches":return i.jsx(IO,{});case"inventory":return i.jsx(UO,{});case"customers":return i.jsx(kO,{});case"sales-orders":return i.jsx(ose,{});case"import-requirements":return i.jsx(cse,{});case"crm":return i.jsx(X$,{});case"command-center":return i.jsx(Nz,{});case"tasks":return i.jsx(kz,{});case"delivery-challan":return i.jsx(Gne,{});case"sales":return i.jsx($ne,{});case"finance":return i.jsx(Zne,{});case"settings":return i.jsx(nse,{});default:return i.jsx(PB,{})}};return i.jsxs(i.Fragment,{children:[s(),i.jsx(Ase,{})]})}function fse(){return i.jsx(WP,{children:i.jsx(zP,{children:i.jsx(XP,{children:i.jsx(dse,{})})})})}jk(document.getElementById("root")).render(i.jsx(G.StrictMode,{children:i.jsx(fse,{})}));export{Lr as _,pse as c,mse as g};
